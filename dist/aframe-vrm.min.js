(()=>{var d1=Object.create;var Nd=Object.defineProperty;var u1=Object.getOwnPropertyDescriptor;var f1=Object.getOwnPropertyNames;var p1=Object.getPrototypeOf,A1=Object.prototype.hasOwnProperty;var m1=Ke=>Nd(Ke,"__esModule",{value:!0});var kd=(Ke=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(Ke,{get:(ye,Oe)=>(typeof require!="undefined"?require:ye)[Oe]}):Ke)(function(Ke){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+Ke+'" is not supported')});var g1=(Ke,ye)=>()=>(ye||Ke((ye={exports:{}}).exports,ye),ye.exports);var v1=(Ke,ye,Oe)=>{if(ye&&typeof ye=="object"||typeof ye=="function")for(let it of f1(ye))!A1.call(Ke,it)&&it!=="default"&&Nd(Ke,it,{get:()=>ye[it],enumerable:!(Oe=u1(ye,it))||Oe.enumerable});return Ke},Lc=Ke=>v1(m1(Nd(Ke!=null?d1(p1(Ke)):{},"default",Ke&&Ke.__esModule&&"default"in Ke?{get:()=>Ke.default,enumerable:!0}:{value:Ke,enumerable:!0})),Ke);var Vp=g1((Dc,Gd)=>{(function(ye,Oe){typeof Dc=="object"&&typeof Gd=="object"?Gd.exports=Oe():typeof define=="function"&&define.amd?define([],Oe):typeof Dc=="object"?Dc.AFRAME=Oe():ye.AFRAME=Oe()})(self,()=>(()=>{var Ke={"./node_modules/an-array/index.js":k=>{var K=Object.prototype.toString;k.exports=f;function f(y){return y.BYTES_PER_ELEMENT&&K.call(y.buffer)==="[object ArrayBuffer]"||Array.isArray(y)}},"./node_modules/as-number/index.js":k=>{k.exports=function(f,y){return typeof f=="number"?f:typeof y=="number"?y:0}},"./node_modules/base64-js/index.js":(k,K)=>{"use strict";K.byteLength=p,K.toByteArray=g,K.fromByteArray=m;for(var f=[],y=[],_=typeof Uint8Array!="undefined"?Uint8Array:Array,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",C=0,l=v.length;C<l;++C)f[C]=v[C],y[v.charCodeAt(C)]=C;y["-".charCodeAt(0)]=62,y["_".charCodeAt(0)]=63;function u(x){var S=x.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var b=x.indexOf("=");b===-1&&(b=S);var L=b===S?0:4-b%4;return[b,L]}function p(x){var S=u(x),b=S[0],L=S[1];return(b+L)*3/4-L}function c(x,S,b){return(S+b)*3/4-b}function g(x){var S,b=u(x),L=b[0],M=b[1],F=new _(c(x,L,M)),H=0,Y=M>0?L-4:L,W;for(W=0;W<Y;W+=4)S=y[x.charCodeAt(W)]<<18|y[x.charCodeAt(W+1)]<<12|y[x.charCodeAt(W+2)]<<6|y[x.charCodeAt(W+3)],F[H++]=S>>16&255,F[H++]=S>>8&255,F[H++]=S&255;return M===2&&(S=y[x.charCodeAt(W)]<<2|y[x.charCodeAt(W+1)]>>4,F[H++]=S&255),M===1&&(S=y[x.charCodeAt(W)]<<10|y[x.charCodeAt(W+1)]<<4|y[x.charCodeAt(W+2)]>>2,F[H++]=S>>8&255,F[H++]=S&255),F}function A(x){return f[x>>18&63]+f[x>>12&63]+f[x>>6&63]+f[x&63]}function h(x,S,b){for(var L,M=[],F=S;F<b;F+=3)L=(x[F]<<16&16711680)+(x[F+1]<<8&65280)+(x[F+2]&255),M.push(A(L));return M.join("")}function m(x){for(var S,b=x.length,L=b%3,M=[],F=16383,H=0,Y=b-L;H<Y;H+=F)M.push(h(x,H,H+F>Y?Y:H+F));return L===1?(S=x[b-1],M.push(f[S>>2]+f[S<<4&63]+"==")):L===2&&(S=(x[b-2]<<8)+x[b-1],M.push(f[S>>10]+f[S>>4&63]+f[S<<2&63]+"=")),M.join("")}},"./node_modules/buffer-equal/index.js":(k,K,f)=>{var y=f("./node_modules/buffer/index.js").Buffer;k.exports=function(_,v){if(!!y.isBuffer(_)&&!!y.isBuffer(v)){if(typeof _.equals=="function")return _.equals(v);if(_.length!==v.length)return!1;for(var C=0;C<_.length;C++)if(_[C]!==v[C])return!1;return!0}}},"./node_modules/buffer/index.js":(k,K,f)=>{"use strict";let y=f("./node_modules/base64-js/index.js"),_=f("./node_modules/ieee754/index.js"),v=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;K.Buffer=p,K.SlowBuffer=F,K.INSPECT_MAX_BYTES=50;let C=2147483647;K.kMaxLength=C,p.TYPED_ARRAY_SUPPORT=l(),!p.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{let z=new Uint8Array(1),I={foo:function(){return 42}};return Object.setPrototypeOf(I,Uint8Array.prototype),Object.setPrototypeOf(z,I),z.foo()===42}catch(z){return!1}}Object.defineProperty(p.prototype,"parent",{enumerable:!0,get:function(){if(!!p.isBuffer(this))return this.buffer}}),Object.defineProperty(p.prototype,"offset",{enumerable:!0,get:function(){if(!!p.isBuffer(this))return this.byteOffset}});function u(z){if(z>C)throw new RangeError('The value "'+z+'" is invalid for option "size"');let I=new Uint8Array(z);return Object.setPrototypeOf(I,p.prototype),I}function p(z,I,R){if(typeof z=="number"){if(typeof I=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(z)}return c(z,I,R)}p.poolSize=8192;function c(z,I,R){if(typeof z=="string")return m(z,I);if(ArrayBuffer.isView(z))return S(z);if(z==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof z);if(oe(z,ArrayBuffer)||z&&oe(z.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(oe(z,SharedArrayBuffer)||z&&oe(z.buffer,SharedArrayBuffer)))return b(z,I,R);if(typeof z=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let ee=z.valueOf&&z.valueOf();if(ee!=null&&ee!==z)return p.from(ee,I,R);let he=L(z);if(he)return he;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof z[Symbol.toPrimitive]=="function")return p.from(z[Symbol.toPrimitive]("string"),I,R);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof z)}p.from=function(z,I,R){return c(z,I,R)},Object.setPrototypeOf(p.prototype,Uint8Array.prototype),Object.setPrototypeOf(p,Uint8Array);function g(z){if(typeof z!="number")throw new TypeError('"size" argument must be of type number');if(z<0)throw new RangeError('The value "'+z+'" is invalid for option "size"')}function A(z,I,R){return g(z),z<=0?u(z):I!==void 0?typeof R=="string"?u(z).fill(I,R):u(z).fill(I):u(z)}p.alloc=function(z,I,R){return A(z,I,R)};function h(z){return g(z),u(z<0?0:M(z)|0)}p.allocUnsafe=function(z){return h(z)},p.allocUnsafeSlow=function(z){return h(z)};function m(z,I){if((typeof I!="string"||I==="")&&(I="utf8"),!p.isEncoding(I))throw new TypeError("Unknown encoding: "+I);let R=H(z,I)|0,ee=u(R),he=ee.write(z,I);return he!==R&&(ee=ee.slice(0,he)),ee}function x(z){let I=z.length<0?0:M(z.length)|0,R=u(I);for(let ee=0;ee<I;ee+=1)R[ee]=z[ee]&255;return R}function S(z){if(oe(z,Uint8Array)){let I=new Uint8Array(z);return b(I.buffer,I.byteOffset,I.byteLength)}return x(z)}function b(z,I,R){if(I<0||z.byteLength<I)throw new RangeError('"offset" is outside of buffer bounds');if(z.byteLength<I+(R||0))throw new RangeError('"length" is outside of buffer bounds');let ee;return I===void 0&&R===void 0?ee=new Uint8Array(z):R===void 0?ee=new Uint8Array(z,I):ee=new Uint8Array(z,I,R),Object.setPrototypeOf(ee,p.prototype),ee}function L(z){if(p.isBuffer(z)){let I=M(z.length)|0,R=u(I);return R.length===0||z.copy(R,0,0,I),R}if(z.length!==void 0)return typeof z.length!="number"||Ce(z.length)?u(0):x(z);if(z.type==="Buffer"&&Array.isArray(z.data))return x(z.data)}function M(z){if(z>=C)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+C.toString(16)+" bytes");return z|0}function F(z){return+z!=z&&(z=0),p.alloc(+z)}p.isBuffer=function(I){return I!=null&&I._isBuffer===!0&&I!==p.prototype},p.compare=function(I,R){if(oe(I,Uint8Array)&&(I=p.from(I,I.offset,I.byteLength)),oe(R,Uint8Array)&&(R=p.from(R,R.offset,R.byteLength)),!p.isBuffer(I)||!p.isBuffer(R))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(I===R)return 0;let ee=I.length,he=R.length;for(let _e=0,De=Math.min(ee,he);_e<De;++_e)if(I[_e]!==R[_e]){ee=I[_e],he=R[_e];break}return ee<he?-1:he<ee?1:0},p.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},p.concat=function(I,R){if(!Array.isArray(I))throw new TypeError('"list" argument must be an Array of Buffers');if(I.length===0)return p.alloc(0);let ee;if(R===void 0)for(R=0,ee=0;ee<I.length;++ee)R+=I[ee].length;let he=p.allocUnsafe(R),_e=0;for(ee=0;ee<I.length;++ee){let De=I[ee];if(oe(De,Uint8Array))_e+De.length>he.length?(p.isBuffer(De)||(De=p.from(De)),De.copy(he,_e)):Uint8Array.prototype.set.call(he,De,_e);else if(p.isBuffer(De))De.copy(he,_e);else throw new TypeError('"list" argument must be an Array of Buffers');_e+=De.length}return he};function H(z,I){if(p.isBuffer(z))return z.length;if(ArrayBuffer.isView(z)||oe(z,ArrayBuffer))return z.byteLength;if(typeof z!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof z);let R=z.length,ee=arguments.length>2&&arguments[2]===!0;if(!ee&&R===0)return 0;let he=!1;for(;;)switch(I){case"ascii":case"latin1":case"binary":return R;case"utf8":case"utf-8":return mr(z).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R*2;case"hex":return R>>>1;case"base64":return vt(z).length;default:if(he)return ee?-1:mr(z).length;I=(""+I).toLowerCase(),he=!0}}p.byteLength=H;function Y(z,I,R){let ee=!1;if((I===void 0||I<0)&&(I=0),I>this.length||((R===void 0||R>this.length)&&(R=this.length),R<=0)||(R>>>=0,I>>>=0,R<=I))return"";for(z||(z="utf8");;)switch(z){case"hex":return mt(this,I,R);case"utf8":case"utf-8":return be(this,I,R);case"ascii":return je(this,I,R);case"latin1":case"binary":return nt(this,I,R);case"base64":return pe(this,I,R);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Dt(this,I,R);default:if(ee)throw new TypeError("Unknown encoding: "+z);z=(z+"").toLowerCase(),ee=!0}}p.prototype._isBuffer=!0;function W(z,I,R){let ee=z[I];z[I]=z[R],z[R]=ee}p.prototype.swap16=function(){let I=this.length;if(I%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let R=0;R<I;R+=2)W(this,R,R+1);return this},p.prototype.swap32=function(){let I=this.length;if(I%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let R=0;R<I;R+=4)W(this,R,R+3),W(this,R+1,R+2);return this},p.prototype.swap64=function(){let I=this.length;if(I%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let R=0;R<I;R+=8)W(this,R,R+7),W(this,R+1,R+6),W(this,R+2,R+5),W(this,R+3,R+4);return this},p.prototype.toString=function(){let I=this.length;return I===0?"":arguments.length===0?be(this,0,I):Y.apply(this,arguments)},p.prototype.toLocaleString=p.prototype.toString,p.prototype.equals=function(I){if(!p.isBuffer(I))throw new TypeError("Argument must be a Buffer");return this===I?!0:p.compare(this,I)===0},p.prototype.inspect=function(){let I="",R=K.INSPECT_MAX_BYTES;return I=this.toString("hex",0,R).replace(/(.{2})/g,"$1 ").trim(),this.length>R&&(I+=" ... "),"<Buffer "+I+">"},v&&(p.prototype[v]=p.prototype.inspect),p.prototype.compare=function(I,R,ee,he,_e){if(oe(I,Uint8Array)&&(I=p.from(I,I.offset,I.byteLength)),!p.isBuffer(I))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof I);if(R===void 0&&(R=0),ee===void 0&&(ee=I?I.length:0),he===void 0&&(he=0),_e===void 0&&(_e=this.length),R<0||ee>I.length||he<0||_e>this.length)throw new RangeError("out of range index");if(he>=_e&&R>=ee)return 0;if(he>=_e)return-1;if(R>=ee)return 1;if(R>>>=0,ee>>>=0,he>>>=0,_e>>>=0,this===I)return 0;let De=_e-he,Ct=ee-R,Bt=Math.min(De,Ct),_t=this.slice(he,_e),Mt=I.slice(R,ee);for(let Xt=0;Xt<Bt;++Xt)if(_t[Xt]!==Mt[Xt]){De=_t[Xt],Ct=Mt[Xt];break}return De<Ct?-1:Ct<De?1:0};function te(z,I,R,ee,he){if(z.length===0)return-1;if(typeof R=="string"?(ee=R,R=0):R>2147483647?R=2147483647:R<-2147483648&&(R=-2147483648),R=+R,Ce(R)&&(R=he?0:z.length-1),R<0&&(R=z.length+R),R>=z.length){if(he)return-1;R=z.length-1}else if(R<0)if(he)R=0;else return-1;if(typeof I=="string"&&(I=p.from(I,ee)),p.isBuffer(I))return I.length===0?-1:re(z,I,R,ee,he);if(typeof I=="number")return I=I&255,typeof Uint8Array.prototype.indexOf=="function"?he?Uint8Array.prototype.indexOf.call(z,I,R):Uint8Array.prototype.lastIndexOf.call(z,I,R):re(z,[I],R,ee,he);throw new TypeError("val must be string, number or Buffer")}function re(z,I,R,ee,he){let _e=1,De=z.length,Ct=I.length;if(ee!==void 0&&(ee=String(ee).toLowerCase(),ee==="ucs2"||ee==="ucs-2"||ee==="utf16le"||ee==="utf-16le")){if(z.length<2||I.length<2)return-1;_e=2,De/=2,Ct/=2,R/=2}function Bt(Mt,Xt){return _e===1?Mt[Xt]:Mt.readUInt16BE(Xt*_e)}let _t;if(he){let Mt=-1;for(_t=R;_t<De;_t++)if(Bt(z,_t)===Bt(I,Mt===-1?0:_t-Mt)){if(Mt===-1&&(Mt=_t),_t-Mt+1===Ct)return Mt*_e}else Mt!==-1&&(_t-=_t-Mt),Mt=-1}else for(R+Ct>De&&(R=De-Ct),_t=R;_t>=0;_t--){let Mt=!0;for(let Xt=0;Xt<Ct;Xt++)if(Bt(z,_t+Xt)!==Bt(I,Xt)){Mt=!1;break}if(Mt)return _t}return-1}p.prototype.includes=function(I,R,ee){return this.indexOf(I,R,ee)!==-1},p.prototype.indexOf=function(I,R,ee){return te(this,I,R,ee,!0)},p.prototype.lastIndexOf=function(I,R,ee){return te(this,I,R,ee,!1)};function X(z,I,R,ee){R=Number(R)||0;let he=z.length-R;ee?(ee=Number(ee),ee>he&&(ee=he)):ee=he;let _e=I.length;ee>_e/2&&(ee=_e/2);let De;for(De=0;De<ee;++De){let Ct=parseInt(I.substr(De*2,2),16);if(Ce(Ct))return De;z[R+De]=Ct}return De}function V(z,I,R,ee){return ae(mr(I,z.length-R),z,R,ee)}function O(z,I,R,ee){return ae(Ji(I),z,R,ee)}function Z(z,I,R,ee){return ae(vt(I),z,R,ee)}function ne(z,I,R,ee){return ae(Ei(I,z.length-R),z,R,ee)}p.prototype.write=function(I,R,ee,he){if(R===void 0)he="utf8",ee=this.length,R=0;else if(ee===void 0&&typeof R=="string")he=R,ee=this.length,R=0;else if(isFinite(R))R=R>>>0,isFinite(ee)?(ee=ee>>>0,he===void 0&&(he="utf8")):(he=ee,ee=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let _e=this.length-R;if((ee===void 0||ee>_e)&&(ee=_e),I.length>0&&(ee<0||R<0)||R>this.length)throw new RangeError("Attempt to write outside buffer bounds");he||(he="utf8");let De=!1;for(;;)switch(he){case"hex":return X(this,I,R,ee);case"utf8":case"utf-8":return V(this,I,R,ee);case"ascii":case"latin1":case"binary":return O(this,I,R,ee);case"base64":return Z(this,I,R,ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ne(this,I,R,ee);default:if(De)throw new TypeError("Unknown encoding: "+he);he=(""+he).toLowerCase(),De=!0}},p.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function pe(z,I,R){return I===0&&R===z.length?y.fromByteArray(z):y.fromByteArray(z.slice(I,R))}function be(z,I,R){R=Math.min(z.length,R);let ee=[],he=I;for(;he<R;){let _e=z[he],De=null,Ct=_e>239?4:_e>223?3:_e>191?2:1;if(he+Ct<=R){let Bt,_t,Mt,Xt;switch(Ct){case 1:_e<128&&(De=_e);break;case 2:Bt=z[he+1],(Bt&192)==128&&(Xt=(_e&31)<<6|Bt&63,Xt>127&&(De=Xt));break;case 3:Bt=z[he+1],_t=z[he+2],(Bt&192)==128&&(_t&192)==128&&(Xt=(_e&15)<<12|(Bt&63)<<6|_t&63,Xt>2047&&(Xt<55296||Xt>57343)&&(De=Xt));break;case 4:Bt=z[he+1],_t=z[he+2],Mt=z[he+3],(Bt&192)==128&&(_t&192)==128&&(Mt&192)==128&&(Xt=(_e&15)<<18|(Bt&63)<<12|(_t&63)<<6|Mt&63,Xt>65535&&Xt<1114112&&(De=Xt))}}De===null?(De=65533,Ct=1):De>65535&&(De-=65536,ee.push(De>>>10&1023|55296),De=56320|De&1023),ee.push(De),he+=Ct}return Ue(ee)}let Re=4096;function Ue(z){let I=z.length;if(I<=Re)return String.fromCharCode.apply(String,z);let R="",ee=0;for(;ee<I;)R+=String.fromCharCode.apply(String,z.slice(ee,ee+=Re));return R}function je(z,I,R){let ee="";R=Math.min(z.length,R);for(let he=I;he<R;++he)ee+=String.fromCharCode(z[he]&127);return ee}function nt(z,I,R){let ee="";R=Math.min(z.length,R);for(let he=I;he<R;++he)ee+=String.fromCharCode(z[he]);return ee}function mt(z,I,R){let ee=z.length;(!I||I<0)&&(I=0),(!R||R<0||R>ee)&&(R=ee);let he="";for(let _e=I;_e<R;++_e)he+=fe[z[_e]];return he}function Dt(z,I,R){let ee=z.slice(I,R),he="";for(let _e=0;_e<ee.length-1;_e+=2)he+=String.fromCharCode(ee[_e]+ee[_e+1]*256);return he}p.prototype.slice=function(I,R){let ee=this.length;I=~~I,R=R===void 0?ee:~~R,I<0?(I+=ee,I<0&&(I=0)):I>ee&&(I=ee),R<0?(R+=ee,R<0&&(R=0)):R>ee&&(R=ee),R<I&&(R=I);let he=this.subarray(I,R);return Object.setPrototypeOf(he,p.prototype),he};function pt(z,I,R){if(z%1!=0||z<0)throw new RangeError("offset is not uint");if(z+I>R)throw new RangeError("Trying to access beyond buffer length")}p.prototype.readUintLE=p.prototype.readUIntLE=function(I,R,ee){I=I>>>0,R=R>>>0,ee||pt(I,R,this.length);let he=this[I],_e=1,De=0;for(;++De<R&&(_e*=256);)he+=this[I+De]*_e;return he},p.prototype.readUintBE=p.prototype.readUIntBE=function(I,R,ee){I=I>>>0,R=R>>>0,ee||pt(I,R,this.length);let he=this[I+--R],_e=1;for(;R>0&&(_e*=256);)he+=this[I+--R]*_e;return he},p.prototype.readUint8=p.prototype.readUInt8=function(I,R){return I=I>>>0,R||pt(I,1,this.length),this[I]},p.prototype.readUint16LE=p.prototype.readUInt16LE=function(I,R){return I=I>>>0,R||pt(I,2,this.length),this[I]|this[I+1]<<8},p.prototype.readUint16BE=p.prototype.readUInt16BE=function(I,R){return I=I>>>0,R||pt(I,2,this.length),this[I]<<8|this[I+1]},p.prototype.readUint32LE=p.prototype.readUInt32LE=function(I,R){return I=I>>>0,R||pt(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+this[I+3]*16777216},p.prototype.readUint32BE=p.prototype.readUInt32BE=function(I,R){return I=I>>>0,R||pt(I,4,this.length),this[I]*16777216+(this[I+1]<<16|this[I+2]<<8|this[I+3])},p.prototype.readBigUInt64LE=Ee(function(I){I=I>>>0,pi(I,"offset");let R=this[I],ee=this[I+7];(R===void 0||ee===void 0)&&Jn(I,this.length-8);let he=R+this[++I]*2**8+this[++I]*2**16+this[++I]*2**24,_e=this[++I]+this[++I]*2**8+this[++I]*2**16+ee*2**24;return BigInt(he)+(BigInt(_e)<<BigInt(32))}),p.prototype.readBigUInt64BE=Ee(function(I){I=I>>>0,pi(I,"offset");let R=this[I],ee=this[I+7];(R===void 0||ee===void 0)&&Jn(I,this.length-8);let he=R*2**24+this[++I]*2**16+this[++I]*2**8+this[++I],_e=this[++I]*2**24+this[++I]*2**16+this[++I]*2**8+ee;return(BigInt(he)<<BigInt(32))+BigInt(_e)}),p.prototype.readIntLE=function(I,R,ee){I=I>>>0,R=R>>>0,ee||pt(I,R,this.length);let he=this[I],_e=1,De=0;for(;++De<R&&(_e*=256);)he+=this[I+De]*_e;return _e*=128,he>=_e&&(he-=Math.pow(2,8*R)),he},p.prototype.readIntBE=function(I,R,ee){I=I>>>0,R=R>>>0,ee||pt(I,R,this.length);let he=R,_e=1,De=this[I+--he];for(;he>0&&(_e*=256);)De+=this[I+--he]*_e;return _e*=128,De>=_e&&(De-=Math.pow(2,8*R)),De},p.prototype.readInt8=function(I,R){return I=I>>>0,R||pt(I,1,this.length),this[I]&128?(255-this[I]+1)*-1:this[I]},p.prototype.readInt16LE=function(I,R){I=I>>>0,R||pt(I,2,this.length);let ee=this[I]|this[I+1]<<8;return ee&32768?ee|4294901760:ee},p.prototype.readInt16BE=function(I,R){I=I>>>0,R||pt(I,2,this.length);let ee=this[I+1]|this[I]<<8;return ee&32768?ee|4294901760:ee},p.prototype.readInt32LE=function(I,R){return I=I>>>0,R||pt(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},p.prototype.readInt32BE=function(I,R){return I=I>>>0,R||pt(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},p.prototype.readBigInt64LE=Ee(function(I){I=I>>>0,pi(I,"offset");let R=this[I],ee=this[I+7];(R===void 0||ee===void 0)&&Jn(I,this.length-8);let he=this[I+4]+this[I+5]*2**8+this[I+6]*2**16+(ee<<24);return(BigInt(he)<<BigInt(32))+BigInt(R+this[++I]*2**8+this[++I]*2**16+this[++I]*2**24)}),p.prototype.readBigInt64BE=Ee(function(I){I=I>>>0,pi(I,"offset");let R=this[I],ee=this[I+7];(R===void 0||ee===void 0)&&Jn(I,this.length-8);let he=(R<<24)+this[++I]*2**16+this[++I]*2**8+this[++I];return(BigInt(he)<<BigInt(32))+BigInt(this[++I]*2**24+this[++I]*2**16+this[++I]*2**8+ee)}),p.prototype.readFloatLE=function(I,R){return I=I>>>0,R||pt(I,4,this.length),_.read(this,I,!0,23,4)},p.prototype.readFloatBE=function(I,R){return I=I>>>0,R||pt(I,4,this.length),_.read(this,I,!1,23,4)},p.prototype.readDoubleLE=function(I,R){return I=I>>>0,R||pt(I,8,this.length),_.read(this,I,!0,52,8)},p.prototype.readDoubleBE=function(I,R){return I=I>>>0,R||pt(I,8,this.length),_.read(this,I,!1,52,8)};function Tt(z,I,R,ee,he,_e){if(!p.isBuffer(z))throw new TypeError('"buffer" argument must be a Buffer instance');if(I>he||I<_e)throw new RangeError('"value" argument is out of bounds');if(R+ee>z.length)throw new RangeError("Index out of range")}p.prototype.writeUintLE=p.prototype.writeUIntLE=function(I,R,ee,he){if(I=+I,R=R>>>0,ee=ee>>>0,!he){let Ct=Math.pow(2,8*ee)-1;Tt(this,I,R,ee,Ct,0)}let _e=1,De=0;for(this[R]=I&255;++De<ee&&(_e*=256);)this[R+De]=I/_e&255;return R+ee},p.prototype.writeUintBE=p.prototype.writeUIntBE=function(I,R,ee,he){if(I=+I,R=R>>>0,ee=ee>>>0,!he){let Ct=Math.pow(2,8*ee)-1;Tt(this,I,R,ee,Ct,0)}let _e=ee-1,De=1;for(this[R+_e]=I&255;--_e>=0&&(De*=256);)this[R+_e]=I/De&255;return R+ee},p.prototype.writeUint8=p.prototype.writeUInt8=function(I,R,ee){return I=+I,R=R>>>0,ee||Tt(this,I,R,1,255,0),this[R]=I&255,R+1},p.prototype.writeUint16LE=p.prototype.writeUInt16LE=function(I,R,ee){return I=+I,R=R>>>0,ee||Tt(this,I,R,2,65535,0),this[R]=I&255,this[R+1]=I>>>8,R+2},p.prototype.writeUint16BE=p.prototype.writeUInt16BE=function(I,R,ee){return I=+I,R=R>>>0,ee||Tt(this,I,R,2,65535,0),this[R]=I>>>8,this[R+1]=I&255,R+2},p.prototype.writeUint32LE=p.prototype.writeUInt32LE=function(I,R,ee){return I=+I,R=R>>>0,ee||Tt(this,I,R,4,4294967295,0),this[R+3]=I>>>24,this[R+2]=I>>>16,this[R+1]=I>>>8,this[R]=I&255,R+4},p.prototype.writeUint32BE=p.prototype.writeUInt32BE=function(I,R,ee){return I=+I,R=R>>>0,ee||Tt(this,I,R,4,4294967295,0),this[R]=I>>>24,this[R+1]=I>>>16,this[R+2]=I>>>8,this[R+3]=I&255,R+4};function kt(z,I,R,ee,he){qi(I,ee,he,z,R,7);let _e=Number(I&BigInt(4294967295));z[R++]=_e,_e=_e>>8,z[R++]=_e,_e=_e>>8,z[R++]=_e,_e=_e>>8,z[R++]=_e;let De=Number(I>>BigInt(32)&BigInt(4294967295));return z[R++]=De,De=De>>8,z[R++]=De,De=De>>8,z[R++]=De,De=De>>8,z[R++]=De,R}function un(z,I,R,ee,he){qi(I,ee,he,z,R,7);let _e=Number(I&BigInt(4294967295));z[R+7]=_e,_e=_e>>8,z[R+6]=_e,_e=_e>>8,z[R+5]=_e,_e=_e>>8,z[R+4]=_e;let De=Number(I>>BigInt(32)&BigInt(4294967295));return z[R+3]=De,De=De>>8,z[R+2]=De,De=De>>8,z[R+1]=De,De=De>>8,z[R]=De,R+8}p.prototype.writeBigUInt64LE=Ee(function(I,R=0){return kt(this,I,R,BigInt(0),BigInt("0xffffffffffffffff"))}),p.prototype.writeBigUInt64BE=Ee(function(I,R=0){return un(this,I,R,BigInt(0),BigInt("0xffffffffffffffff"))}),p.prototype.writeIntLE=function(I,R,ee,he){if(I=+I,R=R>>>0,!he){let Bt=Math.pow(2,8*ee-1);Tt(this,I,R,ee,Bt-1,-Bt)}let _e=0,De=1,Ct=0;for(this[R]=I&255;++_e<ee&&(De*=256);)I<0&&Ct===0&&this[R+_e-1]!==0&&(Ct=1),this[R+_e]=(I/De>>0)-Ct&255;return R+ee},p.prototype.writeIntBE=function(I,R,ee,he){if(I=+I,R=R>>>0,!he){let Bt=Math.pow(2,8*ee-1);Tt(this,I,R,ee,Bt-1,-Bt)}let _e=ee-1,De=1,Ct=0;for(this[R+_e]=I&255;--_e>=0&&(De*=256);)I<0&&Ct===0&&this[R+_e+1]!==0&&(Ct=1),this[R+_e]=(I/De>>0)-Ct&255;return R+ee},p.prototype.writeInt8=function(I,R,ee){return I=+I,R=R>>>0,ee||Tt(this,I,R,1,127,-128),I<0&&(I=255+I+1),this[R]=I&255,R+1},p.prototype.writeInt16LE=function(I,R,ee){return I=+I,R=R>>>0,ee||Tt(this,I,R,2,32767,-32768),this[R]=I&255,this[R+1]=I>>>8,R+2},p.prototype.writeInt16BE=function(I,R,ee){return I=+I,R=R>>>0,ee||Tt(this,I,R,2,32767,-32768),this[R]=I>>>8,this[R+1]=I&255,R+2},p.prototype.writeInt32LE=function(I,R,ee){return I=+I,R=R>>>0,ee||Tt(this,I,R,4,2147483647,-2147483648),this[R]=I&255,this[R+1]=I>>>8,this[R+2]=I>>>16,this[R+3]=I>>>24,R+4},p.prototype.writeInt32BE=function(I,R,ee){return I=+I,R=R>>>0,ee||Tt(this,I,R,4,2147483647,-2147483648),I<0&&(I=4294967295+I+1),this[R]=I>>>24,this[R+1]=I>>>16,this[R+2]=I>>>8,this[R+3]=I&255,R+4},p.prototype.writeBigInt64LE=Ee(function(I,R=0){return kt(this,I,R,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),p.prototype.writeBigInt64BE=Ee(function(I,R=0){return un(this,I,R,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function yn(z,I,R,ee,he,_e){if(R+ee>z.length)throw new RangeError("Index out of range");if(R<0)throw new RangeError("Index out of range")}function Sn(z,I,R,ee,he){return I=+I,R=R>>>0,he||yn(z,I,R,4,34028234663852886e22,-34028234663852886e22),_.write(z,I,R,ee,23,4),R+4}p.prototype.writeFloatLE=function(I,R,ee){return Sn(this,I,R,!0,ee)},p.prototype.writeFloatBE=function(I,R,ee){return Sn(this,I,R,!1,ee)};function Nn(z,I,R,ee,he){return I=+I,R=R>>>0,he||yn(z,I,R,8,17976931348623157e292,-17976931348623157e292),_.write(z,I,R,ee,52,8),R+8}p.prototype.writeDoubleLE=function(I,R,ee){return Nn(this,I,R,!0,ee)},p.prototype.writeDoubleBE=function(I,R,ee){return Nn(this,I,R,!1,ee)},p.prototype.copy=function(I,R,ee,he){if(!p.isBuffer(I))throw new TypeError("argument should be a Buffer");if(ee||(ee=0),!he&&he!==0&&(he=this.length),R>=I.length&&(R=I.length),R||(R=0),he>0&&he<ee&&(he=ee),he===ee||I.length===0||this.length===0)return 0;if(R<0)throw new RangeError("targetStart out of bounds");if(ee<0||ee>=this.length)throw new RangeError("Index out of range");if(he<0)throw new RangeError("sourceEnd out of bounds");he>this.length&&(he=this.length),I.length-R<he-ee&&(he=I.length-R+ee);let _e=he-ee;return this===I&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(R,ee,he):Uint8Array.prototype.set.call(I,this.subarray(ee,he),R),_e},p.prototype.fill=function(I,R,ee,he){if(typeof I=="string"){if(typeof R=="string"?(he=R,R=0,ee=this.length):typeof ee=="string"&&(he=ee,ee=this.length),he!==void 0&&typeof he!="string")throw new TypeError("encoding must be a string");if(typeof he=="string"&&!p.isEncoding(he))throw new TypeError("Unknown encoding: "+he);if(I.length===1){let De=I.charCodeAt(0);(he==="utf8"&&De<128||he==="latin1")&&(I=De)}}else typeof I=="number"?I=I&255:typeof I=="boolean"&&(I=Number(I));if(R<0||this.length<R||this.length<ee)throw new RangeError("Out of range index");if(ee<=R)return this;R=R>>>0,ee=ee===void 0?this.length:ee>>>0,I||(I=0);let _e;if(typeof I=="number")for(_e=R;_e<ee;++_e)this[_e]=I;else{let De=p.isBuffer(I)?I:p.from(I,he),Ct=De.length;if(Ct===0)throw new TypeError('The value "'+I+'" is invalid for argument "value"');for(_e=0;_e<ee-R;++_e)this[_e+R]=De[_e%Ct]}return this};let ln={};function En(z,I,R){ln[z]=class extends R{constructor(){super();Object.defineProperty(this,"message",{value:I.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${z}]`,this.stack,delete this.name}get code(){return z}set code(he){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:he,writable:!0})}toString(){return`${this.name} [${z}]: ${this.message}`}}}En("ERR_BUFFER_OUT_OF_BOUNDS",function(z){return z?`${z} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),En("ERR_INVALID_ARG_TYPE",function(z,I){return`The "${z}" argument must be of type number. Received type ${typeof I}`},TypeError),En("ERR_OUT_OF_RANGE",function(z,I,R){let ee=`The value of "${z}" is out of range.`,he=R;return Number.isInteger(R)&&Math.abs(R)>2**32?he=fi(String(R)):typeof R=="bigint"&&(he=String(R),(R>BigInt(2)**BigInt(32)||R<-(BigInt(2)**BigInt(32)))&&(he=fi(he)),he+="n"),ee+=` It must be ${I}. Received ${he}`,ee},RangeError);function fi(z){let I="",R=z.length,ee=z[0]==="-"?1:0;for(;R>=ee+4;R-=3)I=`_${z.slice(R-3,R)}${I}`;return`${z.slice(0,R)}${I}`}function si(z,I,R){pi(I,"offset"),(z[I]===void 0||z[I+R]===void 0)&&Jn(I,z.length-(R+1))}function qi(z,I,R,ee,he,_e){if(z>R||z<I){let De=typeof I=="bigint"?"n":"",Ct;throw _e>3?I===0||I===BigInt(0)?Ct=`>= 0${De} and < 2${De} ** ${(_e+1)*8}${De}`:Ct=`>= -(2${De} ** ${(_e+1)*8-1}${De}) and < 2 ** ${(_e+1)*8-1}${De}`:Ct=`>= ${I}${De} and <= ${R}${De}`,new ln.ERR_OUT_OF_RANGE("value",Ct,z)}si(ee,he,_e)}function pi(z,I){if(typeof z!="number")throw new ln.ERR_INVALID_ARG_TYPE(I,"number",z)}function Jn(z,I,R){throw Math.floor(z)!==z?(pi(z,R),new ln.ERR_OUT_OF_RANGE(R||"offset","an integer",z)):I<0?new ln.ERR_BUFFER_OUT_OF_BOUNDS:new ln.ERR_OUT_OF_RANGE(R||"offset",`>= ${R?1:0} and <= ${I}`,z)}let Fi=/[^+/0-9A-Za-z-_]/g;function vi(z){if(z=z.split("=")[0],z=z.trim().replace(Fi,""),z.length<2)return"";for(;z.length%4!=0;)z=z+"=";return z}function mr(z,I){I=I||1/0;let R,ee=z.length,he=null,_e=[];for(let De=0;De<ee;++De){if(R=z.charCodeAt(De),R>55295&&R<57344){if(!he){if(R>56319){(I-=3)>-1&&_e.push(239,191,189);continue}else if(De+1===ee){(I-=3)>-1&&_e.push(239,191,189);continue}he=R;continue}if(R<56320){(I-=3)>-1&&_e.push(239,191,189),he=R;continue}R=(he-55296<<10|R-56320)+65536}else he&&(I-=3)>-1&&_e.push(239,191,189);if(he=null,R<128){if((I-=1)<0)break;_e.push(R)}else if(R<2048){if((I-=2)<0)break;_e.push(R>>6|192,R&63|128)}else if(R<65536){if((I-=3)<0)break;_e.push(R>>12|224,R>>6&63|128,R&63|128)}else if(R<1114112){if((I-=4)<0)break;_e.push(R>>18|240,R>>12&63|128,R>>6&63|128,R&63|128)}else throw new Error("Invalid code point")}return _e}function Ji(z){let I=[];for(let R=0;R<z.length;++R)I.push(z.charCodeAt(R)&255);return I}function Ei(z,I){let R,ee,he,_e=[];for(let De=0;De<z.length&&!((I-=2)<0);++De)R=z.charCodeAt(De),ee=R>>8,he=R%256,_e.push(he),_e.push(ee);return _e}function vt(z){return y.toByteArray(vi(z))}function ae(z,I,R,ee){let he;for(he=0;he<ee&&!(he+R>=I.length||he>=z.length);++he)I[he+R]=z[he];return he}function oe(z,I){return z instanceof I||z!=null&&z.constructor!=null&&z.constructor.name!=null&&z.constructor.name===I.name}function Ce(z){return z!==z}let fe=function(){let z="0123456789abcdef",I=new Array(256);for(let R=0;R<16;++R){let ee=R*16;for(let he=0;he<16;++he)I[ee+he]=z[R]+z[he]}return I}();function Ee(z){return typeof BigInt=="undefined"?xe:z}function xe(){throw new Error("BigInt not supported")}},"./node_modules/css-loader/dist/runtime/api.js":k=>{"use strict";k.exports=function(K){var f=[];return f.toString=function(){return this.map(function(_){var v="",C=typeof _[5]!="undefined";return _[4]&&(v+="@supports (".concat(_[4],") {")),_[2]&&(v+="@media ".concat(_[2]," {")),C&&(v+="@layer".concat(_[5].length>0?" ".concat(_[5]):""," {")),v+=K(_),C&&(v+="}"),_[2]&&(v+="}"),_[4]&&(v+="}"),v}).join("")},f.i=function(_,v,C,l,u){typeof _=="string"&&(_=[[null,_,void 0]]);var p={};if(C)for(var c=0;c<this.length;c++){var g=this[c][0];g!=null&&(p[g]=!0)}for(var A=0;A<_.length;A++){var h=[].concat(_[A]);C&&p[h[0]]||(typeof u!="undefined"&&(typeof h[5]=="undefined"||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=u),v&&(h[2]&&(h[1]="@media ".concat(h[2]," {").concat(h[1],"}")),h[2]=v),l&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=l):h[4]="".concat(l)),f.push(h))}},f}},"./node_modules/css-loader/dist/runtime/getUrl.js":k=>{"use strict";k.exports=function(K,f){return f||(f={}),K&&(K=String(K.__esModule?K.default:K),/^['"].*['"]$/.test(K)&&(K=K.slice(1,-1)),f.hash&&(K+=f.hash),/["'() \t\n]|(%20)/.test(K)||f.needQuotes?'"'.concat(K.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):K)}},"./node_modules/css-loader/dist/runtime/sourceMaps.js":k=>{"use strict";k.exports=function(K){var f=K[1],y=K[3];if(!y)return f;if(typeof btoa=="function"){var _=btoa(unescape(encodeURIComponent(JSON.stringify(y)))),v="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(_),C="/*# ".concat(v," */");return[f].concat([C]).join(`
`)}return[f].join(`
`)}},"./node_modules/debug/src/browser.js":(k,K,f)=>{K.formatArgs=_,K.save=v,K.load=C,K.useColors=y,K.storage=l(),K.destroy=(()=>{let p=!1;return()=>{p||(p=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),K.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function y(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function _(p){if(p[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+p[0]+(this.useColors?"%c ":" ")+"+"+k.exports.humanize(this.diff),!this.useColors)return;let c="color: "+this.color;p.splice(1,0,c,"color: inherit");let g=0,A=0;p[0].replace(/%[a-zA-Z%]/g,h=>{h!=="%%"&&(g++,h==="%c"&&(A=g))}),p.splice(A,0,c)}K.log=console.debug||console.log||(()=>{});function v(p){try{p?K.storage.setItem("debug",p):K.storage.removeItem("debug")}catch(c){}}function C(){let p;try{p=K.storage.getItem("debug")}catch(c){}return!p&&typeof process!="undefined"&&"env"in process&&(p=process.env.DEBUG),p}function l(){try{return localStorage}catch(p){}}k.exports=f("./node_modules/debug/src/common.js")(K);let{formatters:u}=k.exports;u.j=function(p){try{return JSON.stringify(p)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}},"./node_modules/debug/src/common.js":(k,K,f)=>{function y(_){C.debug=C,C.default=C,C.coerce=A,C.disable=p,C.enable=u,C.enabled=c,C.humanize=f("./node_modules/ms/index.js"),C.destroy=h,Object.keys(_).forEach(m=>{C[m]=_[m]}),C.names=[],C.skips=[],C.formatters={};function v(m){let x=0;for(let S=0;S<m.length;S++)x=(x<<5)-x+m.charCodeAt(S),x|=0;return C.colors[Math.abs(x)%C.colors.length]}C.selectColor=v;function C(m){let x,S=null,b,L;function M(...F){if(!M.enabled)return;let H=M,Y=Number(new Date),W=Y-(x||Y);H.diff=W,H.prev=x,H.curr=Y,x=Y,F[0]=C.coerce(F[0]),typeof F[0]!="string"&&F.unshift("%O");let te=0;F[0]=F[0].replace(/%([a-zA-Z%])/g,(X,V)=>{if(X==="%%")return"%";te++;let O=C.formatters[V];if(typeof O=="function"){let Z=F[te];X=O.call(H,Z),F.splice(te,1),te--}return X}),C.formatArgs.call(H,F),(H.log||C.log).apply(H,F)}return M.namespace=m,M.useColors=C.useColors(),M.color=C.selectColor(m),M.extend=l,M.destroy=C.destroy,Object.defineProperty(M,"enabled",{enumerable:!0,configurable:!1,get:()=>S!==null?S:(b!==C.namespaces&&(b=C.namespaces,L=C.enabled(m)),L),set:F=>{S=F}}),typeof C.init=="function"&&C.init(M),M}function l(m,x){let S=C(this.namespace+(typeof x=="undefined"?":":x)+m);return S.log=this.log,S}function u(m){C.save(m),C.namespaces=m,C.names=[],C.skips=[];let x,S=(typeof m=="string"?m:"").split(/[\s,]+/),b=S.length;for(x=0;x<b;x++)!S[x]||(m=S[x].replace(/\*/g,".*?"),m[0]==="-"?C.skips.push(new RegExp("^"+m.slice(1)+"$")):C.names.push(new RegExp("^"+m+"$")))}function p(){let m=[...C.names.map(g),...C.skips.map(g).map(x=>"-"+x)].join(",");return C.enable(""),m}function c(m){if(m[m.length-1]==="*")return!0;let x,S;for(x=0,S=C.skips.length;x<S;x++)if(C.skips[x].test(m))return!1;for(x=0,S=C.names.length;x<S;x++)if(C.names[x].test(m))return!0;return!1}function g(m){return m.toString().substring(2,m.toString().length-2).replace(/\.\*\?$/,"*")}function A(m){return m instanceof Error?m.stack||m.message:m}function h(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return C.enable(C.load()),C}k.exports=y},"./node_modules/deep-assign/index.js":(k,K,f)=>{"use strict";var y=f("./node_modules/is-obj/index.js"),_=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;function C(p){if(p==null)throw new TypeError("Sources cannot be null or undefined");return Object(p)}function l(p,c,g){var A=c[g];if(A!=null){if(_.call(p,g)&&(p[g]===void 0||p[g]===null))throw new TypeError("Cannot convert undefined or null to object ("+g+")");!_.call(p,g)||!y(A)?p[g]=A:p[g]=u(Object(p[g]),c[g])}}function u(p,c){if(p===c)return p;c=Object(c);for(var g in c)_.call(c,g)&&l(p,c,g);if(Object.getOwnPropertySymbols)for(var A=Object.getOwnPropertySymbols(c),h=0;h<A.length;h++)v.call(c,A[h])&&l(p,c,A[h]);return p}k.exports=function(c){c=C(c);for(var g=1;g<arguments.length;g++)u(c,arguments[g]);return c}},"./node_modules/dtype/index.js":k=>{k.exports=function(K){switch(K){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},"./node_modules/global/window.js":(k,K,f)=>{var y;typeof window!="undefined"?y=window:typeof f.g!="undefined"?y=f.g:typeof self!="undefined"?y=self:y={},k.exports=y},"./node_modules/ieee754/index.js":(k,K)=>{K.read=function(f,y,_,v,C){var l,u,p=C*8-v-1,c=(1<<p)-1,g=c>>1,A=-7,h=_?C-1:0,m=_?-1:1,x=f[y+h];for(h+=m,l=x&(1<<-A)-1,x>>=-A,A+=p;A>0;l=l*256+f[y+h],h+=m,A-=8);for(u=l&(1<<-A)-1,l>>=-A,A+=v;A>0;u=u*256+f[y+h],h+=m,A-=8);if(l===0)l=1-g;else{if(l===c)return u?NaN:(x?-1:1)*(1/0);u=u+Math.pow(2,v),l=l-g}return(x?-1:1)*u*Math.pow(2,l-v)},K.write=function(f,y,_,v,C,l){var u,p,c,g=l*8-C-1,A=(1<<g)-1,h=A>>1,m=C===23?Math.pow(2,-24)-Math.pow(2,-77):0,x=v?0:l-1,S=v?1:-1,b=y<0||y===0&&1/y<0?1:0;for(y=Math.abs(y),isNaN(y)||y===1/0?(p=isNaN(y)?1:0,u=A):(u=Math.floor(Math.log(y)/Math.LN2),y*(c=Math.pow(2,-u))<1&&(u--,c*=2),u+h>=1?y+=m/c:y+=m*Math.pow(2,1-h),y*c>=2&&(u++,c/=2),u+h>=A?(p=0,u=A):u+h>=1?(p=(y*c-1)*Math.pow(2,C),u=u+h):(p=y*Math.pow(2,h-1)*Math.pow(2,C),u=0));C>=8;f[_+x]=p&255,x+=S,p/=256,C-=8);for(u=u<<C|p,g+=C;g>0;f[_+x]=u&255,x+=S,u/=256,g-=8);f[_+x-S]|=b*128}},"./node_modules/is-buffer/index.js":k=>{k.exports=function(y){return y!=null&&(K(y)||f(y)||!!y._isBuffer)};function K(y){return!!y.constructor&&typeof y.constructor.isBuffer=="function"&&y.constructor.isBuffer(y)}function f(y){return typeof y.readFloatLE=="function"&&typeof y.slice=="function"&&K(y.slice(0,0))}},"./node_modules/is-function/index.js":k=>{k.exports=f;var K=Object.prototype.toString;function f(y){if(!y)return!1;var _=K.call(y);return _==="[object Function]"||typeof y=="function"&&_!=="[object RegExp]"||typeof window!="undefined"&&(y===window.setTimeout||y===window.alert||y===window.confirm||y===window.prompt)}},"./node_modules/is-obj/index.js":k=>{"use strict";k.exports=function(K){var f=typeof K;return K!==null&&(f==="object"||f==="function")}},"./node_modules/layout-bmfont-text/index.js":(k,K,f)=>{var y=f("./node_modules/word-wrapper/index.js"),_=f("./node_modules/xtend/immutable.js"),v=f("./node_modules/as-number/index.js"),C=["x","e","a","o","n","s","r","c","u","m","v","w","z"],l=["m","w"],u=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],p="	".charCodeAt(0),c=" ".charCodeAt(0),g=0,A=1,h=2;k.exports=function(re){return new m(re)};function m(te){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(te)}m.prototype.update=function(te){if(te=_({measure:this._measure},te),this._opt=te,this._opt.tabSize=v(this._opt.tabSize,4),!te.font)throw new Error("must provide a valid bitmap font");var re=this.glyphs,X=te.text||"",V=te.font;this._setupSpaceGlyphs(V);var O=y.lines(X,te),Z=te.width||0;re.length=0;var ne=O.reduce(function(Tt,kt){return Math.max(Tt,kt.width,Z)},0),pe=0,be=0,Re=v(te.lineHeight,V.common.lineHeight),Ue=V.common.base,je=Re-Ue,nt=te.letterSpacing||0,mt=Re*O.length-je,Dt=Y(this._opt.align);be-=mt,this._width=ne,this._height=mt,this._descender=Re-Ue,this._baseline=Ue,this._xHeight=L(V),this._capHeight=F(V),this._lineHeight=Re,this._ascender=Re-je-this._xHeight;var pt=this;O.forEach(function(Tt,kt){for(var un=Tt.start,yn=Tt.end,Sn=Tt.width,Nn,ln=un;ln<yn;ln++){var En=X.charCodeAt(ln),fi=pt.getGlyph(V,En);if(fi){Nn&&(pe+=H(V,Nn.id,fi.id));var si=pe;Dt===A?si+=(ne-Sn)/2:Dt===h&&(si+=ne-Sn),re.push({position:[si,be],data:fi,index:ln,line:kt}),pe+=fi.xadvance+nt,Nn=fi}}be+=Re,pe=0}),this._linesTotal=O.length},m.prototype._setupSpaceGlyphs=function(te){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,!(!te.chars||te.chars.length===0)){var re=b(te,c)||M(te)||te.chars[0],X=this._opt.tabSize*re.xadvance;this._fallbackSpaceGlyph=re,this._fallbackTabGlyph=_(re,{x:0,y:0,xadvance:X,id:p,xoffset:0,yoffset:0,width:0,height:0})}},m.prototype.getGlyph=function(te,re){var X=b(te,re);return X||(re===p?this._fallbackTabGlyph:re===c?this._fallbackSpaceGlyph:null)},m.prototype.computeMetrics=function(te,re,X,V){var O=this._opt.letterSpacing||0,Z=this._opt.font,ne=0,pe=0,be=0,Re,Ue;if(!Z.chars||Z.chars.length===0)return{start:re,end:re,width:0};X=Math.min(te.length,X);for(var je=re;je<X;je++){var nt=te.charCodeAt(je),Re=this.getGlyph(Z,nt);if(Re){var mt=Re.xoffset,Dt=Ue?H(Z,Ue.id,Re.id):0;ne+=Dt;var pt=ne+Re.xadvance+O,Tt=ne+Re.width;if(Tt>=V||pt>=V)break;ne=pt,pe=Tt,Ue=Re}be++}return Ue&&(pe+=Ue.xoffset),{start:re,end:re+be,width:pe}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(x);function x(te){Object.defineProperty(m.prototype,te,{get:S(te),configurable:!0})}function S(te){return new Function(["return function "+te+"() {","  return this._"+te,"}"].join(`
`))()}function b(te,re){if(!te.chars||te.chars.length===0)return null;var X=W(te.chars,re);return X>=0?te.chars[X]:null}function L(te){for(var re=0;re<C.length;re++){var X=C[re].charCodeAt(0),V=W(te.chars,X);if(V>=0)return te.chars[V].height}return 0}function M(te){for(var re=0;re<l.length;re++){var X=l[re].charCodeAt(0),V=W(te.chars,X);if(V>=0)return te.chars[V]}return 0}function F(te){for(var re=0;re<u.length;re++){var X=u[re].charCodeAt(0),V=W(te.chars,X);if(V>=0)return te.chars[V].height}return 0}function H(te,re,X){if(!te.kernings||te.kernings.length===0)return 0;for(var V=te.kernings,O=0;O<V.length;O++){var Z=V[O];if(Z.first===re&&Z.second===X)return Z.amount}return 0}function Y(te){return te==="center"?A:te==="right"?h:g}function W(te,re,X){X=X||0;for(var V=X;V<te.length;V++)if(te[V].id===re)return V;return-1}},"./node_modules/load-bmfont/browser.js":(k,K,f)=>{var y=f("./node_modules/buffer/index.js").Buffer,_=f("./node_modules/xhr/index.js"),v=function(){},C=f("./node_modules/parse-bmfont-ascii/index.js"),l=f("./node_modules/parse-bmfont-xml/lib/browser.js"),u=f("./node_modules/parse-bmfont-binary/index.js"),p=f("./node_modules/load-bmfont/lib/is-binary.js"),c=f("./node_modules/xtend/immutable.js"),g=function(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();k.exports=function(m,x){x=typeof x=="function"?x:v,typeof m=="string"?m={uri:m}:m||(m={});var S=m.binary;S&&(m=h(m)),_(m,function(b,L,M){if(b)return x(b);if(!/^2/.test(L.statusCode))return x(new Error("http status code: "+L.statusCode));if(!M)return x(new Error("no body result"));var F=!1;if(A(M)){var H=new Uint8Array(M);M=y.from(H,"binary")}p(M)&&(F=!0,typeof M=="string"&&(M=y.from(M,"binary"))),F||(y.isBuffer(M)&&(M=M.toString(m.encoding)),M=M.trim());var Y;try{var W=L.headers["content-type"];F?Y=u(M):/json/.test(W)||M.charAt(0)==="{"?Y=JSON.parse(M):/xml/.test(W)||M.charAt(0)==="<"?Y=l(M):Y=C(M)}catch(te){x(new Error("error parsing font "+te.message)),x=v}x(null,Y)})};function A(m){var x=Object.prototype.toString;return x.call(m)==="[object ArrayBuffer]"}function h(m){if(g)return c(m,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest=="undefined")throw new Error("your browser does not support XHR loading");var x=new self.XMLHttpRequest;return x.overrideMimeType("text/plain; charset=x-user-defined"),c({xhr:x},m)}},"./node_modules/load-bmfont/lib/is-binary.js":(k,K,f)=>{var y=f("./node_modules/buffer/index.js").Buffer,_=f("./node_modules/buffer-equal/index.js"),v=y.from([66,77,70,3]);k.exports=function(C){return typeof C=="string"?C.substring(0,3)==="BMF":C.length>4&&_(C.slice(0,4),v)}},"./node_modules/ms/index.js":k=>{var K=1e3,f=K*60,y=f*60,_=y*24,v=_*7,C=_*365.25;k.exports=function(g,A){A=A||{};var h=typeof g;if(h==="string"&&g.length>0)return l(g);if(h==="number"&&isFinite(g))return A.long?p(g):u(g);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(g))};function l(g){if(g=String(g),!(g.length>100)){var A=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(g);if(!!A){var h=parseFloat(A[1]),m=(A[2]||"ms").toLowerCase();switch(m){case"years":case"year":case"yrs":case"yr":case"y":return h*C;case"weeks":case"week":case"w":return h*v;case"days":case"day":case"d":return h*_;case"hours":case"hour":case"hrs":case"hr":case"h":return h*y;case"minutes":case"minute":case"mins":case"min":case"m":return h*f;case"seconds":case"second":case"secs":case"sec":case"s":return h*K;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return h;default:return}}}}function u(g){var A=Math.abs(g);return A>=_?Math.round(g/_)+"d":A>=y?Math.round(g/y)+"h":A>=f?Math.round(g/f)+"m":A>=K?Math.round(g/K)+"s":g+"ms"}function p(g){var A=Math.abs(g);return A>=_?c(g,A,_,"day"):A>=y?c(g,A,y,"hour"):A>=f?c(g,A,f,"minute"):A>=K?c(g,A,K,"second"):g+" ms"}function c(g,A,h,m){var x=A>=h*1.5;return Math.round(g/h)+" "+m+(x?"s":"")}},"./node_modules/parse-bmfont-ascii/index.js":k=>{k.exports=function(v){if(!v)throw new Error("no data provided");v=v.toString().trim();var C={pages:[],chars:[],kernings:[]},l=v.split(/\r\n?|\n/g);if(l.length===0)throw new Error("no data in BMFont file");for(var u=0;u<l.length;u++){var p=K(l[u],u);if(!!p)if(p.key==="page"){if(typeof p.data.id!="number")throw new Error("malformed file at line "+u+" -- needs page id=N");if(typeof p.data.file!="string")throw new Error("malformed file at line "+u+' -- needs page file="path"');C.pages[p.data.id]=p.data.file}else p.key==="chars"||p.key==="kernings"||(p.key==="char"?C.chars.push(p.data):p.key==="kerning"?C.kernings.push(p.data):C[p.key]=p.data)}return C};function K(_,v){if(_=_.replace(/\t+/g," ").trim(),!_)return null;var C=_.indexOf(" ");if(C===-1)throw new Error("no named row at line "+v);var l=_.substring(0,C);_=_.substring(C+1),_=_.replace(/letter=[\'\"]\S+[\'\"]/gi,""),_=_.split("="),_=_.map(function(A){return A.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var u=[],p=0;p<_.length;p++){var c=_[p];p===0?u.push({key:c[0],data:""}):p===_.length-1?u[u.length-1].data=f(c[0]):(u[u.length-1].data=f(c[0]),u.push({key:c[1],data:""}))}var g={key:l,data:{}};return u.forEach(function(A){g.data[A.key]=A.data}),g}function f(_){return!_||_.length===0?"":_.indexOf('"')===0||_.indexOf("'")===0?_.substring(1,_.length-1):_.indexOf(",")!==-1?y(_):parseInt(_,10)}function y(_){return _.split(",").map(function(v){return parseInt(v,10)})}},"./node_modules/parse-bmfont-binary/index.js":k=>{var K=[66,77,70];k.exports=function(g){if(g.length<6)throw new Error("invalid buffer length for BMFont");var A=K.every(function(b,L){return g.readUInt8(L)===b});if(!A)throw new Error("BMFont missing BMF byte header");var h=3,m=g.readUInt8(h++);if(m>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var x={kernings:[],chars:[]},S=0;S<5;S++)h+=f(x,g,h);return x};function f(c,g,A){if(A>g.length-1)return 0;var h=g.readUInt8(A++),m=g.readInt32LE(A);switch(A+=4,h){case 1:c.info=y(g,A);break;case 2:c.common=_(g,A);break;case 3:c.pages=v(g,A,m);break;case 4:c.chars=C(g,A,m);break;case 5:c.kernings=l(g,A,m);break}return 5+m}function y(c,g){var A={};A.size=c.readInt16LE(g);var h=c.readUInt8(g+2);return A.smooth=h>>7&1,A.unicode=h>>6&1,A.italic=h>>5&1,A.bold=h>>4&1,h>>3&1&&(A.fixedHeight=1),A.charset=c.readUInt8(g+3)||"",A.stretchH=c.readUInt16LE(g+4),A.aa=c.readUInt8(g+6),A.padding=[c.readInt8(g+7),c.readInt8(g+8),c.readInt8(g+9),c.readInt8(g+10)],A.spacing=[c.readInt8(g+11),c.readInt8(g+12)],A.outline=c.readUInt8(g+13),A.face=p(c,g+14),A}function _(c,g){var A={};A.lineHeight=c.readUInt16LE(g),A.base=c.readUInt16LE(g+2),A.scaleW=c.readUInt16LE(g+4),A.scaleH=c.readUInt16LE(g+6),A.pages=c.readUInt16LE(g+8);var h=c.readUInt8(g+10);return A.packed=0,A.alphaChnl=c.readUInt8(g+11),A.redChnl=c.readUInt8(g+12),A.greenChnl=c.readUInt8(g+13),A.blueChnl=c.readUInt8(g+14),A}function v(c,g,A){for(var h=[],m=u(c,g),x=m.length+1,S=A/x,b=0;b<S;b++)h[b]=c.slice(g,g+m.length).toString("utf8"),g+=x;return h}function C(c,g,A){for(var h=[],m=A/20,x=0;x<m;x++){var S={},b=x*20;S.id=c.readUInt32LE(g+0+b),S.x=c.readUInt16LE(g+4+b),S.y=c.readUInt16LE(g+6+b),S.width=c.readUInt16LE(g+8+b),S.height=c.readUInt16LE(g+10+b),S.xoffset=c.readInt16LE(g+12+b),S.yoffset=c.readInt16LE(g+14+b),S.xadvance=c.readInt16LE(g+16+b),S.page=c.readUInt8(g+18+b),S.chnl=c.readUInt8(g+19+b),h[x]=S}return h}function l(c,g,A){for(var h=[],m=A/10,x=0;x<m;x++){var S={},b=x*10;S.first=c.readUInt32LE(g+0+b),S.second=c.readUInt32LE(g+4+b),S.amount=c.readInt16LE(g+8+b),h[x]=S}return h}function u(c,g){for(var A=g;A<c.length&&c[A]!==0;A++);return c.slice(g,A)}function p(c,g){return u(c,g).toString("utf8")}},"./node_modules/parse-bmfont-xml/lib/browser.js":(k,K,f)=>{var y=f("./node_modules/parse-bmfont-xml/lib/parse-attribs.js"),_=f("./node_modules/xml-parse-from-string/index.js"),v={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};k.exports=function(c){c=c.toString();var g=_(c),A={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(M){var F=g.getElementsByTagName(M)[0];F&&(A[M]=y(C(F)))});var h=g.getElementsByTagName("pages")[0];if(!h)throw new Error("malformed file -- no <pages> element");for(var m=h.getElementsByTagName("page"),x=0;x<m.length;x++){var S=m[x],b=parseInt(S.getAttribute("id"),10),L=S.getAttribute("file");if(isNaN(b))throw new Error('malformed file -- page "id" attribute is NaN');if(!L)throw new Error('malformed file -- needs page "file" attribute');A.pages[parseInt(b,10)]=L}return["chars","kernings"].forEach(function(M){var F=g.getElementsByTagName(M)[0];if(!!F)for(var H=M.substring(0,M.length-1),Y=F.getElementsByTagName(H),W=0;W<Y.length;W++){var te=Y[W];A[M].push(y(C(te)))}}),A};function C(p){var c=l(p);return c.reduce(function(g,A){var h=u(A.nodeName);return g[h]=A.nodeValue,g},{})}function l(p){for(var c=[],g=0;g<p.attributes.length;g++)c.push(p.attributes[g]);return c}function u(p){return v[p.toLowerCase()]||p}},"./node_modules/parse-bmfont-xml/lib/parse-attribs.js":k=>{var K="chasrset";k.exports=function(_){K in _&&(_.charset=_[K],delete _[K]);for(var v in _)v==="face"||v==="charset"||(v==="padding"||v==="spacing"?_[v]=f(_[v]):_[v]=parseInt(_[v],10));return _};function f(y){return y.split(",").map(function(_){return parseInt(_,10)})}},"./node_modules/parse-headers/parse-headers.js":k=>{var K=function(y){return y.replace(/^\s+|\s+$/g,"")},f=function(y){return Object.prototype.toString.call(y)==="[object Array]"};k.exports=function(y){if(!y)return{};for(var _={},v=K(y).split(`
`),C=0;C<v.length;C++){var l=v[C],u=l.indexOf(":"),p=K(l.slice(0,u)).toLowerCase(),c=K(l.slice(u+1));typeof _[p]=="undefined"?_[p]=c:f(_[p])?_[p].push(c):_[p]=[_[p],c]}return _}},"./node_modules/quad-indices/index.js":(k,K,f)=>{var y=f("./node_modules/dtype/index.js"),_=f("./node_modules/an-array/index.js"),v=f("./node_modules/is-buffer/index.js"),C=[0,2,3],l=[2,1,3];k.exports=function(p,c){(!p||!(_(p)||v(p)))&&(c=p||{},p=null),typeof c=="number"?c={count:c}:c=c||{};for(var g=typeof c.type=="string"?c.type:"uint16",A=typeof c.count=="number"?c.count:1,h=c.start||0,m=c.clockwise!==!1?C:l,x=m[0],S=m[1],b=m[2],L=A*6,M=p||new(y(g))(L),F=0,H=0;F<L;F+=6,H+=4){var Y=F+h;M[Y+0]=H+0,M[Y+1]=H+1,M[Y+2]=H+2,M[Y+3]=H+x,M[Y+4]=H+S,M[Y+5]=H+b}return M}},"./node_modules/super-animejs/lib/anime.es.js":(k,K,f)=>{"use strict";f.r(K),f.d(K,{default:()=>ps});var y={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},_={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},v=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],C={CSS:{},springs:{}};function l(ue,Me,Ne){return Math.min(Math.max(ue,Me),Ne)}function u(ue,Me){return ue.indexOf(Me)>-1}function p(ue,Me){return ue.apply(null,Me)}var c=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,g=/^rgb/,A=/^hsl/,h={arr:function(ue){return Array.isArray(ue)},obj:function(ue){return u(Object.prototype.toString.call(ue),"Object")},pth:function(ue){return h.obj(ue)&&ue.hasOwnProperty("totalLength")},svg:function(ue){return ue instanceof SVGElement},inp:function(ue){return ue instanceof HTMLInputElement},dom:function(ue){return ue.nodeType||h.svg(ue)},str:function(ue){return typeof ue=="string"},fnc:function(ue){return typeof ue=="function"},und:function(ue){return typeof ue=="undefined"},hex:function(ue){return c.test(ue)},rgb:function(ue){return g.test(ue)},hsl:function(ue){return A.test(ue)},col:function(ue){return h.hex(ue)||h.rgb(ue)||h.hsl(ue)},key:function(ue){return!y.hasOwnProperty(ue)&&!_.hasOwnProperty(ue)&&ue!=="targets"&&ue!=="keyframes"}},m=/\(([^)]+)\)/;function x(ue){var Me=m.exec(ue);return Me?Me[1].split(",").map(function(Ne){return parseFloat(Ne)}):[]}function S(ue,Me){var Ne=x(ue),$e=l(h.und(Ne[0])?1:Ne[0],.1,100),We=l(h.und(Ne[1])?100:Ne[1],.1,100),st=l(h.und(Ne[2])?10:Ne[2],.1,100),yt=l(h.und(Ne[3])?0:Ne[3],.1,100),$t=Math.sqrt(We/$e),Gt=st/(2*Math.sqrt(We*$e)),ot=Gt<1?$t*Math.sqrt(1-Gt*Gt):0,on=1,An=Gt<1?(Gt*$t+-yt)/ot:-yt+$t;function Cn(Fn){var In=Me?Me*Fn/1e3:Fn;return Gt<1?In=Math.exp(-In*Gt*$t)*(on*Math.cos(ot*In)+An*Math.sin(ot*In)):In=(on+An*In)*Math.exp(-In*$t),Fn===0||Fn===1?Fn:1-In}function xi(){var Fn=C.springs[ue];if(Fn)return Fn;for(var In=1/6,Yn=0,Bi=0;;)if(Yn+=In,Cn(Yn)===1){if(Bi++,Bi>=16)break}else Bi=0;var er=Yn*In*1e3;return C.springs[ue]=er,er}return Me?Cn:xi}function b(ue,Me){ue===void 0&&(ue=1),Me===void 0&&(Me=.5);var Ne=l(ue,1,10),$e=l(Me,.1,2);return function(We){return We===0||We===1?We:-Ne*Math.pow(2,10*(We-1))*Math.sin((We-1-$e/(Math.PI*2)*Math.asin(1/Ne))*(Math.PI*2)/$e)}}function L(ue){return ue===void 0&&(ue=10),function(Me){return Math.round(Me*ue)*(1/ue)}}var M=function(){var ue=11,Me=1/(ue-1);function Ne(on,An){return 1-3*An+3*on}function $e(on,An){return 3*An-6*on}function We(on){return 3*on}function st(on,An,Cn){return((Ne(An,Cn)*on+$e(An,Cn))*on+We(An))*on}function yt(on,An,Cn){return 3*Ne(An,Cn)*on*on+2*$e(An,Cn)*on+We(An)}function $t(on,An,Cn,xi,Fn){var In,Yn,Bi=0;do Yn=An+(Cn-An)/2,In=st(Yn,xi,Fn)-on,In>0?Cn=Yn:An=Yn;while(Math.abs(In)>1e-7&&++Bi<10);return Yn}function Gt(on,An,Cn,xi){for(var Fn=0;Fn<4;++Fn){var In=yt(An,Cn,xi);if(In===0)return An;var Yn=st(An,Cn,xi)-on;An-=Yn/In}return An}function ot(on,An,Cn,xi){if(!(0<=on&&on<=1&&0<=Cn&&Cn<=1))return;var Fn=new Float32Array(ue);if(on!==An||Cn!==xi)for(var In=0;In<ue;++In)Fn[In]=st(In*Me,on,Cn);function Yn(Bi){for(var er=0,Qt=1,On=ue-1;Qt!==On&&Fn[Qt]<=Bi;++Qt)er+=Me;--Qt;var Hi=(Bi-Fn[Qt])/(Fn[Qt+1]-Fn[Qt]),$n=er+Hi*Me,U=yt($n,on,Cn);return U>=.001?Gt(Bi,$n,on,Cn):U===0?$n:$t(Bi,er,er+Me,on,Cn)}return function(Bi){return on===An&&Cn===xi||Bi===0||Bi===1?Bi:st(Yn(Bi),An,xi)}}return ot}(),F=function(){var ue=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],Me={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],b],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(yt,$t){return function(Gt){return 1-b(yt,$t)(1-Gt)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(yt,$t){return function(Gt){return Gt<.5?b(yt,$t)(Gt*2)/2:1-b(yt,$t)(Gt*-2+2)/2}}]},Ne={linear:[.25,.25,.75,.75]};for(var $e in Me)for(var We=0,st=Me[$e].length;We<st;We++)Ne["ease"+$e+ue[We]]=Me[$e][We];return Ne}();function H(ue,Me){if(h.fnc(ue))return ue;var Ne=ue.split("(")[0],$e=F[Ne],We=x(ue);switch(Ne){case"spring":return S(ue,Me);case"cubicBezier":return p(M,We);case"steps":return p(L,We);default:return h.fnc($e)?p($e,We):p(M,$e)}}function Y(ue){try{var Me=document.querySelectorAll(ue);return Me}catch(Ne){return}}var W=[];function te(ue,Me){for(var Ne=W,$e=ue.length,We=arguments.length>=2?arguments[1]:void 0,st=0;st<$e;st++)if(st in ue){var yt=ue[st];Me.call(We,yt,st,ue)&&Ne.push(yt)}return W=ue,W.length=0,Ne}function re(ue,Me){Me||(Me=[]);for(var Ne=0,$e=ue.length;Ne<$e;Ne++){var We=ue[Ne];Array.isArray(We)?re(We,Me):Me.push(We)}return Me}function X(ue){return h.arr(ue)?ue:(h.str(ue)&&(ue=Y(ue)||ue),ue instanceof NodeList||ue instanceof HTMLCollection?[].slice.call(ue):[ue])}function V(ue,Me){return ue.some(function(Ne){return Ne===Me})}function O(ue){var Me={};for(var Ne in ue)Me[Ne]=ue[Ne];return Me}function Z(ue,Me){var Ne=O(ue);for(var $e in ue)Ne[$e]=Me.hasOwnProperty($e)?Me[$e]:ue[$e];return Ne}function ne(ue,Me){var Ne=O(ue);for(var $e in Me)Ne[$e]=h.und(ue[$e])?Me[$e]:ue[$e];return Ne}var pe=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g;function be(ue){var Me=pe.exec(ue);return Me?"rgba("+Me[1]+",1)":ue}var Re=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Ue=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function je(ue){var Me=ue.replace(Re,function(yt,$t,Gt,ot){return $t+$t+Gt+Gt+ot+ot}),Ne=Ue.exec(Me),$e=parseInt(Ne[1],16),We=parseInt(Ne[2],16),st=parseInt(Ne[3],16);return"rgba("+$e+","+We+","+st+",1)"}var nt=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,mt=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g;function Dt(ue){var Me=nt.exec(ue)||mt.exec(ue),Ne=parseInt(Me[1],10)/360,$e=parseInt(Me[2],10)/100,We=parseInt(Me[3],10)/100,st=Me[4]||1;function yt(Cn,xi,Fn){return Fn<0&&(Fn+=1),Fn>1&&(Fn-=1),Fn<1/6?Cn+(xi-Cn)*6*Fn:Fn<1/2?xi:Fn<2/3?Cn+(xi-Cn)*(2/3-Fn)*6:Cn}var $t,Gt,ot;if($e==0)$t=Gt=ot=We;else{var on=We<.5?We*(1+$e):We+$e-We*$e,An=2*We-on;$t=yt(An,on,Ne+1/3),Gt=yt(An,on,Ne),ot=yt(An,on,Ne-1/3)}return"rgba("+$t*255+","+Gt*255+","+ot*255+","+st+")"}function pt(ue){if(h.rgb(ue))return be(ue);if(h.hex(ue))return je(ue);if(h.hsl(ue))return Dt(ue)}var Tt=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function kt(ue){var Me=Tt.exec(ue);if(Me)return Me[2]}function un(ue){if(u(ue,"translate")||ue==="perspective")return"px";if(u(ue,"rotate")||u(ue,"skew"))return"deg"}function yn(ue,Me){return h.fnc(ue)?ue(Me.target,Me.id,Me.total):ue}function Sn(ue,Me){return ue.getAttribute(Me)}function Nn(ue,Me,Ne){var $e=kt(Me);if(V([Ne,"deg","rad","turn"],$e))return Me;var We=C.CSS[Me+Ne];if(!h.und(We))return We;var st=100,yt=document.createElement(ue.tagName),$t=ue.parentNode&&ue.parentNode!==document?ue.parentNode:document.body;$t.appendChild(yt),yt.style.position="absolute",yt.style.width=st+Ne;var Gt=st/yt.offsetWidth;$t.removeChild(yt);var ot=Gt*parseFloat(Me);return C.CSS[Me+Ne]=ot,ot}function ln(ue,Me,Ne){if(Me in ue.style){var $e=Me.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),We=ue.style[Me]||getComputedStyle(ue).getPropertyValue($e)||"0";return Ne?Nn(ue,We,Ne):We}}function En(ue,Me){if(h.dom(ue)&&!h.inp(ue)&&(Sn(ue,Me)||h.svg(ue)&&ue[Me]))return"attribute";if(h.dom(ue)&&V(v,Me))return"transform";if(h.dom(ue)&&Me!=="transform"&&ln(ue,Me))return"css";if(ue[Me]!=null)return"object"}var fi=/(\w+)\(([^)]*)\)/g;function si(ue){if(!!h.dom(ue)){for(var Me=ue.style.transform||"",Ne=new Map,$e;$e=fi.exec(Me);)Ne.set($e[1],$e[2]);return Ne}}function qi(ue,Me,Ne,$e){var We=u(Me,"scale")?1:0+un(Me),st=si(ue).get(Me)||We;return Ne&&(Ne.transforms.list.set(Me,st),Ne.transforms.last=Me),$e?Nn(ue,st,$e):st}function pi(ue,Me,Ne,$e){switch(En(ue,Me)){case"transform":return qi(ue,Me,$e,Ne);case"css":return ln(ue,Me,Ne);case"attribute":return Sn(ue,Me);default:return ue[Me]||0}}var Jn=/^(\*=|\+=|-=)/;function Fi(ue,Me){var Ne=Jn.exec(ue);if(!Ne)return ue;var $e=kt(ue)||0,We=parseFloat(Me),st=parseFloat(ue.replace(Ne[0],""));switch(Ne[0][0]){case"+":return We+st+$e;case"-":return We-st+$e;case"*":return We*st+$e}}var vi=/\s/g;function mr(ue,Me){if(h.col(ue))return pt(ue);var Ne=kt(ue),$e=Ne?ue.substr(0,ue.length-Ne.length):ue;return Me&&!vi.test(ue)?$e+Me:$e}function Ji(ue,Me){return Math.sqrt(Math.pow(Me.x-ue.x,2)+Math.pow(Me.y-ue.y,2))}function Ei(ue){return Math.PI*2*Sn(ue,"r")}function vt(ue){return Sn(ue,"width")*2+Sn(ue,"height")*2}function ae(ue){return Ji({x:Sn(ue,"x1"),y:Sn(ue,"y1")},{x:Sn(ue,"x2"),y:Sn(ue,"y2")})}function oe(ue){for(var Me=ue.points,Ne=0,$e,We=0;We<Me.numberOfItems;We++){var st=Me.getItem(We);We>0&&(Ne+=Ji($e,st)),$e=st}return Ne}function Ce(ue){var Me=ue.points;return oe(ue)+Ji(Me.getItem(Me.numberOfItems-1),Me.getItem(0))}function fe(ue){if(ue.getTotalLength)return ue.getTotalLength();switch(ue.tagName.toLowerCase()){case"circle":return Ei(ue);case"rect":return vt(ue);case"line":return ae(ue);case"polyline":return oe(ue);case"polygon":return Ce(ue)}}function Ee(ue){var Me=fe(ue);return ue.setAttribute("stroke-dasharray",Me),Me}function xe(ue){for(var Me=ue.parentNode;h.svg(Me)&&(Me=Me.parentNode,!!h.svg(Me.parentNode)););return Me}function z(ue,Me){var Ne=Me||{},$e=Ne.el||xe(ue),We=$e.getBoundingClientRect(),st=Sn($e,"viewBox"),yt=We.width,$t=We.height,Gt=Ne.viewBox||(st?st.split(" "):[0,0,yt,$t]);return{el:$e,viewBox:Gt,x:Gt[0]/1,y:Gt[1]/1,w:yt/Gt[2],h:$t/Gt[3]}}function I(ue,Me){var Ne=h.str(ue)?Y(ue)[0]:ue,$e=Me||100;return function(We){return{property:We,el:Ne,svg:z(Ne),totalLength:fe(Ne)*($e/100)}}}function R(ue,Me){function Ne($t){$t===void 0&&($t=0);var Gt=Me+$t>=1?Me+$t:0;return ue.el.getPointAtLength(Gt)}var $e=z(ue.el,ue.svg),We=Ne(),st=Ne(-1),yt=Ne(1);switch(ue.property){case"x":return(We.x-$e.x)*$e.w;case"y":return(We.y-$e.y)*$e.h;case"angle":return Math.atan2(yt.y-st.y,yt.x-st.x)*180/Math.PI}}var ee=/-?\d*\.?\d+/g;function he(ue,Me){var Ne=mr(h.pth(ue)?ue.totalLength:ue,Me)+"";return{original:Ne,numbers:Ne.match(ee)?Ne.match(ee).map(Number):[0],strings:h.str(ue)||Me?Ne.split(ee):[]}}function _e(ue){var Me=ue?re(h.arr(ue)?ue.map(X):X(ue)):[];return te(Me,function(Ne,$e,We){return We.indexOf(Ne)===$e})}function De(ue){var Me=_e(ue);return Me.map(function(Ne,$e){return{target:Ne,id:$e,total:Me.length,transforms:{list:si(Ne)}}})}var Ct=/^spring/;function Bt(ue,Me){var Ne=O(Me);if(Ct.test(Ne.easing)&&(Ne.duration=S(Ne.easing)),h.arr(ue)){var $e=ue.length,We=$e===2&&!h.obj(ue[0]);We?ue={value:ue}:h.fnc(Me.duration)||(Ne.duration=Me.duration/$e)}var st=h.arr(ue)?ue:[ue];return st.map(function(yt,$t){var Gt=h.obj(yt)&&!h.pth(yt)?yt:{value:yt};return h.und(Gt.delay)&&(Gt.delay=$t?0:Me.delay),h.und(Gt.endDelay)&&(Gt.endDelay=$t===st.length-1?Me.endDelay:0),Gt}).map(function(yt){return ne(yt,Ne)})}function _t(ue){for(var Me=te(re(ue.map(function(st){return Object.keys(st)})),function(st){return h.key(st)}).reduce(function(st,yt){return st.indexOf(yt)<0&&st.push(yt),st},[]),Ne={},$e=function(st){var yt=Me[st];Ne[yt]=ue.map(function($t){var Gt={};for(var ot in $t)h.key(ot)?ot==yt&&(Gt.value=$t[ot]):Gt[ot]=$t[ot];return Gt})},We=0;We<Me.length;We++)$e(We);return Ne}function Mt(ue,Me){var Ne=[],$e=Me.keyframes;$e&&(Me=ne(_t($e),Me));for(var We in Me)h.key(We)&&Ne.push({name:We,tweens:Bt(Me[We],ue)});return Ne}function Xt(ue,Me){var Ne={};for(var $e in ue){var We=yn(ue[$e],Me);h.arr(We)&&(We=We.map(function(st){return yn(st,Me)}),We.length===1&&(We=We[0])),Ne[$e]=We}return Ne.duration=parseFloat(Ne.duration),Ne.delay=parseFloat(Ne.delay),Ne}function Qi(ue,Me){var Ne;return ue.tweens.map(function($e){var We=Xt($e,Me),st=We.value,yt=h.arr(st)?st[1]:st,$t=kt(yt),Gt=pi(Me.target,ue.name,$t,Me),ot=Ne?Ne.to.original:Gt,on=h.arr(st)?st[0]:ot,An=kt(on)||kt(Gt),Cn=$t||An;return h.und(yt)&&(yt=ot),We.from=he(on,Cn),We.to=he(Fi(yt,on),Cn),We.start=Ne?Ne.end:0,We.end=We.start+We.delay+We.duration+We.endDelay,We.easing=H(We.easing,We.duration),We.isPath=h.pth(st),We.isColor=h.col(We.from.original),We.isColor&&(We.round=1),Ne=We,We})}var pn={css:function(ue,Me,Ne){return ue.style[Me]=Ne},attribute:function(ue,Me,Ne){return ue.setAttribute(Me,Ne)},object:function(ue,Me,Ne){return ue[Me]=Ne},transform:function(ue,Me,Ne,$e,We){if($e.list.set(Me,Ne),Me===$e.last||We){var st="";$e.list.forEach(function(yt,$t){st+=$t+"("+yt+") "}),ue.style.transform=st}}};function Oi(ue,Me){for(var Ne=De(ue),$e=0,We=Ne.length;$e<We;$e++){var st=Ne[$e];for(var yt in Me){var $t=yn(Me[yt],st),Gt=st.target,ot=kt($t),on=pi(Gt,yt,ot,st),An=ot||kt(on),Cn=Fi(mr($t,An),on),xi=En(Gt,yt);pn[xi](Gt,yt,Cn,st.transforms,!0)}}}function ti(ue,Me){var Ne=En(ue.target,Me.name);if(Ne){var $e=Qi(Me,ue),We=$e[$e.length-1];return{type:Ne,property:Me.name,animatable:ue,tweens:$e,duration:We.end,delay:$e[0].delay,endDelay:We.endDelay}}}function yi(ue,Me){return te(re(ue.map(function(Ne){return Me.map(function($e){return ti(Ne,$e)})})),function(Ne){return!h.und(Ne)})}function kr(ue,Me){var Ne=ue.length,$e=function(st){return st.timelineOffset?st.timelineOffset:0},We={};return We.duration=Ne?Math.max.apply(Math,ue.map(function(st){return $e(st)+st.duration})):Me.duration,We.delay=Ne?Math.min.apply(Math,ue.map(function(st){return $e(st)+st.delay})):Me.delay,We.endDelay=Ne?We.duration-Math.max.apply(Math,ue.map(function(st){return $e(st)+st.duration-st.endDelay})):Me.endDelay,We}var Ui=0;function es(ue){var Me=Z(y,ue),Ne=Z(_,ue),$e=Mt(Ne,ue),We=De(ue.targets),st=yi(We,$e),yt=kr(st,Ne),$t=Ui;return Ui++,ne(Me,{id:$t,children:[],animatables:We,animations:st,duration:yt.duration,delay:yt.delay,endDelay:yt.endDelay})}var Zi=[],Lr=[],ts,xr=function(){function ue(){ts=requestAnimationFrame(Me)}function Me(Ne){var $e=Zi.length;if($e){for(var We=0;We<$e;){var st=Zi[We];if(!st.paused)st.tick(Ne);else{var yt=Zi.indexOf(st);yt>-1&&(Zi.splice(yt,1),$e=Zi.length)}We++}ue()}else ts=cancelAnimationFrame(ts)}return ue}();function Ni(){if(document.hidden){for(var ue=0,Me=Zi.length;ue<Me;ue++)activeInstance[ue].pause();Lr=Zi.slice(0),Zi=[]}else for(var Ne=0,$e=Lr.length;Ne<$e;Ne++)Lr[Ne].play()}document.addEventListener("visibilitychange",Ni);function Ci(ue){ue===void 0&&(ue={});var Me=0,Ne=0,$e=0,We,st=0,yt=null;function $t(){return window.Promise&&new Promise(function(Qt){return yt=Qt})}var Gt=$t(),ot=es(ue);function on(){ot.reversed=!ot.reversed;for(var Qt=0,On=We.length;Qt<On;Qt++)We[Qt].reversed=ot.reversed}function An(Qt){return ot.reversed?ot.duration-Qt:Qt}function Cn(){Me=0,Ne=An(ot.currentTime)*(1/Ci.speed)}function xi(Qt,On){On&&On.seek(Qt-On.timelineOffset)}function Fn(Qt){if(ot.reversePlayback)for(var Hi=st;Hi--;)xi(Qt,We[Hi]);else for(var On=0;On<st;On++)xi(Qt,We[On])}function In(Qt){for(var On=0,Hi=ot.animations,$n=Hi.length;On<$n;){var U=Hi[On],Q=U.animatable,q=U.tweens,ie=q.length-1,Ae=q[ie];ie&&(Ae=te(q,function(wi){return Qt<wi.end})[0]||Ae);for(var Pe=l(Qt-Ae.start-Ae.delay,0,Ae.duration)/Ae.duration,ze=isNaN(Pe)?1:Ae.easing(Pe),lt=Ae.to.strings,at=Ae.round,Ve=[],et=Ae.to.numbers.length,Et=void 0,zt=0;zt<et;zt++){var tn=void 0,mn=Ae.to.numbers[zt],Ln=Ae.from.numbers[zt]||0;Ae.isPath?tn=R(Ae.value,ze*mn):tn=Ln+ze*(mn-Ln),at&&(Ae.isColor&&zt>2||(tn=Math.round(tn*at)/at)),Ve.push(tn)}var _n=lt.length;if(!_n)Et=Ve[0];else{Et=lt[0];for(var vn=0;vn<_n;vn++){var li=lt[vn],_i=lt[vn+1],Ri=Ve[vn];isNaN(Ri)||(_i?Et+=Ri+_i:Et+=Ri+" ")}}pn[U.type](Q.target,U.property,Et,Q.transforms),U.currentValue=Et,On++}}function Yn(Qt){ot[Qt]&&!ot.passThrough&&ot[Qt](ot)}function Bi(){ot.remaining&&ot.remaining!==!0&&ot.remaining--}function er(Qt){var On=ot.duration,Hi=ot.delay,$n=On-ot.endDelay,U=An(Qt);ot.progress=l(U/On*100,0,100),ot.reversePlayback=U<ot.currentTime,We&&Fn(U),!ot.began&&ot.currentTime>0&&(ot.began=!0,Yn("begin"),Yn("loopBegin")),U<=Hi&&ot.currentTime!==0&&In(0),(U>=$n&&ot.currentTime!==On||!On)&&In(On),U>Hi&&U<$n?(ot.changeBegan||(ot.changeBegan=!0,ot.changeCompleted=!1,Yn("changeBegin")),Yn("change"),In(U)):ot.changeBegan&&(ot.changeCompleted=!0,ot.changeBegan=!1,Yn("changeComplete")),ot.currentTime=l(U,0,On),ot.began&&Yn("update"),Qt>=On&&(Ne=0,Bi(),ot.remaining?(Me=$e,Yn("loopComplete"),Yn("loopBegin"),ot.direction==="alternate"&&on()):(ot.paused=!0,ot.completed||(ot.completed=!0,Yn("loopComplete"),Yn("complete"),"Promise"in window&&(yt(),Gt=$t()))))}return ot.reset=function(){var Qt=ot.direction;ot.passThrough=!1,ot.currentTime=0,ot.progress=0,ot.paused=!0,ot.began=!1,ot.changeBegan=!1,ot.completed=!1,ot.changeCompleted=!1,ot.reversePlayback=!1,ot.reversed=Qt==="reverse",ot.remaining=ot.loop,We=ot.children,st=We.length;for(var On=st;On--;)ot.children[On].reset();(ot.reversed&&ot.loop!==!0||Qt==="alternate"&&ot.loop===1)&&ot.remaining++,In(0)},ot.set=function(Qt,On){return Oi(Qt,On),ot},ot.tick=function(Qt){$e=Qt,Me||(Me=$e),er(($e+(Ne-Me))*Ci.speed)},ot.seek=function(Qt){er(An(Qt))},ot.pause=function(){ot.paused=!0,Cn()},ot.play=function(){!ot.paused||(ot.paused=!1,Zi.push(ot),Cn(),ts||xr())},ot.reverse=function(){on(),Cn()},ot.restart=function(){ot.reset(),ot.play()},ot.finished=Gt,ot.reset(),ot.autoplay&&ot.play(),ot}function $i(ue,Me){for(var Ne=Me.length;Ne--;)V(ue,Me[Ne].animatable.target)&&Me.splice(Ne,1)}function _s(ue){for(var Me=_e(ue),Ne=Zi.length;Ne--;){var $e=Zi[Ne],We=$e.animations,st=$e.children;$i(Me,We);for(var yt=st.length;yt--;){var $t=st[yt],Gt=$t.animations;$i(Me,Gt),!Gt.length&&!$t.children.length&&st.splice(yt,1)}!We.length&&!st.length&&$e.pause()}}function jr(ue,Me){Me===void 0&&(Me={});var Ne=Me.direction||"normal",$e=Me.easing?H(Me.easing):null,We=Me.grid,st=Me.axis,yt=Me.from||0,$t=yt==="first",Gt=yt==="center",ot=yt==="last",on=h.arr(ue),An=parseFloat(on?ue[0]:ue),Cn=on?parseFloat(ue[1]):0,xi=kt(on?ue[1]:ue)||0,Fn=Me.start||0+(on?An:0),In=[],Yn=0;return function(Bi,er,Qt){if($t&&(yt=0),Gt&&(yt=(Qt-1)/2),ot&&(yt=Qt-1),!In.length){for(var On=0;On<Qt;On++){if(!We)In.push(Math.abs(yt-On));else{var Hi=Gt?(We[0]-1)/2:yt%We[0],$n=Gt?(We[1]-1)/2:Math.floor(yt/We[0]),U=On%We[0],Q=Math.floor(On/We[0]),q=Hi-U,ie=$n-Q,Ae=Math.sqrt(q*q+ie*ie);st==="x"&&(Ae=-q),st==="y"&&(Ae=-ie),In.push(Ae)}Yn=Math.max.apply(Math,In)}$e&&(In=In.map(function(ze){return $e(ze/Yn)*Yn})),Ne==="reverse"&&(In=In.map(function(ze){return st?ze<0?ze*-1:-ze:Math.abs(Yn-ze)}))}var Pe=on?(Cn-An)/Yn:An;return Fn+Pe*(Math.round(In[er]*100)/100)+xi}}function Vs(ue){ue===void 0&&(ue={});var Me=Ci(ue);return Me.duration=0,Me.add=function(Ne,$e){var We=Zi.indexOf(Me),st=Me.children;We>-1&&Zi.splice(We,1);function yt(Cn){Cn.passThrough=!0}for(var $t=0;$t<st.length;$t++)yt(st[$t]);var Gt=ne(Ne,Z(_,ue));Gt.targets=Gt.targets||ue.targets;var ot=Me.duration;Gt.autoplay=!1,Gt.direction=Me.direction,Gt.timelineOffset=h.und($e)?ot:Fi($e,ot),yt(Me),Me.seek(Gt.timelineOffset);var on=Ci(Gt);yt(on),st.push(on);var An=kr(st,ue);return Me.delay=An.delay,Me.endDelay=An.endDelay,Me.duration=An.duration,Me.seek(0),Me.reset(),Me.autoplay&&Me.play(),Me},Me}Ci.version="3.0.0",Ci.speed=1,Ci.running=Zi,Ci.remove=_s,Ci.get=pi,Ci.set=Oi,Ci.convertPx=Nn,Ci.path=I,Ci.setDashoffset=Ee,Ci.stagger=jr,Ci.timeline=Vs,Ci.easing=H,Ci.penner=F,Ci.random=function(ue,Me){return Math.floor(Math.random()*(Me-ue+1))+ue};let ps=Ci},"./node_modules/three-bmfont-text/index.js":(k,K,f)=>{var y=f("./node_modules/layout-bmfont-text/index.js"),_=f("./node_modules/quad-indices/index.js"),v=f("./node_modules/three-bmfont-text/lib/vertices.js"),C=f("./node_modules/three-bmfont-text/lib/utils.js");k.exports=function(p){return new l(p)};class l extends THREE.BufferGeometry{constructor(p){super();typeof p=="string"&&(p={text:p}),this._opt=Object.assign({},p),p&&this.update(p)}update(p){if(typeof p=="string"&&(p={text:p}),p=Object.assign({},this._opt,p),!p.font)throw new TypeError("must specify a { font } in options");this.layout=y(p);var c=p.flipY!==!1,g=p.font,A=g.common.scaleW,h=g.common.scaleH,m=this.layout.glyphs.filter(function(M){var F=M.data;return F.width*F.height>0});this.visibleGlyphs=m;var x=v.positions(m),S=v.uvs(m,A,h,c),b=_([],{clockwise:!0,type:"uint16",count:m.length});if(this.setIndex(b),this.setAttribute("position",new THREE.BufferAttribute(x,2)),this.setAttribute("uv",new THREE.BufferAttribute(S,2)),!p.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(p.multipage){var L=v.pages(m);this.setAttribute("page",new THREE.BufferAttribute(L,1))}this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere()}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new THREE.Sphere);var p=this.attributes.position.array,c=this.attributes.position.itemSize;if(!p||!c||p.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}C.computeSphere(p,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new THREE.Box3);var p=this.boundingBox,c=this.attributes.position.array,g=this.attributes.position.itemSize;if(!c||!g||c.length<2){p.makeEmpty();return}C.computeBox(c,p)}}},"./node_modules/three-bmfont-text/lib/utils.js":k=>{var K=2,f={min:[0,0],max:[0,0]};function y(_){var v=_.length/K;f.min[0]=_[0],f.min[1]=_[1],f.max[0]=_[0],f.max[1]=_[1];for(var C=0;C<v;C++){var l=_[C*K+0],u=_[C*K+1];f.min[0]=Math.min(l,f.min[0]),f.min[1]=Math.min(u,f.min[1]),f.max[0]=Math.max(l,f.max[0]),f.max[1]=Math.max(u,f.max[1])}}k.exports.computeBox=function(_,v){y(_),v.min.set(f.min[0],f.min[1],0),v.max.set(f.max[0],f.max[1],0)},k.exports.computeSphere=function(_,v){y(_);var C=f.min[0],l=f.min[1],u=f.max[0],p=f.max[1],c=u-C,g=p-l,A=Math.sqrt(c*c+g*g);v.center.set(C+c/2,l+g/2,0),v.radius=A/2}},"./node_modules/three-bmfont-text/lib/vertices.js":k=>{k.exports.pages=function(f){var y=new Float32Array(f.length*4*1),_=0;return f.forEach(function(v){var C=v.data.page||0;y[_++]=C,y[_++]=C,y[_++]=C,y[_++]=C}),y},k.exports.uvs=function(f,y,_,v){var C=new Float32Array(f.length*4*2),l=0;return f.forEach(function(u){var p=u.data,c=p.x+p.width,g=p.y+p.height,A=p.x/y,h=p.y/_,m=c/y,x=g/_;v&&(h=(_-p.y)/_,x=(_-g)/_),C[l++]=A,C[l++]=h,C[l++]=A,C[l++]=x,C[l++]=m,C[l++]=x,C[l++]=m,C[l++]=h}),C},k.exports.positions=function(f){var y=new Float32Array(f.length*4*2),_=0;return f.forEach(function(v){var C=v.data,l=v.position[0]+C.xoffset,u=v.position[1]+C.yoffset,p=C.width,c=C.height;y[_++]=l,y[_++]=u,y[_++]=l,y[_++]=u+c,y[_++]=l+p,y[_++]=u+c,y[_++]=l+p,y[_++]=u}),y}},"./node_modules/webvr-polyfill/build/webvr-polyfill.js":function(k,K,f){(function(y,_){k.exports=_()})(this,function(){"use strict";var y=typeof window!="undefined"?window:typeof f.g!="undefined"?f.g:typeof self!="undefined"?self:{};function _(b){return b&&b.__esModule&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b}function v(b,L){return L={exports:{}},b(L,L.exports),L.exports}var C=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},l=function(L,M){for(var F=0,H=L.length;F<H;F++)M[F]=L[F]},u=function(L,M){for(var F in M)M.hasOwnProperty(F)&&(L[F]=M[F]);return L},p=v(function(b,L){(function(M,F){b.exports=F()})(y,function(){var M=function(U,Q){if(!(U instanceof Q))throw new TypeError("Cannot call a class as a function")},F=function(){function U(Q,q){for(var ie=0;ie<q.length;ie++){var Ae=q[ie];Ae.enumerable=Ae.enumerable||!1,Ae.configurable=!0,"value"in Ae&&(Ae.writable=!0),Object.defineProperty(Q,Ae.key,Ae)}}return function(Q,q,ie){return q&&U(Q.prototype,q),ie&&U(Q,ie),Q}}(),H=function(){function U(Q,q){var ie=[],Ae=!0,Pe=!1,ze=void 0;try{for(var lt=Q[Symbol.iterator](),at;!(Ae=(at=lt.next()).done)&&(ie.push(at.value),!(q&&ie.length===q));Ae=!0);}catch(Ve){Pe=!0,ze=Ve}finally{try{!Ae&&lt.return&&lt.return()}finally{if(Pe)throw ze}}return ie}return function(Q,q){if(Array.isArray(Q))return Q;if(Symbol.iterator in Object(Q))return U(Q,q);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Y=.001,W=1,te=function(Q,q){return"data:"+Q+","+encodeURIComponent(q)},re=function(Q,q,ie){return Q+(q-Q)*ie},X=function(){var U=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return U}}(),V=function(){var U=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return U}}(),O=function(){var U=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return U}}(),Z=function(){var U=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return U}}(),ne=function(){var U=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),Q=U?parseInt(U[1],10):null;return function(){return Q}}(),pe=function(){var U=!1;return U=X()&&O()&&navigator.userAgent.indexOf("13_4")!==-1,function(){return U}}(),be=function(){var U=!1;if(ne()===65){var Q=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(Q){var q=Q[1].split("."),ie=H(q,4),Ae=ie[0],Pe=ie[1],ze=ie[2],lt=ie[3];U=parseInt(ze,10)===3325&&parseInt(lt,10)<148}}return function(){return U}}(),Re=function(){var U=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return U}}(),Ue=function(){var Q=window.orientation==90||window.orientation==-90;return Re()?!Q:Q},je=function(Q){return!(isNaN(Q)||Q<=Y||Q>W)},nt=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},mt=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},Dt=function(Q){if(V())return!1;if(Q.requestFullscreen)Q.requestFullscreen();else if(Q.webkitRequestFullscreen)Q.webkitRequestFullscreen();else if(Q.mozRequestFullScreen)Q.mozRequestFullScreen();else if(Q.msRequestFullscreen)Q.msRequestFullscreen();else return!1;return!0},pt=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},Tt=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},kt=function(Q,q,ie,Ae){var Pe=Q.createShader(Q.VERTEX_SHADER);Q.shaderSource(Pe,q),Q.compileShader(Pe);var ze=Q.createShader(Q.FRAGMENT_SHADER);Q.shaderSource(ze,ie),Q.compileShader(ze);var lt=Q.createProgram();Q.attachShader(lt,Pe),Q.attachShader(lt,ze);for(var at in Ae)Q.bindAttribLocation(lt,Ae[at],at);return Q.linkProgram(lt),Q.deleteShader(Pe),Q.deleteShader(ze),lt},un=function(Q,q){for(var ie={},Ae=Q.getProgramParameter(q,Q.ACTIVE_UNIFORMS),Pe="",ze=0;ze<Ae;ze++){var lt=Q.getActiveUniform(q,ze);Pe=lt.name.replace("[0]",""),ie[Pe]=Q.getUniformLocation(q,Pe)}return ie},yn=function(Q,q,ie,Ae,Pe,ze,lt){var at=1/(q-ie),Ve=1/(Ae-Pe),et=1/(ze-lt);return Q[0]=-2*at,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=-2*Ve,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=2*et,Q[11]=0,Q[12]=(q+ie)*at,Q[13]=(Pe+Ae)*Ve,Q[14]=(lt+ze)*et,Q[15]=1,Q},Sn=function(){var Q=!1;return function(q){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(q)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(q.substr(0,4)))&&(Q=!0)}(navigator.userAgent||navigator.vendor||window.opera),Q},Nn=function(Q,q){for(var ie in q)q.hasOwnProperty(ie)&&(Q[ie]=q[ie]);return Q},ln=function(Q){if(X()){var q=Q.style.width,ie=Q.style.height;Q.style.width=parseInt(q)+1+"px",Q.style.height=parseInt(ie)+"px",setTimeout(function(){Q.style.width=q,Q.style.height=ie},100)}window.canvas=Q},En=function(){var U=Math.PI/180,Q=Math.PI*.25;function q(Ve,et,Et,zt){var tn=Math.tan(et?et.upDegrees*U:Q),mn=Math.tan(et?et.downDegrees*U:Q),Ln=Math.tan(et?et.leftDegrees*U:Q),_n=Math.tan(et?et.rightDegrees*U:Q),vn=2/(Ln+_n),li=2/(tn+mn);return Ve[0]=vn,Ve[1]=0,Ve[2]=0,Ve[3]=0,Ve[4]=0,Ve[5]=li,Ve[6]=0,Ve[7]=0,Ve[8]=-((Ln-_n)*vn*.5),Ve[9]=(tn-mn)*li*.5,Ve[10]=zt/(Et-zt),Ve[11]=-1,Ve[12]=0,Ve[13]=0,Ve[14]=zt*Et/(Et-zt),Ve[15]=0,Ve}function ie(Ve,et,Et){var zt=et[0],tn=et[1],mn=et[2],Ln=et[3],_n=zt+zt,vn=tn+tn,li=mn+mn,_i=zt*_n,Ri=zt*vn,wi=zt*li,tr=tn*vn,nr=tn*li,ir=mn*li,sr=Ln*_n,zi=Ln*vn,gr=Ln*li;return Ve[0]=1-(tr+ir),Ve[1]=Ri+gr,Ve[2]=wi-zi,Ve[3]=0,Ve[4]=Ri-gr,Ve[5]=1-(_i+ir),Ve[6]=nr+sr,Ve[7]=0,Ve[8]=wi+zi,Ve[9]=nr-sr,Ve[10]=1-(_i+tr),Ve[11]=0,Ve[12]=Et[0],Ve[13]=Et[1],Ve[14]=Et[2],Ve[15]=1,Ve}function Ae(Ve,et,Et){var zt=Et[0],tn=Et[1],mn=Et[2],Ln,_n,vn,li,_i,Ri,wi,tr,nr,ir,sr,zi;return et===Ve?(Ve[12]=et[0]*zt+et[4]*tn+et[8]*mn+et[12],Ve[13]=et[1]*zt+et[5]*tn+et[9]*mn+et[13],Ve[14]=et[2]*zt+et[6]*tn+et[10]*mn+et[14],Ve[15]=et[3]*zt+et[7]*tn+et[11]*mn+et[15]):(Ln=et[0],_n=et[1],vn=et[2],li=et[3],_i=et[4],Ri=et[5],wi=et[6],tr=et[7],nr=et[8],ir=et[9],sr=et[10],zi=et[11],Ve[0]=Ln,Ve[1]=_n,Ve[2]=vn,Ve[3]=li,Ve[4]=_i,Ve[5]=Ri,Ve[6]=wi,Ve[7]=tr,Ve[8]=nr,Ve[9]=ir,Ve[10]=sr,Ve[11]=zi,Ve[12]=Ln*zt+_i*tn+nr*mn+et[12],Ve[13]=_n*zt+Ri*tn+ir*mn+et[13],Ve[14]=vn*zt+wi*tn+sr*mn+et[14],Ve[15]=li*zt+tr*tn+zi*mn+et[15]),Ve}function Pe(Ve,et){var Et=et[0],zt=et[1],tn=et[2],mn=et[3],Ln=et[4],_n=et[5],vn=et[6],li=et[7],_i=et[8],Ri=et[9],wi=et[10],tr=et[11],nr=et[12],ir=et[13],sr=et[14],zi=et[15],gr=Et*_n-zt*Ln,Wr=Et*vn-tn*Ln,ns=Et*li-mn*Ln,as=zt*vn-tn*_n,ws=zt*li-mn*_n,Ms=tn*li-mn*vn,Ss=_i*ir-Ri*nr,As=_i*sr-wi*nr,ms=_i*zi-tr*nr,Mr=Ri*sr-wi*ir,gs=Ri*zi-tr*ir,br=wi*zi-tr*sr,ni=gr*br-Wr*gs+ns*Mr+as*ms-ws*As+Ms*Ss;return ni?(ni=1/ni,Ve[0]=(_n*br-vn*gs+li*Mr)*ni,Ve[1]=(tn*gs-zt*br-mn*Mr)*ni,Ve[2]=(ir*Ms-sr*ws+zi*as)*ni,Ve[3]=(wi*ws-Ri*Ms-tr*as)*ni,Ve[4]=(vn*ms-Ln*br-li*As)*ni,Ve[5]=(Et*br-tn*ms+mn*As)*ni,Ve[6]=(sr*ns-nr*Ms-zi*Wr)*ni,Ve[7]=(_i*Ms-wi*ns+tr*Wr)*ni,Ve[8]=(Ln*gs-_n*ms+li*Ss)*ni,Ve[9]=(zt*ms-Et*gs-mn*Ss)*ni,Ve[10]=(nr*ws-ir*ns+zi*gr)*ni,Ve[11]=(Ri*ns-_i*ws-tr*gr)*ni,Ve[12]=(_n*As-Ln*Mr-vn*Ss)*ni,Ve[13]=(Et*Mr-zt*As+tn*Ss)*ni,Ve[14]=(ir*Wr-nr*as-sr*gr)*ni,Ve[15]=(_i*as-Ri*Wr+wi*gr)*ni,Ve):null}var ze=new Float32Array([0,0,0,1]),lt=new Float32Array([0,0,0]);function at(Ve,et,Et,zt,tn,mn){q(Ve,zt||null,mn.depthNear,mn.depthFar);var Ln=Et.orientation||ze,_n=Et.position||lt;ie(et,Ln,_n),tn&&Ae(et,et,tn),Pe(et,et)}return function(Ve,et,Et){return!Ve||!et?!1:(Ve.pose=et,Ve.timestamp=et.timestamp,at(Ve.leftProjectionMatrix,Ve.leftViewMatrix,et,Et._getFieldOfView("left"),Et._getEyeOffset("left"),Et),at(Ve.rightProjectionMatrix,Ve.rightViewMatrix,et,Et._getFieldOfView("right"),Et._getEyeOffset("right"),Et),!0)}}(),fi=function(){var Q=window.self!==window.top,q=si(document.referrer),ie=si(window.location.href);return Q&&q!==ie},si=function(Q){var q,ie=Q.indexOf("://");ie!==-1?q=ie+3:q=0;var Ae=Q.indexOf("/",q);return Ae===-1&&(Ae=Q.length),Q.substring(0,Ae)},qi=function(Q){if(Q.w>1)return console.warn("getQuaternionAngle: w > 1"),0;var q=2*Math.acos(Q.w);return q},pi=function(){var U={};return function(Q,q){U[Q]===void 0&&(console.warn("webvr-polyfill: "+q),U[Q]=!0)}}(),Jn=function(Q,q){var ie=q?"Please use "+q+" instead.":"";pi(Q,Q+" has been deprecated. This may not work on native WebVR displays. "+ie)};function Fi(U,Q,q){if(!Q){q(U);return}for(var ie=[],Ae=null,Pe=0;Pe<Q.length;++Pe){var ze=Q[Pe];switch(ze){case U.TEXTURE_BINDING_2D:case U.TEXTURE_BINDING_CUBE_MAP:var lt=Q[++Pe];if(lt<U.TEXTURE0||lt>U.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),ie.push(null,null);break}Ae||(Ae=U.getParameter(U.ACTIVE_TEXTURE)),U.activeTexture(lt),ie.push(U.getParameter(ze),null);break;case U.ACTIVE_TEXTURE:Ae=U.getParameter(U.ACTIVE_TEXTURE),ie.push(null);break;default:ie.push(U.getParameter(ze));break}}q(U);for(var Pe=0;Pe<Q.length;++Pe){var ze=Q[Pe],at=ie[Pe];switch(ze){case U.ACTIVE_TEXTURE:break;case U.ARRAY_BUFFER_BINDING:U.bindBuffer(U.ARRAY_BUFFER,at);break;case U.COLOR_CLEAR_VALUE:U.clearColor(at[0],at[1],at[2],at[3]);break;case U.COLOR_WRITEMASK:U.colorMask(at[0],at[1],at[2],at[3]);break;case U.CURRENT_PROGRAM:U.useProgram(at);break;case U.ELEMENT_ARRAY_BUFFER_BINDING:U.bindBuffer(U.ELEMENT_ARRAY_BUFFER,at);break;case U.FRAMEBUFFER_BINDING:U.bindFramebuffer(U.FRAMEBUFFER,at);break;case U.RENDERBUFFER_BINDING:U.bindRenderbuffer(U.RENDERBUFFER,at);break;case U.TEXTURE_BINDING_2D:var lt=Q[++Pe];if(lt<U.TEXTURE0||lt>U.TEXTURE31)break;U.activeTexture(lt),U.bindTexture(U.TEXTURE_2D,at);break;case U.TEXTURE_BINDING_CUBE_MAP:var lt=Q[++Pe];if(lt<U.TEXTURE0||lt>U.TEXTURE31)break;U.activeTexture(lt),U.bindTexture(U.TEXTURE_CUBE_MAP,at);break;case U.VIEWPORT:U.viewport(at[0],at[1],at[2],at[3]);break;case U.BLEND:case U.CULL_FACE:case U.DEPTH_TEST:case U.SCISSOR_TEST:case U.STENCIL_TEST:at?U.enable(ze):U.disable(ze);break;default:console.log("No GL restore behavior for 0x"+ze.toString(16));break}Ae&&U.activeTexture(Ae)}}var vi=Fi,mr=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join(`
`),Ji=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join(`
`);function Ei(U,Q,q,ie){this.gl=U,this.cardboardUI=Q,this.bufferScale=q,this.dirtySubmitFrameBindings=ie,this.ctxAttribs=U.getContextAttributes(),this.instanceExt=U.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=U.drawingBufferWidth,this.bufferHeight=U.drawingBufferHeight,this.realBindFramebuffer=U.bindFramebuffer,this.realEnable=U.enable,this.realDisable=U.disable,this.realColorMask=U.colorMask,this.realClearColor=U.clearColor,this.realViewport=U.viewport,X()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(U.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(U.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=kt(U,mr,Ji,this.attribs),this.uniforms=un(U,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=U.createBuffer(),this.indexBuffer=U.createBuffer(),this.indexCount=0,this.renderTarget=U.createTexture(),this.framebuffer=U.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=U.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=U.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=U.createRenderbuffer()),this.patch(),this.onResize()}Ei.prototype.destroy=function(){var U=this.gl;this.unpatch(),U.deleteProgram(this.program),U.deleteBuffer(this.vertexBuffer),U.deleteBuffer(this.indexBuffer),U.deleteTexture(this.renderTarget),U.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&U.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&U.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&U.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},Ei.prototype.onResize=function(){var U=this.gl,Q=this,q=[U.RENDERBUFFER_BINDING,U.TEXTURE_BINDING_2D,U.TEXTURE0];vi(U,q,function(ie){Q.realBindFramebuffer.call(ie,ie.FRAMEBUFFER,null),Q.scissorTest&&Q.realDisable.call(ie,ie.SCISSOR_TEST),Q.realColorMask.call(ie,!0,!0,!0,!0),Q.realViewport.call(ie,0,0,ie.drawingBufferWidth,ie.drawingBufferHeight),Q.realClearColor.call(ie,0,0,0,1),ie.clear(ie.COLOR_BUFFER_BIT),Q.realBindFramebuffer.call(ie,ie.FRAMEBUFFER,Q.framebuffer),ie.bindTexture(ie.TEXTURE_2D,Q.renderTarget),ie.texImage2D(ie.TEXTURE_2D,0,Q.ctxAttribs.alpha?ie.RGBA:ie.RGB,Q.bufferWidth,Q.bufferHeight,0,Q.ctxAttribs.alpha?ie.RGBA:ie.RGB,ie.UNSIGNED_BYTE,null),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MAG_FILTER,ie.LINEAR),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MIN_FILTER,ie.LINEAR),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_S,ie.CLAMP_TO_EDGE),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_T,ie.CLAMP_TO_EDGE),ie.framebufferTexture2D(ie.FRAMEBUFFER,ie.COLOR_ATTACHMENT0,ie.TEXTURE_2D,Q.renderTarget,0),Q.ctxAttribs.depth&&Q.ctxAttribs.stencil?(ie.bindRenderbuffer(ie.RENDERBUFFER,Q.depthStencilBuffer),ie.renderbufferStorage(ie.RENDERBUFFER,ie.DEPTH_STENCIL,Q.bufferWidth,Q.bufferHeight),ie.framebufferRenderbuffer(ie.FRAMEBUFFER,ie.DEPTH_STENCIL_ATTACHMENT,ie.RENDERBUFFER,Q.depthStencilBuffer)):Q.ctxAttribs.depth?(ie.bindRenderbuffer(ie.RENDERBUFFER,Q.depthBuffer),ie.renderbufferStorage(ie.RENDERBUFFER,ie.DEPTH_COMPONENT16,Q.bufferWidth,Q.bufferHeight),ie.framebufferRenderbuffer(ie.FRAMEBUFFER,ie.DEPTH_ATTACHMENT,ie.RENDERBUFFER,Q.depthBuffer)):Q.ctxAttribs.stencil&&(ie.bindRenderbuffer(ie.RENDERBUFFER,Q.stencilBuffer),ie.renderbufferStorage(ie.RENDERBUFFER,ie.STENCIL_INDEX8,Q.bufferWidth,Q.bufferHeight),ie.framebufferRenderbuffer(ie.FRAMEBUFFER,ie.STENCIL_ATTACHMENT,ie.RENDERBUFFER,Q.stencilBuffer)),!ie.checkFramebufferStatus(ie.FRAMEBUFFER)===ie.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),Q.realBindFramebuffer.call(ie,ie.FRAMEBUFFER,Q.lastBoundFramebuffer),Q.scissorTest&&Q.realEnable.call(ie,ie.SCISSOR_TEST),Q.realColorMask.apply(ie,Q.colorMask),Q.realViewport.apply(ie,Q.viewport),Q.realClearColor.apply(ie,Q.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},Ei.prototype.patch=function(){if(!this.isPatched){var U=this,Q=this.gl.canvas,q=this.gl;X()||(Q.width=nt()*this.bufferScale,Q.height=mt()*this.bufferScale,Object.defineProperty(Q,"width",{configurable:!0,enumerable:!0,get:function(){return U.bufferWidth},set:function(Ae){U.bufferWidth=Ae,U.realCanvasWidth.set.call(Q,Ae),U.onResize()}}),Object.defineProperty(Q,"height",{configurable:!0,enumerable:!0,get:function(){return U.bufferHeight},set:function(Ae){U.bufferHeight=Ae,U.realCanvasHeight.set.call(Q,Ae),U.onResize()}})),this.lastBoundFramebuffer=q.getParameter(q.FRAMEBUFFER_BINDING),this.lastBoundFramebuffer==null&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(q.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(ie,Ae){U.lastBoundFramebuffer=Ae||U.framebuffer,U.realBindFramebuffer.call(q,ie,U.lastBoundFramebuffer)},this.cullFace=q.getParameter(q.CULL_FACE),this.depthTest=q.getParameter(q.DEPTH_TEST),this.blend=q.getParameter(q.BLEND),this.scissorTest=q.getParameter(q.SCISSOR_TEST),this.stencilTest=q.getParameter(q.STENCIL_TEST),q.enable=function(ie){switch(ie){case q.CULL_FACE:U.cullFace=!0;break;case q.DEPTH_TEST:U.depthTest=!0;break;case q.BLEND:U.blend=!0;break;case q.SCISSOR_TEST:U.scissorTest=!0;break;case q.STENCIL_TEST:U.stencilTest=!0;break}U.realEnable.call(q,ie)},q.disable=function(ie){switch(ie){case q.CULL_FACE:U.cullFace=!1;break;case q.DEPTH_TEST:U.depthTest=!1;break;case q.BLEND:U.blend=!1;break;case q.SCISSOR_TEST:U.scissorTest=!1;break;case q.STENCIL_TEST:U.stencilTest=!1;break}U.realDisable.call(q,ie)},this.colorMask=q.getParameter(q.COLOR_WRITEMASK),q.colorMask=function(ie,Ae,Pe,ze){U.colorMask[0]=ie,U.colorMask[1]=Ae,U.colorMask[2]=Pe,U.colorMask[3]=ze,U.realColorMask.call(q,ie,Ae,Pe,ze)},this.clearColor=q.getParameter(q.COLOR_CLEAR_VALUE),q.clearColor=function(ie,Ae,Pe,ze){U.clearColor[0]=ie,U.clearColor[1]=Ae,U.clearColor[2]=Pe,U.clearColor[3]=ze,U.realClearColor.call(q,ie,Ae,Pe,ze)},this.viewport=q.getParameter(q.VIEWPORT),q.viewport=function(ie,Ae,Pe,ze){U.viewport[0]=ie,U.viewport[1]=Ae,U.viewport[2]=Pe,U.viewport[3]=ze,U.realViewport.call(q,ie,Ae,Pe,ze)},this.isPatched=!0,ln(Q)}},Ei.prototype.unpatch=function(){if(!!this.isPatched){var U=this.gl,Q=this.gl.canvas;X()||(Object.defineProperty(Q,"width",this.realCanvasWidth),Object.defineProperty(Q,"height",this.realCanvasHeight)),Q.width=this.bufferWidth,Q.height=this.bufferHeight,U.bindFramebuffer=this.realBindFramebuffer,U.enable=this.realEnable,U.disable=this.realDisable,U.colorMask=this.realColorMask,U.clearColor=this.realClearColor,U.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&U.bindFramebuffer(U.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){ln(Q)},1)}},Ei.prototype.setTextureBounds=function(U,Q){U||(U=[0,0,.5,1]),Q||(Q=[.5,0,.5,1]),this.viewportOffsetScale[0]=U[0],this.viewportOffsetScale[1]=U[1],this.viewportOffsetScale[2]=U[2],this.viewportOffsetScale[3]=U[3],this.viewportOffsetScale[4]=Q[0],this.viewportOffsetScale[5]=Q[1],this.viewportOffsetScale[6]=Q[2],this.viewportOffsetScale[7]=Q[3]},Ei.prototype.submitFrame=function(){var U=this.gl,Q=this,q=[];if(this.dirtySubmitFrameBindings||q.push(U.CURRENT_PROGRAM,U.ARRAY_BUFFER_BINDING,U.ELEMENT_ARRAY_BUFFER_BINDING,U.TEXTURE_BINDING_2D,U.TEXTURE0),vi(U,q,function(Ae){Q.realBindFramebuffer.call(Ae,Ae.FRAMEBUFFER,null);var Pe=0,ze=0;Q.instanceExt&&(Pe=Ae.getVertexAttrib(Q.attribs.position,Q.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),ze=Ae.getVertexAttrib(Q.attribs.texCoord,Q.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),Q.cullFace&&Q.realDisable.call(Ae,Ae.CULL_FACE),Q.depthTest&&Q.realDisable.call(Ae,Ae.DEPTH_TEST),Q.blend&&Q.realDisable.call(Ae,Ae.BLEND),Q.scissorTest&&Q.realDisable.call(Ae,Ae.SCISSOR_TEST),Q.stencilTest&&Q.realDisable.call(Ae,Ae.STENCIL_TEST),Q.realColorMask.call(Ae,!0,!0,!0,!0),Q.realViewport.call(Ae,0,0,Ae.drawingBufferWidth,Ae.drawingBufferHeight),(Q.ctxAttribs.alpha||X())&&(Q.realClearColor.call(Ae,0,0,0,1),Ae.clear(Ae.COLOR_BUFFER_BIT)),Ae.useProgram(Q.program),Ae.bindBuffer(Ae.ELEMENT_ARRAY_BUFFER,Q.indexBuffer),Ae.bindBuffer(Ae.ARRAY_BUFFER,Q.vertexBuffer),Ae.enableVertexAttribArray(Q.attribs.position),Ae.enableVertexAttribArray(Q.attribs.texCoord),Ae.vertexAttribPointer(Q.attribs.position,2,Ae.FLOAT,!1,20,0),Ae.vertexAttribPointer(Q.attribs.texCoord,3,Ae.FLOAT,!1,20,8),Q.instanceExt&&(Pe!=0&&Q.instanceExt.vertexAttribDivisorANGLE(Q.attribs.position,0),ze!=0&&Q.instanceExt.vertexAttribDivisorANGLE(Q.attribs.texCoord,0)),Ae.activeTexture(Ae.TEXTURE0),Ae.uniform1i(Q.uniforms.diffuse,0),Ae.bindTexture(Ae.TEXTURE_2D,Q.renderTarget),Ae.uniform4fv(Q.uniforms.viewportOffsetScale,Q.viewportOffsetScale),Ae.drawElements(Ae.TRIANGLES,Q.indexCount,Ae.UNSIGNED_SHORT,0),Q.cardboardUI&&Q.cardboardUI.renderNoState(),Q.realBindFramebuffer.call(Q.gl,Ae.FRAMEBUFFER,Q.framebuffer),Q.ctxAttribs.preserveDrawingBuffer||(Q.realClearColor.call(Ae,0,0,0,0),Ae.clear(Ae.COLOR_BUFFER_BIT)),Q.dirtySubmitFrameBindings||Q.realBindFramebuffer.call(Ae,Ae.FRAMEBUFFER,Q.lastBoundFramebuffer),Q.cullFace&&Q.realEnable.call(Ae,Ae.CULL_FACE),Q.depthTest&&Q.realEnable.call(Ae,Ae.DEPTH_TEST),Q.blend&&Q.realEnable.call(Ae,Ae.BLEND),Q.scissorTest&&Q.realEnable.call(Ae,Ae.SCISSOR_TEST),Q.stencilTest&&Q.realEnable.call(Ae,Ae.STENCIL_TEST),Q.realColorMask.apply(Ae,Q.colorMask),Q.realViewport.apply(Ae,Q.viewport),(Q.ctxAttribs.alpha||!Q.ctxAttribs.preserveDrawingBuffer)&&Q.realClearColor.apply(Ae,Q.clearColor),Q.instanceExt&&(Pe!=0&&Q.instanceExt.vertexAttribDivisorANGLE(Q.attribs.position,Pe),ze!=0&&Q.instanceExt.vertexAttribDivisorANGLE(Q.attribs.texCoord,ze))}),X()){var ie=U.canvas;(ie.width!=Q.bufferWidth||ie.height!=Q.bufferHeight)&&(Q.bufferWidth=ie.width,Q.bufferHeight=ie.height,Q.onResize())}},Ei.prototype.updateDeviceInfo=function(U){var Q=this.gl,q=this,ie=[Q.ARRAY_BUFFER_BINDING,Q.ELEMENT_ARRAY_BUFFER_BINDING];vi(Q,ie,function(Ae){var Pe=q.computeMeshVertices_(q.meshWidth,q.meshHeight,U);if(Ae.bindBuffer(Ae.ARRAY_BUFFER,q.vertexBuffer),Ae.bufferData(Ae.ARRAY_BUFFER,Pe,Ae.STATIC_DRAW),!q.indexCount){var ze=q.computeMeshIndices_(q.meshWidth,q.meshHeight);Ae.bindBuffer(Ae.ELEMENT_ARRAY_BUFFER,q.indexBuffer),Ae.bufferData(Ae.ELEMENT_ARRAY_BUFFER,ze,Ae.STATIC_DRAW),q.indexCount=ze.length}})},Ei.prototype.computeMeshVertices_=function(U,Q,q){for(var ie=new Float32Array(2*U*Q*5),Ae=q.getLeftEyeVisibleTanAngles(),Pe=q.getLeftEyeNoLensTanAngles(),ze=q.getLeftEyeVisibleScreenRect(Pe),lt=0,at=0;at<2;at++){for(var Ve=0;Ve<Q;Ve++)for(var et=0;et<U;et++,lt++){var Et=et/(U-1),zt=Ve/(Q-1),tn=Et,mn=zt,Ln=re(Ae[0],Ae[2],Et),_n=re(Ae[3],Ae[1],zt),vn=Math.sqrt(Ln*Ln+_n*_n),li=q.distortion.distortInverse(vn),_i=Ln*li/vn,Ri=_n*li/vn;Et=(_i-Pe[0])/(Pe[2]-Pe[0]),zt=(Ri-Pe[3])/(Pe[1]-Pe[3]),Et=(ze.x+Et*ze.width-.5)*2,zt=(ze.y+zt*ze.height-.5)*2,ie[lt*5+0]=Et,ie[lt*5+1]=zt,ie[lt*5+2]=tn,ie[lt*5+3]=mn,ie[lt*5+4]=at}var wi=Ae[2]-Ae[0];Ae[0]=-(wi+Ae[0]),Ae[2]=wi-Ae[2],wi=Pe[2]-Pe[0],Pe[0]=-(wi+Pe[0]),Pe[2]=wi-Pe[2],ze.x=1-(ze.x+ze.width)}return ie},Ei.prototype.computeMeshIndices_=function(U,Q){for(var q=new Uint16Array(2*(U-1)*(Q-1)*6),ie=U/2,Ae=Q/2,Pe=0,ze=0,lt=0;lt<2;lt++)for(var at=0;at<Q;at++)for(var Ve=0;Ve<U;Ve++,Pe++)Ve==0||at==0||(Ve<=ie==at<=Ae?(q[ze++]=Pe,q[ze++]=Pe-U-1,q[ze++]=Pe-U,q[ze++]=Pe-U-1,q[ze++]=Pe,q[ze++]=Pe-1):(q[ze++]=Pe-1,q[ze++]=Pe-U,q[ze++]=Pe,q[ze++]=Pe-U,q[ze++]=Pe-1,q[ze++]=Pe-U-1));return q},Ei.prototype.getOwnPropertyDescriptor_=function(U,Q){var q=Object.getOwnPropertyDescriptor(U,Q);return(q.get===void 0||q.set===void 0)&&(q.configurable=!0,q.enumerable=!0,q.get=function(){return this.getAttribute(Q)},q.set=function(ie){this.setAttribute(Q,ie)}),q};var vt=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join(`
`),ae=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join(`
`),oe=Math.PI/180,Ce=60,fe=12,Ee=20,xe=1,z=.75,I=.3125,R=4,ee=28,he=1.5;function _e(U){this.gl=U,this.attribs={position:0},this.program=kt(U,vt,ae,this.attribs),this.uniforms=un(U,this.program),this.vertexBuffer=U.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}_e.prototype.destroy=function(){var U=this.gl;this.listener&&U.canvas.removeEventListener("click",this.listener,!1),U.deleteProgram(this.program),U.deleteBuffer(this.vertexBuffer)},_e.prototype.listen=function(U,Q){var q=this.gl.canvas;this.listener=function(ie){var Ae=q.clientWidth/2,Pe=ee*he;ie.clientX>Ae-Pe&&ie.clientX<Ae+Pe&&ie.clientY>q.clientHeight-Pe?U(ie):ie.clientX<Pe&&ie.clientY<Pe&&Q(ie)},q.addEventListener("click",this.listener,!1)},_e.prototype.onResize=function(){var U=this.gl,Q=this,q=[U.ARRAY_BUFFER_BINDING];vi(U,q,function(ie){var Ae=[],Pe=ie.drawingBufferWidth/2,ze=Math.max(screen.width,screen.height)*window.devicePixelRatio,lt=ie.drawingBufferWidth/ze,at=lt*window.devicePixelRatio,Ve=R*at/2,et=ee*he*at,Et=ee*at/2,zt=(ee*he-ee)*at;Ae.push(Pe-Ve,et),Ae.push(Pe-Ve,ie.drawingBufferHeight),Ae.push(Pe+Ve,et),Ae.push(Pe+Ve,ie.drawingBufferHeight),Q.gearOffset=Ae.length/2;function tn(li,_i){var Ri=(90-li)*oe,wi=Math.cos(Ri),tr=Math.sin(Ri);Ae.push(I*wi*Et+Pe,I*tr*Et+Et),Ae.push(_i*wi*Et+Pe,_i*tr*Et+Et)}for(var mn=0;mn<=6;mn++){var Ln=mn*Ce;tn(Ln,xe),tn(Ln+fe,xe),tn(Ln+Ee,z),tn(Ln+(Ce-Ee),z),tn(Ln+(Ce-fe),xe)}Q.gearVertexCount=Ae.length/2-Q.gearOffset,Q.arrowOffset=Ae.length/2;function _n(li,_i){Ae.push(zt+li,ie.drawingBufferHeight-zt-_i)}var vn=Ve/Math.sin(45*oe);_n(0,Et),_n(Et,0),_n(Et+vn,vn),_n(vn,Et+vn),_n(vn,Et-vn),_n(0,Et),_n(Et,Et*2),_n(Et+vn,Et*2-vn),_n(vn,Et-vn),_n(0,Et),_n(vn,Et-Ve),_n(ee*at,Et-Ve),_n(vn,Et+Ve),_n(ee*at,Et+Ve),Q.arrowVertexCount=Ae.length/2-Q.arrowOffset,ie.bindBuffer(ie.ARRAY_BUFFER,Q.vertexBuffer),ie.bufferData(ie.ARRAY_BUFFER,new Float32Array(Ae),ie.STATIC_DRAW)})},_e.prototype.render=function(){var U=this.gl,Q=this,q=[U.CULL_FACE,U.DEPTH_TEST,U.BLEND,U.SCISSOR_TEST,U.STENCIL_TEST,U.COLOR_WRITEMASK,U.VIEWPORT,U.CURRENT_PROGRAM,U.ARRAY_BUFFER_BINDING];vi(U,q,function(ie){ie.disable(ie.CULL_FACE),ie.disable(ie.DEPTH_TEST),ie.disable(ie.BLEND),ie.disable(ie.SCISSOR_TEST),ie.disable(ie.STENCIL_TEST),ie.colorMask(!0,!0,!0,!0),ie.viewport(0,0,ie.drawingBufferWidth,ie.drawingBufferHeight),Q.renderNoState()})},_e.prototype.renderNoState=function(){var U=this.gl;U.useProgram(this.program),U.bindBuffer(U.ARRAY_BUFFER,this.vertexBuffer),U.enableVertexAttribArray(this.attribs.position),U.vertexAttribPointer(this.attribs.position,2,U.FLOAT,!1,8,0),U.uniform4f(this.uniforms.color,1,1,1,1),yn(this.projMat,0,U.drawingBufferWidth,0,U.drawingBufferHeight,.1,1024),U.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),U.drawArrays(U.TRIANGLE_STRIP,0,4),U.drawArrays(U.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),U.drawArrays(U.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function De(U){this.coefficients=U}De.prototype.distortInverse=function(U){for(var Q=0,q=1,ie=U-this.distort(Q);Math.abs(q-Q)>1e-4;){var Ae=U-this.distort(q),Pe=q-Ae*((q-Q)/(Ae-ie));Q=q,q=Pe,ie=Ae}return q},De.prototype.distort=function(U){for(var Q=U*U,q=0,ie=0;ie<this.coefficients.length;ie++)q=Q*(q+this.coefficients[ie]);return(q+1)*U};var Ct=Math.PI/180,Bt=180/Math.PI,_t=function(Q,q,ie){this.x=Q||0,this.y=q||0,this.z=ie||0};_t.prototype={constructor:_t,set:function(Q,q,ie){return this.x=Q,this.y=q,this.z=ie,this},copy:function(Q){return this.x=Q.x,this.y=Q.y,this.z=Q.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var Q=this.length();if(Q!==0){var q=1/Q;this.multiplyScalar(q)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(Q){this.x*=Q,this.y*=Q,this.z*=Q},applyQuaternion:function(Q){var q=this.x,ie=this.y,Ae=this.z,Pe=Q.x,ze=Q.y,lt=Q.z,at=Q.w,Ve=at*q+ze*Ae-lt*ie,et=at*ie+lt*q-Pe*Ae,Et=at*Ae+Pe*ie-ze*q,zt=-Pe*q-ze*ie-lt*Ae;return this.x=Ve*at+zt*-Pe+et*-lt-Et*-ze,this.y=et*at+zt*-ze+Et*-Pe-Ve*-lt,this.z=Et*at+zt*-lt+Ve*-ze-et*-Pe,this},dot:function(Q){return this.x*Q.x+this.y*Q.y+this.z*Q.z},crossVectors:function(Q,q){var ie=Q.x,Ae=Q.y,Pe=Q.z,ze=q.x,lt=q.y,at=q.z;return this.x=Ae*at-Pe*lt,this.y=Pe*ze-ie*at,this.z=ie*lt-Ae*ze,this}};var Mt=function(Q,q,ie,Ae){this.x=Q||0,this.y=q||0,this.z=ie||0,this.w=Ae!==void 0?Ae:1};Mt.prototype={constructor:Mt,set:function(Q,q,ie,Ae){return this.x=Q,this.y=q,this.z=ie,this.w=Ae,this},copy:function(Q){return this.x=Q.x,this.y=Q.y,this.z=Q.z,this.w=Q.w,this},setFromEulerXYZ:function(Q,q,ie){var Ae=Math.cos(Q/2),Pe=Math.cos(q/2),ze=Math.cos(ie/2),lt=Math.sin(Q/2),at=Math.sin(q/2),Ve=Math.sin(ie/2);return this.x=lt*Pe*ze+Ae*at*Ve,this.y=Ae*at*ze-lt*Pe*Ve,this.z=Ae*Pe*Ve+lt*at*ze,this.w=Ae*Pe*ze-lt*at*Ve,this},setFromEulerYXZ:function(Q,q,ie){var Ae=Math.cos(Q/2),Pe=Math.cos(q/2),ze=Math.cos(ie/2),lt=Math.sin(Q/2),at=Math.sin(q/2),Ve=Math.sin(ie/2);return this.x=lt*Pe*ze+Ae*at*Ve,this.y=Ae*at*ze-lt*Pe*Ve,this.z=Ae*Pe*Ve-lt*at*ze,this.w=Ae*Pe*ze+lt*at*Ve,this},setFromAxisAngle:function(Q,q){var ie=q/2,Ae=Math.sin(ie);return this.x=Q.x*Ae,this.y=Q.y*Ae,this.z=Q.z*Ae,this.w=Math.cos(ie),this},multiply:function(Q){return this.multiplyQuaternions(this,Q)},multiplyQuaternions:function(Q,q){var ie=Q.x,Ae=Q.y,Pe=Q.z,ze=Q.w,lt=q.x,at=q.y,Ve=q.z,et=q.w;return this.x=ie*et+ze*lt+Ae*Ve-Pe*at,this.y=Ae*et+ze*at+Pe*lt-ie*Ve,this.z=Pe*et+ze*Ve+ie*at-Ae*lt,this.w=ze*et-ie*lt-Ae*at-Pe*Ve,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var Q=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return Q===0?(this.x=0,this.y=0,this.z=0,this.w=1):(Q=1/Q,this.x=this.x*Q,this.y=this.y*Q,this.z=this.z*Q,this.w=this.w*Q),this},slerp:function(Q,q){if(q===0)return this;if(q===1)return this.copy(Q);var ie=this.x,Ae=this.y,Pe=this.z,ze=this.w,lt=ze*Q.w+ie*Q.x+Ae*Q.y+Pe*Q.z;if(lt<0?(this.w=-Q.w,this.x=-Q.x,this.y=-Q.y,this.z=-Q.z,lt=-lt):this.copy(Q),lt>=1)return this.w=ze,this.x=ie,this.y=Ae,this.z=Pe,this;var at=Math.acos(lt),Ve=Math.sqrt(1-lt*lt);if(Math.abs(Ve)<.001)return this.w=.5*(ze+this.w),this.x=.5*(ie+this.x),this.y=.5*(Ae+this.y),this.z=.5*(Pe+this.z),this;var et=Math.sin((1-q)*at)/Ve,Et=Math.sin(q*at)/Ve;return this.w=ze*et+this.w*Et,this.x=ie*et+this.x*Et,this.y=Ae*et+this.y*Et,this.z=Pe*et+this.z*Et,this},setFromUnitVectors:function(){var U,Q,q=1e-6;return function(ie,Ae){return U===void 0&&(U=new _t),Q=ie.dot(Ae)+1,Q<q?(Q=0,Math.abs(ie.x)>Math.abs(ie.z)?U.set(-ie.y,ie.x,0):U.set(0,-ie.z,ie.y)):U.crossVectors(ie,Ae),this.x=U.x,this.y=U.y,this.z=U.z,this.w=Q,this.normalize(),this}}()};function Xt(U){this.width=U.width||nt(),this.height=U.height||mt(),this.widthMeters=U.widthMeters,this.heightMeters=U.heightMeters,this.bevelMeters=U.bevelMeters}var Qi=new Xt({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),pn=new Xt({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),Oi={CardboardV1:new yi({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new yi({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function ti(U,Q){this.viewer=Oi.CardboardV2,this.updateDeviceParams(U),this.distortion=new De(this.viewer.distortionCoefficients);for(var q=0;q<Q.length;q++){var ie=Q[q];Oi[ie.id]=new yi(ie)}}ti.prototype.updateDeviceParams=function(U){this.device=this.determineDevice_(U)||this.device},ti.prototype.getDevice=function(){return this.device},ti.prototype.setViewer=function(U){this.viewer=U,this.distortion=new De(this.viewer.distortionCoefficients)},ti.prototype.determineDevice_=function(U){if(!U)return X()?(console.warn("Using fallback iOS device measurements."),pn):(console.warn("Using fallback Android device measurements."),Qi);var Q=.0254,q=Q/U.xdpi,ie=Q/U.ydpi,Ae=nt(),Pe=mt();return new Xt({widthMeters:q*Ae,heightMeters:ie*Pe,bevelMeters:U.bevelMm*.001})},ti.prototype.getDistortedFieldOfViewLeftEye=function(){var U=this.viewer,Q=this.device,q=this.distortion,ie=U.screenLensDistance,Ae=(Q.widthMeters-U.interLensDistance)/2,Pe=U.interLensDistance/2,ze=U.baselineLensDistance-Q.bevelMeters,lt=Q.heightMeters-ze,at=Bt*Math.atan(q.distort(Ae/ie)),Ve=Bt*Math.atan(q.distort(Pe/ie)),et=Bt*Math.atan(q.distort(ze/ie)),Et=Bt*Math.atan(q.distort(lt/ie));return{leftDegrees:Math.min(at,U.fov),rightDegrees:Math.min(Ve,U.fov),downDegrees:Math.min(et,U.fov),upDegrees:Math.min(Et,U.fov)}},ti.prototype.getLeftEyeVisibleTanAngles=function(){var U=this.viewer,Q=this.device,q=this.distortion,ie=Math.tan(-Ct*U.fov),Ae=Math.tan(Ct*U.fov),Pe=Math.tan(Ct*U.fov),ze=Math.tan(-Ct*U.fov),lt=Q.widthMeters/4,at=Q.heightMeters/2,Ve=U.baselineLensDistance-Q.bevelMeters-at,et=U.interLensDistance/2-lt,Et=-Ve,zt=U.screenLensDistance,tn=q.distort((et-lt)/zt),mn=q.distort((Et+at)/zt),Ln=q.distort((et+lt)/zt),_n=q.distort((Et-at)/zt),vn=new Float32Array(4);return vn[0]=Math.max(ie,tn),vn[1]=Math.min(Ae,mn),vn[2]=Math.min(Pe,Ln),vn[3]=Math.max(ze,_n),vn},ti.prototype.getLeftEyeNoLensTanAngles=function(){var U=this.viewer,Q=this.device,q=this.distortion,ie=new Float32Array(4),Ae=q.distortInverse(Math.tan(-Ct*U.fov)),Pe=q.distortInverse(Math.tan(Ct*U.fov)),ze=q.distortInverse(Math.tan(Ct*U.fov)),lt=q.distortInverse(Math.tan(-Ct*U.fov)),at=Q.widthMeters/4,Ve=Q.heightMeters/2,et=U.baselineLensDistance-Q.bevelMeters-Ve,Et=U.interLensDistance/2-at,zt=-et,tn=U.screenLensDistance,mn=(Et-at)/tn,Ln=(zt+Ve)/tn,_n=(Et+at)/tn,vn=(zt-Ve)/tn;return ie[0]=Math.max(Ae,mn),ie[1]=Math.min(Pe,Ln),ie[2]=Math.min(ze,_n),ie[3]=Math.max(lt,vn),ie},ti.prototype.getLeftEyeVisibleScreenRect=function(U){var Q=this.viewer,q=this.device,ie=Q.screenLensDistance,Ae=(q.widthMeters-Q.interLensDistance)/2,Pe=Q.baselineLensDistance-q.bevelMeters,ze=(U[0]*ie+Ae)/q.widthMeters,lt=(U[1]*ie+Pe)/q.heightMeters,at=(U[2]*ie+Ae)/q.widthMeters,Ve=(U[3]*ie+Pe)/q.heightMeters;return{x:ze,y:Ve,width:at-ze,height:lt-Ve}},ti.prototype.getFieldOfViewLeftEye=function(U){return U?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},ti.prototype.getFieldOfViewRightEye=function(U){var Q=this.getFieldOfViewLeftEye(U);return{leftDegrees:Q.rightDegrees,rightDegrees:Q.leftDegrees,upDegrees:Q.upDegrees,downDegrees:Q.downDegrees}},ti.prototype.getUndistortedFieldOfViewLeftEye=function(){var U=this.getUndistortedParams_();return{leftDegrees:Bt*Math.atan(U.outerDist),rightDegrees:Bt*Math.atan(U.innerDist),downDegrees:Bt*Math.atan(U.bottomDist),upDegrees:Bt*Math.atan(U.topDist)}},ti.prototype.getUndistortedViewportLeftEye=function(){var U=this.getUndistortedParams_(),Q=this.viewer,q=this.device,ie=Q.screenLensDistance,Ae=q.widthMeters/ie,Pe=q.heightMeters/ie,ze=q.width/Ae,lt=q.height/Pe,at=Math.round((U.eyePosX-U.outerDist)*ze),Ve=Math.round((U.eyePosY-U.bottomDist)*lt);return{x:at,y:Ve,width:Math.round((U.eyePosX+U.innerDist)*ze)-at,height:Math.round((U.eyePosY+U.topDist)*lt)-Ve}},ti.prototype.getUndistortedParams_=function(){var U=this.viewer,Q=this.device,q=this.distortion,ie=U.screenLensDistance,Ae=U.interLensDistance/2/ie,Pe=Q.widthMeters/ie,ze=Q.heightMeters/ie,lt=Pe/2-Ae,at=(U.baselineLensDistance-Q.bevelMeters)/ie,Ve=U.fov,et=q.distortInverse(Math.tan(Ct*Ve)),Et=Math.min(lt,et),zt=Math.min(Ae,et),tn=Math.min(at,et),mn=Math.min(ze-at,et);return{outerDist:Et,innerDist:zt,topDist:mn,bottomDist:tn,eyePosX:lt,eyePosY:at}};function yi(U){this.id=U.id,this.label=U.label,this.fov=U.fov,this.interLensDistance=U.interLensDistance,this.baselineLensDistance=U.baselineLensDistance,this.screenLensDistance=U.screenLensDistance,this.distortionCoefficients=U.distortionCoefficients,this.inverseCoefficients=U.inverseCoefficients}ti.Viewers=Oi;var kr=1,Ui="2019-11-09T17:36:14Z",es=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}],Zi={format:kr,last_updated:Ui,devices:es};function Lr(U,Q){if(this.dpdb=Zi,this.recalculateDeviceParams_(),U){this.onDeviceParamsUpdated=Q;var q=new XMLHttpRequest,ie=this;q.open("GET",U,!0),q.addEventListener("load",function(){ie.loading=!1,q.status>=200&&q.status<=299?(ie.dpdb=JSON.parse(q.response),ie.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),q.send()}}Lr.prototype.getDeviceParams=function(){return this.deviceParams},Lr.prototype.recalculateDeviceParams_=function(){var U=this.calcDeviceParams_();U?(this.deviceParams=U,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},Lr.prototype.calcDeviceParams_=function(){var U=this.dpdb;if(!U)return console.error("DPDB not available."),null;if(U.format!=1)return console.error("DPDB has unexpected format version."),null;if(!U.devices||!U.devices.length)return console.error("DPDB does not have a devices section."),null;var Q=navigator.userAgent||navigator.vendor||window.opera,q=nt(),ie=mt();if(!U.devices)return console.error("DPDB has no devices section."),null;for(var Ae=0;Ae<U.devices.length;Ae++){var Pe=U.devices[Ae];if(!Pe.rules){console.warn("Device["+Ae+"] has no rules section.");continue}if(Pe.type!="ios"&&Pe.type!="android"){console.warn("Device["+Ae+"] has invalid type.");continue}if(X()==(Pe.type=="ios")){for(var ze=!1,lt=0;lt<Pe.rules.length;lt++){var at=Pe.rules[lt];if(this.ruleMatches_(at,Q,q,ie)){ze=!0;break}}if(!!ze){var Ve=Pe.dpi[0]||Pe.dpi,et=Pe.dpi[1]||Pe.dpi;return new ts({xdpi:Ve,ydpi:et,bevelMm:Pe.bw})}}}return console.warn("No DPDB device match."),null},Lr.prototype.ruleMatches_=function(U,Q,q,ie){if(!U.ua&&!U.res||(U.ua&&U.ua.substring(0,2)==="SM"&&(U.ua=U.ua.substring(0,7)),U.ua&&Q.indexOf(U.ua)<0))return!1;if(U.res){if(!U.res[0]||!U.res[1])return!1;var Ae=U.res[0],Pe=U.res[1];if(Math.min(q,ie)!=Math.min(Ae,Pe)||Math.max(q,ie)!=Math.max(Ae,Pe))return!1}return!0};function ts(U){this.xdpi=U.xdpi,this.ydpi=U.ydpi,this.bevelMm=U.bevelMm}function xr(U,Q){this.set(U,Q)}xr.prototype.set=function(U,Q){this.sample=U,this.timestampS=Q},xr.prototype.copy=function(U){this.set(U.sample,U.timestampS)};function Ni(U,Q){this.kFilter=U,this.isDebug=Q,this.currentAccelMeasurement=new xr,this.currentGyroMeasurement=new xr,this.previousGyroMeasurement=new xr,X()?this.filterQ=new Mt(-1,0,0,1):this.filterQ=new Mt(1,0,0,1),this.previousFilterQ=new Mt,this.previousFilterQ.copy(this.filterQ),this.accelQ=new Mt,this.isOrientationInitialized=!1,this.estimatedGravity=new _t,this.measuredGravity=new _t,this.gyroIntegralQ=new Mt}Ni.prototype.addAccelMeasurement=function(U,Q){this.currentAccelMeasurement.set(U,Q)},Ni.prototype.addGyroMeasurement=function(U,Q){this.currentGyroMeasurement.set(U,Q);var q=Q-this.previousGyroMeasurement.timestampS;je(q)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},Ni.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var U=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,Q=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,U);this.gyroIntegralQ.multiply(Q),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(Q);var q=new Mt;q.copy(this.filterQ),q.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(q),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var ie=new Mt;ie.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),ie.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",Bt*qi(ie),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var Ae=new Mt;Ae.copy(this.filterQ),Ae.multiply(ie),this.filterQ.slerp(Ae,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},Ni.prototype.getOrientation=function(){return this.filterQ},Ni.prototype.accelToQuaternion_=function(U){var Q=new _t;Q.copy(U),Q.normalize();var q=new Mt;return q.setFromUnitVectors(new _t(0,0,-1),Q),q.inverse(),q},Ni.prototype.gyroToQuaternionDelta_=function(U,Q){var q=new Mt,ie=new _t;return ie.copy(U),ie.normalize(),q.setFromAxisAngle(ie,U.length()*Q),q};function Ci(U,Q){this.predictionTimeS=U,this.isDebug=Q,this.previousQ=new Mt,this.previousTimestampS=null,this.deltaQ=new Mt,this.outQ=new Mt}Ci.prototype.getPrediction=function(U,Q,q){if(!this.previousTimestampS)return this.previousQ.copy(U),this.previousTimestampS=q,U;var ie=new _t;ie.copy(Q),ie.normalize();var Ae=Q.length();if(Ae<Ct*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(Bt*Ae).toFixed(1)),this.outQ.copy(U),this.previousQ.copy(U),this.outQ;var Pe=Ae*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(ie,Pe),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(U),this.previousTimestampS=q,this.outQ};function $i(U,Q,q,ie){this.yawOnly=q,this.accelerometer=new _t,this.gyroscope=new _t,this.filter=new Ni(U,ie),this.posePredictor=new Ci(Q,ie),this.isFirefoxAndroid=Z(),this.isIOS=X();var Ae=ne();this.isDeviceMotionInRadians=!this.isIOS&&Ae&&Ae<66,this.isWithoutDeviceMotion=be()||pe(),this.filterToWorldQ=new Mt,X()?this.filterToWorldQ.setFromAxisAngle(new _t(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new _t(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new Mt,this.worldToScreenQ=new Mt,this.originalPoseAdjustQ=new Mt,this.originalPoseAdjustQ.setFromAxisAngle(new _t(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),Ue()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new Mt,this.orientationOut_=new Float32Array(4),this.start()}$i.prototype.getPosition=function(){return null},$i.prototype.getOrientation=function(){var U=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var Ae=new Mt().setFromAxisAngle(new _t(0,0,-1),0),Pe=new Mt;return window.orientation===-90?Pe.setFromAxisAngle(new _t(0,1,0),Math.PI/-2):Pe.setFromAxisAngle(new _t(0,1,0),Math.PI/2),Ae.multiply(Pe)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var Ae=new Mt;return Ae.setFromAxisAngle(new _t(1,0,0),-Math.PI/2),Ae}(),U=this._deviceOrientationQ;var q=new Mt;return q.copy(U),q.multiply(this.deviceOrientationFilterToWorldQ),q.multiply(this.resetQ),q.multiply(this.worldToScreenQ),q.multiplyQuaternions(this.deviceOrientationFixQ,q),this.yawOnly&&(q.x=0,q.z=0,q.normalize()),this.orientationOut_[0]=q.x,this.orientationOut_[1]=q.y,this.orientationOut_[2]=q.z,this.orientationOut_[3]=q.w,this.orientationOut_}else{var Q=this.filter.getOrientation();U=this.posePredictor.getPrediction(Q,this.gyroscope,this.previousTimestampS)}var q=new Mt;return q.copy(this.filterToWorldQ),q.multiply(this.resetQ),q.multiply(U),q.multiply(this.worldToScreenQ),this.yawOnly&&(q.x=0,q.z=0,q.normalize()),this.orientationOut_[0]=q.x,this.orientationOut_[1]=q.y,this.orientationOut_[2]=q.z,this.orientationOut_[3]=q.w,this.orientationOut_},$i.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),Ue()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},$i.prototype.onDeviceOrientation_=function(U){this._deviceOrientationQ=this._deviceOrientationQ||new Mt;var Q=U.alpha,q=U.beta,ie=U.gamma;Q=(Q||0)*Math.PI/180,q=(q||0)*Math.PI/180,ie=(ie||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(q,Q,-ie)},$i.prototype.onDeviceMotion_=function(U){this.updateDeviceMotion_(U)},$i.prototype.updateDeviceMotion_=function(U){var Q=U.accelerationIncludingGravity,q=U.rotationRate,ie=U.timeStamp/1e3,Ae=ie-this.previousTimestampS;if(Ae<0){pi("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=ie;return}else if(Ae<=Y||Ae>W){pi("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=ie;return}this.accelerometer.set(-Q.x,-Q.y,-Q.z),q&&(Re()?this.gyroscope.set(-q.beta,q.alpha,q.gamma):this.gyroscope.set(q.alpha,q.beta,q.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,ie)),this.filter.addAccelMeasurement(this.accelerometer,ie),this.previousTimestampS=ie},$i.prototype.onOrientationChange_=function(U){this.setScreenTransform_()},$i.prototype.onMessage_=function(U){var Q=U.data;if(!(!Q||!Q.type)){var q=Q.type.toLowerCase();q==="devicemotion"&&this.updateDeviceMotion_(Q.deviceMotionEvent)}},$i.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new _t(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new _t(0,0,1),Math.PI/2);break;case 180:break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},$i.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),X()&&fi()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},$i.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var _s=60,jr=new _t(1,0,0),Vs=new _t(0,0,1),ps=new Mt;ps.setFromAxisAngle(jr,-Math.PI/2),ps.multiply(new Mt().setFromAxisAngle(Vs,Math.PI/2));var ue=function(){function U(Q){M(this,U),this.config=Q,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new Mt,this._outQ=new Mt,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return F(U,[{key:"init",value:function(){var q=null;try{q=new RelativeOrientationSensor({frequency:_s,referenceFrame:"screen"}),q.addEventListener("error",this._onSensorError)}catch(ie){this.errors.push(ie),ie.name==="SecurityError"?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):ie.name==="ReferenceError"?this.useDeviceMotion():console.error(ie)}q&&(this.api="sensor",this.sensor=q,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new $i(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var q=this.sensor.quaternion;this._sensorQ.set(q[0],q[1],q[2],q[3]);var ie=this._outQ;return ie.copy(ps),ie.multiply(this._sensorQ),this.config.YAW_ONLY&&(ie.x=ie.z=0,ie.normalize()),this._out[0]=ie.x,this._out[1]=ie.y,this._out[2]=ie.z,this._out[3]=ie.w,this._out}},{key:"_onSensorError",value:function(q){this.errors.push(q.error),q.error.name==="NotAllowedError"?console.error("Permission to access sensor was denied"):q.error.name==="NotReadableError"?console.error("Sensor could not be read"):console.error(q.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),U}(),Me="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function Ne(){this.loadIcon_();var U=document.createElement("div"),Q=U.style;Q.position="fixed",Q.top=0,Q.right=0,Q.bottom=0,Q.left=0,Q.backgroundColor="gray",Q.fontFamily="sans-serif",Q.zIndex=1e6;var q=document.createElement("img");q.src=this.icon;var Q=q.style;Q.marginLeft="25%",Q.marginTop="25%",Q.width="50%",U.appendChild(q);var ie=document.createElement("div"),Q=ie.style;Q.textAlign="center",Q.fontSize="16px",Q.lineHeight="24px",Q.margin="24px 25%",Q.width="50%",ie.innerHTML="Place your phone into your Cardboard viewer.",U.appendChild(ie);var Ae=document.createElement("div"),Q=Ae.style;Q.backgroundColor="#CFD8DC",Q.position="fixed",Q.bottom=0,Q.width="100%",Q.height="48px",Q.padding="14px 24px",Q.boxSizing="border-box",Q.color="#656A6B",U.appendChild(Ae);var Pe=document.createElement("div");Pe.style.float="left",Pe.innerHTML="No Cardboard viewer?";var ze=document.createElement("a");ze.href="https://www.google.com/get/cardboard/get-cardboard/",ze.innerHTML="get one",ze.target="_blank";var Q=ze.style;Q.float="right",Q.fontWeight=600,Q.textTransform="uppercase",Q.borderLeft="1px solid gray",Q.paddingLeft="24px",Q.textDecoration="none",Q.color="#656A6B",Ae.appendChild(Pe),Ae.appendChild(ze),this.overlay=U,this.text=ie,this.hide()}Ne.prototype.show=function(U){!U&&!this.overlay.parentElement?document.body.appendChild(this.overlay):U&&(this.overlay.parentElement&&this.overlay.parentElement!=U&&this.overlay.parentElement.removeChild(this.overlay),U.appendChild(this.overlay)),this.overlay.style.display="block";var Q=this.overlay.querySelector("img"),q=Q.style;Ue()?(q.width="20%",q.marginLeft="40%",q.marginTop="3%"):(q.width="50%",q.marginLeft="25%",q.marginTop="25%")},Ne.prototype.hide=function(){this.overlay.style.display="none"},Ne.prototype.showTemporarily=function(U,Q){this.show(Q),this.timer=setTimeout(this.hide.bind(this),U)},Ne.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},Ne.prototype.update=function(){this.disableShowTemporarily(),!Ue()&&Sn()?this.show():this.hide()},Ne.prototype.loadIcon_=function(){this.icon=te("image/svg+xml",Me)};var $e="CardboardV1",We="WEBVR_CARDBOARD_VIEWER",st="webvr-polyfill-viewer-selector";function yt(U){try{this.selectedKey=localStorage.getItem(We)}catch(Q){console.error("Failed to load viewer profile: %s",Q)}this.selectedKey||(this.selectedKey=U||$e),this.dialog=this.createDialog_(ti.Viewers),this.root=null,this.onChangeCallbacks_=[]}yt.prototype.show=function(U){this.root=U,U.appendChild(this.dialog);var Q=this.dialog.querySelector("#"+this.selectedKey);Q.checked=!0,this.dialog.style.display="block"},yt.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},yt.prototype.getCurrentViewer=function(){return ti.Viewers[this.selectedKey]},yt.prototype.getSelectedKey_=function(){var U=this.dialog.querySelector("input[name=field]:checked");return U?U.id:null},yt.prototype.onChange=function(U){this.onChangeCallbacks_.push(U)},yt.prototype.fireOnChange_=function(U){for(var Q=0;Q<this.onChangeCallbacks_.length;Q++)this.onChangeCallbacks_[Q](U)},yt.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!ti.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(ti.Viewers[this.selectedKey]);try{localStorage.setItem(We,this.selectedKey)}catch(U){console.error("Failed to save viewer profile: %s",U)}this.hide()},yt.prototype.createDialog_=function(U){var Q=document.createElement("div");Q.classList.add(st),Q.style.display="none";var q=document.createElement("div"),ie=q.style;ie.position="fixed",ie.left=0,ie.top=0,ie.width="100%",ie.height="100%",ie.background="rgba(0, 0, 0, 0.3)",q.addEventListener("click",this.hide.bind(this));var Ae=280,Pe=document.createElement("div"),ie=Pe.style;ie.boxSizing="border-box",ie.position="fixed",ie.top="24px",ie.left="50%",ie.marginLeft=-Ae/2+"px",ie.width=Ae+"px",ie.padding="24px",ie.overflow="hidden",ie.background="#fafafa",ie.fontFamily="'Roboto', sans-serif",ie.boxShadow="0px 5px 20px #666",Pe.appendChild(this.createH1_("Select your viewer"));for(var ze in U)Pe.appendChild(this.createChoice_(ze,U[ze].label));return Pe.appendChild(this.createButton_("Save",this.onSave_.bind(this))),Q.appendChild(q),Q.appendChild(Pe),Q},yt.prototype.createH1_=function(U){var Q=document.createElement("h1"),q=Q.style;return q.color="black",q.fontSize="20px",q.fontWeight="bold",q.marginTop=0,q.marginBottom="24px",Q.innerHTML=U,Q},yt.prototype.createChoice_=function(U,Q){var q=document.createElement("div");q.style.marginTop="8px",q.style.color="black";var ie=document.createElement("input");ie.style.fontSize="30px",ie.setAttribute("id",U),ie.setAttribute("type","radio"),ie.setAttribute("value",U),ie.setAttribute("name","field");var Ae=document.createElement("label");return Ae.style.marginLeft="4px",Ae.setAttribute("for",U),Ae.innerHTML=Q,q.appendChild(ie),q.appendChild(Ae),q},yt.prototype.createButton_=function(U,Q){var q=document.createElement("button");q.innerHTML=U;var ie=q.style;return ie.float="right",ie.textTransform="uppercase",ie.color="#1094f7",ie.fontSize="14px",ie.letterSpacing=0,ie.border=0,ie.background="none",ie.marginTop="16px",q.addEventListener("click",Q),q};var $t=typeof window!="undefined"?window:typeof y!="undefined"?y:typeof self!="undefined"?self:{};function Gt(U){return U&&U.__esModule&&Object.prototype.hasOwnProperty.call(U,"default")?U.default:U}function ot(U,Q){return Q={exports:{}},U(Q,Q.exports),Q.exports}var on=ot(function(U,Q){(function(ie,Ae){U.exports=Ae()})($t,function(){return function(q){var ie={};function Ae(Pe){if(ie[Pe])return ie[Pe].exports;var ze=ie[Pe]={i:Pe,l:!1,exports:{}};return q[Pe].call(ze.exports,ze,ze.exports,Ae),ze.l=!0,ze.exports}return Ae.m=q,Ae.c=ie,Ae.d=function(Pe,ze,lt){Ae.o(Pe,ze)||Object.defineProperty(Pe,ze,{configurable:!1,enumerable:!0,get:lt})},Ae.n=function(Pe){var ze=Pe&&Pe.__esModule?function(){return Pe.default}:function(){return Pe};return Ae.d(ze,"a",ze),ze},Ae.o=function(Pe,ze){return Object.prototype.hasOwnProperty.call(Pe,ze)},Ae.p="",Ae(Ae.s=0)}([function(q,ie,Ae){var Pe=function(){function et(Et,zt){for(var tn=0;tn<zt.length;tn++){var mn=zt[tn];mn.enumerable=mn.enumerable||!1,mn.configurable=!0,"value"in mn&&(mn.writable=!0),Object.defineProperty(Et,mn.key,mn)}}return function(Et,zt,tn){return zt&&et(Et.prototype,zt),tn&&et(Et,tn),Et}}();function ze(et,Et){if(!(et instanceof Et))throw new TypeError("Cannot call a class as a function")}var lt=Ae(1),at=typeof navigator!="undefined"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,Ve=function(){function et(){ze(this,et),at?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",lt),this.noSleepVideo.addEventListener("timeupdate",function(Et){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}.bind(this)))}return Pe(et,[{key:"enable",value:function(){at?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){at?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),et}();q.exports=Ve},function(q,ie,Ae){q.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})}),An=Gt(on),Cn=1e3,xi=[0,0,.5,1],Fn=[.5,0,.5,1],In=window.requestAnimationFrame,Yn=window.cancelAnimationFrame;function Bi(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function er(U){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:U.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:U.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:U.canPresent},maxLayers:{writable:!1,enumerable:!0,value:U.maxLayers},hasOrientation:{enumerable:!0,get:function(){return Jn("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),U.hasOrientation}}})}function Qt(U){U=U||{};var Q="wakelock"in U?U.wakelock:!0;this.isPolyfilled=!0,this.displayId=Cn++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return Jn("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new er({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,Q&&Sn()&&(this.wakelock_=new An)}Qt.prototype.getFrameData=function(U){return En(U,this._getPose(),this)},Qt.prototype.getPose=function(){return Jn("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},Qt.prototype.resetPose=function(){return Jn("VRDisplay.prototype.resetPose"),this._resetPose()},Qt.prototype.getImmediatePose=function(){return Jn("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},Qt.prototype.requestAnimationFrame=function(U){return In(U)},Qt.prototype.cancelAnimationFrame=function(U){return Yn(U)},Qt.prototype.wrapForFullscreen=function(U){if(X())return U;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var Q=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",Q.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==U)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=U,this.originalParent_=U.parentElement,this.originalParent_||document.body.appendChild(U),!this.fullscreenWrapper_.parentElement){var q=this.fullscreenElement_.parentElement;q.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),q.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var ie=this;function Ae(){if(!!ie.fullscreenElement_){var Pe=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];ie.fullscreenElement_.setAttribute("style",Pe.join("; ")+";")}}return Ae(),this.fullscreenWrapper_},Qt.prototype.removeFullscreenWrapper=function(){if(!!this.fullscreenElement_){var U=this.fullscreenElement_;this.fullscreenElementCachedStyle_?U.setAttribute("style",this.fullscreenElementCachedStyle_):U.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var Q=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(U),this.originalParent_===Q?Q.insertBefore(U,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(U),Q.removeChild(this.fullscreenWrapper_),U}},Qt.prototype.requestPresent=function(U){var Q=this.isPresenting,q=this;return U instanceof Array||(Jn("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),U=[U]),new Promise(function(ie,Ae){if(!q.capabilities.canPresent){Ae(new Error("VRDisplay is not capable of presenting."));return}if(U.length==0||U.length>q.capabilities.maxLayers){Ae(new Error("Invalid number of layers."));return}var Pe=U[0];if(!Pe.source){ie();return}var ze=Pe.leftBounds||xi,lt=Pe.rightBounds||Fn;if(Q){var at=q.layer_;at.source!==Pe.source&&(at.source=Pe.source);for(var Ve=0;Ve<4;Ve++)at.leftBounds[Ve]=ze[Ve],at.rightBounds[Ve]=lt[Ve];q.wrapForFullscreen(q.layer_.source),q.updatePresent_(),ie();return}if(q.layer_={predistorted:Pe.predistorted,source:Pe.source,leftBounds:ze.slice(0),rightBounds:lt.slice(0)},q.waitingForPresent_=!1,q.layer_&&q.layer_.source){var et=q.wrapForFullscreen(q.layer_.source),Et=function(){var mn=Tt();q.isPresenting=et===mn,q.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(Ln){console.error("screen.orientation.lock() failed due to",Ln.message)}),q.waitingForPresent_=!1,q.beginPresent_(),ie()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),q.removeFullscreenWrapper(),q.disableWakeLock(),q.endPresent_(),q.removeFullscreenListeners_()),q.fireVRDisplayPresentChange_()},zt=function(){!q.waitingForPresent_||(q.removeFullscreenWrapper(),q.removeFullscreenListeners_(),q.disableWakeLock(),q.waitingForPresent_=!1,q.isPresenting=!1,Ae(new Error("Unable to present.")))};q.addFullscreenListeners_(et,Et,zt),Dt(et)?(q.enableWakeLock(),q.waitingForPresent_=!0):(X()||V())&&(q.enableWakeLock(),q.isPresenting=!0,q.beginPresent_(),q.fireVRDisplayPresentChange_(),ie())}!q.waitingForPresent_&&!X()&&(pt(),Ae(new Error("Unable to present.")))})},Qt.prototype.exitPresent=function(){var U=this.isPresenting,Q=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(q,ie){U?(!pt()&&X()&&(Q.endPresent_(),Q.fireVRDisplayPresentChange_()),V()&&(Q.removeFullscreenWrapper(),Q.removeFullscreenListeners_(),Q.endPresent_(),Q.fireVRDisplayPresentChange_()),q()):ie(new Error("Was not presenting to VRDisplay."))})},Qt.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},Qt.prototype.fireVRDisplayPresentChange_=function(){var U=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(U)},Qt.prototype.fireVRDisplayConnect_=function(){var U=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(U)},Qt.prototype.addFullscreenListeners_=function(U,Q,q){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=U,this.fullscreenChangeHandler_=Q,this.fullscreenErrorHandler_=q,Q&&(document.fullscreenEnabled?U.addEventListener("fullscreenchange",Q,!1):document.webkitFullscreenEnabled?U.addEventListener("webkitfullscreenchange",Q,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",Q,!1):document.msFullscreenEnabled&&U.addEventListener("msfullscreenchange",Q,!1)),q&&(document.fullscreenEnabled?U.addEventListener("fullscreenerror",q,!1):document.webkitFullscreenEnabled?U.addEventListener("webkitfullscreenerror",q,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",q,!1):document.msFullscreenEnabled&&U.addEventListener("msfullscreenerror",q,!1))},Qt.prototype.removeFullscreenListeners_=function(){if(!!this.fullscreenEventTarget_){var U=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var Q=this.fullscreenChangeHandler_;U.removeEventListener("fullscreenchange",Q,!1),U.removeEventListener("webkitfullscreenchange",Q,!1),document.removeEventListener("mozfullscreenchange",Q,!1),U.removeEventListener("msfullscreenchange",Q,!1)}if(this.fullscreenErrorHandler_){var q=this.fullscreenErrorHandler_;U.removeEventListener("fullscreenerror",q,!1),U.removeEventListener("webkitfullscreenerror",q,!1),document.removeEventListener("mozfullscreenerror",q,!1),U.removeEventListener("msfullscreenerror",q,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},Qt.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},Qt.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},Qt.prototype.beginPresent_=function(){},Qt.prototype.endPresent_=function(){},Qt.prototype.submitFrame=function(U){},Qt.prototype.getEyeParameters=function(U){return null};var On={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},Hi={LEFT:"left",RIGHT:"right"};function $n(U){var Q=Nn({},On);U=Nn(Q,U||{}),Qt.call(this,{wakelock:U.MOBILE_WAKE_LOCK}),this.config=U,this.displayName="Cardboard VRDisplay",this.capabilities=new er({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new ue(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new Lr(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new ti(this.dpdb_.getDeviceParams(),U.ADDITIONAL_VIEWERS),this.viewerSelector_=new yt(U.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new Ne),X()&&window.addEventListener("resize",this.onResize_.bind(this))}return $n.prototype=Object.create(Qt.prototype),$n.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},$n.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},$n.prototype._getFieldOfView=function(U){var Q;if(U==Hi.LEFT)Q=this.deviceInfo_.getFieldOfViewLeftEye();else if(U==Hi.RIGHT)Q=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",U),null;return Q},$n.prototype._getEyeOffset=function(U){var Q;if(U==Hi.LEFT)Q=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0];else if(U==Hi.RIGHT)Q=[this.deviceInfo_.viewer.interLensDistance*.5,0,0];else return console.error("Invalid eye provided: %s",U),null;return Q},$n.prototype.getEyeParameters=function(U){var Q=this._getEyeOffset(U),q=this._getFieldOfView(U),ie={offset:Q,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(ie,"fieldOfView",{enumerable:!0,get:function(){return Jn("VRFieldOfView","VRFrameData's projection matrices"),q}}),ie},$n.prototype.onDeviceParamsUpdated_=function(U){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(U),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},$n.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},$n.prototype.beginPresent_=function(){var U=this.layer_.source.getContext("webgl");U||(U=this.layer_.source.getContext("experimental-webgl")),U||(U=this.layer_.source.getContext("webgl2")),!!U&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(U.canvas.width=nt()*this.bufferScale_,U.canvas.height=mt()*this.bufferScale_,this.cardboardUI_=new _e(U)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new _e(U)),this.distorter_=new Ei(U,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen(function(Q){this.viewerSelector_.show(this.layer_.source.parentElement),Q.stopPropagation(),Q.preventDefault()}.bind(this),function(Q){this.exitPresent(),Q.stopPropagation(),Q.preventDefault()}.bind(this)),this.rotateInstructions_&&(Ue()&&Sn()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},$n.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},$n.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},$n.prototype.submitFrame=function(U){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var Q=this.layer_.source.getContext("webgl");Q||(Q=this.layer_.source.getContext("experimental-webgl")),Q||(Q=this.layer_.source.getContext("webgl2"));var q=Q.canvas;(q.width!=this.lastWidth||q.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=q.width,this.lastHeight=q.height,this.cardboardUI_.render()}},$n.prototype.onOrientationChange_=function(U){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},$n.prototype.onResize_=function(U){if(this.layer_){var Q=this.layer_.source.getContext("webgl");Q||(Q=this.layer_.source.getContext("experimental-webgl")),Q||(Q=this.layer_.source.getContext("webgl2"));var q=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];Q.canvas.setAttribute("style",q.join("; ")+";"),ln(Q.canvas)}},$n.prototype.onViewerChanged_=function(U){this.deviceInfo_.setViewer(U),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},$n.prototype.fireVRDisplayDeviceParamsChange_=function(){var U=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(U)},$n.VRFrameData=Bi,$n.VRDisplay=Qt,$n})}),c=_(p),g="0.10.12",A={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function h(b){this.config=u(u({},A),b),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&C())&&(this.enable(),this.getVRDisplays().then(function(L){L&&L[0]&&L[0].fireVRDisplayConnect_&&L[0].fireVRDisplayConnect_()}))}h.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(C()){var b=new c({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(b)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},h.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var b=this.native.VRFrameData,L=new this.native.VRFrameData,M=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(F){if(F instanceof b){M.call(this,F);return}M.call(this,L),F.pose=L.pose,l(L.leftProjectionMatrix,F.leftProjectionMatrix),l(L.rightProjectionMatrix,F.rightProjectionMatrix),l(L.leftViewMatrix,F.leftViewMatrix),l(L.rightViewMatrix,F.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=c.VRDisplay,window.VRFrameData=c.VRFrameData},h.prototype.getVRDisplays=function(){var b=this,L=this.config;return this.hasNative?this.native.getVRDisplays.call(navigator).then(function(M){return M.length>0?M:b.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},h.version=g,h.VRFrameData=c.VRFrameData,h.VRDisplay=c.VRDisplay;var m=Object.freeze({default:h}),x=m&&h||m;typeof y!="undefined"&&y.window&&(y.document||(y.document=y.window.document),y.navigator||(y.navigator=y.window.navigator));var S=x;return S})},"./node_modules/word-wrapper/index.js":k=>{var K=/\n/,f=`
`,y=/\s/;k.exports=function(p,c){var g=k.exports.lines(p,c);return g.map(function(A){return p.substring(A.start,A.end)}).join(`
`)},k.exports.lines=function(c,g){if(g=g||{},g.width===0&&g.mode!=="nowrap")return[];c=c||"";var A=typeof g.width=="number"?g.width:Number.MAX_VALUE,h=Math.max(0,g.start||0),m=typeof g.end=="number"?g.end:c.length,x=g.mode,S=g.measure||u;return x==="pre"?C(S,c,h,m,A):l(S,c,h,m,A,x)};function _(p,c,g,A){var h=p.indexOf(c,g);return h===-1||h>A?A:h}function v(p){return y.test(p)}function C(p,c,g,A,h){for(var m=[],x=g,S=g;S<A&&S<c.length;S++){var b=c.charAt(S),L=K.test(b);if(L||S===A-1){var M=L?S:S+1,F=p(c,x,M,h);m.push(F),x=S+1}}return m}function l(p,c,g,A,h,m){var x=[],S=h;for(m==="nowrap"&&(S=Number.MAX_VALUE);g<A&&g<c.length;){for(var b=_(c,f,g,A);g<b&&v(c.charAt(g));)g++;var L=p(c,g,b,S),M=g+(L.end-L.start),F=M+f.length;if(M<b){for(;M>g&&!v(c.charAt(M));)M--;if(M===g)F>g+f.length&&F--,M=F;else for(F=M;M>g&&v(c.charAt(M-f.length));)M--}if(M>=g){var H=p(c,g,M,S);x.push(H)}g=F}return x}function u(p,c,g,A){var h=Math.min(A,g-c);return{start:c,end:c+h}}},"./node_modules/xhr/index.js":(k,K,f)=>{"use strict";var y=f("./node_modules/global/window.js"),_=f("./node_modules/is-function/index.js"),v=f("./node_modules/parse-headers/parse-headers.js"),C=f("./node_modules/xtend/immutable.js");k.exports=c,k.exports.default=c,c.XMLHttpRequest=y.XMLHttpRequest||h,c.XDomainRequest="withCredentials"in new c.XMLHttpRequest?c.XMLHttpRequest:y.XDomainRequest,l(["get","put","post","patch","head","delete"],function(m){c[m==="delete"?"del":m]=function(x,S,b){return S=p(x,S,b),S.method=m.toUpperCase(),g(S)}});function l(m,x){for(var S=0;S<m.length;S++)x(m[S])}function u(m){for(var x in m)if(m.hasOwnProperty(x))return!1;return!0}function p(m,x,S){var b=m;return _(x)?(S=x,typeof m=="string"&&(b={uri:m})):b=C(x,{uri:m}),b.callback=S,b}function c(m,x,S){return x=p(m,x,S),g(x)}function g(m){if(typeof m.callback=="undefined")throw new Error("callback argument missing");var x=!1,S=function(Re,Ue,je){x||(x=!0,m.callback(Re,Ue,je))};function b(){H.readyState===4&&setTimeout(F,0)}function L(){var be=void 0;if(H.response?be=H.response:be=H.responseText||A(H),Z)try{be=JSON.parse(be)}catch(Re){}return be}function M(be){return clearTimeout(ne),be instanceof Error||(be=new Error(""+(be||"Unknown XMLHttpRequest Error"))),be.statusCode=0,S(be,pe)}function F(){if(!W){var be;clearTimeout(ne),m.useXDR&&H.status===void 0?be=200:be=H.status===1223?204:H.status;var Re=pe,Ue=null;return be!==0?(Re={body:L(),statusCode:be,method:re,headers:{},url:te,rawRequest:H},H.getAllResponseHeaders&&(Re.headers=v(H.getAllResponseHeaders()))):Ue=new Error("Internal XMLHttpRequest Error"),S(Ue,Re,Re.body)}}var H=m.xhr||null;H||(m.cors||m.useXDR?H=new c.XDomainRequest:H=new c.XMLHttpRequest);var Y,W,te=H.url=m.uri||m.url,re=H.method=m.method||"GET",X=m.body||m.data,V=H.headers=m.headers||{},O=!!m.sync,Z=!1,ne,pe={body:void 0,headers:{},statusCode:0,method:re,url:te,rawRequest:H};if("json"in m&&m.json!==!1&&(Z=!0,V.accept||V.Accept||(V.Accept="application/json"),re!=="GET"&&re!=="HEAD"&&(V["content-type"]||V["Content-Type"]||(V["Content-Type"]="application/json"),X=JSON.stringify(m.json===!0?X:m.json))),H.onreadystatechange=b,H.onload=F,H.onerror=M,H.onprogress=function(){},H.onabort=function(){W=!0},H.ontimeout=M,H.open(re,te,!O,m.username,m.password),O||(H.withCredentials=!!m.withCredentials),!O&&m.timeout>0&&(ne=setTimeout(function(){if(!W){W=!0,H.abort("timeout");var be=new Error("XMLHttpRequest timeout");be.code="ETIMEDOUT",M(be)}},m.timeout)),H.setRequestHeader)for(Y in V)V.hasOwnProperty(Y)&&H.setRequestHeader(Y,V[Y]);else if(m.headers&&!u(m.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in m&&(H.responseType=m.responseType),"beforeSend"in m&&typeof m.beforeSend=="function"&&m.beforeSend(H),H.send(X||null),H}function A(m){try{if(m.responseType==="document")return m.responseXML;var x=m.responseXML&&m.responseXML.documentElement.nodeName==="parsererror";if(m.responseType===""&&!x)return m.responseXML}catch(S){}return null}function h(){}},"./node_modules/xml-parse-from-string/index.js":k=>{k.exports=function(){return typeof self.DOMParser!="undefined"?function(f){var y=new self.DOMParser;return y.parseFromString(f,"application/xml")}:typeof self.ActiveXObject!="undefined"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(f){var y=new self.ActiveXObject("Microsoft.XMLDOM");return y.async="false",y.loadXML(f),y}:function(f){var y=document.createElement("div");return y.innerHTML=f,y}}()},"./node_modules/xtend/immutable.js":k=>{k.exports=f;var K=Object.prototype.hasOwnProperty;function f(){for(var y={},_=0;_<arguments.length;_++){var v=arguments[_];for(var C in v)K.call(v,C)&&(y[C]=v[C])}return y}},"./src/components/anchored.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/utils/index.js"),v=_.debug("components:anchored:warn");k.exports.Component=y("anchored",{schema:{persistent:{default:!1}},init:function(){var l=this.el.sceneEl,u=l.getAttribute("webxr"),p=u.optionalFeatures;p.indexOf("anchors")===-1&&(p.push("anchors"),this.el.sceneEl.setAttribute("webxr",u)),this.auxQuaternion=new THREE.Quaternion,this.onEnterVR=this.onEnterVR.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR)},onEnterVR:function(){this.anchor=void 0,this.requestPersistentAnchorPending=this.data.persistent,this.requestAnchorPending=!this.data.persistent},tick:function(){var l=this.el.sceneEl,u=l.renderer.xr,p,c,g,A=this.el.object3D;!l.is("ar-mode")&&!l.is("vr-mode")||(!this.anchor&&this.requestPersistentAnchorPending&&this.restorePersistentAnchor(),!this.anchor&&this.requestAnchorPending&&this.createAnchor(),!!this.anchor&&(p=l.frame,c=u.getReferenceSpace(),g=p.getPose(this.anchor.anchorSpace,c),A.matrix.elements=g.transform.matrix,A.matrix.decompose(A.position,A.rotation,A.scale)))},createAnchor:async function(u,p){var c=this.el.sceneEl,g=c.renderer.xr,A,h,m,x,S=this.el.object3D;if(u=u||S.position,p=p||this.auxQuaternion.setFromEuler(S.rotation),!C(c)){v("This browser doesn't support the WebXR anchors module");return}this.anchor&&this.deleteAnchor(),A=c.frame,h=g.getReferenceSpace(),m=new XRRigidTransform({x:u.x,y:u.y,z:u.z},{x:p.x,y:p.y,z:p.z,w:p.w}),this.requestAnchorPending=!1,x=await A.createAnchor(m,h),this.data.persistent&&(this.el.id?(this.persistentHandle=await x.requestPersistentHandle(),localStorage.setItem(this.el.id,this.persistentHandle)):v("The anchor won't be persisted because the entity has no assigned id.")),c.object3D.attach(this.el.object3D),this.anchor=x},restorePersistentAnchor:async function(){var u=this.el.sceneEl.renderer.xr,p=u.getSession(),c=p.persistentAnchors,g;if(this.requestPersistentAnchorPending=!1,!this.el.id){v("The entity associated to the persistent anchor cannot be retrieved because it doesn't have an assigned id."),this.requestAnchorPending=!0;return}if(c){g=localStorage.getItem(this.el.id);for(var A=0;A<c.length;++A)if(g===c[A]){this.anchor=await p.restorePersistentAnchor(c[A]),this.anchor&&(this.persistentHandle=c[A]);break}this.anchor||(this.requestAnchorPending=!0)}else this.requestPersistentAnchorPending=!0},deleteAnchor:function(){var l,u,p=this.anchor;!p||(l=this.el.sceneEl.renderer.xr,u=l.getSession(),p.delete(),this.el.sceneEl.object3D.add(this.el.object3D),this.persistentHandle&&u.deletePersistentAnchor(this.persistentHandle),this.anchor=void 0)}});function C(l){var u=l.renderer.xr,p=u.getSession();return p&&p.restorePersistentAnchor}},"./src/components/animation.js":(k,K,f)=>{var y=f("./node_modules/super-animejs/lib/anime.es.js").default,_=f("./src/core/component.js").components,v=f("./src/core/component.js").registerComponent,C=f("./src/lib/three.js"),l=f("./src/utils/index.js"),u=new C.Color,p=new C.Color,c=l.entity.getComponentProperty,g=l.entity.setComponentProperty,A={},h="color",m="position",x="rotation",S="scale",b="components",L="object3D";k.exports.Component=v("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(V){return V===!0||V==="true"?!0:V===!1||V==="false"?!1:parseInt(V,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var V=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){V.animationIsPlaying=!1,V.el.emit("animationcomplete",V.eventDetail,!1),V.id&&V.el.emit("animationcomplete__"+V.id,V.eventDetail,!1)}}},update:function(V){var O=this.config,Z=this.data;this.animationIsPlaying=!1,!!this.data.enabled&&(!Z.property||(O.autoplay=!1,O.direction=Z.dir,O.duration=Z.dur,O.easing=Z.easing,O.elasticity=Z.elasticity,O.loop=Z.loop,O.round=Z.round,this.createAndStartAnimation()))},tick:function(V,O){!this.animationIsPlaying||(this.time+=O,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){!this.paused||(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var V=this.data;if(this.updateConfig(),this.animationIsPlaying=!1,this.animation=y(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),!(!V.autoplay||V.startEvents&&V.startEvents.length)){if(V.delay){setTimeout(this.beginAnimation,V.delay);return}this.beginAnimation()}},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){if(!!this.data.enabled){if(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=y(this.config),this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()}},updateConfigForRawColor:function(){var V=this.config,O=this.data,Z=this.el,ne,pe,be;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){ne=O.from===""?W(Z,O.property):O.from,be=O.to,this.setColorConfig(ne,be),ne=this.fromColor,be=this.toColor,this.targetsArray.length=0,this.targetsArray.push(ne),V.targets=this.targetsArray;for(pe in be)V[pe]=be[pe];V.update=function(){var Re={};return function(Ue){var je;je=Ue.animatables[0].target,!(je.r===Re.r&&je.g===Re.g&&je.b===Re.b)&&te(Z,O.property,je,O.type)}}()}},updateConfigForDefault:function(){var V=this.config,O=this.data,Z=this.el,ne,pe,be,Re;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(O.from===""?ne=X(O)?W(Z,O.property):c(Z,O.property):ne=O.from,Re=O.to,be=!isNaN(ne||Re),be?(ne=parseFloat(ne),Re=parseFloat(Re)):(ne=ne&&ne.toString(),Re=Re&&Re.toString()),pe=O.to==="true"||O.to==="false"||O.to===!0||O.to===!1,pe&&(ne=O.from==="true"||O.from===!0?1:0,Re=O.to==="true"||O.to===!0?1:0),this.targets.aframeProperty=ne,V.targets=this.targets,V.aframeProperty=Re,V.update=function(){var Ue;return function(je){var nt;nt=je.animatables[0].target.aframeProperty,nt!==Ue&&(Ue=nt,pe&&(nt=nt>=1),X(O)?te(Z,O.property,nt,O.type):g(Z,O.property,nt))}}())},updateConfigForVector:function(){var V=this.config,O=this.data,Z=this.el,ne,pe,be;pe=O.from!==""?l.coordinates.parse(O.from):c(Z,O.property),be=l.coordinates.parse(O.to),O.property===x&&(F(pe),F(be)),this.targetsArray.length=0,this.targetsArray.push(pe),V.targets=this.targetsArray;for(ne in be)V[ne]=be[ne];if(O.property===m||O.property===x||O.property===S){V.update=function(){var Re={};return function(Ue){var je=Ue.animatables[0].target;je.x===Re.x&&je.y===Re.y&&je.z===Re.z||(Re.x=je.x,Re.y=je.y,Re.z=je.z,Z.object3D[O.property].set(je.x,je.y,je.z))}}();return}V.update=function(){var Re={};return function(Ue){var je=Ue.animatables[0].target;je.x===Re.x&&je.y===Re.y&&je.z===Re.z||(Re.x=je.x,Re.y=je.y,Re.z=je.z,g(Z,O.property,je))}}()},updateConfig:function(){var V;V=M(this.el,this.data.property),X(this.data)&&this.data.type===h?this.updateConfigForRawColor():V==="vec2"||V==="vec3"||V==="vec4"?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(V){var O,Z=this.data,ne=this.el,pe=this;return Z.from!==""||!Z.property.startsWith(b)||(O=re(Z.property)[1],ne.components[O])?!1:(ne.addEventListener("componentinitialized",function be(Re){Re.detail.name===O&&(V(),pe.animation=y(pe.config),ne.removeEventListener("componentinitialized",be))}),!0)},stopRelatedAnimations:function(){var V,O;for(O in this.el.components)V=this.el.components[O],O!==this.attrName&&V.name==="animation"&&(!V.animationIsPlaying||V.data.property===this.data.property&&(V.animationIsPlaying=!1))},addEventListeners:function(){var V=this.data,O=this.el;H(O,V.startEvents,this.onStartEvent),H(O,V.pauseEvents,this.pauseAnimation),H(O,V.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var V=this.data,O=this.el;Y(O,V.startEvents,this.onStartEvent),Y(O,V.pauseEvents,this.pauseAnimation),Y(O,V.resumeEvents,this.resumeAnimation)},setColorConfig:function(V,O){u.set(V),p.set(O),V=this.fromColor,O=this.toColor,V.r=u.r,V.g=u.g,V.b=u.b,O.r=p.r,O.g=p.g,O.b=p.b}});function M(V,O){var Z,ne,pe,be;return pe=O.split("."),ne=pe[0],be=pe[1],Z=V.components[ne]||_[ne],!Z||be&&!Z.schema[be]?null:be?Z.schema[be].type:Z.schema.type}function F(V){V.x=C.MathUtils.degToRad(V.x),V.y=C.MathUtils.degToRad(V.y),V.z=C.MathUtils.degToRad(V.z)}function H(V,O,Z){var ne;for(ne=0;ne<O.length;ne++)V.addEventListener(O[ne],Z)}function Y(V,O,Z){var ne;for(ne=0;ne<O.length;ne++)V.removeEventListener(O[ne],Z)}function W(V,O){var Z,ne,pe;for(ne=re(O),pe=V,Z=0;Z<ne.length;Z++)pe=pe[ne[Z]];if(pe===void 0)throw console.log(V),new Error("[animation] property ("+O+") could not be found");return pe}function te(V,O,Z,ne){var pe,be,Re,Ue;for(O.startsWith("object3D.rotation")&&(Z=C.MathUtils.degToRad(Z)),be=re(O),Ue=V,pe=0;pe<be.length-1;pe++)Ue=Ue[be[pe]];if(Re=be[be.length-1],ne===h){"r"in Ue[Re]?(Ue[Re].r=Z.r,Ue[Re].g=Z.g,Ue[Re].b=Z.b):(Ue[Re].x=Z.r,Ue[Re].y=Z.g,Ue[Re].z=Z.b);return}Ue[Re]=Z}function re(V){return V in A||(A[V]=V.split(".")),A[V]}function X(V){return V.isRawProperty||V.property.startsWith(b)||V.property.startsWith(L)}},"./src/components/camera.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/lib/three.js");k.exports.Component=y("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var v,C=this.el;v=this.camera=new _.PerspectiveCamera,C.setObject3D("camera",v)},update:function(v){var C=this.data,l=this.camera;l.aspect=C.aspect||window.innerWidth/window.innerHeight,l.far=C.far,l.fov=C.fov,l.near=C.near,l.zoom=C.zoom,l.updateProjectionMatrix(),this.updateActiveCamera(v),this.updateSpectatorCamera(v)},updateActiveCamera:function(v){var C=this.data,l=this.el,u=this.system;v&&v.active===C.active||C.spectator||(C.active&&u.activeCameraEl!==l?u.setActiveCamera(l):!C.active&&u.activeCameraEl===l&&u.disableActiveCamera())},updateSpectatorCamera:function(v){var C=this.data,l=this.el,u=this.system;v&&v.spectator===C.spectator||(C.spectator&&u.spectatorCameraEl!==l?u.setSpectatorCamera(l):!C.spectator&&u.spectatorCameraEl===l&&u.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},"./src/components/cursor.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/utils/index.js"),v={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},C={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},l={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]},u={DOWN:["selectstart"],UP:["selectend"]},p="a-mouse-cursor-hover";k.exports.Component=y("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:_.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity","xrselect"]}},after:["tracked-controls"],multiple:!0,init:function(){var c=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.isCursorDown=!1,this.activeXRInput=null,this.updateCanvasBounds=_.debounce(function(){c.canvasBounds=c.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=this.onCursorDown.bind(this),this.onCursorUp=this.onCursorUp.bind(this),this.onIntersection=this.onIntersection.bind(this),this.onIntersectionCleared=this.onIntersectionCleared.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onEnterVR=this.onEnterVR.bind(this)},update:function(c){this.data.rayOrigin!==c.rayOrigin&&this.updateMouseEventListeners()},tick:function(){var c=this.el.sceneEl.frame,g=this.activeXRInput;this.data.rayOrigin==="xrselect"&&c&&g&&this.onMouseMove({frame:c,inputSource:g,type:"fakeselectevent"})},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var c=this.el;c.removeState(C.HOVERING),c.removeState(C.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(C.HOVERED),this.removeEventListeners()},addEventListeners:function(){var c,g=this.data,A=this.el,h=this;function m(){c=A.sceneEl.canvas,!(g.downEvents.length||g.upEvents.length)&&(l.DOWN.forEach(function(x){c.addEventListener(x,h.onCursorDown,{passive:!1})}),l.UP.forEach(function(x){c.addEventListener(x,h.onCursorUp,{passive:!1})}))}c=A.sceneEl.canvas,c?m():A.sceneEl.addEventListener("render-target-loaded",m),g.downEvents.forEach(function(x){A.addEventListener(x,h.onCursorDown)}),g.upEvents.forEach(function(x){A.addEventListener(x,h.onCursorUp)}),A.addEventListener("raycaster-intersection",this.onIntersection),A.addEventListener("raycaster-closest-entity-changed",this.onIntersection),A.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),A.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),A.sceneEl.addEventListener("enter-vr",this.onEnterVR),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var c,g=this.data,A=this.el,h=this;c=A.sceneEl.canvas,c&&!g.downEvents.length&&!g.upEvents.length&&(l.DOWN.forEach(function(m){c.removeEventListener(m,h.onCursorDown)}),l.UP.forEach(function(m){c.removeEventListener(m,h.onCursorUp)})),g.downEvents.forEach(function(m){A.removeEventListener(m,h.onCursorDown)}),g.upEvents.forEach(function(m){A.removeEventListener(m,h.onCursorUp)}),A.removeEventListener("raycaster-intersection",this.onIntersection),A.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),c.removeEventListener("mousemove",this.onMouseMove),c.removeEventListener("touchstart",this.onMouseMove),c.removeEventListener("touchmove",this.onMouseMove),A.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),A.sceneEl.removeEventListener("enter-vr",this.onEnterVR),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var c,g=this.el;c=g.sceneEl.canvas,c.removeEventListener("mousemove",this.onMouseMove),c.removeEventListener("touchmove",this.onMouseMove),g.setAttribute("raycaster","useWorldCoordinates",!1),this.data.rayOrigin==="mouse"&&(c.addEventListener("mousemove",this.onMouseMove),c.addEventListener("touchmove",this.onMouseMove,{passive:!1}),g.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:function(){var c=new THREE.Vector3,g=new THREE.Vector2,A=new THREE.Vector3,h={origin:A,direction:c};return function(m){var x=this.canvasBounds,S=this.el.sceneEl.camera,b,L,M,F,H,Y,W,te;S.parent.updateMatrixWorld(),m.type==="touchmove"||m.type==="touchstart"?L=m.touches.item(0):L=m,b=L.clientX-x.left,M=L.clientY-x.top,g.x=b/x.width*2-1,g.y=-(M/x.height)*2+1,this.data.rayOrigin==="xrselect"&&(m.type==="selectstart"||m.type==="fakeselectevent")?(F=m.frame,H=m.inputSource,Y=this.el.renderer.xr.getReferenceSpace(),W=F.getPose(H.targetRaySpace,Y),te=W.transform,c.set(0,0,-1),c.applyQuaternion(te.orientation),A.copy(te.position)):m.type==="fakeselectout"?(c.set(0,1,0),A.set(0,9999,0)):S&&S.isPerspectiveCamera?(A.setFromMatrixPosition(S.matrixWorld),c.set(g.x,g.y,.5).unproject(S).sub(A).normalize()):S&&S.isOrthographicCamera?(A.set(g.x,g.y,(S.near+S.far)/(S.near-S.far)).unproject(S),c.set(0,0,-1).transformDirection(S.matrixWorld)):console.error("AFRAME.Raycaster: Unsupported camera type: "+S.type),this.el.setAttribute("raycaster",h),m.type==="touchmove"&&m.preventDefault()}}(),onCursorDown:function(c){this.isCursorDown=!0,this.data.rayOrigin==="mouse"&&c.type==="touchstart"&&(this.onMouseMove(c),this.el.components.raycaster.checkIntersections(),c.preventDefault()),this.data.rayOrigin==="xrselect"&&c.type==="selectstart"&&(this.activeXRInput=c.inputSource,this.onMouseMove(c),this.el.components.raycaster.checkIntersections(),this.el.components.raycaster.intersectedEls.length&&this.el.sceneEl.components["ar-hit-test"]!==void 0&&this.el.sceneEl.getAttribute("ar-hit-test").enabled&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!1),this.reenableARHitTest=!0)),this.twoWayEmit(v.MOUSEDOWN,c),this.cursorDownEl=this.intersectedEl},onCursorUp:function(c){if(!!this.isCursorDown){this.isCursorDown=!1;var g=this.data;this.twoWayEmit(v.MOUSEUP,c),this.reenableARHitTest===!0&&(this.el.sceneEl.setAttribute("ar-hit-test","enabled",!0),this.reenableARHitTest=void 0),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(v.MOUSEUP,this.intersectedEventDetail)),(!g.fuse||g.rayOrigin==="mouse"||g.rayOrigin==="xrselect")&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(v.CLICK,c),g.rayOrigin==="xrselect"&&this.activeXRInput===c.inputSource&&this.onMouseMove({type:"fakeselectout"}),this.activeXRInput=null,this.cursorDownEl=null,c.type==="touchend"&&c.preventDefault()}},onIntersection:function(c){var g,A=this.el,h,m,x;h=c.detail.els[0]===A?1:0,x=c.detail.intersections[h],m=c.detail.els[h],!!m&&this.intersectedEl!==m&&(this.intersectedEl&&(g=this.el.components.raycaster.getIntersection(this.intersectedEl),g&&g.distance<=x.distance)||(this.clearCurrentIntersection(!0),this.setIntersection(m,x)))},onIntersectionCleared:function(c){var g=c.detail.clearedEls;g.indexOf(this.intersectedEl)!==-1&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);var c=this.el.sceneEl.xrSession,g=this;!c||this.data.rayOrigin!=="mouse"&&(u.DOWN.forEach(function(A){c.addEventListener(A,g.onCursorDown)}),u.UP.forEach(function(A){c.addEventListener(A,g.onCursorUp)}))},setIntersection:function(c,g){var A=this.el,h=this.data,m=this;this.intersectedEl!==c&&(this.intersectedEl=c,A.addState(C.HOVERING),c.addState(C.HOVERED),this.twoWayEmit(v.MOUSEENTER),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.add(p),!(h.fuseTimeout===0||!h.fuse||h.rayOrigin==="xrselect"||h.rayOrigin==="mouse")&&(A.addState(C.FUSING),this.twoWayEmit(v.FUSING),this.fuseTimeout=setTimeout(function(){A.removeState(C.FUSING),m.twoWayEmit(v.CLICK)},h.fuseTimeout)))},clearCurrentIntersection:function(c){var g,A,h,m=this.el;!this.intersectedEl||(this.intersectedEl.removeState(C.HOVERED),m.removeState(C.HOVERING),m.removeState(C.FUSING),this.twoWayEmit(v.MOUSELEAVE),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.remove(p),this.intersectedEl=null,clearTimeout(this.fuseTimeout),c!==!0&&(h=this.el.components.raycaster.intersections,h.length!==0&&(g=h[0].object.el===m?1:0,A=h[g],!!A&&this.setIntersection(A.object.el,A))))},twoWayEmit:function(c,g){var A=this.el,h=this.intersectedEl,m;function x(S,b){g instanceof MouseEvent?S.mouseEvent=g:typeof TouchEvent!="undefined"&&g instanceof TouchEvent&&(S.touchEvent=g)}m=this.el.components.raycaster.getIntersection(h),this.eventDetail.intersectedEl=h,this.eventDetail.intersection=m,x(this.eventDetail,g),A.emit(c,this.eventDetail),!!h&&(this.intersectedEventDetail.intersection=m,x(this.intersectedEventDetail,g),h.emit(c,this.intersectedEventDetail))}})},"./src/components/generic-tracked-controller-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/utils/tracked-controls.js"),v=_.checkControllerPresentAndSetup,C=_.emitIfAxesChanged,l=_.onButtonEvent,u="generic",p={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]};k.exports.Component=y("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"},disabled:{default:!1}},after:["tracked-controls"],mapping:p,bindMethods:function(){this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var c=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(g){l(g.detail.id,"down",c)},this.onButtonUp=function(g){l(g.detail.id,"up",c)},this.onButtonTouchStart=function(g){l(g.detail.id,"touchstart",c)},this.onButtonTouchEnd=function(g){l(g.detail.id,"touchend",c)},this.controllerPresent=!1,this.wasControllerConnected=!1,this.lastControllerCheck=0,this.bindMethods(),this.el.addEventListener("controllerconnected",function(g){g.detail.name!==c.name&&(c.wasControllerConnected=!0,c.removeEventListeners(),c.removeControllersUpdateListener())})},addEventListeners:function(){var c=this.el;c.addEventListener("buttonchanged",this.onButtonChanged),c.addEventListener("buttondown",this.onButtonDown),c.addEventListener("buttonup",this.onButtonUp),c.addEventListener("touchstart",this.onButtonTouchStart),c.addEventListener("touchend",this.onButtonTouchEnd),c.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var c=this.el;c.removeEventListener("buttonchanged",this.onButtonChanged),c.removeEventListener("buttondown",this.onButtonDown),c.removeEventListener("buttonup",this.onButtonUp),c.removeEventListener("touchstart",this.onButtonTouchStart),c.removeEventListener("touchend",this.onButtonTouchEnd),c.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var c=this.data,g=c.hand?c.hand:void 0;v(this,u,{hand:g,iterateControllerProfiles:!0})},play:function(){this.wasControllerConnected||(this.checkIfControllerPresent(),this.addControllersUpdateListener())},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var c=this.el,g=this.data;if(this.el.components["tracked-controls"]){this.removeEventListeners();return}c.setAttribute("tracked-controls",{hand:g.hand,idPrefix:u,orientationOffset:g.orientationOffset,iterateControllerProfiles:!0}),!!this.data.defaultModel&&this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){!this.wasControllerConnected||this.checkIfControllerPresent()},onButtonChanged:function(c){var g=this.mapping.buttons[c.detail.id];!g||this.el.emit(g+"changed",c.detail.state)},onAxisMoved:function(c){C(this,this.mapping.axes,c)},initDefaultModel:function(){var c=this.modelEl=document.createElement("a-entity");c.setAttribute("geometry",{primitive:"sphere",radius:.03}),c.setAttribute("material",{color:this.data.color}),this.el.appendChild(c),this.el.emit("controllermodelready",{name:"generic-tracked-controller-controls",model:this.modelEl,rayOrigin:{origin:{x:0,y:0,z:-.01},direction:{x:0,y:0,z:-1}}})}})},"./src/components/geometry.js":(k,K,f)=>{var y=f("./src/core/geometry.js").geometries,_=f("./src/core/geometry.js").geometryNames,v=f("./src/core/component.js").registerComponent,C=f("./src/lib/three.js"),l=new C.BufferGeometry;k.exports.Component=v("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:_,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(u){var p=this.data,c=this.el,g,A=this.system;this.geometry&&(A.unuseGeometry(u),this.geometry=null),this.geometry=A.getOrCreateGeometry(p),g=c.getObject3D("mesh"),g?g.geometry=this.geometry:(g=new C.Mesh,g.geometry=this.geometry,this.el.getAttribute("material")||(g.material=new C.MeshStandardMaterial({color:Math.random()*16777215,metalness:0,roughness:.5})),c.setObject3D("mesh",g))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=l,this.geometry=null},updateSchema:function(u){var p=this.oldData&&this.oldData.primitive,c=u.primitive,g=y[c]&&y[c].schema;if(!g)throw new Error("Unknown geometry schema `"+c+"`");p&&p===c||this.extendSchema(g)}})},"./src/components/gltf-model.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/lib/three.js"),v=f("./src/utils/index.js"),C=v.debug("components:gltf-model:warn");k.exports.Component=y("gltf-model",{schema:{type:"model"},init:function(){var l=this,u=this.system.getDRACOLoader(),p=this.system.getMeshoptDecoder(),c=this.system.getKTX2Loader();this.model=null,this.loader=new _.GLTFLoader,u&&this.loader.setDRACOLoader(u),p?this.ready=p.then(function(g){l.loader.setMeshoptDecoder(g)}):this.ready=Promise.resolve(),c&&this.loader.setKTX2Loader(c)},update:function(){var l=this,u=this.el,p=this.data;!p||(this.remove(),this.ready.then(function(){l.loader.load(p,function(g){l.model=g.scene||g.scenes[0],l.model.animations=g.animations,u.setObject3D("mesh",l.model),u.emit("model-loaded",{format:"gltf",model:l.model})},void 0,function(g){var A=g&&g.message?g.message:"Failed to load glTF model";C(A),u.emit("model-error",{format:"gltf",src:p})})}))},remove:function(){!this.model||this.el.removeObject3D("mesh")}})},"./src/components/grabbable.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent;y("grabbable",{init:function(){this.el.setAttribute("obb-collider","centerModel: true")}})},"./src/components/hand-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/constants/index.js").AFRAME_CDN_ROOT,v={toonLeft:_+"controllers/hands/leftHand.glb",toonRight:_+"controllers/hands/rightHand.glb",lowPolyLeft:_+"controllers/hands/leftHandLow.glb",lowPolyRight:_+"controllers/hands/rightHandLow.glb",highPolyLeft:_+"controllers/hands/leftHandHigh.glb",highPolyRight:_+"controllers/hands/rightHandHigh.glb"},C={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},l={};l[C.fist]="grip",l[C.thumbUp]="pistol",l[C.point]="pointing",k.exports.Component=y("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},after:["tracked-controls"],init:function(){var c=this,g=this.el;this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){c.handleButton("grip","down")},this.onGripUp=function(){c.handleButton("grip","up")},this.onTrackpadDown=function(){c.handleButton("trackpad","down")},this.onTrackpadUp=function(){c.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){c.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){c.handleButton("trackpad","touchend")},this.onTriggerDown=function(){c.handleButton("trigger","down")},this.onTriggerUp=function(){c.handleButton("trigger","up")},this.onTriggerTouchStart=function(){c.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){c.handleButton("trigger","touchend")},this.onGripTouchStart=function(){c.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){c.handleButton("grip","touchend")},this.onThumbstickDown=function(){c.handleButton("thumbstick","down")},this.onThumbstickUp=function(){c.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){c.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){c.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){c.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){c.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){c.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){c.handleButton("surface","touchend")},this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),g.addEventListener("controllerconnected",this.onControllerConnected),g.addEventListener("controllerdisconnected",this.onControllerDisconnected),g.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(c,g){var A=this.el.getObject3D("mesh");!A||!A.mixer||A.mixer.update(g/1e3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=!1},addEventListeners:function(){var c=this.el;c.addEventListener("gripdown",this.onGripDown),c.addEventListener("gripup",this.onGripUp),c.addEventListener("trackpaddown",this.onTrackpadDown),c.addEventListener("trackpadup",this.onTrackpadUp),c.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),c.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),c.addEventListener("triggerdown",this.onTriggerDown),c.addEventListener("triggerup",this.onTriggerUp),c.addEventListener("triggertouchstart",this.onTriggerTouchStart),c.addEventListener("triggertouchend",this.onTriggerTouchEnd),c.addEventListener("griptouchstart",this.onGripTouchStart),c.addEventListener("griptouchend",this.onGripTouchEnd),c.addEventListener("thumbstickdown",this.onThumbstickDown),c.addEventListener("thumbstickup",this.onThumbstickUp),c.addEventListener("abuttontouchstart",this.onAorXTouchStart),c.addEventListener("abuttontouchend",this.onAorXTouchEnd),c.addEventListener("bbuttontouchstart",this.onBorYTouchStart),c.addEventListener("bbuttontouchend",this.onBorYTouchEnd),c.addEventListener("xbuttontouchstart",this.onAorXTouchStart),c.addEventListener("xbuttontouchend",this.onAorXTouchEnd),c.addEventListener("ybuttontouchstart",this.onBorYTouchStart),c.addEventListener("ybuttontouchend",this.onBorYTouchEnd),c.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),c.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var c=this.el;c.removeEventListener("gripdown",this.onGripDown),c.removeEventListener("gripup",this.onGripUp),c.removeEventListener("trackpaddown",this.onTrackpadDown),c.removeEventListener("trackpadup",this.onTrackpadUp),c.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),c.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),c.removeEventListener("triggerdown",this.onTriggerDown),c.removeEventListener("triggerup",this.onTriggerUp),c.removeEventListener("triggertouchstart",this.onTriggerTouchStart),c.removeEventListener("triggertouchend",this.onTriggerTouchEnd),c.removeEventListener("griptouchstart",this.onGripTouchStart),c.removeEventListener("griptouchend",this.onGripTouchEnd),c.removeEventListener("thumbstickdown",this.onThumbstickDown),c.removeEventListener("thumbstickup",this.onThumbstickUp),c.removeEventListener("abuttontouchstart",this.onAorXTouchStart),c.removeEventListener("abuttontouchend",this.onAorXTouchEnd),c.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),c.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),c.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),c.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),c.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),c.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),c.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),c.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(c){var g,A=this.el,h=this.data.hand,m=this.data.handModelStyle,x=this.data.color,S=this;if(g={hand:h,model:!1},h!==c){var b=v[m+h.charAt(0).toUpperCase()+h.slice(1)];this.loader.load(b,function(L){var M=L.scene.children[0],F=h==="left"?Math.PI/2:-Math.PI/2,H=A.sceneEl.hasWebXR?-Math.PI/2:0;M.mixer=new THREE.AnimationMixer(M),S.clips=L.animations,A.setObject3D("mesh",M),M.traverse(function(Y){!Y.isMesh||(Y.material.color=new THREE.Color(x))}),M.position.set(0,0,0),M.rotation.set(H,0,F),A.setAttribute("magicleap-controls",g),A.setAttribute("vive-controls",g),A.setAttribute("oculus-touch-controls",g),A.setAttribute("pico-controls",g),A.setAttribute("windows-motion-controls",g),A.setAttribute("hp-mixed-reality-controls",g)})}},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(c,g){var A,h=g==="down",m=g==="touchstart";if(g.indexOf("touch")===0){if(m===this.touchedButtons[c])return;this.touchedButtons[c]=m}else{if(h===this.pressedButtons[c])return;this.pressedButtons[c]=h}A=this.gesture,this.gesture=this.determineGesture(),this.gesture!==A&&(this.animateGesture(this.gesture,A),this.emitGestureEvents(this.gesture,A))},determineGesture:function(){var c,g=this.pressedButtons.grip,A=this.pressedButtons.surface||this.touchedButtons.surface,h=this.pressedButtons.trackpad||this.touchedButtons.trackpad,m=this.pressedButtons.trigger||this.touchedButtons.trigger,x=this.touchedButtons.AorX||this.touchedButtons.BorY,S=p(this.el.components["tracked-controls"]);return S?g||m?c=C.fist:h&&(c=C.point):g?A||x||h?c=m?C.fist:C.point:c=m?C.thumbUp:C.pointThumb:m&&(c=C.hold),c},getClip:function(c){var g,A;for(A=0;A<this.clips.length;A++)if(g=this.clips[A],g.name===c)return g},animateGesture:function(c,g){if(c){this.playAnimation(c||C.open,g,!1);return}this.playAnimation(g,g,!0)},emitGestureEvents:function(c,g){var A=this.el,h;g!==c&&(h=u(g,!1),h&&A.emit(h),h=u(c,!0),h&&A.emit(h))},playAnimation:function(c,g,A){var h,m,x=this.el.getObject3D("mesh"),S;if(!!x){if(h=this.getClip(c),S=x.mixer.clipAction(h),A){S.paused=!1,S.timeScale=-1;return}if(S.clampWhenFinished=!0,S.loop=THREE.LoopOnce,S.repetitions=0,S.timeScale=1,S.time=0,S.weight=1,!g){x.mixer.stopAllAction(),S.play();return}h=this.getClip(g),S.reset(),S.play(),m=x.mixer.clipAction(h),m.crossFadeTo(S,.15,!0)}}});function u(c,g){var A;if(!!c){if(A=l[c],A==="grip")return A+(g?"close":"open");if(A==="point")return A+(g?"up":"down");if(A==="pointing"||A==="pistol")return A+(g?"start":"end")}}function p(c){var g=c&&c.controller,A=g&&(g.id&&g.id.indexOf("OpenVR ")===0||g.profiles&&g.profiles[0]&&g.profiles[0]==="htc-vive");return A}},"./src/components/hand-tracking-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/core/a-entity.js").AEntity,v=f("./src/utils/tracked-controls.js"),C=v.checkControllerPresentAndSetup,l=f("./src/constants/index.js").AFRAME_CDN_ROOT,u=l+"controllers/oculus-hands/v4/left.glb",p=l+"controllers/oculus-hands/v4/right.glb",c=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],g=0,A=4,h=9,m=.015,x=.1;k.exports.Component=y("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"},modelOpacity:{default:1}},after:["tracked-controls"],bindMethods:function(){this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var S=0;S<this.jointEls.length;++S)this.jointEls[S].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var S=0;S<this.jointEls.length;++S)this.jointEls[S].object3D.visible=!1},init:function(){var S=this.el.sceneEl,b=S.getAttribute("webxr"),L=b.optionalFeatures;L.indexOf("hand-tracking")===-1&&(L.push("hand-tracking"),S.setAttribute("webxr",b)),this.wristObject3D=new THREE.Object3D,this.el.sceneEl.object3D.add(this.wristObject3D),this.onModelLoaded=this.onModelLoaded.bind(this),this.onChildAttached=this.onChildAttached.bind(this),this.jointEls=[],this.controllerPresent=!1,this.isPinched=!1,this.pinchEventDetail={position:new THREE.Vector3,wristRotation:new THREE.Quaternion},this.indexTipPosition=new THREE.Vector3,this.hasPoses=!1,this.jointPoses=new Float32Array(16*c.length),this.jointRadii=new Float32Array(c.length),this.bindMethods(),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace),this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace),this.el.addEventListener("child-attached",this.onChildAttached),this.el.object3D.visible=!1,this.wristObject3D.visible=!1},onChildAttached:function(S){this.addChildEntity(S.detail.el)},update:function(){this.updateModelMaterial()},updateModelMaterial:function(){var S=this.jointEls,b=this.skinnedMesh,L=this.data.modelOpacity!==1;b&&(this.skinnedMesh.material.color.set(this.data.modelColor),this.skinnedMesh.material.transparent=L,this.skinnedMesh.material.opacity=this.data.modelOpacity);for(var M=0;M<S.length;M++)S[M].setAttribute("material",{color:this.data.modelColor,transparent:L,opacity:this.data.modelOpacity})},updateReferenceSpace:function(){var S=this,b=this.el.sceneEl.xrSession;if(this.referenceSpace=void 0,!!b){var L=S.el.sceneEl.systems.webxr.sessionReferenceSpaceType;b.requestReferenceSpace(L).then(function(M){S.referenceSpace=M}).catch(function(M){throw S.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(L,"tracked-controls-webxr uses reference space "+L),M})}},checkIfControllerPresent:function(){var S=this.data,b=S.hand?S.hand:void 0;C(this,"",{hand:b,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},tick:function(){var S=this.el.sceneEl,b=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,L=S.frame,M=this.el.components["tracked-controls-webxr"],F=this.referenceSpace;!b||!L||!F||!M||(this.hasPoses=!1,b.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),this.hasPoses=L.fillPoses(b.hand.values(),F,this.jointPoses)&&L.fillJointRadii(b.hand.values(),this.jointRadii),this.updateHandModel(),this.detectGesture(),this.updateWristObject()))},updateWristObject:function(){var S=new THREE.Matrix4;return function(){var b=this.wristObject3D;!b||!this.hasPoses||(S.fromArray(this.jointPoses,g*16),b.position.setFromMatrixPosition(S),b.quaternion.setFromRotationMatrix(S))}}(),updateHandModel:function(){this.data.modelStyle==="dots"&&this.updateHandDotsModel(),this.data.modelStyle==="mesh"&&this.updateHandMeshModel()},getBone:function(S){for(var b=this.bones,L=0;L<b.length;L++)if(b[L].name===S)return b[L];return null},updateHandMeshModel:function(){var S=new THREE.Matrix4;return function(){var b=0,L=this.jointPoses,M=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller;if(!(!M||!this.mesh)&&(this.mesh.visible=!1,!!this.hasPoses))for(var F of M.hand.values()){var H=this.getBone(F.jointName);H!=null&&(this.mesh.visible=!0,S.fromArray(L,b*16),H.position.setFromMatrixPosition(S),H.quaternion.setFromRotationMatrix(S)),b++}}}(),updateHandDotsModel:function(){for(var S=this.jointPoses,b=this.jointRadii,L=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,M,F,H=0;H<L.hand.size;H++)M=this.jointEls[H],F=M.object3D,M.object3D.visible=this.hasPoses,!!this.hasPoses&&(F.matrix.fromArray(S,H*16),F.matrix.decompose(F.position,F.rotation,F.scale),M.setAttribute("scale",{x:b[H],y:b[H],z:b[H]}))},detectGesture:function(){this.detectPinch()},detectPinch:function(){var S=new THREE.Vector3,b=new THREE.Matrix4;return function(){var L=this.indexTipPosition,M=this.pinchEventDetail;if(!!this.hasPoses){S.setFromMatrixPosition(b.fromArray(this.jointPoses,A*16)),L.setFromMatrixPosition(b.fromArray(this.jointPoses,h*16)),M.wristRotation.setFromRotationMatrix(b.fromArray(this.jointPoses,g*16));var F=L.distanceTo(S);F<m&&this.isPinched===!1&&(this.isPinched=!0,this.pinchDistance=F,M.position.copy(L).add(S).multiplyScalar(.5),this.el.emit("pinchstarted",M)),F>this.pinchDistance+this.pinchDistance*x&&this.isPinched===!0&&(this.isPinched=!1,M.position.copy(L).add(S).multiplyScalar(.5),this.el.emit("pinchended",M)),this.isPinched&&(M.position.copy(L).add(S).multiplyScalar(.5),this.el.emit("pinchmoved",M))}}}(),pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var S=this.el,b=this.data;if(S.setAttribute("tracked-controls",{id:"",hand:b.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0}),this.mesh){this.mesh!==S.getObject3D("mesh")&&S.setObject3D("mesh",this.mesh);return}this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){var S=this.el,b;this.checkIfControllerPresent(),b=S.components["tracked-controls"]&&S.components["tracked-controls"].controller,!!this.mesh&&b&&b.hand&&b.hand instanceof XRHand&&S.setObject3D("mesh",this.mesh)},initDefaultModel:function(){var S=this.data;S.modelStyle==="dots"&&this.initDotsModel(),S.modelStyle==="mesh"&&this.initMeshHandModel(),this.el.object3D.visible=!0,this.wristObject3D.visible=!0},initDotsModel:function(){if(this.jointEls.length===0){for(var S=0;S<c.length;++S){var b=this.jointEl=document.createElement("a-entity");b.setAttribute("geometry",{primitive:"sphere",radius:1}),b.object3D.visible=!1,this.el.appendChild(b),this.jointEls.push(b)}this.updateModelMaterial()}},initMeshHandModel:function(){var S=this.data.hand==="left"?u:p;this.el.setAttribute("gltf-model",S)},onModelLoaded:function(){var S=this.mesh=this.el.getObject3D("mesh").children[0],b=this.skinnedMesh=S.getObjectByProperty("type","SkinnedMesh");!this.skinnedMesh||(this.bones=b.skeleton.bones,this.el.removeObject3D("mesh"),S.position.set(0,0,0),S.rotation.set(0,0,0),b.frustumCulled=!1,b.material=new THREE.MeshStandardMaterial,this.updateModelMaterial(),this.setupChildrenEntities(),this.el.setObject3D("mesh",S))},setupChildrenEntities:function(){for(var S=this.el.children,b=0;b<S.length;++b)S[b]instanceof _&&this.addChildEntity(S[b])},addChildEntity:function(S){S instanceof _&&this.wristObject3D.add(S.object3D)}})},"./src/components/hand-tracking-grab-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/lib/three.js");y("hand-tracking-grab-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},color:{type:"color",default:"white"},hoverColor:{type:"color",default:"#538df1"},hoverEnabled:{default:!1}},init:function(){var v=this.el,C=this.data,l;C.hand==="right"?l="components.hand-tracking-controls.bones.3":l="components.hand-tracking-controls.bones.21",v.setAttribute("hand-tracking-controls",{hand:C.hand}),v.setAttribute("obb-collider",{trackedObject3D:l,size:.04}),this.auxMatrix=new _.Matrix4,this.auxQuaternion=new _.Quaternion,this.auxQuaternion2=new _.Quaternion,this.auxVector=new _.Vector3,this.auxVector2=new _.Vector3,this.grabbingObjectPosition=new _.Vector3,this.grabbedObjectPosition=new _.Vector3,this.grabbedObjectPositionDelta=new _.Vector3,this.grabDeltaPosition=new _.Vector3,this.grabInitialRotation=new _.Quaternion,this.onCollisionStarted=this.onCollisionStarted.bind(this),this.el.addEventListener("obbcollisionstarted",this.onCollisionStarted),this.onCollisionEnded=this.onCollisionEnded.bind(this),this.el.addEventListener("obbcollisionended",this.onCollisionEnded),this.onPinchStarted=this.onPinchStarted.bind(this),this.el.addEventListener("pinchstarted",this.onPinchStarted),this.onPinchEnded=this.onPinchEnded.bind(this),this.el.addEventListener("pinchended",this.onPinchEnded),this.onPinchMoved=this.onPinchMoved.bind(this),this.el.addEventListener("pinchmoved",this.onPinchMoved)},transferEntityOwnership:function(){for(var v,C=this.el.sceneEl.querySelectorAll("[hand-tracking-grab-controls]"),l=0;l<C.length;++l)v=C[l].components["hand-tracking-grab-controls"],v!==this&&this.grabbedEl&&this.grabbedEl===v.grabbedEl&&v.releaseGrabbedEntity();return!1},onCollisionStarted:function(v){var C=v.detail.withEl;this.collidedEl||!C.getAttribute("grabbable")||(this.collidedEl=C,this.grabbingObject3D=v.detail.trackedObject3D,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.hoverColor))},onCollisionEnded:function(){this.collidedEl=void 0,!this.grabbedEl&&(this.grabbingObject3D=void 0,this.data.hoverEnabled&&this.el.setAttribute("hand-tracking-controls","modelColor",this.data.color))},onPinchStarted:function(v){!this.collidedEl||(this.pinchPosition=v.detail.position,this.wristRotation=v.detail.wristRotation,this.grabbedEl=this.collidedEl,this.transferEntityOwnership(),this.grab())},onPinchEnded:function(){this.releaseGrabbedEntity()},onPinchMoved:function(v){this.wristRotation=v.detail.wristRotation},releaseGrabbedEntity:function(){var v=this.grabbedEl;!v||(v.object3D.updateMatrixWorld=this.originalUpdateMatrixWorld,v.object3D.matrixAutoUpdate=!0,v.object3D.matrixWorldAutoUpdate=!0,v.object3D.matrixWorld.decompose(this.auxVector,this.auxQuaternion,this.auxVector2),v.object3D.position.copy(this.auxVector),v.object3D.quaternion.copy(this.auxQuaternion),this.el.emit("grabended",{grabbedEl:v}),this.grabbedEl=void 0)},grab:function(){var v=this.grabbedEl,C;C=v.object3D.getWorldPosition(this.grabbedObjectPosition),this.grabDeltaPosition.copy(C).sub(this.pinchPosition),this.grabInitialRotation.copy(this.auxQuaternion.copy(this.wristRotation).invert()),this.originalUpdateMatrixWorld=v.object3D.updateMatrixWorld,v.object3D.updateMatrixWorld=function(){},v.object3D.updateMatrixWorldChildren=function(l){for(var u=this.children,p=0,c=u.length;p<c;p++){var g=u[p];(g.matrixWorldAutoUpdate===!0||l===!0)&&g.updateMatrixWorld(!0)}},v.object3D.matrixAutoUpdate=!1,v.object3D.matrixWorldAutoUpdate=!1,this.el.emit("grabstarted",{grabbedEl:v})},tock:function(){var v=this.auxMatrix,C=this.auxQuaternion,l=this.auxQuaternion2,u,p=this.grabbedEl;!p||(u=p.object3D,u.getWorldQuaternion(l),u.matrixWorld.identity(),v.identity(),v.makeTranslation(this.pinchPosition),u.matrixWorld.multiply(v),v.identity(),v.makeRotationFromQuaternion(C.copy(this.wristRotation).multiply(this.grabInitialRotation)),u.matrixWorld.multiply(v),v.identity(),v.makeTranslation(this.grabDeltaPosition),u.matrixWorld.multiply(v),v.identity(),v.makeRotationFromQuaternion(l),u.matrixWorld.multiply(v),v.makeScale(p.object3D.scale.x,p.object3D.scale.y,p.object3D.scale.z),u.matrixWorld.multiply(v),u.updateMatrixWorldChildren())}})},"./src/components/hide-on-enter-ar.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent;k.exports.Component=y("hide-on-enter-ar",{init:function(){var _=this;this.el.sceneEl.addEventListener("enter-vr",function(){_.el.sceneEl.is("ar-mode")&&(_.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){_.el.object3D.visible=!0})}})},"./src/components/hide-on-enter-vr.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent;k.exports.Component=y("hide-on-enter-vr",{init:function(){var _=this;this.el.sceneEl.addEventListener("enter-vr",function(){_.el.sceneEl.is("vr-mode")&&(_.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){_.el.object3D.visible=!0})}})},"./src/components/hp-mixed-reality-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/lib/three.js"),v=f("./src/utils/tracked-controls.js"),C=v.checkControllerPresentAndSetup,l=v.emitIfAxesChanged,u=v.onButtonEvent,p="hp-mixed-reality",c=f("./src/constants/index.js").AFRAME_CDN_ROOT,g=c+"controllers/hp/mixed-reality/",A={x:0,y:0,z:.06},h={_x:Math.PI/4,_y:0,_z:0,_order:"XYZ"},m={left:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton"]}};k.exports.Component=y("hp-mixed-reality-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:m,init:function(){var x=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(S){u(S.detail.id,"down",x,x.data.hand)},this.onButtonUp=function(S){u(S.detail.id,"up",x,x.data.hand)},this.onButtonTouchEnd=function(S){u(S.detail.id,"touchend",x,x.data.hand)},this.onButtonTouchStart=function(S){u(S.detail.id,"touchstart",x,x.data.hand)},this.previousButtonValues={},this.bindMethods()},update:function(){var x=this.data;this.controllerIndex=x.hand==="right"?0:x.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var x=this.el;x.addEventListener("buttonchanged",this.onButtonChanged),x.addEventListener("buttondown",this.onButtonDown),x.addEventListener("buttonup",this.onButtonUp),x.addEventListener("touchstart",this.onButtonTouchStart),x.addEventListener("touchend",this.onButtonTouchEnd),x.addEventListener("axismove",this.onAxisMoved),x.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var x=this.el;x.removeEventListener("buttonchanged",this.onButtonChanged),x.removeEventListener("buttondown",this.onButtonDown),x.removeEventListener("buttonup",this.onButtonUp),x.removeEventListener("touchstart",this.onButtonTouchStart),x.removeEventListener("touchend",this.onButtonTouchEnd),x.removeEventListener("axismove",this.onAxisMoved),x.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var x=this.data;C(this,p,{index:this.controllerIndex,hand:x.hand})},injectTrackedControls:function(){var x=this.el,S=this.data;x.setAttribute("tracked-controls",{idPrefix:p,hand:S.hand,controller:this.controllerIndex,orientationOffset:S.orientationOffset}),!!this.data.model&&this.el.setAttribute("gltf-model",g+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(x){var S=this.mapping[this.data.hand].buttons[x.detail.id],b;!S||(S==="trigger"&&(b=x.detail.state.value,console.log("analog value of trigger press: "+b)),this.el.emit(S+"changed",x.detail.state))},onModelLoaded:function(x){var S=x.detail.model;!this.data.model||(S.position.copy(A),S.rotation.copy(h),this.el.emit("controllermodelready",{name:"hp-mixed-reality-controls",model:this.data.model,rayOrigin:new _.Vector3(0,0,0)}))},onAxisMoved:function(x){l(this,this.mapping.axes,x)}})},"./src/components/index.js":(k,K,f)=>{f("./src/components/animation.js"),f("./src/components/anchored.js"),f("./src/components/camera.js"),f("./src/components/cursor.js"),f("./src/components/geometry.js"),f("./src/components/generic-tracked-controller-controls.js"),f("./src/components/gltf-model.js"),f("./src/components/grabbable.js"),f("./src/components/hand-tracking-controls.js"),f("./src/components/hand-tracking-grab-controls.js"),f("./src/components/hand-controls.js"),f("./src/components/hide-on-enter-ar.js"),f("./src/components/hide-on-enter-vr.js"),f("./src/components/hp-mixed-reality-controls.js"),f("./src/components/layer.js"),f("./src/components/laser-controls.js"),f("./src/components/light.js"),f("./src/components/line.js"),f("./src/components/link.js"),f("./src/components/look-controls.js"),f("./src/components/magicleap-controls.js"),f("./src/components/material.js"),f("./src/components/obb-collider.js"),f("./src/components/obj-model.js"),f("./src/components/oculus-go-controls.js"),f("./src/components/oculus-touch-controls.js"),f("./src/components/pico-controls.js"),f("./src/components/position.js"),f("./src/components/raycaster.js"),f("./src/components/rotation.js"),f("./src/components/scale.js"),f("./src/components/shadow.js"),f("./src/components/sound.js"),f("./src/components/text.js"),f("./src/components/tracked-controls.js"),f("./src/components/tracked-controls-webvr.js"),f("./src/components/tracked-controls-webxr.js"),f("./src/components/visible.js"),f("./src/components/valve-index-controls.js"),f("./src/components/vive-controls.js"),f("./src/components/vive-focus-controls.js"),f("./src/components/wasd-controls.js"),f("./src/components/windows-motion-controls.js"),f("./src/components/scene/ar-hit-test.js"),f("./src/components/scene/background.js"),f("./src/components/scene/debug.js"),f("./src/components/scene/device-orientation-permission-ui.js"),f("./src/components/scene/embedded.js"),f("./src/components/scene/inspector.js"),f("./src/components/scene/fog.js"),f("./src/components/scene/keyboard-shortcuts.js"),f("./src/components/scene/pool.js"),f("./src/components/scene/real-world-meshing.js"),f("./src/components/scene/reflection.js"),f("./src/components/scene/screenshot.js"),f("./src/components/scene/stats.js"),f("./src/components/scene/xr-mode-ui.js")},"./src/components/laser-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/utils/index.js");y("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var v=this.config,C=this.data,l=this.el,u=this,p={hand:C.hand,model:C.model};l.setAttribute("hp-mixed-reality-controls",p),l.setAttribute("magicleap-controls",p),l.setAttribute("oculus-go-controls",p),l.setAttribute("oculus-touch-controls",p),l.setAttribute("pico-controls",p),l.setAttribute("valve-index-controls",p),l.setAttribute("vive-controls",p),l.setAttribute("vive-focus-controls",p),l.setAttribute("windows-motion-controls",p),l.setAttribute("generic-tracked-controller-controls",{hand:p.hand}),l.addEventListener("controllerconnected",c),l.addEventListener("controllerdisconnected",g),l.addEventListener("controllermodelready",function(A){c(A),u.modelReady=!0});function c(A){var h=v[A.detail.name];if(!!h){var m=_.extend({showLine:!0},h.raycaster||{});A.detail.rayOrigin&&(m.origin=A.detail.rayOrigin.origin,m.direction=A.detail.rayOrigin.direction,m.showLine=!0),A.detail.rayOrigin||!u.modelReady?l.setAttribute("raycaster",m):l.setAttribute("raycaster","showLine",!0),l.setAttribute("cursor",_.extend({fuse:!1},h.cursor))}}function g(A){var h=v[A.detail.name];!h||l.setAttribute("raycaster","showLine",!1)}},config:{"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"hp-mixed-reality-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"pico-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},"./src/components/layer.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/utils/index.js"),v=_.debug("components:layer:warn");k.exports.Component=y("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var l=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion,this.position=new THREE.Vector3,this.bindMethods(),this.needsRedraw=!1,this.frameBuffer=l.createFramebuffer();var u=this.el.sceneEl.getAttribute("webxr"),p=u.requiredFeatures;p.indexOf("layers")===-1&&(p.push("layers"),this.el.sceneEl.setAttribute("webxr",u)),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this)},update:function(l){this.data.src!==l.src&&this.updateSrc()},updateSrc:function(){var l=this.data.type;if(this.texture=void 0,l==="quad"){this.loadQuadImage();return}if(l==="monocubemap"||l==="stereocubemap"){this.loadCubeMapImages();return}},loadCubeMapImages:function(){var l,u=this.xrGLFactory,p=this.el.sceneEl.frame,c=this.data.src,g=this.data.type;this.visibilityChanged=!1,!!this.layer&&(g!=="monocubemap"&&g!=="stereocubemap"||(c.complete?this.pendingCubeMapUpdate=!1:this.pendingCubeMapUpdate=!0,this.loadingScreen?this.loadingScreen=!1:this.loadingScreen=!0,g==="monocubemap"?(l=u.getSubImage(this.layer,p),this.loadCubeMapImage(l.colorTexture,c,0)):(l=u.getSubImage(this.layer,p,"left"),this.loadCubeMapImage(l.colorTexture,c,0),l=u.getSubImage(this.layer,p,"right"),this.loadCubeMapImage(l.colorTexture,c,6))))},loadQuadImage:function(){var l=this.data.src,u=this;this.el.sceneEl.systems.material.loadTexture(l,{src:l},function(c){u.el.sceneEl.renderer.initTexture(c),u.texture=c,l.tagName==="VIDEO"&&setTimeout(function(){u.textureIsVideo=!0},1e3),u.layer&&(u.layer.height=u.data.height/2||u.texture.image.height/1e3,u.layer.width=u.data.width/2||u.texture.image.width/1e3,u.needsRedraw=!0),u.updateQuadPanel()})},preGenerateCubeMapTextures:function(l,u){this.data.type==="monocubemap"?this.generateCubeMapTextures(l,0,u):(this.generateCubeMapTextures(l,0,u),this.generateCubeMapTextures(l,6,u))},generateCubeMapTextures:function(l,u,p){for(var c=this.data,g=this.cubeFaceSize,A=Math.min(l.width,l.height),h=[],m,x,S=0;S<6;S++){var b=document.createElement("CANVAS");b.width=b.height=g;var L=b.getContext("2d");c.rotateCubemap&&(S===2||S===3)&&(L.save(),L.translate(g,g),L.rotate(Math.PI)),L.drawImage(l,(S+u)*A,0,A,A,0,0,g,g),L.restore(),p&&p(),h.push(b)}return c.rotateCubemap&&(m=h[0],x=h[1],h[0]=x,h[1]=m,m=h[4],x=h[5],h[4]=x,h[5]=m),p&&p(),h},loadCubeMapImage:function(l,u,p){var c=this.el.sceneEl.renderer.getContext(),g;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,!1),c.bindTexture(c.TEXTURE_CUBE_MAP,l),!u.complete||this.loadingScreen?g=this.loadingScreenImages:g=this.generateCubeMapTextures(u,p);var A=0;g.forEach(function(h,m){c.texSubImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+m,0,0,0,c.RGBA,c.UNSIGNED_BYTE,h),A=c.getError()}),A!==0&&console.log("renderingError, WebGL Error Code: "+A),c.bindTexture(c.TEXTURE_CUBE_MAP,null)},tick:function(){!this.el.sceneEl.xrSession||(!this.layer&&(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),!(!this.needsRedraw&&!this.layer.needsRedraw&&!this.textureIsVideo)&&(this.data.type==="quad"&&this.draw(),this.needsRedraw=!1))},initLayer:function(){var l=this,u=this.data.type;if(this.el.sceneEl.xrSession.onvisibilitychange=function(p){l.visibilityChanged=p.session.visibilityState!=="hidden"},u==="quad"){this.initQuadLayer();return}if(u==="monocubemap"||u==="stereocubemap"){this.initCubeMapLayer();return}},initQuadLayer:function(){var l=this.el.sceneEl,u=l.renderer.getContext(),p=this.xrGLFactory=new XRWebGLBinding(l.xrSession,u);!this.texture||(this.layer=p.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1e3,width:this.data.width/2||this.texture.image.width/1e3}),this.initLoadingScreenImages(),l.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var l=this.data.src,u=this.el.sceneEl,p=u.renderer.getContext(),c=p.getParameter(p.MAX_CUBE_MAP_TEXTURE_SIZE),g=this.cubeFaceSize=Math.min(c,Math.min(l.width,l.height)),A=this.xrGLFactory=new XRWebGLBinding(u.xrSession,p);this.layer=A.createCubeLayer({space:this.referenceSpace,viewPixelWidth:g,viewPixelHeight:g,layout:this.data.type==="monocubemap"?"mono":"stereo",isStatic:!1}),this.initLoadingScreenImages(),this.loadCubeMapImages(),u.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var l=this.cubeFaceSize,u=this.loadingScreenImages=[],p=0;p<6;p++){var c=document.createElement("CANVAS");c.width=c.height=l;var g=c.getContext("2d");c.width=c.height=l,g.fillStyle="black",g.fillRect(0,0,l,l),p!==2&&p!==3&&(g.translate(l,0),g.scale(-1,1),g.fillStyle="white",g.font="30px Arial",g.fillText("Loading",l/2,l/2)),u.push(c)}},destroyLayer:function(){!this.layer||(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(l){this.layerEnabled=l,this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var l=this.quadPanelEl;this.quadPanelEl||(l=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(l)),l.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0}),l.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1e3,width:this.data.width||this.texture.image.height/1e3})},draw:function(){var l=this.el.sceneEl,u=this.el.sceneEl.renderer.getContext(),p=this.xrGLFactory.getSubImage(this.layer,l.frame),c=l.renderer.properties.get(this.texture).__webglTexture,g=u.getParameter(u.FRAMEBUFFER_BINDING);u.viewport(p.viewport.x,p.viewport.y,p.viewport.width,p.viewport.height),u.bindFramebuffer(u.FRAMEBUFFER,this.frameBuffer),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,p.colorTexture,0),C(u,c,p,this.data.src),u.bindFramebuffer(u.FRAMEBUFFER,g)},updateTransform:function(){var l=this.el,u=this.position,p=this.quaternion;l.object3D.updateMatrixWorld(),u.setFromMatrixPosition(l.object3D.matrixWorld),p.setFromRotationMatrix(l.object3D.matrixWorld),this.layerEnabled||u.set(0,0,1e8),this.layer.transform=new XRRigidTransform(u,p)},onEnterVR:function(){var l=this.el.sceneEl,u=l.xrSession;if(!l.hasWebXR||!XRWebGLBinding||!u){v("The layer component requires WebXR and the layers API enabled");return}u.requestReferenceSpace("local-floor").then(this.onRequestedReferenceSpace),this.layerEnabled=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0),this.destroyLayer()},onRequestedReferenceSpace:function(l){this.referenceSpace=l}});function C(l,u,p,c){var g=l.createFramebuffer(),A=p.viewport.x,h=p.viewport.y,m=p.viewport.x+p.viewport.width,x=p.viewport.y+p.viewport.height;c.tagName==="VIDEO"&&(l.bindTexture(l.TEXTURE_2D,u),l.texSubImage2D(l.TEXTURE_2D,0,0,0,c.width,c.height,l.RGB,l.UNSIGNED_BYTE,c)),l.bindFramebuffer(l.READ_FRAMEBUFFER,g),l.framebufferTexture2D(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,u,0),l.readBuffer(l.COLOR_ATTACHMENT0),l.blitFramebuffer(0,0,c.width,c.height,A,h,m,x,l.COLOR_BUFFER_BIT,l.NEAREST),l.bindFramebuffer(l.READ_FRAMEBUFFER,null),l.deleteFramebuffer(g)}},"./src/components/light.js":(k,K,f)=>{var y=f("./src/utils/index.js"),_=y.diff,v=f("./src/utils/debug.js"),C=f("./src/core/component.js").registerComponent,l=f("./src/lib/three.js"),u=f("./src/utils/math.js"),p=l.MathUtils.degToRad,c=v("components:light:warn"),g=new l.CubeTextureLoader,A={};k.exports.Component=C("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color",if:{type:["ambient","directional","hemisphere","point","spot"]}},envMap:{default:"",if:{type:["probe"]}},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot","probe"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot","probe"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowCameraAutomatic:{default:"",if:{type:["directional"]}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var h=this.el;this.light=null,this.defaultTarget=null,this.system.registerLight(h)},update:function(h){var m=this.data,x=_(m,h),S=this.light,b=this;if(S&&!("type"in x)){var L=!1;Object.keys(x).forEach(function(M){var F=m[M];switch(M){case"color":{S.color.set(F);break}case"groundColor":{S.groundColor.set(F);break}case"angle":{S.angle=p(F);break}case"target":{F===null?(m.type==="spot"||m.type==="directional")&&(S.target=b.defaultTarget):F.hasLoaded?b.onSetTarget(F,S):F.addEventListener("loaded",b.onSetTarget.bind(b,F,S));break}case"envMap":b.updateProbeMap(m,S);break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":L||(b.updateShadow(),L=!0);break;case"shadowCameraAutomatic":m.shadowCameraAutomatic?b.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(m.shadowCameraAutomatic)):b.shadowCameraAutomaticEls=[];break;default:S[M]=F}});return}this.setLight(this.data),this.updateShadow()},tick:function(){var h=new l.Box3,m=new l.Vector3,x=new l.Vector3,S=new l.Matrix4,b=new l.Sphere,L=new l.Vector3;return function(){if(!!(this.data.type==="directional"&&this.light.shadow&&this.light.shadow.camera instanceof l.OrthographicCamera&&this.shadowCameraAutomaticEls.length)){var M=this.light.shadow.camera;M.getWorldDirection(m),M.getWorldPosition(x),S.copy(M.matrixWorld),S.invert(),M.near=1,M.left=1e5,M.right=-1e5,M.top=-1e5,M.bottom=1e5,this.shadowCameraAutomaticEls.forEach(function(F){h.setFromObject(F.object3D),h.getBoundingSphere(b);var H=u.distanceOfPointFromPlane(x,m,b.center),Y=u.nearestPointInPlane(x,m,b.center,L),W=Y.applyMatrix4(S);M.near=Math.min(-H-b.radius-1,M.near),M.left=Math.min(-b.radius+W.x,M.left),M.right=Math.max(b.radius+W.x,M.right),M.top=Math.max(b.radius+W.y,M.top),M.bottom=Math.min(-b.radius+W.y,M.bottom)}),M.updateProjectionMatrix()}}}(),setLight:function(h){var m=this.el,x=this.getLight(h);x&&(this.light&&m.removeObject3D("light"),this.light=x,this.light.el=m,m.setObject3D("light",this.light),(h.type==="spot"||h.type==="directional"||h.type==="hemisphere")&&m.getObject3D("light").translateY(-1),h.type==="spot"&&(m.setObject3D("light-target",this.defaultTarget),m.getObject3D("light-target").position.set(0,0,-1)),h.shadowCameraAutomatic?this.shadowCameraAutomaticEls=Array.from(document.querySelectorAll(h.shadowCameraAutomatic)):this.shadowCameraAutomaticEls=[])},updateShadow:function(){var h=this.el,m=this.data,x=this.light;x.castShadow=m.castShadow;var S=h.getObject3D("cameraHelper");if(m.shadowCameraVisible&&!S?h.setObject3D("cameraHelper",new l.CameraHelper(x.shadow.camera)):!m.shadowCameraVisible&&S&&h.removeObject3D("cameraHelper"),!m.castShadow)return x;x.shadow.bias=m.shadowBias,x.shadow.radius=m.shadowRadius,x.shadow.mapSize.height=m.shadowMapHeight,x.shadow.mapSize.width=m.shadowMapWidth,x.shadow.camera.near=m.shadowCameraNear,x.shadow.camera.far=m.shadowCameraFar,x.shadow.camera instanceof l.OrthographicCamera?(x.shadow.camera.top=m.shadowCameraTop,x.shadow.camera.right=m.shadowCameraRight,x.shadow.camera.bottom=m.shadowCameraBottom,x.shadow.camera.left=m.shadowCameraLeft):x.shadow.camera.fov=m.shadowCameraFov,x.shadow.camera.updateProjectionMatrix(),S&&S.update()},getLight:function(h){var m=h.angle,x=new l.Color(h.color);x=x.getHex();var S=h.decay,b=h.distance,L=new l.Color(h.groundColor);L=L.getHex();var M=h.intensity,F=h.type,H=h.target,Y=null;switch(F.toLowerCase()){case"ambient":return new l.AmbientLight(x,M);case"directional":return Y=new l.DirectionalLight(x,M),this.defaultTarget=Y.target,H&&(H.hasLoaded?this.onSetTarget(H,Y):H.addEventListener("loaded",this.onSetTarget.bind(this,H,Y))),Y;case"hemisphere":return new l.HemisphereLight(x,L,M);case"point":return new l.PointLight(x,M,b,S);case"spot":return Y=new l.SpotLight(x,M,b,p(m),h.penumbra,S),this.defaultTarget=Y.target,H&&(H.hasLoaded?this.onSetTarget(H,Y):H.addEventListener("loaded",this.onSetTarget.bind(this,H,Y))),Y;case"probe":return Y=new l.LightProbe,this.updateProbeMap(h,Y),Y;default:c("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",F)}},updateProbeMap:function(h,m){h.envMap||m.copy(new l.LightProbe),A[h.envMap]instanceof window.Promise&&A[h.envMap].then(function(x){m.copy(x)}),A[h.envMap]instanceof l.LightProbe&&m.copy(A[h.envMap]),A[h.envMap]=new window.Promise(function(x){y.srcLoader.validateCubemapSrc(h.envMap,function(b){g.load(b,function(L){var M=l.LightProbeGenerator.fromCubeTexture(L);A[h.envMap]=M,m.copy(M)})})})},onSetTarget:function(h,m){m.target=h.object3D},remove:function(){var h=this.el;h.removeObject3D("light"),h.getObject3D("cameraHelper")&&h.removeObject3D("cameraHelper")}})},"./src/components/line.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent;k.exports.Component=y("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var v=this.data,C,l;l=this.material=new THREE.LineBasicMaterial({color:v.color,opacity:v.opacity,transparent:v.opacity<1,visible:v.visible}),C=this.geometry=new THREE.BufferGeometry,C.setAttribute("position",new THREE.BufferAttribute(new Float32Array(2*3),3)),this.line=new THREE.Line(C,l),this.el.setObject3D(this.attrName,this.line)},update:function(v){var C=this.data,l=this.geometry,u=!1,p=this.material,c=l.attributes.position.array;_(C.start,v.start)||(c[0]=C.start.x,c[1]=C.start.y,c[2]=C.start.z,u=!0),_(C.end,v.end)||(c[3]=C.end.x,c[4]=C.end.y,c[5]=C.end.z,u=!0),u&&(l.attributes.position.needsUpdate=!0,l.computeBoundingSphere()),p.color.setStyle(C.color),p.opacity=C.opacity,p.transparent=C.opacity<1,p.visible=C.visible},remove:function(){this.el.removeObject3D(this.attrName,this.line)}});function _(v,C){return!v||!C?!1:v.x===C.x&&v.y===C.y&&v.z===C.z}},"./src/components/link.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/core/shader.js").registerShader,v=f("./src/lib/three.js");k.exports.Component=y("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new v.Quaternion,this.hiddenEls=[]},update:function(C){var l=this.data,u=this.el,p,c;!l.visualAspectEnabled||(this.initVisualAspect(),p=l.highlighted?l.highlightedColor:l.backgroundColor,c=l.highlighted?l.highlightedColor:l.borderColor,u.setAttribute("material","backgroundColor",p),u.setAttribute("material","strokeColor",c),l.on!==C.on&&this.updateEventListener(),C.peekMode!==void 0&&l.peekMode!==C.peekMode&&this.updatePeekMode(),!(!l.image||C.image===l.image)&&u.setAttribute("material","pano",typeof l.image=="string"?l.image:l.image.src))},updatePeekMode:function(){var C=this.el,l=this.sphereEl;this.data.peekMode?(this.hideAll(),C.getObject3D("mesh").visible=!1,l.setAttribute("visible",!0)):(this.showAll(),C.getObject3D("mesh").visible=!0,l.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var C=this.el;!C.isPlaying||(this.removeEventListener(),C.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var C=this.data.on;!C||this.el.removeEventListener(C,this.navigate)},initVisualAspect:function(){var C=this.el,l,u,p;!this.data.visualAspectEnabled||this.visualAspectInitialized||(p=this.textEl=this.textEl||document.createElement("a-entity"),u=this.sphereEl=this.sphereEl||document.createElement("a-entity"),l=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),C.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),C.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),p.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),p.setAttribute("position","0 1.5 0"),C.appendChild(p),l.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),l.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),l.setAttribute("rotation","0 180 0"),l.setAttribute("position","0 0 0"),l.setAttribute("visible",!1),C.appendChild(l),u.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),u.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),u.setAttribute("visible",!1),C.appendChild(u),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:function(){var C=new v.Vector3,l=new v.Vector3,u=new v.Quaternion,p=new v.Vector3;return function(){var c=this.el,g=c.object3D,A=c.sceneEl.camera,h,m,x=this.textEl;if(!!this.data.visualAspectEnabled)if(g.updateMatrixWorld(),A.parent.updateMatrixWorld(),A.updateMatrixWorld(),g.matrix.decompose(l,u,p),l.setFromMatrixPosition(g.matrixWorld),C.setFromMatrixPosition(A.matrixWorld),m=l.distanceTo(C),m>20)this.previousQuaternion||(this.quaternionClone.copy(u),this.previousQuaternion=this.quaternionClone),g.lookAt(C);else{if(h=this.calculateCameraPortalOrientation(),m<.5){if(this.semiSphereEl.getAttribute("visible")===!0)return;x.setAttribute("text","width",1.5),h<=0?(x.setAttribute("position","0 0 0.75"),x.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(x.setAttribute("position","0 0 -0.75"),x.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),c.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=h}else h<=0?x.setAttribute("rotation","0 180 0"):x.setAttribute("rotation","0 0 0"),x.setAttribute("text","width",5),x.setAttribute("position","0 1.5 0"),c.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(g.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}(),hideAll:function(){var C=this.el,l=this.hiddenEls,u=this;l.length>0||C.sceneEl.object3D.traverse(function(p){p&&p.el&&p.el.hasAttribute("link-controls")||!p.el||p===C.sceneEl.object3D||p.el===C||p.el===u.sphereEl||p.el===C.sceneEl.cameraEl||p.el.getAttribute("visible")===!1||p.el===u.textEl||p.el===u.semiSphereEl||(p.el.setAttribute("visible",!1),l.push(p.el))})},showAll:function(){this.hiddenEls.forEach(function(C){C.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var C=new v.Matrix4,l=new v.Vector3,u=new v.Vector3(0,0,1),p=new v.Vector3(0,0,0);return function(){var c=this.el,g=c.sceneEl.camera;return l.set(0,0,0),u.set(0,0,1),p.set(0,0,0),c.object3D.matrixWorld.extractRotation(C),u.applyMatrix4(C),c.object3D.updateMatrixWorld(),c.object3D.localToWorld(p),g.parent.parent.updateMatrixWorld(),g.parent.updateMatrixWorld(),g.updateMatrixWorld(),g.localToWorld(l),l.sub(p).normalize(),u.normalize(),Math.sign(u.dot(l))}}(),remove:function(){this.removeEventListener()}}),_("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join(`
`),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join(`
`)})},"./src/components/look-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/lib/three.js"),v=f("./src/utils/index.js"),C=Math.PI/2;k.exports.Component=y("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0,this.previousHMDPosition=new _.Vector3,this.hmdQuaternion=new _.Quaternion,this.magicWindowAbsoluteEuler=new _.Euler,this.magicWindowDeltaEuler=new _.Euler,this.position=new _.Vector3,this.magicWindowObject=new _.Object3D,this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.previousMouseEvent={},this.setupMagicWindowControls(),this.savedPose={position:new _.Vector3,rotation:new _.Euler},(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.onEnterVR()},setupMagicWindowControls:function(){var l,u=this.data;(v.device.isMobile()||v.device.isMobileDeviceRequestingDesktopSite())&&(l=this.magicWindowControls=new _.DeviceOrientationControls(this.magicWindowObject),typeof DeviceOrientationEvent!="undefined"&&DeviceOrientationEvent.requestPermission&&(l.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?l.enabled=u.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){l.enabled=u.magicWindowTrackingEnabled})))},update:function(l){var u=this.data;u.enabled!==l.enabled&&this.updateGrabCursor(u.enabled),l&&!u.magicWindowTrackingEnabled&&l.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0)),this.magicWindowControls&&(this.magicWindowControls.enabled=u.magicWindowTrackingEnabled),l&&!u.pointerLockEnabled!==l.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(l){var u=this.data;!u.enabled||this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this),this.onPointerLockChange=this.onPointerLockChange.bind(this),this.onPointerLockError=this.onPointerLockError.bind(this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new _.Object3D,this.yawObject=new _.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var l=this.el.sceneEl,u=l.canvas;if(!u){l.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}u.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),u.addEventListener("touchstart",this.onTouchStart,{passive:!0}),window.addEventListener("touchmove",this.onTouchMove,{passive:!0}),window.addEventListener("touchend",this.onTouchEnd,{passive:!0}),l.addEventListener("enter-vr",this.onEnterVR),l.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))},removeEventListeners:function(){var l=this.el.sceneEl,u=l&&l.canvas;!u||(u.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),u.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),l.removeEventListener("enter-vr",this.onEnterVR),l.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:function(){var l=this.el.object3D,u=this.pitchObject,p=this.yawObject,c=this.el.sceneEl;(c.is("vr-mode")||c.is("ar-mode"))&&c.checkHeadsetConnected()||(this.updateMagicWindowOrientation(),l.rotation.x=this.magicWindowDeltaEuler.x+u.rotation.x,l.rotation.y=this.magicWindowDeltaEuler.y+p.rotation.y,l.rotation.z=this.magicWindowDeltaEuler.z)},updateMagicWindowOrientation:function(){var l=this.magicWindowAbsoluteEuler,u=this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),l.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),!this.previousMagicWindowYaw&&l.y!==0&&(this.previousMagicWindowYaw=l.y),this.previousMagicWindowYaw&&(u.x=l.x,u.y+=l.y-this.previousMagicWindowYaw,u.z=l.z,this.previousMagicWindowYaw=l.y))},onMouseMove:function(l){var u,p,c,g=this.pitchObject,A=this.previousMouseEvent,h=this.yawObject;!this.data.enabled||!this.mouseDown&&!this.pointerLocked||(this.pointerLocked?(p=l.movementX||l.mozMovementX||0,c=l.movementY||l.mozMovementY||0):(p=l.screenX-A.screenX,c=l.screenY-A.screenY),this.previousMouseEvent.screenX=l.screenX,this.previousMouseEvent.screenY=l.screenY,u=this.data.reverseMouseDrag?1:-1,h.rotation.y+=p*.002*u,g.rotation.x+=c*.002*u,g.rotation.x=Math.max(-C,Math.min(C,g.rotation.x)))},onMouseDown:function(l){var u=this.el.sceneEl;if(!(!this.data.enabled||!this.data.mouseEnabled||(u.is("vr-mode")||u.is("ar-mode"))&&u.checkHeadsetConnected())&&l.button===0){var p=u&&u.canvas;this.mouseDown=!0,this.previousMouseEvent.screenX=l.screenX,this.previousMouseEvent.screenY=l.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(p.requestPointerLock?p.requestPointerLock():p.mozRequestPointerLock&&p.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(l){l.touches.length!==1||!this.data.touchEnabled||this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode")||(this.touchStart={x:l.touches[0].pageX,y:l.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(l){var u,p=this.el.sceneEl.canvas,c,g=this.yawObject;!this.touchStarted||!this.data.touchEnabled||(c=2*Math.PI*(l.touches[0].pageX-this.touchStart.x)/p.clientWidth,u=this.data.reverseTouchDrag?1:-1,g.rotation.y-=c*.5*u,this.touchStart={x:l.touches[0].pageX,y:l.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var l=this.el.sceneEl;!l.checkHeadsetConnected()||(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),l.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){!this.el.sceneEl.checkHeadsetConnected()||(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(l){var u=this.el.sceneEl;function p(){u.canvas.classList.add("a-grab-cursor")}function c(){u.canvas.classList.remove("a-grab-cursor")}if(!u.canvas){l?u.addEventListener("render-target-loaded",p):u.addEventListener("render-target-loaded",c);return}if(l){p();return}c()},saveCameraPose:function(){var l=this.el;this.savedPose.position.copy(l.object3D.position),this.savedPose.rotation.copy(l.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var l=this.el,u=this.savedPose;!this.hasSavedPose||(l.object3D.position.copy(u.position),l.object3D.rotation.copy(u.rotation),this.hasSavedPose=!1)}})},"./src/components/magicleap-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/utils/tracked-controls.js"),v=_.checkControllerPresentAndSetup,C=_.emitIfAxesChanged,l=_.onButtonEvent,u="magicleap",p="-one",c=u+p,g=f("./src/constants/index.js").AFRAME_CDN_ROOT,A=g+"controllers/magicleap/magicleap-one-controller.glb",h={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]};k.exports.Component=y("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:h,init:function(){var m=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(x){l(x.detail.id,"down",m)},this.onButtonUp=function(x){l(x.detail.id,"up",m)},this.onButtonTouchEnd=function(x){l(x.detail.id,"touchend",m)},this.onButtonTouchStart=function(x){l(x.detail.id,"touchstart",m)},this.previousButtonValues={},this.bindMethods()},update:function(){var m=this.data;this.controllerIndex=m.hand==="right"?0:m.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var m=this.el;m.addEventListener("buttonchanged",this.onButtonChanged),m.addEventListener("buttondown",this.onButtonDown),m.addEventListener("buttonup",this.onButtonUp),m.addEventListener("touchstart",this.onButtonTouchStart),m.addEventListener("touchend",this.onButtonTouchEnd),m.addEventListener("axismove",this.onAxisMoved),m.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var m=this.el;m.removeEventListener("buttonchanged",this.onButtonChanged),m.removeEventListener("buttondown",this.onButtonDown),m.removeEventListener("buttonup",this.onButtonUp),m.removeEventListener("touchstart",this.onButtonTouchStart),m.removeEventListener("touchend",this.onButtonTouchEnd),m.removeEventListener("axismove",this.onAxisMoved),m.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var m=this.data;v(this,c,{index:this.controllerIndex,hand:m.hand})},injectTrackedControls:function(){var m=this.el,x=this.data;m.setAttribute("tracked-controls",{idPrefix:c,hand:x.hand,controller:this.controllerIndex,orientationOffset:x.orientationOffset}),!!this.data.model&&this.el.setAttribute("gltf-model",A)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(m){var x=this.mapping.buttons[m.detail.id],S;!x||(x==="trigger"&&(S=m.detail.state.value,console.log("analog value of trigger press: "+S)),this.el.emit(x+"changed",m.detail.state))},onModelLoaded:function(m){var x=m.detail.model;x.scale.set(.01,.01,.01)},onAxisMoved:function(m){C(this,this.mapping.axes,m)},updateModel:function(m,x){},setButtonColor:function(m,x){}})},"./src/components/material.js":(k,K,f)=>{var y=f("./src/utils/index.js"),_=f("./src/core/component.js"),v=f("./src/lib/three.js"),C=f("./src/core/shader.js"),l=y.debug("components:material:error"),u=_.registerComponent,p=C.shaders,c=C.shaderNames;k.exports.Component=u("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:c,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColorsEnabled:{default:!1},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0},anisotropy:{default:0,min:0}},init:function(){this.material=null},update:function(m){var x=this.data;(!this.shader||x.shader!==m.shader)&&this.updateShader(x.shader),this.shader.update(this.data),this.updateMaterial(m)},updateSchema:function(m){var x,S,b,L;S=m&&m.shader,x=this.oldData&&this.oldData.shader,L=S||x,b=p[L]&&p[L].schema,b||l("Unknown shader schema "+L),!(x&&S===x)&&(this.extendSchema(b),this.updateBehavior())},updateBehavior:function(){var m,x=this.el.sceneEl,S=this.schema,b=this,L;function M(F,H){var Y;for(Y in L)L[Y]=F;b.shader.update(L)}this.tick=void 0,L={};for(m in S)S[m].type==="time"&&(this.tick=M,L[m]=!0);!x||(this.tick?x.addBehavior(this):x.removeBehavior(this))},updateShader:function(m){var x=this.data,S=p[m]&&p[m].Shader,b;if(!S)throw new Error("Unknown shader "+m);b=this.shader=new S,b.el=this.el,b.init(x),this.setMaterial(b.material),this.updateSchema(x)},updateMaterial:function(m){var x=this.data,S=this.material,b;S.alphaTest=x.alphaTest,S.depthTest=x.depthTest!==!1,S.depthWrite=x.depthWrite!==!1,S.opacity=x.opacity,S.flatShading=x.flatShading,S.side=g(x.side),S.transparent=x.transparent!==!1||x.opacity<1,S.vertexColors=x.vertexColorsEnabled,S.visible=x.visible,S.blending=A(x.blending),S.dithering=x.dithering;for(b in m)break;b&&(m.alphaTest!==x.alphaTest||m.side!==x.side||m.vertexColorsEnabled!==x.vertexColorsEnabled)&&(S.needsUpdate=!0)},remove:function(){var m=new v.MeshBasicMaterial,x=this.material,S=this.el.getObject3D("mesh");S&&(S.material=m),h(x,this.system)},setMaterial:function(m){var x=this.el,S,b=this.system;this.material&&h(this.material,b),this.material=m,b.registerMaterial(m),S=x.getObject3D("mesh"),S?S.material=m:x.addEventListener("object3dset",function L(M){M.detail.type!=="mesh"||M.target!==x||(x.getObject3D("mesh").material=m,x.removeEventListener("object3dset",L))})}});function g(m){switch(m){case"back":return v.BackSide;case"double":return v.DoubleSide;default:return v.FrontSide}}function A(m){switch(m){case"none":return v.NoBlending;case"additive":return v.AdditiveBlending;case"subtractive":return v.SubtractiveBlending;case"multiply":return v.MultiplyBlending;default:return v.NormalBlending}}function h(m,x){m.dispose(),x.unregisterMaterial(m),Object.keys(m).filter(function(S){return m[S]&&m[S].isTexture}).forEach(function(S){m[S].dispose()})}},"./src/components/obb-collider.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/lib/three.js");y("obb-collider",{schema:{size:{default:0},trackedObject3D:{default:""},minimumColliderDimension:{default:.02},centerModel:{default:!1}},init:function(){this.previousScale=new _.Vector3().copy(this.el.object3D.scale),this.auxEuler=new _.Euler,this.boundingBox=new _.Box3,this.boundingBoxSize=new _.Vector3,this.updateCollider=this.updateCollider.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.updateBoundingBox=this.updateBoundingBox.bind(this),this.el.addEventListener("model-loaded",this.onModelLoaded),this.updateCollider(),this.system.addCollider(this.el)},remove:function(){this.system.removeCollider(this.el)},update:function(){this.data.trackedObject3D&&(this.trackedObject3DPath=this.data.trackedObject3D.split("."))},onModelLoaded:function(){this.data.centerModel&&this.centerModel(),this.updateCollider()},centerModel:function(){var v=this.el,C=v.components["gltf-model"]&&v.components["gltf-model"].model,l,u;!C||(this.el.removeObject3D("mesh"),l=new _.Box3().setFromObject(C),u=l.getCenter(new _.Vector3),C.position.x+=C.position.x-u.x,C.position.y+=C.position.y-u.y,C.position.z+=C.position.z-u.z,this.el.setObject3D("mesh",C))},updateCollider:function(){var v=this.el,C=this.boundingBoxSize,l=this.aabb=this.aabb||new _.OBB;if(this.obb=this.obb||new _.OBB,!v.hasLoaded){v.addEventListener("loaded",this.updateCollider);return}this.updateBoundingBox(),l.halfSize.copy(C).multiplyScalar(.5),this.el.sceneEl.systems["obb-collider"].data.showColliders&&this.showCollider()},showCollider:function(){this.updateColliderMesh(),this.renderColliderMesh.visible=!0},updateColliderMesh:function(){var v=this.renderColliderMesh,C=this.boundingBoxSize;if(!v){this.initColliderMesh();return}v.geometry.dispose(),v.geometry=new _.BoxGeometry(C.x,C.y,C.z)},hideCollider:function(){!this.renderColliderMesh||(this.renderColliderMesh.visible=!1)},initColliderMesh:function(){var v,C,l;v=this.boundingBoxSize,C=this.renderColliderGeometry=new _.BoxGeometry(v.x,v.y,v.z),l=this.renderColliderMesh=new _.Mesh(C,new _.MeshLambertMaterial({color:65280,side:_.DoubleSide})),l.matrixAutoUpdate=!1,l.matrixWorldAutoUpdate=!1,l.updateMatrixWorld=function(){},this.el.sceneEl.object3D.add(l)},updateBoundingBox:function(){var v=new _.Vector3,C=new _.Vector3,l=new _.Quaternion,u=new _.Quaternion,p=new _.Matrix4;return function(){var c=this.auxEuler,g=this.boundingBox,A=this.data.size,h=this.trackedObject3D||this.el.object3D,m=this.boundingBoxSize,x=this.data.minimumColliderDimension;if(A){this.boundingBoxSize.x=A,this.boundingBoxSize.y=A,this.boundingBoxSize.z=A;return}c.copy(h.rotation),h.rotation.set(0,0,0),h.parent.matrixWorld.decompose(v,l,C),p.compose(v,u,C),h.parent.matrixWorld.copy(p),g.setFromObject(h,!0),g.getSize(m),m.x=m.x<x?x:m.x,m.y=m.y<x?x:m.y,m.z=m.z<x?x:m.z,h.parent.matrixWorld.compose(v,l,C),this.el.object3D.rotation.copy(c)}}(),checkTrackedObject:function(){var v=this.trackedObject3DPath,C;if(v&&v.length&&!this.trackedObject3D){C=this.el;for(var l=0;l<v.length&&(C=C[v[l]],!!C);l++);C&&(this.trackedObject3D=C,this.updateCollider())}return this.trackedObject3D},tick:function(){var v=new _.Vector3,C=new _.Vector3,l=new _.Quaternion,u=new _.Matrix4;return function(){var p=this.obb,c=this.renderColliderMesh,g=this.checkTrackedObject()||this.el.object3D;!g||(g.updateMatrix(),g.updateMatrixWorld(!0),g.matrixWorld.decompose(v,l,C),(Math.abs(C.x-this.previousScale.x)>1e-4||Math.abs(C.y-this.previousScale.y)>1e-4||Math.abs(C.z-this.previousScale.z)>1e-4)&&this.updateCollider(),this.previousScale.copy(C),C.set(1,1,1),u.compose(v,l,C),c&&c.matrixWorld.copy(u),p.copy(this.aabb),p.applyMatrix4(u))}}()})},"./src/components/obj-model.js":(k,K,f)=>{var y=f("./src/utils/debug.js"),_=f("./src/core/component.js").registerComponent,v=f("./src/lib/three.js"),C=y("components:obj-model:warn");k.exports.Component=_("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var l=this;this.model=null,this.objLoader=new v.OBJLoader,this.mtlLoader=new v.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin="",this.el.addEventListener("componentinitialized",function(u){!l.model||u.detail.name==="material"&&l.applyMaterial()})},update:function(){var l=this.data;!l.obj||(this.resetMesh(),this.loadObj(l.obj,l.mtl))},remove:function(){this.resetMesh()},resetMesh:function(){!this.model||this.el.removeObject3D("mesh")},loadObj:function(l,u){var p=this,c=this.el,g=this.mtlLoader,A=this.objLoader,h=this.el.sceneEl.systems.renderer,m=u.substr(0,u.lastIndexOf("/")+1);if(u){c.hasAttribute("material")&&C("Material component properties are ignored when a .MTL is provided"),g.setResourcePath(m),g.load(u,function(x){x.preload(),A.setMaterials(x),A.load(l,function(S){p.model=S,p.model.traverse(function(b){if(b.isMesh){var L=b.material;L.map&&h.applyColorCorrection(L.map),L.emissiveMap&&h.applyColorCorrection(L.emissiveMap)}}),c.setObject3D("mesh",S),c.emit("model-loaded",{format:"obj",model:S})})});return}A.load(l,function(S){p.model=S,p.applyMaterial(),c.setObject3D("mesh",S),c.emit("model-loaded",{format:"obj",model:S})})},applyMaterial:function(){var l=this.el.components.material;!l||this.model.traverse(function(u){u instanceof v.Mesh&&(u.material=l.material)})}})},"./src/components/oculus-go-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/utils/tracked-controls.js"),v=_.checkControllerPresentAndSetup,C=_.emitIfAxesChanged,l=_.onButtonEvent,u=f("./src/utils/index.js").device.isWebXRAvailable,p="oculus-go",c="Oculus Go",g=f("./src/constants/index.js").AFRAME_CDN_ROOT,A=g+"controllers/oculus/go/oculus-go-controller.gltf",h=u?p:c,m={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},x={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]},S=u?x:m;k.exports.Component=y("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:S,bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var b=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(L){l(L.detail.id,"down",b)},this.onButtonUp=function(L){l(L.detail.id,"up",b)},this.onButtonTouchStart=function(L){l(L.detail.id,"touchstart",b)},this.onButtonTouchEnd=function(L){l(L.detail.id,"touchend",b)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var b=this.el;b.addEventListener("buttonchanged",this.onButtonChanged),b.addEventListener("buttondown",this.onButtonDown),b.addEventListener("buttonup",this.onButtonUp),b.addEventListener("touchstart",this.onButtonTouchStart),b.addEventListener("touchend",this.onButtonTouchEnd),b.addEventListener("model-loaded",this.onModelLoaded),b.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var b=this.el;b.removeEventListener("buttonchanged",this.onButtonChanged),b.removeEventListener("buttondown",this.onButtonDown),b.removeEventListener("buttonup",this.onButtonUp),b.removeEventListener("touchstart",this.onButtonTouchStart),b.removeEventListener("touchend",this.onButtonTouchEnd),b.removeEventListener("model-loaded",this.onModelLoaded),b.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){v(this,h,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var b=this.el,L=this.data;b.setAttribute("tracked-controls",{armModel:L.armModel,hand:L.hand,idPrefix:h,orientationOffset:L.orientationOffset}),!!this.data.model&&this.el.setAttribute("gltf-model",A)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(b){var L=b.detail.model,M;b.target!==this.el||!this.data.model||(M=this.buttonMeshes={},M.trigger=L.getObjectByName("oculus_go_button_trigger"),M.trackpad=L.getObjectByName("oculus_go_touchpad"),M.touchpad=L.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function(b){var L=this.mapping.buttons[b.detail.id];!L||this.el.emit(L+"changed",b.detail.state)},onAxisMoved:function(b){C(this,this.mapping.axes,b)},updateModel:function(b,L){!this.data.model||this.updateButtonModel(b,L)},updateButtonModel:function(b,L){var M=this.buttonMeshes;if(!(!M||!M[b])){var F,H;switch(L){case"down":F=this.data.buttonHighlightColor;break;case"touchstart":F=this.data.buttonTouchedColor;break;default:F=this.data.buttonColor}H=M[b],H.material.color.set(F)}}})},"./src/components/oculus-touch-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/lib/three.js"),v=f("./src/utils/tracked-controls.js"),C=v.checkControllerPresentAndSetup,l=v.emitIfAxesChanged,u=v.onButtonEvent,p=f("./src/utils/index.js").device.isWebXRAvailable,c="oculus-touch",g="Oculus Touch",A=p?c:g,h=f("./src/constants/index.js").AFRAME_CDN_ROOT,m=h+"controllers/oculus/oculus-touch-controller-",x=h+"controllers/meta/",S={left:{modelUrl:m+"left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new _.Vector3(-.005,.003,-.055),modelPivotRotation:new _.Euler(0,0,0)},right:{modelUrl:m+"right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new _.Vector3(.005,.003,-.055),modelPivotRotation:new _.Euler(0,0,0)}},b={left:{modelUrl:m+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new _.Vector3(-.005,.036,-.037),modelPivotRotation:new _.Euler(Math.PI/4.5,0,0)},right:{modelUrl:m+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new _.Vector3(.005,.036,-.037),modelPivotRotation:new _.Euler(Math.PI/4.5,0,0)}},L=p?b:S,M="oculus-touch",F={"oculus-touch":L,"oculus-touch-v2":{left:{modelUrl:m+"gen2-left.gltf",rayOrigin:{origin:{x:-.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new _.Vector3(0,-.007,-.021),modelPivotRotation:new _.Euler(-Math.PI/4,0,0)},right:{modelUrl:m+"gen2-right.gltf",rayOrigin:{origin:{x:.006,y:-.03,z:-.04},direction:{x:0,y:-.9,z:-1}},modelPivotOffset:new _.Vector3(0,-.007,-.021),modelPivotRotation:new _.Euler(-Math.PI/4,0,0)}},"oculus-touch-v3":{left:{modelUrl:m+"v3-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new _.Vector3(0,0,0),modelPivotRotation:new _.Euler(0,0,0)},right:{modelUrl:m+"v3-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new _.Vector3(0,0,0),modelPivotRotation:new _.Euler(0,0,0)}},"meta-quest-touch-pro":{left:{modelUrl:x+"quest-touch-pro-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new _.Vector3(0,0,0),modelPivotRotation:new _.Euler(0,0,0)},right:{modelUrl:x+"quest-touch-pro-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new _.Vector3(0,0,0),modelPivotRotation:new _.Euler(0,0,0)}},"meta-quest-touch-plus":{left:{modelUrl:x+"quest-touch-plus-left.glb",rayOrigin:{origin:{x:.0065,y:-.0186,z:-.05},direction:{x:.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new _.Vector3(0,0,0),modelPivotRotation:new _.Euler(0,0,0)},right:{modelUrl:x+"quest-touch-plus-right.glb",rayOrigin:{origin:{x:-.0065,y:-.0186,z:-.05},direction:{x:-.12394785839500175,y:-.5944043672340157,z:-.7945567170519814}},modelPivotOffset:new _.Vector3(0,0,0),modelPivotRotation:new _.Euler(0,0,0)}}},H={left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},Y={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}},W=p?Y:H;k.exports.Component=y("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},after:["tracked-controls"],mapping:W,bindMethods:function(){this.onButtonChanged=this.onButtonChanged.bind(this),this.onThumbstickMoved=this.onThumbstickMoved.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var re=this;this.onButtonDown=function(X){u(X.detail.id,"down",re,re.data.hand)},this.onButtonUp=function(X){u(X.detail.id,"up",re,re.data.hand)},this.onButtonTouchStart=function(X){u(X.detail.id,"touchstart",re,re.data.hand)},this.onButtonTouchEnd=function(X){u(X.detail.id,"touchend",re,re.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.triggerEuler=new _.Euler},addEventListeners:function(){var re=this.el;re.addEventListener("buttonchanged",this.onButtonChanged),re.addEventListener("buttondown",this.onButtonDown),re.addEventListener("buttonup",this.onButtonUp),re.addEventListener("touchstart",this.onButtonTouchStart),re.addEventListener("touchend",this.onButtonTouchEnd),re.addEventListener("axismove",this.onAxisMoved),re.addEventListener("model-loaded",this.onModelLoaded),re.addEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var re=this.el;re.removeEventListener("buttonchanged",this.onButtonChanged),re.removeEventListener("buttondown",this.onButtonDown),re.removeEventListener("buttonup",this.onButtonUp),re.removeEventListener("touchstart",this.onButtonTouchStart),re.removeEventListener("touchend",this.onButtonTouchEnd),re.removeEventListener("axismove",this.onAxisMoved),re.removeEventListener("model-loaded",this.onModelLoaded),re.removeEventListener("thumbstickmoved",this.onThumbstickMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){C(this,A,{hand:this.data.hand,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function(re){var X=this.data,V;if(!!X.model){if(this.controllerObject3D){this.el.setObject3D("mesh",this.controllerObject3D);return}if(this.displayModel=F[X.controllerType]||F[M],X.controllerType==="auto"){var O=this.el.sceneEl.systems["tracked-controls-webvr"];if(O&&O.vrDisplay){var Z=O.vrDisplay.displayName;/^Oculus Quest$/.test(Z)&&(this.displayModel=F["oculus-touch-v2"])}else{V=M;for(var ne=Object.keys(F),pe=0;pe<re.profiles.length;pe++)if(ne.indexOf(re.profiles[pe])!==-1){V=re.profiles[pe];break}this.displayModel=F[V]}}var be=this.displayModel[X.hand].modelUrl;this.isTouchV3orPROorPlus=this.displayModel===F["oculus-touch-v3"]||this.displayModel===F["meta-quest-touch-pro"]||this.displayModel===F["meta-quest-touch-plus"],this.el.setAttribute("gltf-model",be)}},injectTrackedControls:function(re){var X=this.data,V=c,O=X.hand==="right"?"Oculus Touch (Right)":"Oculus Touch (Left)",Z=p?V:O;this.el.setAttribute("tracked-controls",{id:Z,hand:X.hand,orientationOffset:X.orientationOffset,handTrackingEnabled:!1,iterateControllerProfiles:!0,space:"gripSpace"}),this.loadModel(re)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(re){var X=this.mapping[this.data.hand].buttons[re.detail.id];if(!!X){if(this.isTouchV3orPROorPlus)this.onButtonChangedV3orPROorPlus(re);else{var V=this.buttonMeshes,O;(X==="trigger"||X==="grip")&&(O=re.detail.state.value),V&&(X==="trigger"&&V.trigger&&(V.trigger.rotation.x=this.originalXRotationTrigger-O*(Math.PI/26)),X==="grip"&&V.grip&&(O*=this.data.hand==="left"?-1:1,V.grip.position.x=this.originalXPositionGrip+O*.004))}this.el.emit(X+"changed",re.detail.state)}},onButtonChangedV3orPROorPlus:function(re){var X=this.mapping[this.data.hand].buttons[re.detail.id],V=this.buttonObjects,O;!V||!V[X]||(O=re.detail.state.value,V[X].quaternion.slerpQuaternions(this.buttonRanges[X].min.quaternion,this.buttonRanges[X].max.quaternion,O),V[X].position.lerpVectors(this.buttonRanges[X].min.position,this.buttonRanges[X].max.position,O))},onModelLoaded:function(re){if(!(re.target!==this.el||!this.data.model)){if(this.isTouchV3orPROorPlus)this.onTouchV3orPROorPlusModelLoaded(re);else{var X=this.controllerObject3D=re.detail.model,V;V=this.buttonMeshes={},V.grip=X.getObjectByName("buttonHand"),this.originalXPositionGrip=V.grip&&V.grip.position.x,V.trigger=X.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=V.trigger&&V.trigger.rotation.x,V.thumbstick=X.getObjectByName("stick"),V.xbutton=X.getObjectByName("buttonX"),V.abutton=X.getObjectByName("buttonA"),V.ybutton=X.getObjectByName("buttonY"),V.bbutton=X.getObjectByName("buttonB")}for(var O in this.buttonMeshes)this.buttonMeshes[O]&&te(this.buttonMeshes[O]);this.applyOffset(re.detail.model),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin})}},applyOffset:function(re){re.position.copy(this.displayModel[this.data.hand].modelPivotOffset),re.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation)},onTouchV3orPROorPlusModelLoaded:function(re){var X=this.controllerObject3D=re.detail.model,V=this.buttonObjects={},O=this.buttonMeshes={},Z=this.buttonRanges={};O.grip=X.getObjectByName("squeeze"),V.grip=X.getObjectByName("xr_standard_squeeze_pressed_value"),Z.grip={min:X.getObjectByName("xr_standard_squeeze_pressed_min"),max:X.getObjectByName("xr_standard_squeeze_pressed_max")},V.grip.minX=V.grip.position.x,O.thumbstick=X.getObjectByName("thumbstick"),V.thumbstick=X.getObjectByName("xr_standard_thumbstick_pressed_value"),Z.thumbstick={min:X.getObjectByName("xr_standard_thumbstick_pressed_min"),max:X.getObjectByName("xr_standard_thumbstick_pressed_max")},V.thumbstickXAxis=X.getObjectByName("xr_standard_thumbstick_xaxis_pressed_value"),Z.thumbstickXAxis={min:X.getObjectByName("xr_standard_thumbstick_xaxis_pressed_min"),max:X.getObjectByName("xr_standard_thumbstick_xaxis_pressed_max")},V.thumbstickYAxis=X.getObjectByName("xr_standard_thumbstick_yaxis_pressed_value"),Z.thumbstickYAxis={min:X.getObjectByName("xr_standard_thumbstick_yaxis_pressed_min"),max:X.getObjectByName("xr_standard_thumbstick_yaxis_pressed_max")},O.trigger=X.getObjectByName("trigger"),V.trigger=X.getObjectByName("xr_standard_trigger_pressed_value"),Z.trigger={min:X.getObjectByName("xr_standard_trigger_pressed_min"),max:X.getObjectByName("xr_standard_trigger_pressed_max")},Z.trigger.diff={x:Math.abs(Z.trigger.max.rotation.x)-Math.abs(Z.trigger.min.rotation.x),y:Math.abs(Z.trigger.max.rotation.y)-Math.abs(Z.trigger.min.rotation.y),z:Math.abs(Z.trigger.max.rotation.z)-Math.abs(Z.trigger.min.rotation.z)};var ne=this.data.hand==="left"?"x":"a",pe=this.data.hand==="left"?"y":"b",be=ne+"button",Re=pe+"button";O[be]=X.getObjectByName(ne+"_button"),V[be]=X.getObjectByName(ne+"_button_pressed_value"),Z[be]={min:X.getObjectByName(ne+"_button_pressed_min"),max:X.getObjectByName(ne+"_button_pressed_max")},O[Re]=X.getObjectByName(pe+"_button"),V[Re]=X.getObjectByName(pe+"_button_pressed_value"),Z[Re]={min:X.getObjectByName(pe+"_button_pressed_min"),max:X.getObjectByName(pe+"_button_pressed_max")}},onAxisMoved:function(re){l(this,this.mapping[this.data.hand].axes,re)},onThumbstickMoved:function(re){if(!(!this.buttonMeshes||!this.buttonMeshes.thumbstick)){if(this.isTouchV3orPROorPlus){this.updateThumbstickTouchV3orPROorPlus(re);return}for(var X in re.detail)this.buttonObjects.thumbstick.rotation[this.axisMap[X]]=this.buttonRanges.thumbstick.originalRotation[this.axisMap[X]]-Math.PI/8*re.detail[X]*(X==="y"||this.data.hand==="right"?-1:1)}},axisMap:{y:"x",x:"z"},updateThumbstickTouchV3orPROorPlus:function(re){var X=(re.detail.x+1)/2;this.buttonObjects.thumbstickXAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickXAxis.min.quaternion,this.buttonRanges.thumbstickXAxis.max.quaternion,X);var V=(re.detail.y+1)/2;this.buttonObjects.thumbstickYAxis.quaternion.slerpQuaternions(this.buttonRanges.thumbstickYAxis.min.quaternion,this.buttonRanges.thumbstickYAxis.max.quaternion,V)},updateModel:function(re,X){!this.data.model||this.updateButtonModel(re,X)},updateButtonModel:function(re,X){var V=this.buttonMeshes,O,Z;!V||V[re]&&(Z=X==="up"||X==="touchend"?V[re].originalColor||this.data.buttonColor:X==="touchstart"?this.data.buttonTouchColor:this.data.buttonHighlightColor,O=V[re],O.material.color.set(Z))}});function te(re){re.traverse(function(X){var V;X.type==="Mesh"&&(V=X.material.clone(),re.originalColor=X.material.color,X.material.dispose(),X.material=V)})}},"./src/components/pico-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/lib/three.js"),v=f("./src/utils/tracked-controls.js"),C=v.checkControllerPresentAndSetup,l=v.emitIfAxesChanged,u=v.onButtonEvent,p="pico-4",c=f("./src/constants/index.js").AFRAME_CDN_ROOT,g=c+"controllers/pico/pico4/",A={left:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","squeeze","none","thumbstick","abutton","bbutton"]}};k.exports.Component=y("pico-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:A,init:function(){var h=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(m){u(m.detail.id,"down",h,h.data.hand)},this.onButtonUp=function(m){u(m.detail.id,"up",h,h.data.hand)},this.onButtonTouchEnd=function(m){u(m.detail.id,"touchend",h,h.data.hand)},this.onButtonTouchStart=function(m){u(m.detail.id,"touchstart",h,h.data.hand)},this.bindMethods()},update:function(){var h=this.data;this.controllerIndex=h.hand==="right"?0:h.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var h=this.el;h.addEventListener("buttonchanged",this.onButtonChanged),h.addEventListener("buttondown",this.onButtonDown),h.addEventListener("buttonup",this.onButtonUp),h.addEventListener("touchstart",this.onButtonTouchStart),h.addEventListener("touchend",this.onButtonTouchEnd),h.addEventListener("axismove",this.onAxisMoved),h.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var h=this.el;h.removeEventListener("buttonchanged",this.onButtonChanged),h.removeEventListener("buttondown",this.onButtonDown),h.removeEventListener("buttonup",this.onButtonUp),h.removeEventListener("touchstart",this.onButtonTouchStart),h.removeEventListener("touchend",this.onButtonTouchEnd),h.removeEventListener("axismove",this.onAxisMoved),h.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var h=this.data;C(this,p,{index:this.controllerIndex,hand:h.hand})},injectTrackedControls:function(){var h=this.el,m=this.data;h.setAttribute("tracked-controls",{idPrefix:p,hand:m.hand,controller:this.controllerIndex,orientationOffset:m.orientationOffset}),!!this.data.model&&this.el.setAttribute("gltf-model",g+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(h){var m=this.mapping[this.data.hand].buttons[h.detail.id],x;!m||(m==="trigger"&&(x=h.detail.state.value,console.log("analog value of trigger press: "+x)),this.el.emit(m+"changed",h.detail.state))},onModelLoaded:function(h){h.target!==this.el||!this.data.model||this.el.emit("controllermodelready",{name:"pico-controls",model:this.data.model,rayOrigin:new _.Vector3(0,0,0)})},onAxisMoved:function(h){l(this,this.mapping.axes,h)}})},"./src/components/position.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent;k.exports.Component=y("position",{schema:{type:"vec3"},update:function(){var _=this.el.object3D,v=this.data;_.position.set(v.x,v.y,v.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},"./src/components/raycaster.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/lib/three.js"),v=f("./src/utils/index.js"),C=v.debug("components:raycaster:warn"),l=/^[\w\s-.,[\]#]*$/,u={childList:!0,attributes:!0,subtree:!0},p={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared",INTERSECTION_CLOSEST_ENTITY_CHANGED:"raycaster-closest-entity-changed"};k.exports.Component=y("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new _.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new _.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new _.Vector3,this.otherLineEndVec3=new _.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(g){var A=this.data,h=this.el,m=this.raycaster;m.far=A.far,m.near=A.near,A.showLine&&(A.far!==g.far||A.origin!==g.origin||A.direction!==g.direction||!g.showLine)&&(this.unitLineEndVec3.copy(A.direction).normalize(),this.drawLine()),!A.showLine&&g.showLine&&h.removeAttribute("line"),A.objects!==g.objects&&!l.test(A.objects)&&C('[raycaster] Selector "'+A.objects+'" may not update automatically with DOM changes.'),A.objects||C('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),A.autoRefresh!==g.autoRefresh&&h.isPlaying&&(A.autoRefresh?this.addEventListeners():this.removeEventListeners()),g.enabled&&!A.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){!this.data.autoRefresh||(this.observer.observe(this.el.sceneEl,u),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var g=this.data,A;A=g.objects?this.el.sceneEl.querySelectorAll(g.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(A),this.dirty=!1},tock:function(g){var A=this.data,h=this.prevCheckTime;!A.enabled||h&&g-h<A.interval||(this.prevCheckTime=g,this.checkIntersections())},checkIntersections:function(){var g=this.clearedIntersectedEls,A=this.el,h=this.data,m,x=this.intersectedEls,S,b=this.intersections,L=this.newIntersectedEls,M=this.newIntersections,F=this.prevIntersectedEls,H=this.rawIntersections;for(this.dirty&&this.refreshObjects(),c(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),H.length=0,this.raycaster.intersectObjects(this.objects,!0,H),b.length=0,x.length=0,m=0;m<H.length;m++)S=H[m],!(h.showLine&&S.object===A.getObject3D("line"))&&S.object.el&&(b.push(S),x.push(S.object.el));for(M.length=0,L.length=0,m=0;m<b.length;m++)F.indexOf(b[m].object.el)===-1&&(M.push(b[m]),L.push(b[m].object.el));for(g.length=0,m=0;m<F.length;m++)x.indexOf(F[m])===-1&&(F[m].emit(p.INTERSECT_CLEAR,this.intersectedClearedDetail),g.push(F[m]));for(g.length&&A.emit(p.INTERSECTION_CLEAR,this.intersectionClearedDetail),m=0;m<L.length;m++)L[m].emit(p.INTERSECT,this.intersectedDetail);M.length&&(this.intersectionDetail.els=L,this.intersectionDetail.intersections=M,A.emit(p.INTERSECTION,this.intersectionDetail)),(F.length===0&&b.length>0||F.length>0&&b.length===0||F.length&&b.length&&F[0]!==b[0].object.el)&&(this.intersectionDetail.els=this.intersectedEls,this.intersectionDetail.intersections=b,A.emit(p.INTERSECTION_CLOSEST_ENTITY_CHANGED,this.intersectionDetail)),h.showLine&&setTimeout(this.updateLine)},updateLine:function(){var g=this.el,A=this.intersections,h;A.length&&(A[0].object.el===g&&A[1]?h=A[1].distance:h=A[0].distance),this.drawLine(h)},getIntersection:function(g){var A,h;for(A=0;A<this.intersections.length;A++)if(h=this.intersections[A],h.object.el===g)return h;return null},updateOriginDirection:function(){var g=new _.Vector3,A=new _.Vector3;return function(){var m=this.el,x=this.data;if(x.useWorldCoordinates){this.raycaster.set(x.origin,x.direction);return}m.object3D.updateMatrixWorld(),A.setFromMatrixPosition(m.object3D.matrixWorld),(x.origin.x!==0||x.origin.y!==0||x.origin.z!==0)&&(A=m.object3D.localToWorld(A.copy(x.origin))),g.copy(x.direction).transformDirection(m.object3D.matrixWorld).normalize(),this.raycaster.set(A,g)}}(),drawLine:function(g){var A=this.data,h=this.el,m;m=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,g===void 0&&(g=A.far===1/0?1e3:A.far),this.lineData.start=A.origin,this.lineData.end=m.copy(this.unitLineEndVec3).multiplyScalar(g).add(A.origin),this.lineData.color=A.lineColor,this.lineData.opacity=A.lineOpacity,h.setAttribute("line",this.lineData)},flattenObject3DMaps:function(g){var A,h,m=this.objects,x=this.el.sceneEl.object3D;function S(L){return L.parent?S(L.parent):L===x}for(m.length=0,h=0;h<g.length;h++){var b=g[h];if(b.isEntity&&b.object3D&&S(b.object3D))for(A in b.object3DMap)m.push(b.getObject3D(A))}return m},clearAllIntersections:function(){var g;for(g=0;g<this.intersectedEls.length;g++)this.intersectedEls[g].emit(p.INTERSECT_CLEAR,this.intersectedClearedDetail);c(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(p.INTERSECTION_CLEAR,this.intersectionClearedDetail)}});function c(g,A){var h;for(g.length=A.length,h=0;h<A.length;h++)g[h]=A[h]}},"./src/components/rotation.js":(k,K,f)=>{var y=f("./src/lib/three.js").MathUtils.degToRad,_=f("./src/core/component.js").registerComponent;k.exports.Component=_("rotation",{schema:{type:"vec3"},update:function(){var v=this.data,C=this.el.object3D;C.rotation.set(y(v.x),y(v.y),y(v.z),"YXZ")},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},"./src/components/scale.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent;k.exports.Component=y("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var _=this.data,v=this.el.object3D;v.scale.set(_.x,_.y,_.z)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},"./src/components/scene/ar-hit-test.js":(k,K,f)=>{var y="data:image/webp;base64,UklGRkQHAABXRUJQVlA4WAoAAAAQAAAA/wEA/wEAQUxQSL0DAAARDzD/ERGCjrY9sYYFfgo6aa1kJ7K0w9Lo3AadLSVeFxevQwj5kuM8RfR/Atw/C0+ozB/oUBrloFZs6ElSW88j1KA4yExNWQaqRZquIDF0JYmlq0hAuUDTFu66tng3teW7pa3cQf1V1edvur54M/Slm6Wv3Gx9zw0MXlQLntcsBN6wkHjTQuYtC4W3LTw8mGRVG57TbAROtxHfZNhInGkjc5aNwtk2Hg6Mvki14k+NkZzCwQgCxalcAv3kddRTPI1DcUrXId1FLf1uHpzaQz4tquhZVLlKesbVpqKeTj0n0F5PpXDlFN9UqmhalL/ImuZFo6KmToWLoKlddMprqlS8cKovBvHo2kTiFV2LN4msaxKZl3QNiair8xYRdDWivIvXVXmbcMqJ51UebZuFXxZt6xd4laxtciqRtA3Cv0nU1t+kEUFbI8JvCa+tvkm3FDlO/W+OR99+kWEp/YYo+tYfTVnf/K8cE/F///3vv//993eeL+a+uvjawLcX3xjYvJotBFY3kVjTRGFtE+BU2AiMbiQyhpHMWEYeBozAH5qNBYRDB5KBCaTDBKKBAZTDBoKBDjwHAN5ABeCJBsAZcAAC0YHHxAYSMYBiYgGZWEA2MYFCbCCZGAAIANFEB+AnYgMQTDQAYSJ2AN5EBZAm4gDgTDgAeSIu4DGygTIRN1CMLOCZiACykQlg4jsAycgA8AO+BxCNdJyDkcbwRirDGXGnx8w+FDPrkM3MQ9JQZMYhiiwV/RDMtIM3U1/DmXHUo+IR2kSR2ToWkQ1NIn2qf2J8LCqJKiDUiSADHY3whirhdHgZ94HKaR97PhE+twEUJUFoAcgyTct8hfSxSkShASDKdMJ/ritKHwgyQ0sD4D/miCxU5SbhOOUDTnZpccCjYP/i0bZ/8bAgtVGEoGapWIQXyzKVKLwgNJFk2rtMIgoNRJlOZF7SNSSyUEeQmbxBFKEmtYjEe8S8zOZ1AkJVCmS88FJOtF40Ksg4oUaFiygk3C8qlTVNyl8UTevCUdAE2t14PfVqU1FPp57TopKeQZWromddTQp6QOfTOEQt/ZDuipZ11w/wOiqO8dRORcc6BQEkDQMClaHcn5wV9yLbxsNZNgpn2sicYSNxuo34Js1G4FQbnuNsOPa28PCWhcKbFjJvWEi8ZiHwqgXPcxbc5db33Cx95WboSzddX7yp+vyN0+eul7ZyN7Xlu64t3jVt4c5pc4JLV5EYupJE0xUknC4nOjVlmaYpyLit53HCQ0+ScnqceNcS5dzUkd0/CwMAVlA4IGADAAAQXwCdASoAAgACP8ne6Wy/tjCpqJ/IA/A5CWlu4XYBG/Pz8AfwD8APz//f3v8E1fuHZnxKYACtfuHZnxKYACrYTb5mOslhxu843ecbvON3nG7zjd3a0VCn7G1MABVxwH/Xd25gAK1+4dmfEpe2+PHhQaj75++riG6FuYACtfuHZnxKYACRrK3q9xO8Ss3uWKnMhs/rDF1hi6wxdYYusMXWGI5QRcCFDZog5OgqNlse1NDuz/UoFa/cOzPiUwAEsAOK4/nu5eZHK2tlXxJfNYlMABWv3Dsz4bvNJ5YA/LtxJ38SmAArX7h2Z8Sk5vdZUYv7mZPiUwAFa/cOzPh21s5OgZxf1mfEpemRyFr/rM+JS9noA/LtxJ38SmAAlUJIotzAASn6TjdhK+D3Dsz4dyvB7h2Z8O2tnJ0DOL+sz4lL2nKLT4lL/+iSLOocxq639w7M34MNZdm55uJ8v8ra2cpVZnxKTq2F3PN/cNksAfl24k7+JTAASqrD37h2Z7b1W+VtbOUqsz4lJ1bC7nm/uGyWAPy7cSd/EpgAJVVh79w7M9t6rfK2tnKVWZ8Sk6thdzzf3DZLAH5duJO/iUwAEqqw9+4dme29VvlbWzlKrM+JSdWwu55v7hslgD8u3EnfxKYACVVYe/cOzPbeq3ytrZylVme0kYJ8557FLerqFrzIbPrrf3DZLAH5duJO/iUvaVMS9BoaF4p7pSDFTP1XMyfElelrM0DOL+sz4eBJ13nV1OppBGPuKb4YzXQgq9uH19uS/0+JS9t9fr6ZUlQBelDG6GMgq97otb5QMPJwtKyBTbFp8Sl7b6/X0ykkawEOsgdiE6Fi0vb/Eve6xkwsmug0Z4nGNHQO8839bpTsjpz7SWIJxKagvd1QWMa6FYT1KEw3j4XDT6vJ9Xk+nyfT5Pq8n1eEmk5dinMM/9Fcfz4Z3Dsz3KD2dw7LxBRxKrqUUGQPH/7zxr1KIfNpLEJ0MZB2ITM/0Z2EFoh12NlXnEcpYcbvON3nG7zjd5xu84vfcNIAAP7+y8ceyzbVxkakPYY4lcr72fqOnDwipv+yxC71wAADBrjKnAAAAAAAAAAAAAAw7oNGHttqWONcoFN/2WIDc2pa6WVFtFYROlsaMaTXdcOjXHz93+YxAglKa4AAAAA=",_=f("./src/core/component.js").registerComponent,v=f("./src/lib/three.js"),C=21,l=function(){var g=new v.Quaternion,A=new v.Vector3;function h(m,x,S){x.position.copy(m.transform.position),x.quaternion.copy(m.transform.orientation),A.copy(S),g.copy(m.transform.orientation),A.applyQuaternion(g),x.position.sub(A)}return h}();l.tempFakePose={transform:{orientation:new v.Quaternion,position:new v.Vector3}};function u(g,A){this.renderer=g,this.xrHitTestSource=null,g.xr.addEventListener("sessionend",function(){this.xrHitTestSource=null}.bind(this)),g.xr.addEventListener("sessionstart",function(){this.sessionStart(A)}.bind(this)),this.renderer.xr.isPresenting&&this.sessionStart(A)}u.prototype.previousFrameAnchors=new Set,u.prototype.anchorToObject3D=new Map;function p(g){console.warn(g.message),console.warn('Cannot requestHitTestSource Are you missing: webxr="optionalFeatures: hit-test;" from <a-scene>?')}u.prototype.sessionStart=function(A){if(this.session=this.renderer.xr.getSession(),!("requestHitTestSource"in this.session)){p({message:"No requestHitTestSource on the session."});return}A.space?this.session.requestHitTestSource(A).then(function(h){this.xrHitTestSource=h}.bind(this)).catch(p):A.profile&&this.session.requestHitTestSourceForTransientInput(A).then(function(h){this.xrHitTestSource=h,this.transient=!0}.bind(this)).catch(p)},u.prototype.anchorFromLastHitTestResult=function(g,A){var h=this.lastHitTest;if(!!h){var m={object3D:g,offset:A};Array.from(this.anchorToObject3D.entries()).forEach(function(x){var S=x[1].object3D,b=x[0];S===g&&(this.anchorToObject3D.delete(b),b.delete())}.bind(this)),h.createAnchor&&h.createAnchor().then(function(x){this.anchorToObject3D.set(x,m)}.bind(this)).catch(function(x){console.warn(x.message),console.warn('Cannot create anchor, are you missing: webxr="optionalFeatures: anchors;" from <a-scene>?')})}},u.prototype.doHit=function(A){if(!!this.renderer.xr.isPresenting){var h=this.renderer.xr.getReferenceSpace(),m=A.getViewerPose(h),x,S;if(this.xrHitTestSource&&m)return this.transient?(x=A.getHitTestResultsForTransientInput(this.xrHitTestSource),x.length>0?(S=x[0].results,S.length>0?(this.lastHitTest=S[0],S[0].getPose(h)):!1):!1):(x=A.getHitTestResults(this.xrHitTestSource),x.length>0?(this.lastHitTest=x[0],x[0].getPose(h)):!1)}},u.updateAnchorPoses=function(g,A){var h=g.trackedAnchors||u.prototype.previousFrameAnchors;u.prototype.previousFrameAnchors.forEach(function(m){h.has(m)||u.prototype.anchorToObject3D.delete(m)}),h.forEach(function(m){var x,S,b,L;try{x=g.getPose(m.anchorSpace,A)}catch(M){}if(x){if(S=u.prototype.anchorToObject3D.get(m),!S)return;b=S.offset,L=S.object3D,l(x,L,b)}})};var c;k.exports.Component=_("ar-hit-test",{schema:{target:{type:"selector"},enabled:{default:!0},src:{default:y,type:"map"},type:{default:"footprint",oneOf:["footprint","map"]},footprintDepth:{default:.1},mapSize:{type:"vec2",default:{x:.5,y:.5}}},sceneOnly:!0,init:function(){this.hitTest=null,this.imageDataArray=new Uint8ClampedArray(512*512*4),this.imageData=new ImageData(this.imageDataArray,512,512),this.textureCache=new Map,this.orthoCam=new v.OrthographicCamera,this.orthoCam.layers.set(C),this.textureTarget=new v.WebGLRenderTarget(512,512,{}),this.basicMaterial=new v.MeshBasicMaterial({color:0,side:v.DoubleSide}),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.context.imageSmoothingEnabled=!1,this.canvas.width=512,this.canvas.height=512,this.canvasTexture=new v.CanvasTexture(this.canvas,{alpha:!0}),this.canvasTexture.flipY=!1;var g=this.el.getAttribute("webxr"),A=g.optionalFeatures;(!A.includes("hit-test")||!A.includes("anchors"))&&(A.push("hit-test"),A.push("anchors"),this.el.setAttribute("webxr",g)),this.el.sceneEl.renderer.xr.addEventListener("sessionend",function(){this.hitTest=null}.bind(this)),this.el.sceneEl.renderer.xr.addEventListener("sessionstart",function(){if(!!this.el.is("ar-mode")){var h=this.el.sceneEl.renderer,m=this.session=h.xr.getSession();this.hasPosedOnce=!1,this.bboxMesh.visible=!1,c||(c=new Map),m.requestReferenceSpace("viewer").then(function(b){this.hitTest=new u(h,{space:b}),c.set(b,this.hitTest),this.el.emit("ar-hit-test-start")}.bind(this));var x="generic-touchscreen",S=new u(h,{profile:x});m.addEventListener("selectstart",function(b){if(this.data.enabled===!0){var L=b.inputSource;this.bboxMesh.visible=!0,this.hasPosedOnce===!0&&(this.el.emit("ar-hit-test-select-start",{inputSource:L,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion}),L.profiles[0]===x?this.hitTest=S:(this.hitTest=c.get(L)||new u(h,{space:L.targetRaySpace}),c.set(L,this.hitTest)))}}.bind(this)),m.addEventListener("selectend",function(b){if(!this.hitTest||this.data.enabled!==!0){this.hitTest=null;return}var L=b.inputSource,M;this.hasPosedOnce===!0&&(this.bboxMesh.visible=!1,this.data.target&&(M=this.data.target.object3D,M&&(l.tempFakePose.transform.position.copy(this.bboxMesh.position),l.tempFakePose.transform.orientation.copy(this.bboxMesh.quaternion),l(l.tempFakePose,M,this.bboxOffset),M.visible=!0,this.hitTest.anchorFromLastHitTestResult(M,this.bboxOffset))),this.el.emit("ar-hit-test-select",{inputSource:L,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion})),this.hitTest=null}.bind(this))}}.bind(this)),this.bboxOffset=new v.Vector3,this.update=this.update.bind(this),this.makeBBox()},update:function(){this.data.enabled===!1&&(this.hitTest=null,this.bboxMesh.visible=!1),this.data.target&&(this.data.target.object3D?(this.data.target.addEventListener("model-loaded",this.update),this.data.target.object3D.layers.enable(C),this.data.target.object3D.traverse(function(g){g.layers.enable(C)})):this.data.target.addEventListener("loaded",this.update,{once:!0})),this.bboxNeedsUpdate=!0},makeBBox:function(){var g=new v.PlaneGeometry(1,1),A=new v.MeshBasicMaterial({transparent:!0,color:16777215});g.rotateX(-Math.PI/2),g.rotateY(-Math.PI/2),this.bbox=new v.Box3,this.bboxMesh=new v.Mesh(g,A),this.el.setObject3D("ar-hit-test",this.bboxMesh),this.bboxMesh.visible=!1},updateFootprint:function(){var g,A=this.el.sceneEl.renderer,h,m,x=A.xr.enabled;this.bboxMesh.material.map=this.canvasTexture,this.bboxMesh.material.needsUpdate=!0,this.orthoCam.rotation.set(-Math.PI/2,0,-Math.PI/2),this.orthoCam.position.copy(this.bboxMesh.position),this.orthoCam.position.y-=this.bboxMesh.scale.y/2,this.orthoCam.near=.1,this.orthoCam.far=this.orthoCam.near+this.data.footprintDepth*this.bboxMesh.scale.y,this.orthoCam.position.y+=this.orthoCam.far,this.orthoCam.right=this.bboxMesh.scale.z/2,this.orthoCam.left=-this.bboxMesh.scale.z/2,this.orthoCam.top=this.bboxMesh.scale.x/2,this.orthoCam.bottom=-this.bboxMesh.scale.x/2,this.orthoCam.updateProjectionMatrix(),h=A.getRenderTarget(),A.setRenderTarget(this.textureTarget),A.xr.enabled=!1,m=this.el.object3D.background,this.el.object3D.overrideMaterial=this.basicMaterial,this.el.object3D.background=null,A.render(this.el.object3D,this.orthoCam),this.el.object3D.background=m,this.el.object3D.overrideMaterial=null,A.xr.enabled=x,A.setRenderTarget(h),A.readRenderTargetPixels(this.textureTarget,0,0,512,512,this.imageDataArray),this.context.putImageData(this.imageData,0,0),this.context.shadowColor="white",this.context.shadowBlur=10,this.context.drawImage(this.canvas,0,0),g=this.context.getImageData(0,0,512,512);for(var S=0;S<512*512;S++)g.data[S*4+3]!==0&&g.data[S*4+3]!==255&&(g.data[S*4+3]=128);this.context.putImageData(g,0,0),this.canvasTexture.needsUpdate=!0},tick:function(){var g,A=this.el.sceneEl.frame,h=this.el.sceneEl.renderer;if(A&&u.updateAnchorPoses(A,h.xr.getReferenceSpace()),this.bboxNeedsUpdate){if(this.bboxNeedsUpdate=!1,!this.data.target||this.data.type==="map"){var m;this.textureCache.has(this.data.src)?m=this.textureCache.get(this.data.src):(m=new v.TextureLoader().load(this.data.src),this.textureCache.set(this.data.src,m)),this.bboxMesh.material.map=m,this.bboxMesh.material.needsUpdate=!0}this.data.target&&this.data.target.object3D?(this.bbox.setFromObject(this.data.target.object3D),this.bbox.getCenter(this.bboxMesh.position),this.bbox.getSize(this.bboxMesh.scale),this.data.type==="footprint"&&(this.bboxMesh.scale.x*=1.04,this.bboxMesh.scale.z*=1.04,this.updateFootprint()),this.bboxMesh.position.y-=this.bboxMesh.scale.y/2,this.bboxOffset.copy(this.bboxMesh.position),this.bboxOffset.sub(this.data.target.object3D.position)):this.bboxMesh.scale.set(this.data.mapSize.x,1,this.data.mapSize.y)}this.hitTest&&(g=this.hitTest.doHit(A),g&&(this.hasPosedOnce!==!0&&(this.hasPosedOnce=!0,this.el.emit("ar-hit-test-achieved")),this.bboxMesh.visible=!0,this.bboxMesh.position.copy(g.transform.position),this.bboxMesh.quaternion.copy(g.transform.orientation)))}})},"./src/components/scene/background.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent;k.exports.Component=y("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},sceneOnly:!0,update:function(){var _=this.data,v=this.el.object3D;_.transparent?v.background=null:v.background=new THREE.Color(_.color)},remove:function(){var _=this.el.object3D;_.background=null}})},"./src/components/scene/debug.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent;k.exports.Component=y("debug",{schema:{default:!0},sceneOnly:!0})},"./src/components/scene/device-orientation-permission-ui.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/constants/index.js"),v="a-modal",C="a-dialog",l="a-dialog-text",u="a-dialog-text-container",p="a-dialog-buttons-container",c="a-dialog-button",g="a-dialog-allow-button",A="a-dialog-deny-button",h="a-dialog-ok-button";k.exports.Component=y("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},sceneOnly:!0,init:function(){var b=this;if(!!this.data.enabled){if(window.isSecureContext||this.showHTTPAlert(),typeof DeviceOrientationEvent=="undefined"||!DeviceOrientationEvent.requestPermission){this.permissionGranted=!0;return}this.onDeviceMotionDialogAllowClicked=this.onDeviceMotionDialogAllowClicked.bind(this),this.onDeviceMotionDialogDenyClicked=this.onDeviceMotionDialogDenyClicked.bind(this),DeviceOrientationEvent.requestPermission().then(function(){b.el.emit("deviceorientationpermissiongranted"),b.permissionGranted=!0}).catch(function(){b.devicePermissionDialogEl=m(b.data.denyButtonText,b.data.allowButtonText,b.data.deviceMotionMessage,b.onDeviceMotionDialogAllowClicked,b.onDeviceMotionDialogDenyClicked),b.el.appendChild(b.devicePermissionDialogEl)})}},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showHTTPAlert:function(){var b=this,L=x(b.data.cancelButtonText,b.data.httpsMessage,function(){b.el.removeChild(L)});this.el.appendChild(L)},onDeviceMotionDialogAllowClicked:function(){var b=this;this.el.emit("deviceorientationpermissionrequested"),DeviceOrientationEvent.requestPermission().then(function(L){L==="granted"?(b.el.emit("deviceorientationpermissiongranted"),b.permissionGranted=!0):b.el.emit("deviceorientationpermissionrejected"),b.remove()}).catch(console.error)}});function m(b,L,M,F,H){var Y,W,te;return Y=document.createElement("div"),Y.classList.add(p),W=document.createElement("button"),W.classList.add(c,A),W.setAttribute(_.AFRAME_INJECTED,""),W.innerHTML=b,Y.appendChild(W),te=document.createElement("button"),te.classList.add(c,g),te.setAttribute(_.AFRAME_INJECTED,""),te.innerHTML=L,Y.appendChild(te),te.addEventListener("click",function(re){re.stopPropagation(),F()}),W.addEventListener("click",function(re){re.stopPropagation(),H()}),S(M,Y)}function x(b,L,M){var F,H;return F=document.createElement("div"),F.classList.add(p),H=document.createElement("button"),H.classList.add(c,h),H.setAttribute(_.AFRAME_INJECTED,""),H.innerHTML=b,F.appendChild(H),H.addEventListener("click",function(Y){Y.stopPropagation(),M()}),S(L,F)}function S(b,L){var M,F,H,Y;return M=document.createElement("div"),M.classList.add(v),M.setAttribute(_.AFRAME_INJECTED,""),F=document.createElement("div"),F.className=C,F.setAttribute(_.AFRAME_INJECTED,""),M.appendChild(F),H=document.createElement("div"),H.classList.add(u),F.appendChild(H),Y=document.createElement("div"),Y.classList.add(l),Y.innerHTML=b,H.appendChild(Y),F.appendChild(L),M}},"./src/components/scene/embedded.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent;k.exports.Component=y("embedded",{dependencies:["xr-mode-ui"],schema:{default:!0},sceneOnly:!0,update:function(){var _=this.el,v=_.querySelector(".a-enter-vr");this.data===!0?(v&&v.classList.add("embedded"),_.removeFullScreenStyles()):(v&&v.classList.remove("embedded"),_.addFullScreenStyles())}})},"./src/components/scene/fog.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/lib/three.js"),v=f("./src/utils/debug.js"),C=v("components:fog:warn");k.exports.Component=y("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},sceneOnly:!0,update:function(){var u=this.data,p=this.el,c=this.el.object3D.fog;if(!c||u.type!==c.name){p.object3D.fog=l(u);return}Object.keys(this.schema).forEach(function(g){var A=u[g];g==="color"&&(A=new _.Color(A)),c[g]=A})},remove:function(){var u=this.el,p=this.el.object3D.fog;!p||(u.object3D.fog=null)}});function l(u){var p;return u.type==="exponential"?p=new _.FogExp2(u.color,u.density):p=new _.Fog(u.color,u.near,u.far),p.name=u.type,p}},"./src/components/scene/inspector.js":(k,K,f)=>{var y=f("./src/constants/index.js").AFRAME_INJECTED,_=f("./package.json"),v=f("./src/core/component.js").registerComponent,C=f("./src/utils/index.js");function l(h){var m=h.split(".");return m[2]="x",m.join(".")}var u="https://aframe.io/aframe-inspector/dist/aframe-inspector.js",p="https://unpkg.com/aframe-inspector@"+l(_.version)+"/dist/aframe-inspector.min.js",c=p,g="Loading Inspector",A="Error loading Inspector";k.exports.Component=v("inspector",{schema:{url:{default:c}},sceneOnly:!0,init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var h;!this.firstPlay||(h=C.getUrlParameter("inspector"),h!=="false"&&!!h&&(this.openInspector(),this.firstPlay=!1))},initOverlay:function(){var h='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML=g+h},remove:function(){this.removeEventListeners()},onKeydown:function(h){var m=h.keyCode===73&&(h.ctrlKey&&h.altKey||h.getModifierState("AltGraph"));!m||this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(h){h.data==="INJECT_AFRAME_INSPECTOR"&&this.openInspector()},openInspector:function(h){var m=this,x;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected){AFRAME.INSPECTOR.open(h);return}this.showLoader(),x=document.createElement("script"),x.src=this.data.url,x.setAttribute("data-name","aframe-inspector"),x.setAttribute(y,""),x.onload=function(){AFRAME.INSPECTOR.open(h),m.hideLoader(),m.removeEventListeners()},x.onerror=function(){m.loadingMessageEl.innerHTML=A},document.head.appendChild(x),AFRAME.inspectorInjected=!0},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})},"./src/components/scene/keyboard-shortcuts.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/utils/index.js").shouldCaptureKeyEvent;k.exports.Component=y("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},sceneOnly:!0,init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(v){var C=this.data;this.enterVREnabled=C.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(v){var C=this.el;!_(v)||(this.enterVREnabled&&v.keyCode===70&&C.enterVR(),this.enterVREnabled&&v.keyCode===27&&C.exitVR())}})},"./src/components/scene/pool.js":(k,K,f)=>{var y=f("./src/utils/debug.js"),_=f("./src/core/component.js").registerComponent,v=y("components:pool:warn");k.exports.Component=_("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},sceneOnly:!0,multiple:!0,initPool:function(){var C;for(this.availableEls=[],this.usedEls=[],this.data.mixin||v("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||v("Container "+this.data.container+" not found.")),this.container=this.container||this.el,C=0;C<this.data.size;++C)this.createEntity()},update:function(C){var l=this.data;(C.mixin!==l.mixin||C.size!==l.size)&&this.initPool()},createEntity:function(){var C;C=document.createElement("a-entity"),C.play=this.wrapPlay(C.play),C.setAttribute("mixin",this.data.mixin),C.object3D.visible=!1,C.pause(),this.container.appendChild(C),this.availableEls.push(C);var l=this.usedEls;C.addEventListener("loaded",function(){l.indexOf(C)===-1&&(C.object3DParent=C.object3D.parent,C.object3D.parent.remove(C.object3D))})},wrapPlay:function(C){var l=this.usedEls;return function(){l.indexOf(this)!==-1&&C.call(this)}},requestEntity:function(){var C;if(this.availableEls.length===0){if(this.data.dynamic===!1){v("Requested entity from empty pool: "+this.attrName);return}else v("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName);this.createEntity()}return C=this.availableEls.shift(),this.usedEls.push(C),C.object3DParent&&(C.object3DParent.add(C.object3D),this.updateRaycasters()),C.object3D.visible=!0,C},returnEntity:function(C){var l=this.usedEls.indexOf(C);if(l===-1){v("The returned entity was not previously pooled from "+this.attrName);return}return this.usedEls.splice(l,1),this.availableEls.push(C),C.object3DParent=C.object3D.parent,C.object3D.parent.remove(C.object3D),this.updateRaycasters(),C.object3D.visible=!1,C.pause(),C},updateRaycasters:function(){var C=document.querySelectorAll("[raycaster]");C.forEach(function(l){l.components.raycaster.setDirty()})}})},"./src/components/scene/real-world-meshing.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/lib/three.js");k.exports.Component=y("real-world-meshing",{schema:{filterLabels:{type:"array"},meshesEnabled:{default:!0},meshMixin:{default:!0},planesEnabled:{default:!0},planeMixin:{default:""}},sceneOnly:!0,init:function(){var v=this.el.getAttribute("webxr"),C=v.requiredFeatures;C.indexOf("mesh-detection")===-1&&(C.push("mesh-detection"),this.el.setAttribute("webxr",v)),C.indexOf("plane-detection")===-1&&(C.push("plane-detection"),this.el.setAttribute("webxr",v)),this.meshEntities=[],this.initWorldMeshEntity=this.initWorldMeshEntity.bind(this)},tick:function(){!this.el.is("ar-mode")||(this.detectMeshes(),this.updateMeshes())},detectMeshes:function(){var v=this.data,C,l,u=this.el,p=u.renderer.xr,c,g=this.meshEntities,A=!1,h=[],m=this.data.filterLabels;c=u.frame,C=c.detectedMeshes,l=c.detectedPlanes;for(var x=0;x<g.length;x++)g[x].present=!1;if(v.meshesEnabled){for(var S of C.values())if(!(m.length&&m.indexOf(S.semanticLabel)===-1)){for(x=0;x<g.length;x++)if(S===g[x].mesh){A=!0,g[x].present=!0,g[x].lastChangedTime<S.lastChangedTime&&this.updateMeshGeometry(g[x].el,S),g[x].lastChangedTime=S.lastChangedTime;break}A||h.push(S),A=!1}}if(v.planesEnabled){for(S of l.values())if(!(m.length&&m.indexOf(S.semanticLabel)===-1)){for(x=0;x<g.length;x++)if(S===g[x].mesh){A=!0,g[x].present=!0,g[x].lastChangedTime<S.lastChangedTime&&this.updateMeshGeometry(g[x].el,S),g[x].lastChangedTime=S.lastChangedTime;break}A||h.push(S),A=!1}}this.deleteMeshes(),this.createNewMeshes(h)},updateMeshes:function(){var v=new _.Matrix4;return function(){for(var C,l=this.el,u,p=l.frame,c=this.meshEntities,g=l.renderer.xr.getReferenceSpace(),A,h=0;h<c.length;h++)A=c[h].mesh.meshSpace||c[h].mesh.planeSpace,C=p.getPose(A,g),u=c[h].el,!!u.hasLoaded&&(v.fromArray(C.transform.matrix),v.decompose(u.object3D.position,u.object3D.quaternion,u.object3D.scale))}}(),deleteMeshes:function(){for(var v=this.meshEntities,C=[],l=0;l<v.length;l++)v[l].present?C.push(v[l]):this.el.removeChild(v[l]);this.meshEntities=C},createNewMeshes:function(v){for(var C,l=0;l<v.length;l++)C=document.createElement("a-entity"),this.meshEntities.push({mesh:v[l],el:C}),C.addEventListener("loaded",this.initWorldMeshEntity),this.el.appendChild(C)},initMeshGeometry:function(v){var C,l,u;if(v instanceof XRPlane){l=new _.Shape,u=v.polygon;for(var p=0;p<u.length;++p)p===0?l.moveTo(u[p].x,u[p].z):l.lineTo(u[p].x,u[p].z);return C=new _.ShapeGeometry(l),C.rotateX(Math.PI/2),C}return C=new _.BufferGeometry,C.setAttribute("position",new _.BufferAttribute(v.vertices,3)),C.setIndex(new _.BufferAttribute(v.indices,1)),C},initWorldMeshEntity:function(v){for(var C=v.target,l,u,p,c=this.meshEntities,g=0;g<c.length;g++)if(c[g].el===C){p=c[g];break}l=this.initMeshGeometry(p.mesh),u=new _.Mesh(l,new _.MeshBasicMaterial({color:Math.random()*16777215,side:_.DoubleSide})),C.setObject3D("mesh",u),p.mesh instanceof XRPlane&&this.data.planeMixin?C.setAttribute("mixin",this.data.planeMixin):this.data.meshMixin&&C.setAttribute("mixin",this.data.meshMixin),C.setAttribute("data-world-mesh",p.mesh.semanticLabel)},updateMeshGeometry:function(v,C){var l=v.getObject3D("mesh");l.geometry.dispose(),l.geometry=this.initMeshGeometry(C)}})},"./src/components/scene/reflection.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent;function _(v,C,l,u){var p=Math.max(v.primaryLightIntensity.x,Math.max(v.primaryLightIntensity.y,v.primaryLightIntensity.z));C.sh.fromArray(v.sphericalHarmonicsCoefficients),C.intensity=1,l&&(l.color.setRGB(v.primaryLightIntensity.x/p,v.primaryLightIntensity.y/p,v.primaryLightIntensity.z/p),l.intensity=p,u.copy(v.primaryLightDirection))}k.exports.Component=y("reflection",{schema:{directionalLight:{type:"selector"}},sceneOnly:!0,init:function(){var v=this;this.cubeRenderTarget=new THREE.WebGLCubeRenderTarget(16),this.cubeCamera=new THREE.CubeCamera(.1,1e3,this.cubeRenderTarget),this.lightingEstimationTexture=new THREE.WebGLCubeRenderTarget(16).texture,this.needsVREnvironmentUpdate=!0;var C=this.el.getAttribute("webxr"),l=C.optionalFeatures;l.includes("light-estimation")||(l.push("light-estimation"),this.el.setAttribute("webxr",C)),this.el.addEventListener("enter-vr",function(){if(!!v.el.is("ar-mode")){var u=v.el.renderer,p=u.xr.getSession();p.requestLightProbe&&v.startLightProbe()}}),this.el.addEventListener("exit-vr",function(){v.xrLightProbe&&v.stopLightProbe()}),this.el.object3D.environment=this.cubeRenderTarget.texture},stopLightProbe:function(){this.xrLightProbe=null,this.probeLight&&(this.probeLight.components.light.light.intensity=0),this.needsVREnvironmentUpdate=!0,this.el.object3D.environment=this.cubeRenderTarget.texture},startLightProbe:function(){this.needsLightProbeUpdate=!0},setupLightProbe:function(){var v=this.el.renderer,C=v.xr.getSession(),l=this,u=v.getContext();if(!this.probeLight){var p=document.createElement("a-light");p.setAttribute("type","probe"),p.setAttribute("intensity",0),this.el.appendChild(p),this.probeLight=p}switch(C.preferredReflectionFormat){case"srgba8":u.getExtension("EXT_sRGB");break;case"rgba16f":u.getExtension("OES_texture_half_float");break}this.glBinding=new XRWebGLBinding(C,u),u.getExtension("EXT_sRGB"),u.getExtension("OES_texture_half_float"),C.requestLightProbe().then(function(c){l.xrLightProbe=c,c.addEventListener("reflectionchange",l.updateXRCubeMap.bind(l))}).catch(function(c){console.warn("Lighting estimation not supported: "+c.message),console.warn('Are you missing: webxr="optionalFeatures: light-estimation;" from <a-scene>?')})},updateXRCubeMap:function(){var v=this.el.renderer,C=this.glBinding.getReflectionCubeMap(this.xrLightProbe);if(C){var l=v.properties.get(this.lightingEstimationTexture);l.__webglTexture=C,this.lightingEstimationTexture.needsPMREMUpdate=!0,this.el.object3D.environment=this.lightingEstimationTexture}},tick:function(){var v=this.el.object3D,C=this.el.renderer,l=this.el.frame;if(l&&this.xrLightProbe){var u=l.getLightEstimate(this.xrLightProbe);u&&_(u,this.probeLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.object3D.position)}this.needsVREnvironmentUpdate&&(v.environment=null,this.needsVREnvironmentUpdate=!1,this.cubeCamera.position.set(0,1.6,0),this.cubeCamera.update(C,v),v.environment=this.cubeRenderTarget.texture),this.needsLightProbeUpdate&&l&&(this.setupLightProbe(),this.needsLightProbeUpdate=!1)},remove:function(){this.el.object3D.environment=null,this.probeLight&&this.el.removeChild(this.probeLight)}})},"./src/components/scene/screenshot.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/lib/three.js"),v=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),C=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join(`
`);k.exports.Component=y("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},sceneOnly:!0,setup:function(){var l=this.el;if(!this.canvas){var u=l.renderer.getContext();!u||(this.cubeMapSize=u.getParameter(u.MAX_CUBE_MAP_TEXTURE_SIZE),this.material=new _.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:v,fragmentShader:C,side:_.DoubleSide}),this.quad=new _.Mesh(new _.PlaneGeometry(1,1),this.material),this.quad.visible=!1,this.camera=new _.OrthographicCamera(-1/2,1/2,1/2,-1/2,-1e4,1e4),this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),l.object3D.add(this.quad),this.onKeyDown=this.onKeyDown.bind(this))}},getRenderTarget:function(l,u){return new _.WebGLRenderTarget(l,u,{colorSpace:this.el.sceneEl.renderer.outputColorSpace,minFilter:_.LinearFilter,magFilter:_.LinearFilter,wrapS:_.ClampToEdgeWrapping,wrapT:_.ClampToEdgeWrapping,format:_.RGBAFormat,type:_.UnsignedByteType})},resize:function(l,u){this.quad.scale.set(l,u,1),this.camera.left=-1*l/2,this.camera.right=l/2,this.camera.top=u/2,this.camera.bottom=-1*u/2,this.camera.updateProjectionMatrix(),this.canvas.width=l,this.canvas.height=u},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(l){var u=l.keyCode===83&&l.ctrlKey&&l.altKey;if(!(!this.data||!u)){var p=l.shiftKey?"equirectangular":"perspective";this.capture(p)}},setCapture:function(l){var u=this.el,p,c,g,A;return l==="perspective"?(this.quad.visible=!1,c=this.data.camera&&this.data.camera.components.camera.camera||u.camera,p={width:this.data.width,height:this.data.height}):(c=this.camera,A=new _.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,2048),{format:_.RGBFormat,generateMipmaps:!0,minFilter:_.LinearMipmapLinearFilter,colorSpace:_.SRGBColorSpace}),g=new _.CubeCamera(u.camera.near,u.camera.far,A),u.camera.getWorldPosition(g.position),u.camera.getWorldQuaternion(g.quaternion),g.update(u.renderer,u.object3D),this.quad.material.uniforms.map.value=g.renderTarget.texture,p={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:c,size:p,projection:l}},capture:function(l){var u=this.el.renderer.xr.enabled,p=this.el.renderer,c;this.setup(),p.xr.enabled=!1,c=this.setCapture(l),this.renderCapture(c.camera,c.size,c.projection),this.saveCapture(),p.xr.enabled=u},getCanvas:function(l){var u=this.el.renderer.xr.enabled,p=this.el.renderer;this.setup();var c=this.setCapture(l);return p.xr.enabled=!1,this.renderCapture(c.camera,c.size,c.projection),p.xr.enabled=u,this.canvas},renderCapture:function(l,u,p){var c=this.el.renderer.autoClear,g=this.el,A,h,m,x=g.renderer;h=this.getRenderTarget(u.width,u.height),m=new Uint8Array(4*u.width*u.height),this.resize(u.width,u.height),x.autoClear=!0,x.clear(),x.setRenderTarget(h),x.render(g.object3D,l),x.autoClear=c,x.readRenderTargetPixels(h,0,0,u.width,u.height,m),x.setRenderTarget(null),p==="perspective"&&(m=this.flipPixelsVertically(m,u.width,u.height)),A=new ImageData(new Uint8ClampedArray(m),u.width,u.height),this.quad.visible=!1,this.ctx.putImageData(A,0,0)},flipPixelsVertically:function(l,u,p){for(var c=l.slice(0),g=0;g<u;++g)for(var A=0;A<p;++A)c[g*4+A*u*4]=l[g*4+(p-A)*u*4],c[g*4+1+A*u*4]=l[g*4+1+(p-A)*u*4],c[g*4+2+A*u*4]=l[g*4+2+(p-A)*u*4],c[g*4+3+A*u*4]=l[g*4+3+(p-A)*u*4];return c},saveCapture:function(){this.canvas.toBlob(function(l){var u="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",p=document.createElement("a"),c=URL.createObjectURL(l);p.href=c,p.setAttribute("download",u),p.innerHTML="downloading...",p.style.display="none",document.body.appendChild(p),setTimeout(function(){p.click(),document.body.removeChild(p)},1)},"image/png")}})},"./src/components/scene/stats.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./vendor/rStats.js"),v=f("./src/utils/index.js");f("./vendor/rStats.extras.js"),f("./src/lib/rStatsAframe.js");var C=window.aframeStats,l="a-hidden",u=window.threeStats;k.exports.Component=y("stats",{schema:{default:!0},sceneOnly:!0,init:function(){var c=this.el;v.getUrlParameter("stats")!=="false"&&(this.stats=p(c),this.statsEl=document.querySelector(".rs-base"),this.hideBound=this.hide.bind(this),this.showBound=this.show.bind(this),c.addEventListener("enter-vr",this.hideBound),c.addEventListener("exit-vr",this.showBound))},update:function(){if(!!this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),!!this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var c=this.stats;!c||(c("rAF").tick(),c("FPS").frame(),c().update())},hide:function(){this.statsEl.classList.add(l)},show:function(){this.statsEl.classList.remove(l)}});function p(c){var g=new u(c.renderer),A=new C(c),h=c.isMobile?[]:[g,A];return new _({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:h})}},"./src/components/scene/xr-mode-ui.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/constants/index.js"),v=f("./src/utils/index.js"),C="a-enter-vr",l="a-enter-ar",u="a-enter-vr-button",p="a-enter-ar-button",c="a-hidden",g="a-orientation-modal";k.exports.Component=y("xr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},cardboardModeEnabled:{default:!1},enterVRButton:{default:""},enterVREnabled:{default:!0},enterARButton:{default:""},enterAREnabled:{default:!0},XRMode:{default:"vr",oneOf:["vr","ar","xr"]}},sceneOnly:!0,init:function(){var S=this,b=this.el;v.getUrlParameter("ui")!=="false"&&(this.insideLoader=!1,this.enterVREl=null,this.enterAREl=null,this.orientationModalEl=null,this.bindMethods(),b.addEventListener("enter-vr",this.updateEnterInterfaces),b.addEventListener("exit-vr",this.updateEnterInterfaces),b.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(L){L.data.type==="loaderReady"&&(S.insideLoader=!0,S.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=this.onEnterVRButtonClick.bind(this),this.onEnterARButtonClick=this.onEnterARButtonClick.bind(this),this.onModalClick=this.onModalClick.bind(this),this.toggleOrientationModalIfNeeded=this.toggleOrientationModalIfNeeded.bind(this),this.updateEnterInterfaces=this.updateEnterInterfaces.bind(this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var S=this.data,b=this.el;if(!S.enabled||this.insideLoader||v.getUrlParameter("ui")==="false")return this.remove();this.enterVREl||this.enterAREl||this.orientationModalEl||(!this.enterVREl&&S.enterVREnabled&&(S.XRMode==="xr"||S.XRMode==="vr")&&(S.enterVRButton?(this.enterVREl=document.querySelector(S.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=A(this.onEnterVRButtonClick),b.appendChild(this.enterVREl))),!this.enterAREl&&S.enterAREnabled&&(S.XRMode==="xr"||S.XRMode==="ar")&&(S.enterARButton?(this.enterAREl=document.querySelector(S.enterARButton),this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=h(this.onEnterARButtonClick,S.XRMode==="xr"),b.appendChild(this.enterAREl))),this.orientationModalEl=m(this.onModalClick),b.appendChild(this.orientationModalEl),this.updateEnterInterfaces())},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(S){S&&S.parentNode&&S.parentNode.removeChild(S)}),this.enterVREl=void 0,this.enterAREl=void 0,this.orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleEnterARButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var S=this.el;!this.enterVREl||(S.is("vr-mode")||(S.isMobile||v.device.isMobileDeviceRequestingDesktopSite())&&!this.data.cardboardModeEnabled&&!v.device.checkVRSupport()?this.enterVREl.classList.add(c):(v.device.checkVRSupport()||this.enterVREl.classList.add("fullscreen"),this.enterVREl.classList.remove(c),S.enterVR(!1,!0)))},toggleEnterARButtonIfNeeded:function(){var S=this.el;!this.enterAREl||(S.is("vr-mode")||!v.device.checkARSupport()?this.enterAREl.classList.add(c):(this.enterAREl.classList.remove(c),S.enterVR(!0,!0)))},toggleOrientationModalIfNeeded:function(){var S=this.el,b=this.orientationModalEl;!b||!S.isMobile||(!v.device.isLandscape()&&S.is("vr-mode")?b.classList.remove(c):b.classList.add(c))}});function A(S){var b,L;return L=document.createElement("div"),L.classList.add(C),L.setAttribute(_.AFRAME_INJECTED,""),b=document.createElement("button"),b.className=u,b.setAttribute("title","Enter VR mode with a headset or fullscreen without"),b.setAttribute(_.AFRAME_INJECTED,""),v.device.isMobile()&&x(b),L.appendChild(b),b.addEventListener("click",function(M){S(),M.stopPropagation()}),L}function h(S,b){var L,M;return M=document.createElement("div"),M.classList.add(l),b&&M.classList.add("xr"),M.setAttribute(_.AFRAME_INJECTED,""),L=document.createElement("button"),L.className=p,L.setAttribute("title","Enter AR mode with a headset or handheld device."),L.setAttribute(_.AFRAME_INJECTED,""),v.device.isMobile()&&x(L),M.appendChild(L),L.addEventListener("click",function(F){S(),F.stopPropagation()}),M}function m(S){var b=document.createElement("div");b.className=g,b.classList.add(c),b.setAttribute(_.AFRAME_INJECTED,"");var L=document.createElement("button");return L.setAttribute(_.AFRAME_INJECTED,""),L.innerHTML="Exit VR",L.addEventListener("click",S),b.appendChild(L),b}function x(S){S.addEventListener("touchstart",function(){S.classList.remove("resethover")},{passive:!0}),S.addEventListener("touchend",function(){S.classList.add("resethover")},{passive:!0})}},"./src/components/shadow.js":(k,K,f)=>{var y=f("./src/core/component.js"),_=f("./src/lib/three.js"),v=y.registerComponent;k.exports.Component=v("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=this.update.bind(this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var C=this.data;this.updateDescendants(C.cast,C.receive)},remove:function(){var C=this.el;C.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(C,l){var u=this.el.sceneEl;this.el.object3D.traverse(function(p){if(p instanceof _.Mesh&&(p.castShadow=C,p.receiveShadow=l,u.hasLoaded&&p.material))for(var c=Array.isArray(p.material)?p.material:[p.material],g=0;g<c.length;g++)c[g].needsUpdate=!0})}})},"./src/components/sound.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/utils/debug.js"),v=f("./src/lib/three.js"),C=_("components:sound:warn");k.exports.Component=y("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},loopStart:{default:0},loopEnd:{default:0},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var l=this;this.listener=null,this.audioLoader=new v.AudioLoader,this.pool=new v.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){l.playSound()}},update:function(l){var u=this.data,p,c,g=u.src!==l.src;if(g){if(!u.src)return;this.setupSound()}for(p=0;p<this.pool.children.length;p++)c=this.pool.children[p],u.positional&&(c.setDistanceModel(u.distanceModel),c.setMaxDistance(u.maxDistance),c.setRefDistance(u.refDistance),c.setRolloffFactor(u.rolloffFactor)),c.setLoop(u.loop),c.setLoopStart(u.loopStart),u.loopStart!==0&&u.loopEnd===0?c.setLoopEnd(c.buffer.duration):c.setLoopEnd(u.loopEnd),c.setVolume(u.volume),c.isPaused=!1;if(u.on!==l.on&&this.updateEventListener(l.on),g){var A=this;this.loaded=!1,this.audioLoader.load(u.src,function(h){for(p=0;p<A.pool.children.length;p++)c=A.pool.children[p],c.setBuffer(h);A.loaded=!0,v.Cache.remove(u.src),(A.data.autoplay||A.mustPlay)&&A.playSound(A.processSound),A.el.emit("sound-loaded",A.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var l,u;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(l=0;l<this.pool.children.length;l++)u=this.pool.children[l],u.disconnect()}catch(p){C("Audio source not properly disconnected")}},updateEventListener:function(l){var u=this.el;l&&u.removeEventListener(l,this.playSoundBound),u.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var l=this.el,u,p=l.sceneEl,c=this,g;this.pool.children.length>0&&(this.stopSound(),l.removeObject3D("sound"));var A=this.listener=p.audioListener||new v.AudioListener;for(p.audioListener=A,p.camera&&p.camera.add(A),p.addEventListener("camera-set-active",function(h){h.detail.cameraEl.getObject3D("camera").add(A)}),this.pool=new v.Group,u=0;u<this.data.poolSize;u++)g=this.data.positional?new v.PositionalAudio(A):new v.Audio(A),this.pool.add(g);for(l.setObject3D(this.attrName,this.pool),u=0;u<this.pool.children.length;u++)g=this.pool.children[u],g.onEnded=function(){this.isPlaying=!1,c.el.emit("sound-ended",c.evtDetail,!1)}},pauseSound:function(){var l,u;for(this.isPlaying=!1,l=0;l<this.pool.children.length;l++)u=this.pool.children[l],!(!u.source||!u.source.buffer||!u.isPlaying||u.isPaused)&&(u.isPaused=!0,u.pause())},playSound:function(l){var u,p,c;if(!this.loaded){C("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0,this.processSound=l;return}for(u=!1,this.isPlaying=!0,p=0;p<this.pool.children.length;p++)if(c=this.pool.children[p],!c.isPlaying&&c.buffer&&!u){l&&l(c),c.play(),c.isPaused=!1,u=!0;continue}if(!u){C("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=!1,this.processSound=void 0},stopSound:function(){var l,u;for(this.isPlaying=!1,l=0;l<this.pool.children.length;l++){if(u=this.pool.children[l],!u.source||!u.source.buffer)return;u.stop()}}})},"./src/components/text.js":(k,K,f)=>{var y=f("./node_modules/three-bmfont-text/index.js"),_=f("./node_modules/load-bmfont/browser.js"),v=f("./src/core/component.js").registerComponent,C=f("./src/core/shader.js"),l=f("./src/lib/three.js"),u=f("./src/utils/index.js"),p=u.debug("components:text:error"),c=C.shaders,g=u.debug("components:text:warn"),A=1,h=16,m=f("./src/constants/index.js").AFRAME_CDN_ROOT,x=m+"fonts/",S={aileronsemibold:x+"Aileron-Semibold.fnt",dejavu:x+"DejaVu-sdf.fnt",exo2bold:x+"Exo2Bold.fnt",exo2semibold:x+"Exo2SemiBold.fnt",kelsonsans:x+"KelsonSans.fnt",monoid:x+"Monoid.fnt",mozillavr:x+"mozillavr.fnt",roboto:x+"Roboto-msdf.json",sourcecodepro:x+"SourceCodePro.fnt"},b=["roboto"],L="roboto";k.exports.FONTS=S;var M=new Z,F={},H={},Y=/^\w+:/;k.exports.Component=v("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:L},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:c},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=y(),this.createOrUpdateMaterial(),this.explicitGeoDimensionsChecked=!1},update:function(ne){var pe=this.data,be=this.currentFont;if(H[pe.font]?this.texture=H[pe.font]:(this.texture=H[pe.font]=new l.Texture,this.texture.anisotropy=h),this.createOrUpdateMaterial(),ne.font!==pe.font){this.updateFont();return}be&&(this.updateGeometry(this.geometry,be),this.updateLayout())},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var ne=this.data,pe,be=this.material,Re,Ue=this.shaderData,je;if(je=ne.shader,b.indexOf(ne.font)!==-1||ne.font.indexOf("-msdf.")>=0?je="msdf":ne.font in S&&b.indexOf(ne.font)===-1&&(je="sdf"),pe=(this.shaderObject&&this.shaderObject.name)!==je,Ue.alphaTest=ne.alphaTest,Ue.color=ne.color,Ue.map=this.texture,Ue.opacity=ne.opacity,Ue.side=W(ne.side),Ue.transparent=ne.transparent,Ue.negate=ne.negate,!pe){this.shaderObject.update(Ue),be.transparent=Ue.transparent,be.side=Ue.side;return}Re=X(this.el,je,Ue),this.material=Re.material,this.shaderObject=Re.shader,this.material.side=Ue.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var ne=this.data,pe=this.el,be,Re=this.geometry,Ue=this;ne.font||g("No font specified. Using the default font."),this.mesh&&(this.mesh.visible=!1),be=this.lookupFont(ne.font||L)||ne.font,M.get(be,function(){return te(be,ne.yOffset)}).then(function(nt){var mt;if(nt.pages.length!==1)throw new Error("Currently only single-page bitmap fonts are supported.");F[be]||(nt.widthFactor=F[nt]=O(nt)),Ue.currentFont=nt,mt=Ue.getFontImageSrc(),M.get(mt,function(){return re(mt)}).then(function(Dt){var pt=Ue.texture;!pt||(pt.image=Dt,pt.needsUpdate=!0,H[ne.font]=pt,Ue.texture=pt,Ue.initMesh(),Ue.currentFont=nt,Ue.updateGeometry(Re,nt),Ue.updateLayout(),Ue.mesh.visible=!0,pe.emit("textfontset",{font:ne.font,fontObj:nt}))}).catch(function(Dt){p(Dt.message),p(Dt.stack)})}).catch(function(je){p(je.message),p(je.stack)})},initMesh:function(){this.mesh||(this.mesh=new l.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh))},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var ne=this.lookupFont(this.data.font||L)||this.data.font,pe=this.currentFont.pages[0];return pe.match(Y)&&pe.indexOf("http")!==0?ne.replace(/(\.fnt)|(\.json)/,".png"):l.LoaderUtils.extractUrlBase(ne)+pe},updateLayout:function(){var ne,pe,be=this.el,Re=this.data,Ue=this.geometry,je,nt,mt,Dt=this.mesh,pt,Tt,kt,un,yn;if(!(!Dt||!Ue.layout)){if(je=be.getAttribute("geometry"),kt=Re.width||je&&je.width||A,pt=V(Re.wrapPixels,Re.wrapCount,this.currentFont.widthFactor),Tt=kt/pt,mt=Ue.layout,nt=Tt*(mt.height+mt.descender),je&&je.primitive==="plane"&&(this.explicitGeoDimensionsChecked||(this.explicitGeoDimensionsChecked=!0,this.hasExplicitGeoWidth=!!je.width,this.hasExplicitGeoHeight=!!je.height),this.hasExplicitGeoWidth||be.setAttribute("geometry","width",kt),this.hasExplicitGeoHeight||be.setAttribute("geometry","height",nt)),ne=Re.anchor==="align"?Re.align:Re.anchor,ne==="left")un=0;else if(ne==="right")un=-1*mt.width;else if(ne==="center")un=-1*mt.width/2;else throw new TypeError("Invalid text.anchor property value",ne);if(pe=Re.baseline,pe==="bottom")yn=0;else if(pe==="top")yn=-1*mt.height+mt.ascender;else if(pe==="center")yn=-1*mt.height/2;else throw new TypeError("Invalid text.baseline property value",pe);Dt.position.x=un*Tt+Re.xOffset,Dt.position.y=yn*Tt,Dt.position.z=Re.zOffset,Dt.scale.set(Tt,-1*Tt,Tt)}},lookupFont:function(ne){return S[ne]},updateGeometry:function(){var ne={},pe={},be=/\\n/g,Re=/\\t/g;return function(Ue,je){var nt=this.data;pe.font=je,pe.lineHeight=nt.lineHeight&&isFinite(nt.lineHeight)?nt.lineHeight:je.common.lineHeight,pe.text=nt.value.toString().replace(be,`
`).replace(Re,"	"),pe.width=V(nt.wrapPixels,nt.wrapCount,je.widthFactor),Ue.update(u.extend(ne,nt,pe))}}()});function W(ne){switch(ne){case"back":return l.FrontSide;case"double":return l.DoubleSide;default:return l.BackSide}}function te(ne,pe){return new Promise(function(be,Re){_(ne,function(Ue,je){if(Ue){p("Error loading font",ne),Re(Ue);return}ne.indexOf("/Roboto-msdf.json")>=0&&(pe=30),pe&&je.chars.map(function(mt){mt.yoffset+=pe}),be(je)})})}function re(ne){return new Promise(function(pe,be){new l.ImageLoader().load(ne,function(Re){pe(Re)},void 0,function(){p("Error loading font image",ne),be(null)})})}function X(ne,pe,be){var Re,Ue;return Ue=new c[pe].Shader,Ue.el=ne,Ue.init(be),Ue.update(be),Re=Ue.material,Re.transparent=be.transparent,{material:Re,shader:Ue}}function V(ne,pe,be){return ne||(.5+pe)*be}function O(ne){var pe=0,be=0,Re=0;return ne.chars.map(function(Ue){pe+=Ue.xadvance,Ue.id>=48&&Ue.id<=57&&(Re++,be+=Ue.xadvance)}),Re?be/Re:pe/ne.chars.length}function Z(){var ne=this.cache={};this.get=function(pe,be){return pe in ne||(ne[pe]=be()),ne[pe]}}},"./src/components/tracked-controls-webvr.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/utils/tracked-controls.js"),v=f("./src/constants/index.js").DEFAULT_CAMERA_HEIGHT,C=f("./src/lib/three.js"),l=f("./src/constants/index.js").DEFAULT_HANDEDNESS,u={x:.175,y:-.3,z:-.03},p={x:0,y:0,z:-.175},c={touches:[]},g={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};k.exports.Component=y("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new C.Vector3,this.controllerQuaternion=new C.Quaternion,this.controllerEuler=new C.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(A,h){var m=this.el.getObject3D("mesh");m&&m.update&&m.update(h/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return v},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var A=this.data,h=_.findMatchingControllerWebVR(this.system.controllers,A.id,A.idPrefix,A.hand,A.controller);this.controller=h,this.el.components["tracked-controls"].controller=h,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(A){var h=this.controller,m=this.controllerEuler,x=this.controllerQuaternion,S=this.deltaControllerPosition,b,L,M,F,H;L=this.getHeadElement(),M=L.object3D,H=this.defaultUserHeight(),F=h.pose,b=(h?h.hand:void 0)||l,A.copy(M.position),S.set(u.x*(b==="left"?-1:b==="right"?1:0),u.y,u.z),S.multiplyScalar(H),S.applyAxisAngle(M.up,M.rotation.y),A.add(S),S.set(p.x,p.y,p.z),S.multiplyScalar(H),F.orientation?x.fromArray(F.orientation):x.copy(M.quaternion),m.setFromQuaternion(x),m.set(m.x,m.y,0),S.applyEuler(m),A.add(S)},updatePose:function(){var A=this.controller,h=this.data,m=this.el.object3D,x,S=this.system.vrDisplay,b;!A||(x=A.pose,x.position?m.position.fromArray(x.position):h.armModel&&this.applyArmModel(m.position),x.orientation&&m.quaternion.fromArray(x.orientation),S&&x.position&&(b=this.el.sceneEl.renderer.xr.getStandingMatrix(),m.matrix.compose(m.position,m.quaternion,m.scale),m.matrix.multiplyMatrices(b,m.matrix),m.matrix.decompose(m.position,m.quaternion,m.scale)),m.rotateX(this.data.orientationOffset.x*C.MathUtils.DEG2RAD),m.rotateY(this.data.orientationOffset.y*C.MathUtils.DEG2RAD),m.rotateZ(this.data.orientationOffset.z*C.MathUtils.DEG2RAD))},updateButtons:function(){var A,h=this.controller,m;if(!!h){for(m=0;m<h.buttons.length;++m)this.buttonStates[m]||(this.buttonStates[m]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[m]||(this.buttonEventDetails[m]={id:m,state:this.buttonStates[m]}),A=h.buttons[m],this.handleButton(m,A);this.handleAxes()}},handleButton:function(A,h){var m;return m=this.handlePress(A,h)|this.handleTouch(A,h)|this.handleValue(A,h),m?(this.el.emit(g.BUTTONCHANGED,this.buttonEventDetails[A],!1),!0):!1},handleAxes:function(){var A=!1,h=this.controller.axes,m,x=this.axis,S=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),m=0;m<h.length;++m)S.push(x[m]!==h[m]),S[m]&&(A=!0);if(!A)return!1;for(this.axis.splice(0,this.axis.length),m=0;m<h.length;m++)this.axis.push(h[m]);return this.el.emit(g.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(A,h){var m,x=this.buttonStates[A];return h.pressed===x.pressed?!1:(m=h.pressed?g.BUTTONDOWN:g.BUTTONUP,this.el.emit(m,this.buttonEventDetails[A],!1),x.pressed=h.pressed,!0)},handleTouch:function(A,h){var m,x=this.buttonStates[A];return h.touched===x.touched?!1:(m=h.touched?g.TOUCHSTART:g.TOUCHEND,this.el.emit(m,this.buttonEventDetails[A],!1,c),x.touched=h.touched,!0)},handleValue:function(A,h){var m=this.buttonStates[A];return h.value===m.value?!1:(m.value=h.value,!0)}})},"./src/components/tracked-controls-webxr.js":(k,K,f)=>{var y=f("./src/utils/tracked-controls.js"),_=f("./src/core/component.js").registerComponent,v={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};k.exports.Component=_("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"gripSpace"}},init:function(){this.updateController=this.updateController.bind(this),this.buttonEventDetails={},this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.changedAxes=[],this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var C=this.el.sceneEl;this.updateController(),C.addEventListener("controllersupdated",this.updateController)},pause:function(){var C=this.el.sceneEl;C.removeEventListener("controllersupdated",this.updateController)},isControllerPresent:function(C){return!(!this.controller||this.controller.gamepad||C.inputSource.handedness!=="none"&&C.inputSource.handedness!==this.data.hand)},updateController:function(){this.controller=y.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var C=this.el.sceneEl,l=this.controller,u=C.frame;!l||!C.frame||!this.system.referenceSpace||l.hand||(this.pose=u.getPose(l[this.data.space],this.system.referenceSpace),this.updatePose(),this.updateButtons())},updatePose:function(){var C=this.el.object3D,l=this.pose;!l||(C.matrix.elements=l.transform.matrix,C.matrix.decompose(C.position,C.rotation,C.scale))},updateButtons:function(){var C,l,u=this.controller,p;if(!(!u||!u.gamepad)){for(p=u.gamepad,l=0;l<p.buttons.length;++l)this.buttonStates[l]||(this.buttonStates[l]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[l]||(this.buttonEventDetails[l]={id:l,state:this.buttonStates[l]}),C=p.buttons[l],this.handleButton(l,C);this.handleAxes()}},handleButton:function(C,l){var u;return u=this.handlePress(C,l)|this.handleTouch(C,l)|this.handleValue(C,l),u?(this.el.emit(v.BUTTONCHANGED,this.buttonEventDetails[C],!1),!0):!1},handleAxes:function(){var C=!1,l=this.controller.gamepad.axes,u,p=this.axis,c=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),u=0;u<l.length;++u)c.push(p[u]!==l[u]),c[u]&&(C=!0);if(!C)return!1;for(this.axis.splice(0,this.axis.length),u=0;u<l.length;u++)this.axis.push(l[u]);return this.el.emit(v.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(C,l){var u,p=this.buttonStates[C];return l.pressed===p.pressed?!1:(u=l.pressed?v.BUTTONDOWN:v.BUTTONUP,this.el.emit(u,this.buttonEventDetails[C],!1),p.pressed=l.pressed,!0)},handleTouch:function(C,l){var u,p=this.buttonStates[C];return l.touched===p.touched?!1:(u=l.touched?v.TOUCHSTART:v.TOUCHEND,this.el.emit(u,this.buttonEventDetails[C],!1),p.touched=l.touched,!0)},handleValue:function(C,l){var u=this.buttonStates[C];return l.value===u.value?!1:(u.value=l.value,!0)}})},"./src/components/tracked-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent;k.exports.Component=y("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1},space:{type:"string",oneOf:["targetRaySpace","gripSpace"],default:"targetRaySpace"}},after:["tracked-controls-webvr","tracked-controls-webxr"],update:function(){var _=this.data,v=this.el;v.sceneEl.hasWebXR?v.setAttribute("tracked-controls-webxr",{id:_.id,hand:_.hand,index:_.controller,iterateControllerProfiles:_.iterateControllerProfiles,handTrackingEnabled:_.handTrackingEnabled,space:_.space}):v.setAttribute("tracked-controls-webvr",_)}})},"./src/components/valve-index-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/lib/three.js"),v=f("./src/utils/tracked-controls.js"),C=v.checkControllerPresentAndSetup,l=v.emitIfAxesChanged,u=v.onButtonEvent,p=f("./src/constants/index.js").AFRAME_CDN_ROOT,c=p+"controllers/valve/index/valve-index-",g={left:c+"left.glb",right:c+"right.glb"},A="valve",h=f("./src/utils/index.js").device.isWebXRAvailable,m={left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}},x={left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}},S={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},b={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}},L=h?b:S,M=h?x:m;k.exports.Component=y("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},after:["tracked-controls"],mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var F=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(H){u(H.detail.id,"down",F)},this.onButtonUp=function(H){u(H.detail.id,"up",F)},this.onButtonTouchEnd=function(H){u(H.detail.id,"touchend",F)},this.onButtonTouchStart=function(H){u(H.detail.id,"touchstart",F)},this.previousButtonValues={},this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var F=this.el;F.addEventListener("buttonchanged",this.onButtonChanged),F.addEventListener("buttondown",this.onButtonDown),F.addEventListener("buttonup",this.onButtonUp),F.addEventListener("touchend",this.onButtonTouchEnd),F.addEventListener("touchstart",this.onButtonTouchStart),F.addEventListener("model-loaded",this.onModelLoaded),F.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var F=this.el;F.removeEventListener("buttonchanged",this.onButtonChanged),F.removeEventListener("buttondown",this.onButtonDown),F.removeEventListener("buttonup",this.onButtonUp),F.removeEventListener("touchend",this.onButtonTouchEnd),F.removeEventListener("touchstart",this.onButtonTouchStart),F.removeEventListener("model-loaded",this.onModelLoaded),F.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var F=this.data,H=F.hand==="right"?0:F.hand==="left"?1:2;C(this,A,{index:H,iterateControllerProfiles:!0,hand:F.hand})},injectTrackedControls:function(){var F=this.el,H=this.data;F.setAttribute("tracked-controls",{idPrefix:A,controller:H.hand==="right"?1:H.hand==="left"?0:2,hand:H.hand,orientationOffset:H.orientationOffset}),this.loadModel()},loadModel:function(){var F=this.data;!F.model||this.el.setAttribute("gltf-model",""+g[F.hand]+"")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(F){var H=this.mapping.buttons[F.detail.id],Y=this.buttonMeshes,W;!H||(H==="trigger"&&(W=F.detail.state.value,Y&&Y.trigger&&(Y.trigger.rotation.x=this.triggerOriginalRotationX-W*(Math.PI/40))),this.el.emit(H+"changed",F.detail.state))},onModelLoaded:function(F){var H,Y=F.detail.model,W=this;F.target!==this.el||!this.data.model||(H=this.buttonMeshes={},H.grip={left:Y.getObjectByName("leftgrip"),right:Y.getObjectByName("rightgrip")},H.menu=Y.getObjectByName("menubutton"),H.system=Y.getObjectByName("systembutton"),H.trackpad=Y.getObjectByName("touchpad"),H.trigger=Y.getObjectByName("trigger"),this.triggerOriginalRotationX=H.trigger.rotation.x,Object.keys(H).forEach(function(te){W.setButtonColor(te,W.data.buttonColor)}),Y.position.copy(M[this.data.hand]),Y.rotation.copy(L[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controls",model:this.data.model,rayOrigin:new _.Vector3(0,0,0)}))},onAxisMoved:function(F){l(this,this.mapping.axes,F)},updateModel:function(F,H){var Y,W;!this.data.model||(W=H.indexOf("touch")!==-1,!W&&(Y=H==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(F,Y)))},setButtonColor:function(F,H){}})},"./src/components/visible.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent;k.exports.Component=y("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},"./src/components/vive-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/utils/tracked-controls.js"),v=_.checkControllerPresentAndSetup,C=_.emitIfAxesChanged,l=_.onButtonEvent,u=f("./src/constants/index.js").AFRAME_CDN_ROOT,p=u+"controllers/vive/vr_controller_vive.obj",c=u+"controllers/vive/vr_controller_vive.mtl",g=f("./src/utils/index.js").device.isWebXRAvailable,A="htc-vive",h="OpenVR ",m=g?A:h,x={axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},S={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","none"]},b=g?S:x;k.exports.Component=y("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},after:["tracked-controls"],mapping:b,init:function(){var L=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(M){l(M.detail.id,"down",L)},this.onButtonUp=function(M){l(M.detail.id,"up",L)},this.onButtonTouchEnd=function(M){l(M.detail.id,"touchend",L)},this.onButtonTouchStart=function(M){l(M.detail.id,"touchstart",L)},this.previousButtonValues={},this.bindMethods()},update:function(){var L=this.data;this.controllerIndex=L.hand==="right"?0:L.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},addEventListeners:function(){var L=this.el;L.addEventListener("buttonchanged",this.onButtonChanged),L.addEventListener("buttondown",this.onButtonDown),L.addEventListener("buttonup",this.onButtonUp),L.addEventListener("touchend",this.onButtonTouchEnd),L.addEventListener("touchstart",this.onButtonTouchStart),L.addEventListener("model-loaded",this.onModelLoaded),L.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var L=this.el;L.removeEventListener("buttonchanged",this.onButtonChanged),L.removeEventListener("buttondown",this.onButtonDown),L.removeEventListener("buttonup",this.onButtonUp),L.removeEventListener("touchend",this.onButtonTouchEnd),L.removeEventListener("touchstart",this.onButtonTouchStart),L.removeEventListener("model-loaded",this.onModelLoaded),L.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var L=this.data;v(this,m,{index:this.controllerIndex,hand:L.hand})},injectTrackedControls:function(){var L=this.el,M=this.data;L.setAttribute("tracked-controls",{idPrefix:m,hand:M.hand,controller:this.controllerIndex,orientationOffset:M.orientationOffset}),!!this.data.model&&this.el.setAttribute("obj-model",{obj:p,mtl:c})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(L){var M=this.mapping.buttons[L.detail.id],F=this.buttonMeshes,H;!M||(M==="trigger"&&(H=L.detail.state.value,F&&F.trigger&&(F.trigger.rotation.x=-H*(Math.PI/12))),this.el.emit(M+"changed",L.detail.state))},onModelLoaded:function(L){var M,F=L.detail.model,H=this;L.target!==this.el||!this.data.model||(M=this.buttonMeshes={},M.grip={left:F.getObjectByName("leftgrip"),right:F.getObjectByName("rightgrip")},M.menu=F.getObjectByName("menubutton"),M.system=F.getObjectByName("systembutton"),M.trackpad=F.getObjectByName("touchpad"),M.touchpad=F.getObjectByName("touchpad"),M.trigger=F.getObjectByName("trigger"),Object.keys(M).forEach(function(Y){H.setButtonColor(Y,H.data.buttonColor)}),F.position.set(0,-.015,.04))},onAxisMoved:function(L){C(this,this.mapping.axes,L)},updateModel:function(L,M){var F,H;!this.data.model||(H=M.indexOf("touch")!==-1,!H&&(F=M==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(L,F)))},setButtonColor:function(L,M){var F=this.buttonMeshes;if(!!F){if(L==="grip"){F.grip.left.material.color.set(M),F.grip.right.material.color.set(M);return}F[L].material.color.set(M)}}})},"./src/components/vive-focus-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/utils/tracked-controls.js"),v=_.checkControllerPresentAndSetup,C=_.emitIfAxesChanged,l=_.onButtonEvent,u=f("./src/constants/index.js").AFRAME_CDN_ROOT,p=u+"controllers/vive/focus-controller/focus-controller.gltf",c=f("./src/utils/index.js").device.isWebXRAvailable,g="htc-vive-focus",A="HTC Vive Focus ",h=c?g:A,m={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},x={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad","none","menu"]},S=c?x:m;k.exports.Component=y("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},after:["tracked-controls"],mapping:S,bindMethods:function(){this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.removeControllersUpdateListener=this.removeControllersUpdateListener.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var b=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(L){l(L.detail.id,"down",b)},this.onButtonUp=function(L){l(L.detail.id,"up",b)},this.onButtonTouchStart=function(L){l(L.detail.id,"touchstart",b)},this.onButtonTouchEnd=function(L){l(L.detail.id,"touchend",b)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var b=this.el;b.addEventListener("buttonchanged",this.onButtonChanged),b.addEventListener("buttondown",this.onButtonDown),b.addEventListener("buttonup",this.onButtonUp),b.addEventListener("touchstart",this.onButtonTouchStart),b.addEventListener("touchend",this.onButtonTouchEnd),b.addEventListener("model-loaded",this.onModelLoaded),b.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var b=this.el;b.removeEventListener("buttonchanged",this.onButtonChanged),b.removeEventListener("buttondown",this.onButtonDown),b.removeEventListener("buttonup",this.onButtonUp),b.removeEventListener("touchstart",this.onButtonTouchStart),b.removeEventListener("touchend",this.onButtonTouchEnd),b.removeEventListener("model-loaded",this.onModelLoaded),b.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){v(this,h,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var b=this.el,L=this.data;b.setAttribute("tracked-controls",{armModel:L.armModel,idPrefix:h,orientationOffset:L.orientationOffset}),!!this.data.model&&this.el.setAttribute("gltf-model",p)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(b){var L=b.detail.model,M;b.target!==this.el||!this.data.model||(M=this.buttonMeshes={},M.trigger=L.getObjectByName("BumperKey"),M.triggerPressed=L.getObjectByName("BumperKey_Press"),M.triggerPressed&&(M.triggerPressed.visible=!1),M.trackpad=L.getObjectByName("TouchPad"),M.trackpadPressed=L.getObjectByName("TouchPad_Press"),M.trackpadPressed&&(M.trackpadPressed.visible=!1))},onButtonChanged:function(b){var L=this.mapping.buttons[b.detail.id];!L||this.el.emit(L+"changed",b.detail.state)},onAxisMoved:function(b){C(this,this.mapping.axes,b)},updateModel:function(b,L){!this.data.model||this.updateButtonModel(b,L)},updateButtonModel:function(b,L){var M=this.buttonMeshes,F=b+"Pressed";if(!(!M||!M[b]||!M[F])){var H;switch(L){case"down":H=this.data.buttonHighlightColor;break;case"touchstart":H=this.data.buttonTouchedColor;break}H&&M[F].material.color.set(H),M[F].visible=!!H,M[b].visible=!H}}})},"./src/components/wasd-controls.js":(k,K,f)=>{var y=f("./src/constants/index.js").keyboardevent.KEYCODE_TO_CODE,_=f("./src/core/component.js").registerComponent,v=f("./src/lib/three.js"),C=f("./src/utils/index.js"),l=C.shouldCaptureKeyEvent,u=1e-5,p=.2,c=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];k.exports.Component=_("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},after:["look-controls"],init:function(){this.keys={},this.easing=1.1,this.velocity=new v.Vector3,this.onBlur=this.onBlur.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onFocus=this.onFocus.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onVisibilityChange=this.onVisibilityChange.bind(this),this.attachVisibilityEventListeners()},tick:function(A,h){var m=this.data,x=this.el,S=this.velocity;!S[m.adAxis]&&!S[m.wsAxis]&&g(this.keys)||(h=h/1e3,this.updateVelocity(h),!(!S[m.adAxis]&&!S[m.wsAxis])&&x.object3D.position.add(this.getMovementVector(h)))},update:function(A){A.adAxis!==this.data.adAxis&&(this.velocity[A.adAxis]=0),A.wsAxis!==this.data.wsAxis&&(this.velocity[A.wsAxis]=0)},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(A){var h,m,x,S=this.data,b=this.keys,L=this.velocity,M,F;if(m=S.adAxis,M=S.wsAxis,A>p){L[m]=0,L[M]=0;return}var H=Math.pow(1/this.easing,A*60);L[m]!==0&&(L[m]=L[m]*H),L[M]!==0&&(L[M]=L[M]*H),Math.abs(L[m])<u&&(L[m]=0),Math.abs(L[M])<u&&(L[M]=0),!!S.enabled&&(h=S.acceleration,S.adEnabled&&(x=S.adInverted?-1:1,(b.KeyA||b.ArrowLeft)&&(L[m]-=x*h*A),(b.KeyD||b.ArrowRight)&&(L[m]+=x*h*A)),S.wsEnabled&&(F=S.wsInverted?-1:1,(b.KeyW||b.ArrowUp)&&(L[M]-=F*h*A),(b.KeyS||b.ArrowDown)&&(L[M]+=F*h*A)))},getMovementVector:function(){var A=new v.Vector3(0,0,0),h=new v.Euler(0,0,0,"YXZ");return function(m){var x=this.el.getAttribute("rotation"),S=this.velocity,b;return A.copy(S),A.multiplyScalar(m),x&&(b=this.data.fly?x.x:0,h.set(v.MathUtils.degToRad(b),v.MathUtils.degToRad(x.y),0),A.applyEuler(h)),A}}(),attachVisibilityEventListeners:function(){window.oncontextmenu=this.onContextMenu,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onContextMenu:function(){for(var A=Object.keys(this.keys),h=0;h<A.length;h++)delete this.keys[A[h]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(A){var h;!l(A)||(h=A.code||y[A.keyCode],c.indexOf(h)!==-1&&(this.keys[h]=!0))},onKeyUp:function(A){var h;h=A.code||y[A.keyCode],delete this.keys[h]}});function g(A){var h;for(h in A)return!1;return!0}},"./src/components/windows-motion-controls.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/utils/tracked-controls.js"),v=_.checkControllerPresentAndSetup,C=_.emitIfAxesChanged,l=_.onButtonEvent,u=f("./src/utils/index.js"),p=u.debug("components:windows-motion-controls:debug"),c=u.debug("components:windows-motion-controls:warn"),g=f("./src/constants/index.js").DEFAULT_HANDEDNESS,A=f("./src/constants/index.js").AFRAME_CDN_ROOT,h=A+"controllers/microsoft/",m={left:"left.glb",right:"right.glb",default:"universal.glb"},x=f("./src/utils/index.js").device.isWebXRAvailable,S="windows-mixed-reality",b="Spatial Controller (Spatial Interaction Source) ",L=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,M=x?S:b,F={axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},H={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},Y=x?H:F;k.exports.Component=y("windows-motion-controls",{schema:{hand:{default:g},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},after:["tracked-controls"],mapping:Y,bindMethods:function(){this.onModelError=this.onModelError.bind(this),this.onModelLoaded=this.onModelLoaded.bind(this),this.onControllersUpdate=this.onControllersUpdate.bind(this),this.checkIfControllerPresent=this.checkIfControllerPresent.bind(this),this.onAxisMoved=this.onAxisMoved.bind(this)},init:function(){var W=this,te=this.el;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(re){l(re.detail.id,"down",W)},this.onButtonUp=function(re){l(re.detail.id,"up",W)},this.onButtonTouchStart=function(re){l(re.detail.id,"touchstart",W)},this.onButtonTouchEnd=function(re){l(re.detail.id,"touchend",W)},this.onControllerConnected=function(){W.setModelVisibility(!0)},this.onControllerDisconnected=function(){W.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},te.addEventListener("controllerconnected",this.onControllerConnected),te.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var W=this.el;W.addEventListener("buttonchanged",this.onButtonChanged),W.addEventListener("buttondown",this.onButtonDown),W.addEventListener("buttonup",this.onButtonUp),W.addEventListener("touchstart",this.onButtonTouchStart),W.addEventListener("touchend",this.onButtonTouchEnd),W.addEventListener("axismove",this.onAxisMoved),W.addEventListener("model-error",this.onModelError),W.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var W=this.el;W.removeEventListener("buttonchanged",this.onButtonChanged),W.removeEventListener("buttondown",this.onButtonDown),W.removeEventListener("buttonup",this.onButtonUp),W.removeEventListener("touchstart",this.onButtonTouchStart),W.removeEventListener("touchend",this.onButtonTouchEnd),W.removeEventListener("axismove",this.onAxisMoved),W.removeEventListener("model-error",this.onModelError),W.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){v(this,M,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var W=this.createControllerModelUrl();this.loadModel(W)},createControllerModelUrl:function(W){var te=this.el.components["tracked-controls"],re=te?te.controller:null,X="default",V=this.data.hand,O;if(re&&!window.hasNativeWebXRImplementation&&(V=re.hand,!W)){var Z=re.id.match(L);X=Z&&Z[0]||X}return O=m[V]||m.default,h+X+"/"+O},injectTrackedControls:function(){var W=this.data;this.el.setAttribute("tracked-controls",{idPrefix:M,controller:W.pair,hand:W.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(W){var te=this.createControllerModelUrl(!0);W.detail.src!==te?(c("Failed to load controller model for device, attempting to load default."),this.loadModel(te)):c("Failed to load default controller model.")},loadModel:function(W){this.el.setAttribute("gltf-model","url("+W+")")},onModelLoaded:function(W){var te=this.controllerModel=W.detail.model,re=this.loadedMeshInfo,X,V,O,Z;if(W.target!==this.el)return;if(p("Processing model"),re.buttonMeshes={},re.axisMeshes={},te){for(X=0;X<this.mapping.buttons.length;X++){if(V=this.mapping.buttonMeshNames[this.mapping.buttons[X]],!V){p("Skipping unknown button at index: "+X+" with mapped name: "+this.mapping.buttons[X]);continue}if(O=te.getObjectByName(V),!O){c("Missing button mesh with name: "+V);continue}Z={index:X,value:ne(O,"VALUE"),pressed:ne(O,"PRESSED"),unpressed:ne(O,"UNPRESSED")},Z.value&&Z.pressed&&Z.unpressed?re.buttonMeshes[this.mapping.buttons[X]]=Z:c("Missing button submesh under mesh with name: "+V+"(VALUE: "+!!Z.value+", PRESSED: "+!!Z.pressed+", UNPRESSED:"+!!Z.unpressed+")")}for(X=0;X<this.mapping.axisMeshNames.length;X++){if(V=this.mapping.axisMeshNames[X],!V){p("Skipping unknown axis at index: "+X);continue}if(O=te.getObjectByName(V),!O){c("Missing axis mesh with name: "+V);continue}Z={index:X,value:ne(O,"VALUE"),min:ne(O,"MIN"),max:ne(O,"MAX")},Z.value&&Z.min&&Z.max?re.axisMeshes[X]=Z:c("Missing axis submesh under mesh with name: "+V+"(VALUE: "+!!Z.value+", MIN: "+!!Z.min+", MAX:"+!!Z.max+")")}this.calculateRayOriginFromMesh(te),this.setModelVisibility()}p("Model load complete.");function ne(pe,be){for(var Re=0,Ue=pe.children.length;Re<Ue;Re++){var je=pe.children[Re];if(je&&je.name===be)return je}}},calculateRayOriginFromMesh:function(){var W=new THREE.Quaternion;return function(te){var re;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,re=te.getObjectByName(this.mapping.pointingPoseMeshName),re){var X=te.parent;X&&(te.parent=null,te.updateMatrixWorld(!0),te.parent=X),re.getWorldPosition(this.rayOrigin.origin),re.getWorldQuaternion(W),this.rayOrigin.direction.applyQuaternion(W),X&&te.updateMatrixWorld(!0)}else p("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var W=new THREE.Quaternion;return function(te,re){var X=this.loadedMeshInfo.axisMeshes[te];if(!!X){var V=X.min,O=X.max,Z=X.value,ne=re*.5+.5;Z.setRotationFromQuaternion(W.copy(V.quaternion).slerp(O.quaternion,ne)),Z.position.lerpVectors(V.position,O.position,ne)}}}(),lerpButtonTransform:function(){var W=new THREE.Quaternion;return function(te,re){var X=this.loadedMeshInfo.buttonMeshes[te];if(!!X){var V=X.unpressed,O=X.pressed,Z=X.value;Z.setRotationFromQuaternion(W.copy(V.quaternion).slerp(O.quaternion,re)),Z.position.lerpVectors(V.position,O.position,re)}}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(W){var te=this.mapping.buttons[W.detail.id];te&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(te,W.detail.state.value),this.el.emit(te+"changed",W.detail.state))},onAxisMoved:function(W){var te=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var re=0;re<te;re++)this.lerpAxisTransform(re,W.detail.axis[re]||0);C(this,this.mapping.axes,W)},setModelVisibility:function(W){var te=this.el.getObject3D("mesh");!this.controllerPresent||(W=W!==void 0?W:this.modelVisible,this.modelVisible=W,!!te&&(te.visible=W))}})},"./src/constants/index.js":(k,K,f)=>{k.exports={AFRAME_CDN_ROOT:window.AFRAME_CDN_ROOT||"https://cdn.aframe.io/",AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:f("./src/constants/keyboardevent.js")}},"./src/constants/keyboardevent.js":k=>{k.exports={KEYCODE_TO_CODE:{"38":"ArrowUp","37":"ArrowLeft","40":"ArrowDown","39":"ArrowRight","87":"KeyW","65":"KeyA","83":"KeyS","68":"KeyD"}}},"./src/core/a-assets.js":(k,K,f)=>{var y=f("./src/core/a-node.js").ANode,_=f("./src/utils/debug.js"),v=f("./src/lib/three.js"),C=new v.FileLoader,l=_("core:a-assets:warn");class u extends y{constructor(){super();this.isAssets=!0,this.fileLoader=C,this.timeout=null}doConnectedCallback(){var b=this,L,M=[],F,H,Y,W,te,re;if(super.doConnectedCallback(),!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(W=this.querySelectorAll("img"),L=0;L<W.length;L++)Y=g(W[L]),M.push(new Promise(function(X,V){if(v.Cache.add(W[L].getAttribute("src"),Y),Y.complete){X();return}Y.onload=X,Y.onerror=V}));for(H=this.querySelectorAll("audio, video"),L=0;L<H.length;L++)F=g(H[L]),!F.src&&!F.srcObject&&l("Audio/video asset has neither `src` nor `srcObject` attributes."),M.push(c(F));re=this.getChildren(),re.forEach(function(X){!X.isAssetItem||!X.hasAttribute("src")||M.push(new Promise(function(O,Z){if(X.hasLoaded)return O();X.addEventListener("loaded",O),X.addEventListener("error",Z)}))}),Promise.allSettled(M).then(function(){b.timeout!==null&&b.load()}),te=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){b.hasLoaded||(l("Asset loading timed out in",te,"ms"),b.timeout=null,b.emit("timeout"),b.load())},te)}disconnectedCallback(){super.disconnectedCallback(),this.timeout&&clearTimeout(this.timeout)}load(){super.load.call(this,null,function(){return!1})}}customElements.define("a-assets",u);class p extends y{constructor(){super();this.data=null,this.isAssetItem=!0}connectedCallback(){var b=this,L=this.getAttribute("src");C.setResponseType(this.getAttribute("response-type")||m(L)),C.load(L,function(F){b.data=F,y.prototype.load.call(b)},function(F){b.emit("progress",{loadedBytes:F.loaded,totalBytes:F.total,xhr:F})},function(F){b.emit("error",{xhr:F})})}}customElements.define("a-asset-item",p);function c(S){if(!(!S.hasAttribute("autoplay")&&S.getAttribute("preload")!=="auto"))return new Promise(function(b,L){if(S.readyState===4)return b();if(S.error)return L();S.addEventListener("loadeddata",M,!1),S.addEventListener("progress",M,!1),S.addEventListener("error",L,!1);function M(){for(var F=0,H=0;H<S.buffered.length;H++)F+=S.buffered.end(H)-S.buffered.start(H);F>=S.duration&&(S.tagName==="VIDEO"&&v.Cache.add(S.getAttribute("src"),S),b())}})}function g(S){var b=A(S);return b.tagName&&b.tagName.toLowerCase()==="video"&&(b.setAttribute("playsinline",""),b.setAttribute("webkit-playsinline","")),b!==S&&(S.parentNode.appendChild(b),S.parentNode.removeChild(S)),b}function A(S){var b,L;return S.hasAttribute("crossorigin")||(L=S.getAttribute("src"),L!==null&&(L.indexOf("://")===-1||h(L)===window.location.host))?S:(l('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',L),S.crossOrigin="anonymous",b=S.cloneNode(!0),b)}function h(S){var b=S.indexOf("://")>-1?S.split("/")[2]:S.split("/")[0];return b.substring(0,b.indexOf(":"))}function m(S){var b=x(S),L=b.lastIndexOf(".");if(L>=0){var M=b.slice(L,S.search(/\?|#|$/));if(M===".glb")return"arraybuffer"}return"text"}k.exports.inferResponseType=m;function x(S){var b=document.createElement("a");b.href=S;var L=b.search.replace(/^\?/,""),M=S.replace(L,"").replace("?","");return M.substring(M.lastIndexOf("/")+1)}k.exports.getFileNameFromURL=x},"./src/core/a-cubemap.js":(k,K,f)=>{var y=f("./src/utils/debug.js"),_=y("core:cubemap:warn");class v extends HTMLElement{constructor(l){return l=super(l),l}onReadyStateChange(){document.readyState==="complete"&&this.doConnectedCallback()}connectedCallback(){if(document.readyState!=="complete"){document.addEventListener("readystatechange",this.onReadyStateChange.bind(this));return}v.prototype.doConnectedCallback.call(this)}doConnectedCallback(){this.srcs=this.validate()}validate(){var l=this.querySelectorAll("[src]"),u,p=[];if(l.length===6){for(u=0;u<l.length;u++)l[u].tagName==="IMG"?p.push(l[u]):p.push(l[u].getAttribute("src"));return p}_("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")}}customElements.define("a-cubemap",v)},"./src/core/a-entity.js":(k,K,f)=>{var y=f("./src/core/a-node.js").ANode,_=f("./src/core/component.js").components,v=f("./src/lib/three.js"),C=f("./src/utils/index.js"),l=C.debug("core:a-entity:debug"),u=C.debug("core:a-entity:warn"),p="__",c=["position","rotation","scale","visible"],g={once:!0};class A extends y{constructor(){super();this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new v.Group,this.object3D.rotation.order="YXZ",this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}attributeChangedCallback(M,F,H){var Y=this.components[M];if(super.attributeChangedCallback(),Y&&Y.justInitialized&&H===""){delete Y.justInitialized;return}!Y&&H===null||this.setEntityAttribute(M,F,H)}doConnectedCallback(){var M=this,F,H;if(super.doConnectedCallback(),H=this.sceneEl,this.addToParent(),!this.isScene){if(!H){this.load();return}if(F=H.querySelector("a-assets"),F&&!F.hasLoaded){F.addEventListener("loaded",function(){M.load()});return}this.load()}}disconnectedCallback(){var M;if(!!this.parentEl){for(M in this.components)this.removeComponent(M,!1);this.isScene||(this.removeFromParent(),super.disconnectedCallback(),this.object3D.el=null)}}getObject3D(M){return this.object3DMap[M]}setObject3D(M,F){var H,Y=this;if(!(F instanceof v.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");H=this.getObject3D(M),H&&this.object3D.remove(H),F.el=this,F.children.length&&F.traverse(function(te){te.el=Y}),this.object3D.add(F),this.object3DMap[M]=F,this.emit("object3dset",{object:F,type:M})}removeObject3D(M){var F=this.getObject3D(M);if(!F){u("Tried to remove `Object3D` of type:",M,"which was not defined.");return}this.object3D.remove(F),delete this.object3DMap[M],this.emit("object3dremove",{type:M})}getOrCreateObject3D(M,F){var H=this.getObject3D(M);return!H&&F&&(H=new F,this.setObject3D(M,H)),u("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),H}add(M){if(!M.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(M.object3D),this.emit("child-attached",{el:M})}addToParent(){var M=this.parentEl=this.parentNode;!M||!M.add||this.attachedToParent||(M.add(this),this.attachedToParent=!0)}removeFromParent(){var M=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,M.emit("child-detached",{el:this})}load(){var M=this;this.hasLoaded||!this.parentEl||super.load.call(this,function(){!M.parentEl||(M.updateComponents(),(M.isScene||M.parentEl.isPlaying)&&M.play())})}remove(M){M?this.object3D.remove(M.object3D):this.parentNode.removeChild(this)}getChildEntities(){for(var M=this.children,F=[],H=0;H<M.length;H++){var Y=M[H];Y instanceof A&&F.push(Y)}return F}initComponent(M,F,H){var Y,W,te,re,X;te=C.split(M,p),re=te[0],W=te.length>2?te.slice(1).join("__"):te[1],!!_[re]&&(X=h(this,M)||F!==void 0,!(!X&&!H)&&(M in this.components||(this.initComponentDependencies(re),Y=new _[re].Component(this,F,W),this.isPlaying&&Y.play(),this.hasAttribute(M)||(Y.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,M,"")),l("Component initialized: %s",M))))}initComponentDependencies(M){var F=this,H=_[M],Y,W;if(!!H&&(Y=_[M].dependencies,!!Y))for(W=0;W<Y.length;W++)F.initComponent(Y[W],window.HTMLElement.prototype.getAttribute.call(F,Y[W])||void 0,!0)}removeComponent(M,F){var H;if(H=this.components[M],!!H){if(!H.initialized){this.addEventListener("componentinitialized",function Y(W){W.detail.name===M&&(this.removeComponent(M,F),this.removeEventListener("componentinitialized",Y))});return}H.pause(),H.remove(),F&&(H.destroy(),delete this.components[M],this.hasAttribute(M)&&window.HTMLElement.prototype.removeAttribute.call(this,M)),this.emit("componentremoved",H.evtDetail,!1)}}updateComponents(){var M,F,H,Y,W=this.componentsToUpdate;if(!(!this.hasLoaded&&!this.isLoading)){for(H=0;H<this.mixinEls.length;H++)for(Y in this.mixinEls[H].componentCache)S(Y)&&(W[Y]=!0);if(this.getExtraComponents){F=this.getExtraComponents();for(Y in F)S(Y)&&(W[Y]=!0)}for(H=0;H<this.attributes.length;++H)Y=this.attributes[H].name,c.indexOf(Y)===-1&&S(Y)&&(W[Y]=!0);for(H=0;H<c.length;H++)Y=c[H],!!this.hasAttribute(Y)&&this.updateComponent(Y,this.getDOMAttribute(Y));for(Y in W)M=x(this.getDOMAttribute(Y),F&&F[Y]),this.updateComponent(Y,M),delete W[Y]}}updateComponent(M,F,H){var Y=this.components[M];if(Y){if(F===null&&!h(this,M)){this.removeComponent(M,!0);return}Y.updateProperties(F,H);return}this.initComponent(M,F,!1)}removeAttribute(M,F){var H=this.components[M];if(H&&F===void 0&&this.removeComponent(M,!0),H&&F!==void 0){H.resetProperty(F);return}M==="mixin"&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,M)}play(){var M,F,H;if(!(this.isPlaying||!this.hasLoaded&&!this.isLoading)){this.isPlaying=!0;for(H in this.components)this.components[H].play();for(M=this.getChildEntities(),F=0;F<M.length;F++)M[F].play();this.emit("play")}}pause(){var M,F,H;if(!!this.isPlaying){this.isPlaying=!1;for(H in this.components)this.components[H].pause();for(M=this.getChildEntities(),F=0;F<M.length;F++)M[F].pause();this.emit("pause")}}setEntityAttribute(M,F,H){if(_[M]||this.components[M]){this.updateComponent(M,H);return}if(M==="mixin"){if(H===this.computedMixinStr)return;this.mixinUpdate(H,F)}}mixinUpdate(M,F,H){var Y=A.componentsUpdated,W,te,re,X,V=this;if(H||(F=F||this.getAttribute("mixin")),!this.hasLoaded){this.addEventListener("loaded-private",function(){V.mixinUpdate(M,F,!0)},g);return}for(re=this.updateMixins(M,F),Y.length=0,X=0;X<this.mixinEls.length;X++)for(W in this.mixinEls[X].componentCache)Y.indexOf(W)===-1&&(this.components[W]?this.components[W].handleMixinUpdate():this.initComponent(W,null),Y.push(W));for(X=0;X<re.oldMixinIds.length;X++)if(te=document.getElementById(re.oldMixinIds[X]),!!te)for(W in te.componentCache)Y.indexOf(W)===-1&&this.components[W]&&(this.getDOMAttribute(W)?this.components[W].handleMixinUpdate():this.removeComponent(W,!0))}setAttribute(M,F,H){var Y=A.singlePropUpdate,W,te,re,X,V,O;if(X=M.indexOf(p),re=X>0?M.substring(0,X):M,!_[re]){M==="mixin"&&this.mixinUpdate(F),super.setAttribute.call(this,M,F);return}if(!this.components[M]&&this.hasAttribute(M)&&this.updateComponent(M,window.HTMLElement.prototype.getAttribute.call(this,M)),typeof H!="undefined"&&typeof F=="string"&&F.length>0&&typeof C.styleParser.parse(F)=="string"){for(O in Y)delete Y[O];W=Y,W[F]=H,te=!1}else W=F,te=H===!0;this.updateComponent(M,W,te),V=this.sceneEl&&this.sceneEl.getAttribute("debug"),V&&this.components[M].flushToDOM()}flushToDOM(M){var F=this.components,H,Y=this.children,W,te;for(te in F)F[te].flushToDOM();if(!!M)for(W=0;W<Y.length;++W)H=Y[W],!!H.flushToDOM&&H.flushToDOM(M)}getAttribute(M){var F;return M==="position"?this.object3D.position:M==="rotation"?b(this):M==="scale"?this.object3D.scale:M==="visible"?this.object3D.visible:(F=this.components[M],F?F.data:window.HTMLElement.prototype.getAttribute.call(this,M))}getDOMAttribute(M){var F=this.components[M];return F?F.attrValue:window.HTMLElement.prototype.getAttribute.call(this,M)}addState(M){this.is(M)||(this.states.push(M),this.emit("stateadded",M))}removeState(M){var F=this.states.indexOf(M);F!==-1&&(this.states.splice(F,1),this.emit("stateremoved",M))}is(M){return this.states.indexOf(M)!==-1}inspect(){this.sceneEl.components.inspector.openInspector(this)}destroy(){var M;if(this.parentNode){u("Entity can only be destroyed if detached from scenegraph.");return}for(M in this.components)this.components[M].destroy()}}function h(L,M){return L.components[M]&&L.components[M].attrValue?!0:m(M,L.mixinEls)}function m(L,M){var F,H=!1;for(F=0;F<M.length&&(H=M[F].hasAttribute(L),!H);++F);return H}function x(L,M){return M?M.constructor===Object?C.extend(M,C.styleParser.parse(L||{})):L||M:L}function S(L){return L.indexOf(p)!==-1&&(L=C.split(L,p)[0]),!!_[L]}function b(L){var M=v.MathUtils.radToDeg,F=L.object3D.rotation,H=L.rotationObj;return H.x=M(F.x),H.y=M(F.y),H.z=M(F.z),H}A.componentsUpdated=[],A.singlePropUpdate={},customElements.define("a-entity",A),k.exports.AEntity=A},"./src/core/a-mixin.js":(k,K,f)=>{var y=f("./src/core/a-node.js").ANode,_=f("./src/core/component.js").components,v=f("./src/utils/index.js"),C=v.styleParser,l="__";class u extends y{constructor(){super();this.componentCache={},this.rawAttributeCache={},this.isMixin=!0}doConnectedCallback(){super.doConnectedCallback(),this.sceneEl=this.closestScene(),this.id=this.getAttribute("id"),this.cacheAttributes(),this.updateEntities(),this.load()}attributeChangedCallback(c,g,A){super.attributeChangedCallback(),this.cacheAttribute(c,A),this.updateEntities()}setAttribute(c,g){window.HTMLElement.prototype.setAttribute.call(this,c,g),this.cacheAttribute(c,g)}cacheAttribute(c,g){var A,h;h=v.split(c,l)[0],A=_[h],g===void 0&&(g=window.HTMLElement.prototype.getAttribute.call(this,c)),this.rawAttributeCache[c]=g,!!A&&(this.componentCache[c]=this.parseComponentAttrValue(A,g))}parseComponentAttrValue(c,g){var A;return typeof g!="string"?g:(c.isSingleProperty?(A=c.schema.parse(g),typeof A=="string"&&(A=g)):A=C.parse(g),A)}getAttribute(c){return this.componentCache[c]||window.HTMLElement.prototype.getAttribute.call(this,c)}cacheAttributes(){var c=this.attributes,g,A;for(A=0;A<c.length;A++)g=c[A].name,this.cacheAttribute(g)}updateEntities(){var c,g,A;if(!!this.sceneEl)for(g=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),A=0;A<g.length;A++)c=g[A],!(!c.hasLoaded||c.isMixin)&&c.mixinUpdate(this.id)}}customElements.define("a-mixin",u)},"./src/core/a-node.js":(k,K,f)=>{var y=f("./src/utils/index.js"),_=f("./src/core/readyState.js"),v=y.debug("core:a-node:warn"),C={"a-scene":!0,"a-assets":!0,"a-assets-items":!0,"a-cubemap":!0,"a-mixin":!0,"a-node":!0,"a-entity":!0};function l(p){return p.tagName.toLowerCase()in C||p.isNode}class u extends HTMLElement{constructor(){super();this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]}connectedCallback(){if(!_.canInitializeElements){document.addEventListener("aframeready",this.connectedCallback.bind(this));return}this.doConnectedCallback()}doConnectedCallback(){var c;this.sceneEl=this.closestScene(),this.sceneEl||v("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(c=this.getAttribute("mixin"),c&&this.updateMixins(c))}attributeChangedCallback(c,g,A){A!==this.computedMixinStr&&c==="mixin"&&!this.isMixin&&this.updateMixins(A,g)}closestScene(){for(var c=this;c&&!c.isScene;)c=c.parentElement;return c}closest(c){for(var g=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,A=this;A&&!g.call(A,c);)A=A.parentElement;return A}disconnectedCallback(){this.hasLoaded=!1}load(c,g){var A,h,m=this;this.hasLoaded||(g=g||l,A=this.getChildren(),h=A.filter(g).map(function(x){return new Promise(function(b,L){if(x.hasLoaded)return b();x.addEventListener("loaded",b),x.addEventListener("error",L)})}),Promise.allSettled(h).then(function(S){S.forEach(function(L){L.status==="rejected"&&v("Rendering scene with errors on node: ",L.reason.target)}),m.isLoading=!0,m.setupMutationObserver(),c&&c(),m.isLoading=!1,m.hasLoaded=!0,m.emit("loaded-private",void 0,!1),m.emit("loaded",void 0,!1)}))}setupMutationObserver(){var c=this,g={attributes:!0,attributeOldValue:!0},A=new MutationObserver(function(m){var x;for(x=0;x<m.length;x++)if(m[x].type==="attributes"){var S=m[x].attributeName,b=window.HTMLElement.prototype.getAttribute.call(c,S),L=m[x].oldValue;c.attributeChangedCallback(S,L,b)}});A.observe(this,g)}getChildren(){return Array.prototype.slice.call(this.children,0)}updateMixins(c,g){var A=u.newMixinIdArray,h=u.oldMixinIdArray,m=u.mixinIds,x,S,b;for(A.length=0,h.length=0,S=c?y.split(c.trim(),/\s+/):A,b=g?y.split(g.trim(),/\s+/):h,m.newMixinIds=S,m.oldMixinIds=b,x=0;x<b.length;x++)S.indexOf(b[x])===-1&&this.unregisterMixin(b[x]);for(this.computedMixinStr="",this.mixinEls.length=0,x=0;x<S.length;x++)this.registerMixin(S[x]);return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),S.length===0&&window.HTMLElement.prototype.removeAttribute.call(this,"mixin"),m}registerMixin(c){var g,A,h,m=document.getElementById(c);if(!m){v("No mixin was found with id `%s`",c);return}if(h=m.getAttribute("mixin"),h)for(g=y.split(h.trim(),/\s+/),A=0;A<g.length;A++)this.registerMixin(g[A]);this.computedMixinStr=this.computedMixinStr+" "+m.id,this.mixinEls.push(m)}setAttribute(c,g){c==="mixin"&&this.updateMixins(g),window.HTMLElement.prototype.setAttribute.call(this,c,g)}unregisterMixin(c){var g,A=this.mixinEls,h;for(g=0;g<A.length;++g)if(h=A[g],c===h.id){A.splice(g,1);break}}emit(c,g,A,h){var m=u.evtData;A===void 0&&(A=!0),m.bubbles=!!A,m.detail=g,h&&(m=y.extend({},h,m)),this.dispatchEvent(new CustomEvent(c,m))}}u.evtData={},u.newMixinIdArray=[],u.oldMixinIdArray=[],u.mixinIds={},customElements.define("a-node",u),k.exports.ANode=u,k.exports.knownTags=C},"./src/core/component.js":(k,K,f)=>{var y=f("./src/core/schema.js"),_=f("./src/core/scene/scenes.js"),v=f("./src/core/system.js"),C=f("./src/utils/index.js"),l=k.exports.components={},u=y.parseProperty,p=y.process,c=y.isSingleProperty,g=y.stringifyProperties,A=y.stringifyProperty,h=C.styleParser,m=C.debug("core:component:warn"),x=document.currentScript,S=new RegExp("[A-Z]+"),b={},L=Object.freeze({}),M=[],F={get:function(O,Z){return O.getComputedPropertyValue(Z)},set:function(O,Z,ne){return Z in O.schema?O.recomputeProperty(Z,ne):ne!==void 0&&O.handleUnknownProperty(Z,ne),!0}},H=k.exports.Component=function(O,Z,ne){var pe=this;if(this.sceneOnly&&!O.isScene)throw new Error("Component `"+this.name+"` can only be applied to <a-scene>");if(ne&&!this.multiple)throw new Error("Trying to initialize multiple components of type `"+this.name+"`. There can only be one component of this type per entity.");this.el=O,this.id=ne,this.attrName=this.name+(ne?"__"+ne:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.el.components[this.attrName]=this,this.objectPool=b[this.name];var be=this.events;this.events={},Y(this,be),this.attrValue=void 0,this.isObjectBased?(this.data=this.objectPool.use(),C.objectPool.removeUnusedKeys(this.data,this.schema),this.oldData=this.objectPool.use(),C.objectPool.removeUnusedKeys(this.oldData,this.schema),this.attrValueProxy=new Proxy(this,F)):(this.data=void 0,this.oldData=void 0,this.attrValueProxy=void 0),this.deferUnknownPropertyWarnings=!!this.updateSchema,this.silenceUnknownPropertyWarnings=!1,this.throttledEmitComponentChanged=C.throttleLeadingAndTrailing(function(){O.emit("componentchanged",pe.evtDetail,!1)},200),this.updateProperties(Z,!0)};H.prototype={schema:{},init:function(){},events:{},update:function(O){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},stringify:function(O){var Z=this.schema;return typeof O=="string"?O:this.isSingleProperty?A(O,Z):(O=g(O,Z),h.stringify(O))},flushToDOM:function(O){var Z=O?this.data:this.attrValue;Z!=null&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(Z))},updateProperties:function(O,Z){var ne=this.el;this.updateData(O,Z),!(!ne.hasLoaded&&!ne.isLoading)&&(this.initialized?this.callUpdateHandler():this.initComponent())},initComponent:function(){var O=this.el,Z;O.initializingComponents[this.name]||(O.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete O.initializingComponents[this.name],Z=this.isObjectBased?L:void 0,this.dataChanged=!1,this.storeOldData(),this.update(Z),O.isPlaying&&this.play(),O.emit("componentinitialized",this.evtDetail,!1))},updateData:function(O,Z){if(this.isSingleProperty){this.recomputeProperty(void 0,O);return}Z?(C.objectPool.clearObject(this.attrValue),this.recomputeData(O),this.schemaChangeRequired=!!this.updateSchema):typeof O=="string"?h.parse(O,this.attrValueProxy):C.extend(this.attrValueProxy,O),this.updateSchemaIfNeeded(O)},updateSchemaIfNeeded:function(O){if(!this.schemaChangeRequired||!this.updateSchema){for(var Z=0;Z<M.length;Z++)m("Unknown property `"+M[Z]+"` for component `"+this.name+"`.");M.length=0;return}M.length=0,this.updateSchema(this.data),C.objectPool.removeUnusedKeys(this.data,this.schema),this.silenceUnknownPropertyWarnings=!0,this.recomputeData(O),this.silenceUnknownPropertyWarnings=!1,this.schemaChangeRequired=!1},callUpdateHandler:function(){if(!(!this.isPositionRotationScale&&!this.dataChanged)){this.dataChanged=!1;var O=this.oldData;this.oldDataInUse=!0,this.update(O),O!==this.oldData&&this.objectPool.recycle(O),this.oldDataInUse=!1,this.storeOldData(),this.throttledEmitComponentChanged()}},handleMixinUpdate:function(){this.recomputeData(),this.updateSchemaIfNeeded(),this.callUpdateHandler()},resetProperty:function(O){!this.isSingleProperty&&!(O in this.schema)||(O?this.attrValue[O]=void 0:(this.isObjectBased&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0),this.recomputeProperty(O,void 0),this.updateSchemaIfNeeded(),this.callUpdateHandler())},extendSchema:function(O){var Z;Z=C.extend({},l[this.name].schema),C.extend(Z,O),this.schema=p(Z),this.el.emit("schemachanged",this.evtDetail)},getComputedPropertyValue:function(O){var Z=this.el.mixinEls,ne=this.attrValue&&O?this.attrValue[O]:this.attrValue;if(ne!==void 0)return ne;for(var pe=Z.length-1;pe>=0;pe--){var be=Z[pe].getAttribute(this.attrName);if(!(be===null||O&&!(O in be)))return O?be[O]:be}var Re=O?this.schema[O].default:this.schema.default;return Re},recomputeProperty:function(O,Z){var ne=O?this.schema[O]:this.schema;if(Z!=null){this.attrValue===void 0&&this.isObjectBased&&(this.attrValue=this.objectPool.use());var pe=O?this.attrValue[O]:this.attrValue;pe=ne.isCacheable?u(Z,ne,pe):Z,typeof pe=="string"&&(pe=Z===""?void 0:Z),O?this.attrValue[O]=pe:this.attrValue=pe}this.oldDataInUse&&(this.oldData=this.objectPool.use(),C.objectPool.removeUnusedKeys(this.oldData,this.schema),this.storeOldData(),this.oldDataInUse=!1);var be=O?this.oldData[O]:this.oldData,Re=O?this.data[O]:this.data,Ue=u(this.getComputedPropertyValue(O),ne,Re);return ne.type==="array"&&!O&&(Ue=C.clone(Ue)),ne.equals(Ue,be)||(this.dataChanged=!0,ne.schemaChange&&(this.schemaChangeRequired=!0)),O?this.data[O]=Ue:this.data=Ue,Ue},handleUnknownProperty:function(O,Z){this.attrValue===void 0&&(this.attrValue=this.objectPool.use()),this.attrValue[O]=Z,this.silenceUnknownPropertyWarnings||(this.deferUnknownPropertyWarnings?M.push(O):this.silenceUnknownPropertyWarnings||m("Unknown property `"+O+"` for component `"+this.name+"`."))},storeOldData:function(){if(!this.isObjectBased){this.oldData=this.data;return}if(this.isSingleProperty){this.oldData=u(this.data,this.schema,this.oldData);return}var O;for(O in this.schema)this.data[O]!==void 0&&(this.data[O]&&typeof this.data[O]=="object"?this.oldData[O]=u(this.data[O],this.schema[O],this.oldData[O]):this.oldData[O]=this.data[O])},recomputeData:function(O){var Z;if(this.isSingleProperty){this.recomputeProperty(void 0,O);return}if(O&&typeof O=="object")for(Z in this.schema)this.attrValueProxy[Z]=O[Z];else for(Z in this.schema)this.attrValueProxy[Z]=void 0;typeof O=="string"&&h.parse(O,this.attrValueProxy);for(Z in this.attrValue)this.attrValue[Z]!==void 0&&M.indexOf(Z)!==-1&&(Z in this.schema||m("Unknown property `"+Z+"` for component `"+this.name+"`."))},eventsAttach:function(){var O;this.eventsDetach();for(O in this.events)this.el.addEventListener(O,this.events[O])},eventsDetach:function(){var O;for(O in this.events)this.el.removeEventListener(O,this.events[O])},destroy:function(){this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.data),this.objectPool.recycle(this.oldData),this.attrValue=this.data=this.oldData=this.attrValueProxy=void 0}};function Y(O,Z){var ne;for(ne in Z)O.events[ne]=Z[ne].bind(O)}if(window.debug)var W=k.exports.registrationOrderWarnings={};k.exports.registerComponent=function(O,Z){var ne,pe={},be,Re;if(document.currentScript&&document.currentScript!==x&&_.forEach(function(nt){nt.hasLoaded||document.currentScript.compareDocumentPosition(nt)!==Node.DOCUMENT_POSITION_FOLLOWING&&(m("The component `"+O+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(W[O]=!0))}),S.test(O)===!0&&m("The component name `"+O+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+O.toLowerCase()+"`"),O.indexOf("__")!==-1)throw new Error("The component name `"+O+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(Z).forEach(function(je){pe[je]={value:Z[je],writable:!0}}),l[O])throw new Error("The component `"+O+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");ne=function(je,nt,mt){H.call(this,je,nt,mt)},ne.prototype=Object.create(H.prototype,pe),ne.prototype.name=O,ne.prototype.isPositionRotationScale=O==="position"||O==="rotation"||O==="scale",ne.prototype.constructor=ne,ne.prototype.system=v&&v.systems[O],ne.prototype.play=X(ne.prototype.play),ne.prototype.pause=re(ne.prototype.pause),be=C.extend(p(ne.prototype.schema,ne.prototype.name)),ne.prototype.isSingleProperty=Re=c(ne.prototype.schema),ne.prototype.isObjectBased=!Re||Re&&(V(be.default)||V(u(void 0,be))),b[O]=C.objectPool.createPool(),l[O]={Component:ne,dependencies:ne.prototype.dependencies,before:ne.prototype.before,after:ne.prototype.after,isSingleProperty:ne.prototype.isSingleProperty,isObjectBased:ne.prototype.isObjectBased,multiple:ne.prototype.multiple,sceneOnly:ne.prototype.sceneOnly,name:O,schema:be,stringify:ne.prototype.stringify};for(var Ue=0;Ue<_.length;Ue++)_[Ue].emit("componentregistered",{name:O},!1);return ne};function te(O){return O.tick||O.tock}function re(O){return function(){var ne=this.el.sceneEl;!this.isPlaying||(O.call(this),this.isPlaying=!1,this.eventsDetach(),!!te(this)&&ne.removeBehavior(this))}}function X(O){return function(){var ne=this.el.sceneEl,pe=this.el.isPlaying&&!this.isPlaying;!this.initialized||!pe||(O.call(this),this.isPlaying=!0,this.eventsAttach(),!!te(this)&&ne.addBehavior(this))}}function V(O){return O&&O.constructor===Object&&!(O instanceof window.HTMLElement)}},"./src/core/geometry.js":(k,K,f)=>{var y=f("./src/core/schema.js"),_=y.process,v=k.exports.geometries={},C=k.exports.geometryNames=[],l=f("./src/lib/three.js"),u=k.exports.Geometry=function(){};u.prototype={schema:{},init:function(p){return this.geometry=new l.BufferGeometry,this.geometry},update:function(p){}},k.exports.registerGeometry=function(p,c){var g,A={};if(Object.keys(c).forEach(function(m){A[m]={value:c[m],writable:!0}}),v[p])throw new Error("The geometry `"+p+"` has been already registered");return g=function(){u.call(this)},g.prototype=Object.create(u.prototype,A),g.prototype.name=p,g.prototype.constructor=g,v[p]={Geometry:g,schema:_(g.prototype.schema)},C.push(p),g}},"./src/core/propertyTypes.js":(k,K,f)=>{var y=f("./src/utils/coordinates.js"),_=f("./node_modules/debug/src/browser.js"),v=_("core:propertyTypes:warn"),C=k.exports.propertyTypes={},l=/[,> .[\]:]/,u=/url\((.+)\)/;p("audio","",h),p("array",[],c,g,A),p("asset","",h),p("boolean",!1,b),p("color","#FFF"),p("int",0,L),p("number",0,M),p("map","",h),p("model","",h),p("selector",null,F,Y,S,!1),p("selectorAll",null,H,W,A,!1),p("src","",te),p("string",""),p("time",0,L),p("vec2",{x:0,y:0},re,y.stringify,y.equals),p("vec3",{x:0,y:0,z:0},re,y.stringify,y.equals),p("vec4",{x:0,y:0,z:0,w:1},re,y.stringify,y.equals);function p(O,Z,ne,pe,be,Re){if(O in C)throw new Error("Property type "+O+" is already registered.");C[O]={default:Z,parse:ne||m,stringify:pe||x,equals:be||S,isCacheable:Re!==!1}}k.exports.registerPropertyType=p;function c(O){if(Array.isArray(O))return O;if(!O||typeof O!="string")return[];return O.split(",").map(Z);function Z(ne){return ne.trim()}}function g(O){return O.join(", ")}function A(O,Z){if(!Array.isArray(O)||!Array.isArray(Z))return O===Z;if(O.length!==Z.length)return!1;for(var ne=0;ne<O.length;ne++)if(O[ne]!==Z[ne])return!1;return!0}function h(O){var Z,ne;if(typeof O!="string")return O;if(ne=O.match(u),ne)return ne[1];if(O.charAt(0)==="#"){if(Z=document.getElementById(O.substring(1)),Z)return Z.tagName==="CANVAS"||Z.tagName==="VIDEO"||Z.tagName==="IMG"?Z:Z.getAttribute("src");v('"'+O+'" asset not found.');return}return O}function m(O){return O}function x(O){return O===null?"null":O.toString()}function S(O,Z){return O===Z}function b(O){return O!=="false"&&O!==!1}function L(O){return parseInt(O,10)}function M(O){return parseFloat(O,10)}function F(O){return O?typeof O!="string"?O:O[0]==="#"&&!l.test(O)?document.getElementById(O.substring(1)):document.querySelector(O):null}function H(O){return O?typeof O!="string"?O:Array.prototype.slice.call(document.querySelectorAll(O),0):null}function Y(O){return O.getAttribute?"#"+O.getAttribute("id"):x(O)}function W(O){return O instanceof Array?O.map(function(Z){return"#"+Z.getAttribute("id")}).join(", "):x(O)}function te(O){return v("`src` property type is deprecated. Use `asset` instead."),h(O)}function re(O,Z,ne){return y.parse(O,Z,ne)}function X(O,Z){return O==="audio"&&typeof Z!="string"||O==="array"&&!Array.isArray(Z)||O==="asset"&&typeof Z!="string"||O==="boolean"&&typeof Z!="boolean"||O==="color"&&typeof Z!="string"||O==="int"&&typeof Z!="number"||O==="number"&&typeof Z!="number"||O==="map"&&typeof Z!="string"||O==="model"&&typeof Z!="string"||O==="selector"&&typeof Z!="string"&&Z!==null||O==="selectorAll"&&typeof Z!="string"&&Z!==null||O==="src"&&typeof Z!="string"||O==="string"&&typeof Z!="string"||O==="time"&&typeof Z!="number"?!1:O==="vec2"?V(Z,2):O==="vec3"?V(Z,3):O==="vec4"?V(Z,4):!0}k.exports.isValidDefaultValue=X;function V(O,Z){if(O===null)return!0;if(typeof O!="object"||Object.keys(O).length!==Z)return!1;var ne=O.x,pe=O.y,be=O.z,Re=O.w;return!(typeof ne!="number"||typeof pe!="number"||Z>2&&typeof be!="number"||Z>3&&typeof Re!="number")}k.exports.isValidDefaultCoordinate=V},"./src/core/readyState.js":k=>{k.exports.canInitializeElements=!1;function K(){if(document.readyState==="complete"){f();return}document.addEventListener("readystatechange",function y(){document.readyState==="complete"&&(document.removeEventListener("readystatechange",y),f())})}k.exports.waitForDocumentReadyState=K;function f(){k.exports.canInitializeElements||(k.exports.canInitializeElements=!0,setTimeout(function(){document.dispatchEvent(new CustomEvent("aframeready"))}))}k.exports.emitReady=f},"./src/core/scene/a-scene.js":(k,K,f)=>{var y=f("./src/core/scene/metaTags.js").inject,_=f("./src/core/scene/wakelock.js"),v=f("./src/core/scene/loadingScreen.js"),C=f("./src/core/scene/scenes.js"),l=f("./src/core/system.js").systems,u=f("./src/core/component.js").components,p=f("./src/lib/three.js"),c=f("./src/utils/index.js"),g=c.debug("core:a-scene:warn"),A=f("./src/core/a-entity.js").AEntity,h=f("./src/core/a-node.js").ANode,m=f("./src/core/scene/postMessage.js"),x=c.device.isIOS(),S=c.device.isMobile(),b=c.device.isWebXRAvailable;x&&f("./src/utils/ios-orientationchange-blank-bug.js");class L extends A{constructor(){var V;super();V=this,V.clock=new p.Clock,V.isIOS=x,V.isMobile=S,V.hasWebXR=b,V.isAR=!1,V.isScene=!0,V.object3D=new p.Scene,V.object3D.onAfterRender=function(O,Z,ne){V.isPlaying&&V.tock(V.time,V.delta,ne)},V.resize=V.resize.bind(V),V.render=V.render.bind(V),V.systems={},V.systemNames=[],V.time=V.delta=0,V.usedOfferSession=!1,V.componentOrder=[],V.behaviors={},V.hasLoaded=!1,V.isPlaying=!1,V.originalHTML=V.innerHTML}addFullScreenStyles(){document.documentElement.classList.add("a-fullscreen")}removeFullScreenStyles(){document.documentElement.classList.remove("a-fullscreen")}doConnectedCallback(){var V=this,O=this.hasAttribute("embedded");this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("xr-mode-ui",""),this.setAttribute("device-orientation-permission-ui",""),super.doConnectedCallback(),re(this),this.setupRenderer(),v.setup(this,H),this.resize(),O||this.addFullScreenStyles(),m(this),y(this),_(this),this.onVRPresentChangeBound=this.onVRPresentChange.bind(this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){V.enterVR()},this.exitVRBound=function(){V.exitVR()},this.exitVRTrueBound=function(){V.exitVR(!0)},this.pointerRestrictedBound=function(){V.pointerRestricted()},this.pointerUnrestrictedBound=function(){V.pointerUnrestricted()},V.hasWebXR||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)),window.addEventListener("sessionend",this.resize),this.addEventListener("cameraready",function(){V.attachedCallbackPostCamera()}),this.initSystems(),this.componentOrder=M(u,this.componentOrder),this.addEventListener("componentregistered",function(){V.componentOrder=M(u,V.componentOrder)}),this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){V.enterVR()})}attachedCallbackPostCamera(){var V,O=this;window.addEventListener("load",V),window.addEventListener("resize",function(){O.isIOS?setTimeout(O.resize,100):O.resize()}),this.play(),C.push(this)}initSystems(){var V;this.initSystem("camera");for(V in l)V!=="camera"&&this.initSystem(V)}initSystem(V){this.systems[V]||(this.systems[V]=new l[V](this),this.systemNames.push(V))}disconnectedCallback(){var V=C.indexOf(this);super.disconnectedCallback(),C.splice(V,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound),window.removeEventListener("sessionend",this.resize),this.renderer.dispose()}addBehavior(V){var O,Z=this.behaviors[V.name],ne;Z||(Z=this.behaviors[V.name]={tick:{inUse:!1,array:[],markedForRemoval:[]},tock:{inUse:!1,array:[],markedForRemoval:[]}});for(ne in Z)if(!!V[ne]){if(O=Z[ne],O.inUse){var pe=O.markedForRemoval.indexOf(V);pe!==-1&&O.markedForRemoval.splice(pe,1)}O.array.indexOf(V)===-1&&O.array.push(V)}}getPointerLockElement(){return document.pointerLockElement}checkHeadsetConnected(){return c.device.checkHeadsetConnected()}enterAR(){var V;if(!this.hasWebXR)throw V="Failed to enter AR mode, WebXR not supported.",new Error(V);if(!c.device.checkARSupport())throw V="Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.",new Error(V);return this.enterVR(!0)}enterVR(V,O){var Z=this,ne,pe=Z.renderer.xr,be;if(O&&(!navigator.xr||!navigator.xr.offerSession))return Promise.resolve("OfferSession is not supported.");if(Z.usedOfferSession&&O)return Promise.resolve("OfferSession was already called.");if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile){var Re=Z.getAttribute("renderer");if(pe.enabled=!0,this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var Ue=this.sceneEl.systems.webxr.sessionReferenceSpaceType;pe.setReferenceSpaceType(Ue);var je=V?"immersive-ar":"immersive-vr";return be=this.sceneEl.systems.webxr.sessionConfiguration,new Promise(function(pt,Tt){var kt=O?navigator.xr.offerSession.bind(navigator.xr):navigator.xr.requestSession.bind(navigator.xr);Z.usedOfferSession|=O,kt(je,be).then(function(yn){O&&(Z.usedOfferSession=!1),pe.layersEnabled=be.requiredFeatures.indexOf("layers")!==-1,pe.setSession(yn).then(function(){pe.setFoveation(Re.foveationLevel),Z.xrSession=yn,Z.systems.renderer.setWebXRFrameRate(yn),yn.addEventListener("end",Z.exitVRBound),mt(pt)})},function(yn){var Sn=je==="immersive-ar",Nn=Sn?"AR":"VR";Tt(new Error("Failed to enter "+Nn+" mode (`requestSession`)",{cause:yn}))})})}else{if(ne=c.device.getVRDisplay(),pe.setDevice(ne),ne.isPresenting&&!window.hasNativeWebVRImplementation)return mt(),Promise.resolve();var nt={highRefreshRate:Re.highRefreshRate};return ne.requestPresent([{source:this.canvas,attributes:nt}]).then(mt,Dt)}}return mt(),Promise.resolve();function mt(pt){var Tt;window.hasNativeWebVRImplementation&&!window.hasNativeWebXRImplementation&&(Tt=new CustomEvent("vrdisplaypresentchange",{detail:{display:c.device.getVRDisplay()}}),window.dispatchEvent(Tt)),V?Z.addState("ar-mode"):Z.addState("vr-mode"),Z.emit("enter-vr",{target:Z}),!Z.hasWebXR&&Z.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),Z.addFullScreenStyles(),!Z.isMobile&&!Z.checkHeadsetConnected()&&W(Z.canvas),Z.resize(),pt&&pt()}function Dt(pt){throw Z.removeState("vr-mode"),pt&&pt.message?new Error("Failed to enter VR mode (`requestPresent`): "+pt.message):new Error("Failed to enter VR mode (`requestPresent`).")}}exitVR(){var V=this,O,Z=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){if(Z.enabled=!1,O=c.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0;else if(O.isPresenting)return O.exitPresent().then(ne,pe)}else te();return ne(),Promise.resolve();function ne(){V.removeState("vr-mode"),V.removeState("ar-mode"),V.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),V.hasAttribute("embedded")&&V.removeFullScreenStyles(),V.resize(),V.isIOS&&c.forceCanvasResizeSafariMobile(V.canvas),V.renderer.setPixelRatio(window.devicePixelRatio),V.emit("exit-vr",{target:V})}function pe(be){throw be&&be.message?new Error("Failed to exit VR mode (`exitPresent`): "+be.message):new Error("Failed to exit VR mode (`exitPresent`).")}}pointerRestricted(){if(this.canvas){var V=this.getPointerLockElement();V&&V!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}pointerUnrestricted(){var V=this.getPointerLockElement();V&&V===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}onVRPresentChange(V){var O=V.display||V.detail.display;if(O&&O.isPresenting){this.enterVR();return}this.exitVR()}getAttribute(V){var O=this.systems[V];return O?O.data:A.prototype.getAttribute.call(this,V)}getDOMAttribute(V){var O=this.systems[V];return O?O.data:A.prototype.getDOMAttribute.call(this,V)}setAttribute(V,O,Z){if(l[V]){h.prototype.setAttribute.call(this,V,O);var ne=this.systems[V];ne&&ne.updateProperties(O);return}A.prototype.setAttribute.call(this,V,O,Z)}removeBehavior(V){var O,Z,ne=this.behaviors[V.name],pe;for(Z in ne)!V[Z]||(O=ne[Z],pe=O.array.indexOf(V),pe!==-1&&(O.inUse?O.markedForRemoval.indexOf(V)===-1&&O.markedForRemoval.push(V):(O.array[pe]=O.array[O.array.length-1],O.array.pop())))}resize(){var V=this.camera,O=this.canvas,Z,ne,pe,be=this.renderer.xr.isPresenting;ne=this.renderer.xr.enabled&&be,!(!V||!O||this.is("vr-mode")&&(this.isMobile||ne))&&(Z=this.getAttribute("embedded")&&!this.is("vr-mode"),pe=H(O,Z,this.maxCanvasSize,this.is("vr-mode")),V.aspect=pe.width/pe.height,V.updateProjectionMatrix(),this.renderer.setSize(pe.width,pe.height,!1),this.emit("rendererresize",null,!1))}setupRenderer(){var V=this,O,Z,ne,pe;pe={alpha:!0,antialias:!S,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"},this.maxCanvasSize={height:-1,width:-1},this.hasAttribute("renderer")&&(ne=this.getAttribute("renderer"),Z=c.styleParser.parse(ne),Z.precision&&(pe.precision=Z.precision+"p"),Z.antialias&&Z.antialias!=="auto"&&(pe.antialias=Z.antialias==="true"),Z.logarithmicDepthBuffer&&Z.logarithmicDepthBuffer!=="auto"&&(pe.logarithmicDepthBuffer=Z.logarithmicDepthBuffer==="true"),Z.alpha&&(pe.alpha=Z.alpha==="true"),Z.stencil&&(pe.stencil=Z.stencil==="true"),Z.multiviewStereo&&(pe.multiviewStereo=Z.multiviewStereo==="true"),this.maxCanvasSize={width:Z.maxCanvasWidth?parseInt(Z.maxCanvasWidth):this.maxCanvasSize.width,height:Z.maxCanvasHeight?parseInt(Z.maxCanvasHeight):this.maxCanvasSize.height}),O=this.renderer=new p.WebGLRenderer(pe),O.setPixelRatio(window.devicePixelRatio),this.camera&&O.xr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){O.xr.setPoseTarget(V.camera.el.object3D)})}play(){var V=this,O=this;if(this.renderStarted){A.prototype.play.call(this);return}this.addEventListener("loaded",function(){var Z=this.renderer,ne,pe=this.renderer.xr;A.prototype.play.call(this),!O.renderStarted&&(O.resize(),O.renderer&&(window.performance&&window.performance.mark("render-started"),v.remove(),ne=c.device.getVRDisplay(),ne&&ne.isPresenting&&(pe.setDevice(ne),pe.enabled=!0,O.enterVR()),Z.setAnimationLoop(this.render),O.renderStarted=!0,O.emit("renderstart")))}),setTimeout(function(){A.prototype.load.call(V)})}updateComponent(V){V in l||A.prototype.updateComponent.apply(this,arguments)}tick(V,O){var Z,ne=this.systems;for(this.callComponentBehaviors("tick",V,O),Z=0;Z<this.systemNames.length;Z++)!ne[this.systemNames[Z]].tick||ne[this.systemNames[Z]].tick(V,O)}tock(V,O,Z){var ne,pe=this.systems;for(this.callComponentBehaviors("tock",V,O),ne=0;ne<this.systemNames.length;ne++)!pe[this.systemNames[ne]].tock||pe[this.systemNames[ne]].tock(V,O,Z)}render(V,O){var Z=this.renderer;this.frame=O,this.delta=this.clock.getDelta()*1e3,this.time=this.clock.elapsedTime*1e3,this.isPlaying&&this.tick(this.time,this.delta);var ne=null;this.is("ar-mode")&&(ne=this.object3D.background,this.object3D.background=null),Z.render(this.object3D,this.camera),ne&&(this.object3D.background=ne)}callComponentBehaviors(V,O,Z){for(var ne,pe=0;pe<this.componentOrder.length;pe++){var be=this.behaviors[this.componentOrder[pe]];if(!!be){var Re=be[V];for(Re.inUse=!0,ne=0;ne<Re.array.length;ne++)!Re.array[ne].isPlaying||Re.array[ne][V](O,Z);for(Re.inUse=!1,ne=0;ne<Re.markedForRemoval.length;ne++)this.removeBehavior(Re.markedForRemoval[ne]);Re.markedForRemoval.length=0}}}}function M(X,V){var O={},Z,ne,pe=V||[];pe.length=0;for(ne in X){var be=X[ne];if(be!==void 0){var Re=be.before?be.before.slice(0):[],Ue=be.after?be.after.slice(0):[];O[ne]={before:Re,after:Ue,visited:!1,done:!1}}}for(ne in O)for(Z=0;Z<O[ne].before.length;Z++){var je=O[ne].before[Z];if(!(je in O)){g("Invalid ordering constraint, no component named `"+je+"` referenced by `"+ne+"`");continue}O[je].after.push(ne)}function nt(mt){if(!(!(mt in O)||O[mt].done)){if(O[mt].visited){g("Cycle detected, ignoring one or more before/after constraints. The resulting order might be incorrect");return}O[mt].visited=!0;for(var Dt=0;Dt<O[mt].after.length;Dt++){var pt=O[mt].after[Dt];pt in O||g("Invalid before/after constraint, no component named `"+pt+"` referenced in `"+mt+"`"),nt(pt)}O[mt].done=!0,pe.push(mt)}}for(ne in O)O[ne].done||nt(ne);return pe}k.exports.determineComponentBehaviorOrder=M;function F(X,V){var O,Z=window.devicePixelRatio;return!V||V.width===-1&&V.height===-1||X.width*Z<V.width&&X.height*Z<V.height||(O=X.width/X.height,X.width*Z>V.width&&V.width!==-1&&(X.width=Math.round(V.width/Z),X.height=Math.round(V.width/O/Z)),X.height*Z>V.height&&V.height!==-1&&(X.height=Math.round(V.height/Z),X.width=Math.round(V.height*O/Z))),X}customElements.define("a-scene",L);function H(X,V,O,Z){if(!X.parentElement)return{height:0,width:0};if(V){var ne;return ne={height:X.parentElement.offsetHeight,width:X.parentElement.offsetWidth},F(ne,O)}return Y(O,Z)}function Y(X,V){var O;return O={height:document.body.offsetHeight,width:document.body.offsetWidth},V?O:F(O,X)}function W(X){var V=X.requestFullscreen||X.webkitRequestFullscreen||X.mozRequestFullScreen||X.msRequestFullscreen;V.apply(X,[{navigationUI:"hide"}])}function te(){var X=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;!X||(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function re(X){var V;V=document.createElement("canvas"),V.classList.add("a-canvas"),V.dataset.aframeCanvas=!0,X.appendChild(V),document.addEventListener("fullscreenchange",O),document.addEventListener("mozfullscreenchange",O),document.addEventListener("webkitfullscreenchange",O),document.addEventListener("MSFullscreenChange",O),V.addEventListener("touchmove",function(Z){Z.preventDefault()},{passive:!1}),X.canvas=V,X.emit("render-target-loaded",{target:V}),setTimeout(X.resize.bind(X),0);function O(){var Z=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;Z||X.exitVR(),document.activeElement.blur(),document.body.focus()}}k.exports.setupCanvas=re,k.exports.AScene=L},"./src/core/scene/loadingScreen.js":(k,K,f)=>{var y=f("./src/utils/index.js"),_=y.styleParser,v,C,l,u="loading-screen",p="a-loader-title";k.exports.setup=function(h,m){v=h,l=m;var x=v.hasAttribute(u)?_.parse(v.getAttribute(u)):void 0,S=x&&x.dotsColor||"white",b=x&&x.backgroundColor||"#24CAFF",L=x===void 0||x.enabled==="true"||x.enabled===void 0,M,F,H,Y,W,te,re,X,V,O;!L||(M=new THREE.Scene,F=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),H=new THREE.MeshBasicMaterial({color:S}),Y=new THREE.Mesh(F,H),W=Y.clone(),te=Y.clone(),re=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),X=new THREE.Clock,V=0,O=function(){v.renderer.render(M,re),V=X.getElapsedTime()%4,Y.visible=V>=1,W.visible=V>=2,te.visible=V>=3},M.background=new THREE.Color(b),M.add(re),Y.position.set(-1,0,-15),W.position.set(0,0,-15),te.position.set(1,0,-15),re.add(Y),re.add(W),re.add(te),g(),setTimeout(function(){v.hasLoaded||(c(re),C.style.display="block",window.addEventListener("resize",function(){c(re)}),v.renderer.setAnimationLoop(O))},200))},k.exports.remove=function(){window.removeEventListener("resize",c),!!C&&(C.style.display="none")};function c(A){var h=v.hasAttribute("embedded"),m=l(v.canvas,h,v.maxCanvasSize,v.is("vr-mode"));A.aspect=m.width/m.height,A.updateProjectionMatrix(),v.renderer.setSize(m.width,m.height,!1)}function g(){C=document.createElement("div"),C.className=p,C.innerHTML=document.title,C.style.display="none",v.appendChild(C)}},"./src/core/scene/metaTags.js":(k,K,f)=>{var y=f("./src/constants/index.js"),_=f("./src/utils/index.js").extend,v=k.exports.MOBILE_HEAD_TAGS=[l({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),l({name:"mobile-web-app-capable",content:"yes"}),l({name:"theme-color",content:"black"})],C=[l({name:"apple-mobile-web-app-capable",content:"yes"}),l({name:"apple-mobile-web-app-status-bar-style",content:"black"}),u({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function l(c){return{tagName:"meta",attributes:c,exists:function(){return document.querySelector('meta[name="'+c.name+'"]')}}}function u(c){return{tagName:"link",attributes:c,exists:function(){return document.querySelector('link[rel="'+c.rel+'"]')}}}k.exports.inject=function(g){var A=document.head,h=A.querySelector("script"),m,x=[];return v.forEach(S),g.isIOS&&C.forEach(S),x;function S(b){!b||b.exists()||(m=p(b),!!m&&(h?h.parentNode.insertBefore(m,h):A.appendChild(m),x.push(m)))}};function p(c){if(!(!c||!c.tagName)){var g=document.createElement(c.tagName);return g.setAttribute(y.AFRAME_INJECTED,""),_(g,c.attributes)}}},"./src/core/scene/postMessage.js":(k,K,f)=>{var y=f("./src/utils/index.js").isIframed;k.exports=function(C){!y()||window.addEventListener("message",_.bind(C))};function _(v){var C=this;if(!!v.data)switch(v.data.type){case"vr":switch(v.data.data){case"enter":C.enterVR();break;case"exit":C.exitVR();break}}}},"./src/core/scene/scenes.js":k=>{k.exports=[]},"./src/core/scene/wakelock.js":(k,K,f)=>{var y=f("./vendor/wakelock/wakelock.js");k.exports=function(v){if(!!v.isMobile){var C=v.wakelock=new y;v.addEventListener("enter-vr",function(){C.request()}),v.addEventListener("exit-vr",function(){C.release()})}}},"./src/core/schema.js":(k,K,f)=>{var y=f("./src/utils/index.js"),_=f("./src/core/propertyTypes.js"),v=y.debug,C=_.isValidDefaultValue,l=_.propertyTypes,u=v("core:schema:warn");function p(h){return"type"in h?typeof h.type=="string":"default"in h}k.exports.isSingleProperty=p,k.exports.process=function(h,m){var x;if(p(h))return c(h,m);for(x in h)h[x]=c(h[x],m);return h};function c(h,m){var x=h.default,S,b,L=h.type;return h.type?h.type==="bool"?L="boolean":h.type==="float"&&(L="number"):x!==void 0&&(typeof x=="boolean"||typeof x=="number")?L=typeof x:Array.isArray(x)?L="array":L="string",b=l[L],b||u("Unknown property type for component `"+m+"`: "+L),S=!!h.parse,h.parse=h.parse||b.parse,h.stringify=h.stringify||b.stringify,h.equals=h.equals||b.equals,h.isCacheable=h.isCacheable===!0||b.isCacheable,h.type=L,"default"in h?!S&&!C(L,x)&&u("Default value `"+x+"` does not match type `"+L+"` in component `"+m+"`"):h.default=b.default,h}k.exports.processPropertyDefinition=c,k.exports.parseProperties=function(){var h=[];return function(m,x,S,b,L){var M,F,H,Y;h.length=0;for(F in S?m:x)S&&m[F]===void 0||h.push(F);if(m===null||typeof m!="object")return m;for(F in m)m[F]!==void 0&&!x[F]&&!L&&u("Unknown property `"+F+"` for component/system `"+b+"`.");for(M=0;M<h.length;M++){if(F=h[M],H=x[F],Y=m[F],!x[F])return;m[F]=g(Y,H)}return m}}();function g(h,m,x){return(h==null||h==="")&&(h=m.default,Array.isArray(h)&&(h=h.slice())),m.parse(h,m.default,x)}k.exports.parseProperty=g,k.exports.stringifyProperties=function(h,m){var x,S,b,L={},M;for(x in h)S=m[x],b=h[x],M=b,typeof M=="object"&&(M=A(b,S),S||u("Unknown component property: "+x)),L[x]=M;return L};function A(h,m){return typeof h!="object"?h:!m||h===null?JSON.stringify(h):m.stringify(h)}k.exports.stringifyProperty=A},"./src/core/shader.js":(k,K,f)=>{var y=f("./src/core/schema.js"),_=y.process,v=k.exports.shaders={},C=k.exports.shaderNames=[],l=f("./src/lib/three.js"),u=f("./src/utils/index.js"),p={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},c=k.exports.Shader=function(){};c.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(g){return this.uniforms=this.initUniforms(),this.material=new(this.raw?l.RawShaderMaterial:l.ShaderMaterial)({uniforms:this.uniforms,glslVersion:this.raw||this.glsl3?l.GLSL3:null,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initUniforms:function(){var g,A=this.schema,h={},m;for(g in A)A[g].is==="uniform"&&(m=p[A[g].type],h[g]={type:m,value:void 0});return h},update:function(g){var A,h,m=this.schema,x=this.uniforms;for(A in g)if(!(!m[A]||m[A].is!=="uniform")){if(m[A].type==="map"){if(!x[A]||x[A].value===g[A])continue;h="_texture_"+A,this.setMapOnTextureLoad(x,A,h),u.material.updateMapMaterialFromData(h,A,this,g);continue}x[A].value=this.parseValue(m[A].type,g[A]),x[A].needsUpdate=!0}},parseValue:function(g,A){var h;switch(g){case"vec2":return new l.Vector2(A.x,A.y);case"vec3":return new l.Vector3(A.x,A.y,A.z);case"vec4":return new l.Vector4(A.x,A.y,A.z,A.w);case"color":return h=new l.Color(A),new l.Vector3(h.r,h.g,h.b);default:return A}},setMapOnTextureLoad:function(g,A,h){var m=this;this.el.addEventListener("materialtextureloaded",function(){g[A].value=m.material[h],g[A].needsUpdate=!0})}},k.exports.registerShader=function(g,A){var h,m={};if(Object.keys(A).forEach(function(x){m[x]={value:A[x],writable:!0}}),v[g])throw new Error("The shader "+g+" has already been registered");return h=function(){c.call(this)},h.prototype=Object.create(c.prototype,m),h.prototype.name=g,h.prototype.constructor=h,v[g]={Shader:h,schema:_(h.prototype.schema)},C.push(g),h}},"./src/core/system.js":(k,K,f)=>{var y=f("./src/core/component.js"),_=f("./src/core/schema.js"),v=f("./src/utils/index.js"),C=f("./src/core/readyState.js"),l=_.parseProperties,u=_.parseProperty,p=_.process,c=_.isSingleProperty,g=v.styleParser,A=k.exports.systems={},h=k.exports.System=function(m){var x=y&&y.components[this.name];this.el=m,this.sceneEl=m,x&&(x.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};h.prototype={schema:{},init:function(){},update:function(m){},updateProperties:function(m){var x=this.data;!Object.keys(_).length||(this.buildData(m),this.update(x))},buildData:function(m){var x=this.schema;!Object.keys(x).length||(m=m||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),c(x)?this.data=u(m,x):this.data=l(g.parse(m)||{},x,!1,this.name))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},k.exports.registerSystem=function(m,x){var S,b,L={},M=v.findAllScenes(document);if(Object.keys(x).forEach(function(F){L[F]={value:x[F],writable:!0}}),A[m])throw new Error("The system `"+m+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");if(b=function(F){h.call(this,F)},b.prototype=Object.create(h.prototype,L),b.prototype.name=m,b.prototype.constructor=b,b.prototype.schema=v.extend(p(b.prototype.schema)),A[m]=b,C.canInitializeElements)for(S=0;S<M.length;S++)M[S].initSystem(m)}},"./src/extras/components/index.js":(k,K,f)=>{f("./src/extras/components/pivot.js")},"./src/extras/components/pivot.js":(k,K,f)=>{var y=f("./src/core/component.js").registerComponent,_=f("./src/lib/three.js"),v=new _.Vector3,C=new _.Vector3;y("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var l=this.data,u=this.el,p=u.object3D.parent,c=u.object3D,g=new _.Group;v.copy(c.position),C.copy(c.rotation),p.remove(c),g.add(c),p.add(g),u.object3D=g,c.position.set(-1*l.x,-1*l.y,-1*l.z),g.position.set(l.x+v.x,l.y+v.y,l.z+v.z),g.rotation.copy(c.rotation),c.rotation.set(0,0,0)}})},"./src/extras/primitives/getMeshMixin.js":(k,K,f)=>{var y=f("./src/core/component.js").components,_=f("./src/core/shader.js").shaders,v=f("./src/utils/index.js"),C={};Object.keys(y.material.schema).forEach(l),Object.keys(_.standard.schema).forEach(l);function l(u){var p=u.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();u==="fog"&&(p="material-fog"),u==="visible"&&(p="material-visible"),C[p]="material."+u}k.exports=function(){return{defaultComponents:{material:{}},mappings:v.extend({},C)}}},"./src/extras/primitives/index.js":(k,K,f)=>{f("./src/extras/primitives/primitives/a-camera.js"),f("./src/extras/primitives/primitives/a-cursor.js"),f("./src/extras/primitives/primitives/a-curvedimage.js"),f("./src/extras/primitives/primitives/a-gltf-model.js"),f("./src/extras/primitives/primitives/a-image.js"),f("./src/extras/primitives/primitives/a-light.js"),f("./src/extras/primitives/primitives/a-link.js"),f("./src/extras/primitives/primitives/a-obj-model.js"),f("./src/extras/primitives/primitives/a-sky.js"),f("./src/extras/primitives/primitives/a-sound.js"),f("./src/extras/primitives/primitives/a-text.js"),f("./src/extras/primitives/primitives/a-video.js"),f("./src/extras/primitives/primitives/a-videosphere.js"),f("./src/extras/primitives/primitives/meshPrimitives.js")},"./src/extras/primitives/primitives.js":(k,K,f)=>{var y=f("./src/core/a-node.js").knownTags,_=f("./src/core/a-entity.js").AEntity,v=f("./src/core/component.js").components,C=f("./src/utils/index.js"),l=C.debug,u=C.entity.setComponentProperty,p=l("extras:primitives:debug"),c=l("extras:primitives:warn"),g=l("extras:primitives:error"),A=k.exports.primitives={};k.exports.registerPrimitive=function(b,L){if(b=b.toLowerCase(),y[b]){g("Trying to register primitive "+b+" that has been already previously registered");return}y[b]=!0,p("Registering <%s>",b),L.defaultAttributes&&c("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var M=L.mappings||{},F=class extends _{constructor(){super();this.defaultComponentsFromPrimitive=L.defaultComponents||L.defaultAttributes||{},this.deprecated=L.deprecated||null,this.deprecatedMappings=L.deprecatedMappings||{},this.mappings=M,L.deprecated&&console.warn(L.deprecated),this.resolveMappingCollisions()}resolveMappingCollisions(){var H=this.mappings,Y=this;Object.keys(H).forEach(function(te){var re;te!==te.toLowerCase()&&c("Mapping keys should be specified in lower case. The mapping key "+te+" may not be recognized"),v[te]&&(re=H[te].replace(".","-"),H[re]=H[te],delete H[te],console.warn("The primitive "+Y.tagName.toLowerCase()+" has a mapping collision. The attribute "+te+" has the same name as a registered component and has been renamed to "+re))})}getExtraComponents(){var H,Y,W,te,re,X=this;for(Y=C.clone(this.defaultComponentsFromPrimitive),re=this.getAttribute("mixin"),re&&(re=C.split(re.trim(),/\s+/),re.forEach(function(be){var Re=document.getElementById(be);if(!!Re){var Ue=Re.rawAttributeCache,je=Re.componentCache;for(var nt in Ue){if(te=X.mappings[nt],te){h(te,Ue[nt],Y);return}nt in je&&(Y[nt]=V(Y[nt],je[nt]))}}})),W=0;W<this.attributes.length;W++)H=this.attributes[W],te=this.mappings[H.name],te&&h(te,H.value,Y);return Y;function V(pe,be){return O(pe)?Z(be):O(be)?Z(pe):ne(pe)&&ne(be)?C.extendDeep(pe,be):Z(be)}function O(pe){return typeof pe=="undefined"}function Z(pe){return ne(pe)?C.extendDeep({},pe):pe}function ne(pe){return pe!==null&&pe.constructor===Object}}attributeChangedCallback(H,Y,W){var te=this.mappings[H];if(H in this.deprecatedMappings&&console.warn(this.deprecatedMappings[H]),!H||!te){super.attributeChangedCallback(H,Y,W);return}u(this,te,W)}};return customElements.define(b,F),F.mappings=M,A[b]=F,F};function h(S,b,L){var M=C.entity.getComponentPropertyPath(S);M.constructor===Array?(L[M[0]]=L[M[0]]||{},L[M[0]][M[1]]=b.trim()):L[M]=b.trim()}function m(S,b){var L=v[S].schema;Object.keys(L).map(function(M){var F=M.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();b[F]!==void 0&&(F=S+"-"+M),b[F]=S+"."+M})}function x(S,b,L){L=L||{},Object.keys(b).map(function(F){m(F,L)}),k.exports.registerPrimitive(S,C.extendDeep({},null,{defaultComponents:b,mappings:L}))}k.exports.definePrimitive=x},"./src/extras/primitives/primitives/a-camera.js":(k,K,f)=>{var y=f("./src/extras/primitives/primitives.js").registerPrimitive;y("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},"./src/extras/primitives/primitives/a-cursor.js":(k,K,f)=>{var y=f("./src/extras/primitives/getMeshMixin.js"),_=f("./src/extras/primitives/primitives.js").registerPrimitive,v=f("./src/utils/index.js");_("a-cursor",v.extendDeep({},y(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},"./src/extras/primitives/primitives/a-curvedimage.js":(k,K,f)=>{var y=f("./src/extras/primitives/getMeshMixin.js"),_=f("./src/extras/primitives/primitives.js").registerPrimitive,v=f("./src/utils/index.js");_("a-curvedimage",v.extendDeep({},y(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},"./src/extras/primitives/primitives/a-gltf-model.js":(k,K,f)=>{var y=f("./src/extras/primitives/primitives.js").registerPrimitive;y("a-gltf-model",{mappings:{src:"gltf-model"}})},"./src/extras/primitives/primitives/a-image.js":(k,K,f)=>{var y=f("./src/extras/primitives/getMeshMixin.js"),_=f("./src/extras/primitives/primitives.js").registerPrimitive,v=f("./src/utils/index.js");_("a-image",v.extendDeep({},y(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-light.js":(k,K,f)=>{var y=f("./src/extras/primitives/primitives.js").registerPrimitive;y("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target",envmap:"light.envMap","shadow-camera-automatic":"light.shadowCameraAutomatic"}})},"./src/extras/primitives/primitives/a-link.js":(k,K,f)=>{var y=f("./src/extras/primitives/primitives.js").registerPrimitive;y("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},"./src/extras/primitives/primitives/a-obj-model.js":(k,K,f)=>{var y=f("./src/extras/primitives/getMeshMixin.js")(),_=f("./src/extras/primitives/primitives.js").registerPrimitive,v=f("./src/utils/index.js");_("a-obj-model",v.extendDeep({},y,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},"./src/extras/primitives/primitives/a-sky.js":(k,K,f)=>{var y=f("./src/extras/primitives/getMeshMixin.js"),_=f("./src/extras/primitives/primitives.js").registerPrimitive,v=f("./src/utils/index.js"),C=f("./src/extras/primitives/primitives/meshPrimitives.js");_("a-sky",v.extendDeep({},y(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:v.extendDeep({},C["a-sphere"].mappings)}))},"./src/extras/primitives/primitives/a-sound.js":(k,K,f)=>{var y=f("./src/extras/primitives/primitives.js").registerPrimitive;y("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},"./src/extras/primitives/primitives/a-text.js":(k,K,f)=>{var y=f("./src/extras/primitives/primitives.js").definePrimitive;y("a-text",{text:{anchor:"align",width:5}})},"./src/extras/primitives/primitives/a-video.js":(k,K,f)=>{var y=f("./src/extras/primitives/getMeshMixin.js"),_=f("./src/extras/primitives/primitives.js").registerPrimitive,v=f("./src/utils/index.js");_("a-video",v.extendDeep({},y(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},"./src/extras/primitives/primitives/a-videosphere.js":(k,K,f)=>{var y=f("./src/extras/primitives/getMeshMixin.js"),_=f("./src/extras/primitives/primitives.js").registerPrimitive,v=f("./src/utils/index.js");_("a-videosphere",v.extendDeep({},y(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},"./src/extras/primitives/primitives/meshPrimitives.js":(k,K,f)=>{var y=f("./src/extras/primitives/getMeshMixin.js"),_=f("./src/core/geometry.js").geometries,v=f("./src/core/geometry.js").geometryNames,C=f("./src/extras/primitives/primitives.js").registerPrimitive,l=f("./src/utils/index.js"),u=k.exports={};v.forEach(function(g){var A=_[g],h=p(g),m={};Object.keys(A.schema).forEach(function(L){m[p(L)]="geometry."+L});var x="a-"+h,S=C(x,l.extendDeep({},y(),{defaultComponents:{geometry:{primitive:g}},mappings:m}));u[x]=S});function p(c){return c.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},"./src/geometries/box.js":(k,K,f)=>{var y=f("./src/core/geometry.js").registerGeometry,_=f("./src/lib/three.js");y("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(v){this.geometry=new _.BoxGeometry(v.width,v.height,v.depth,v.segmentsWidth,v.segmentsHeight,v.segmentsDepth)}})},"./src/geometries/circle.js":(k,K,f)=>{var y=f("./src/core/geometry.js").registerGeometry,_=f("./src/lib/three.js"),v=_.MathUtils.degToRad;y("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(C){this.geometry=new _.CircleGeometry(C.radius,C.segments,v(C.thetaStart),v(C.thetaLength))}})},"./src/geometries/cone.js":(k,K,f)=>{var y=f("./src/core/geometry.js").registerGeometry,_=f("./src/lib/three.js"),v=_.MathUtils.degToRad;y("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(C){this.geometry=new _.CylinderGeometry(C.radiusTop,C.radiusBottom,C.height,C.segmentsRadial,C.segmentsHeight,C.openEnded,v(C.thetaStart),v(C.thetaLength))}})},"./src/geometries/cylinder.js":(k,K,f)=>{var y=f("./src/core/geometry.js").registerGeometry,_=f("./src/lib/three.js"),v=_.MathUtils.degToRad;y("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(C){this.geometry=new _.CylinderGeometry(C.radius,C.radius,C.height,C.segmentsRadial,C.segmentsHeight,C.openEnded,v(C.thetaStart),v(C.thetaLength))}})},"./src/geometries/dodecahedron.js":(k,K,f)=>{var y=f("./src/core/geometry.js").registerGeometry,_=f("./src/lib/three.js");y("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(v){this.geometry=new _.DodecahedronGeometry(v.radius,v.detail)}})},"./src/geometries/icosahedron.js":(k,K,f)=>{var y=f("./src/core/geometry.js").registerGeometry,_=f("./src/lib/three.js");y("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(v){this.geometry=new _.IcosahedronGeometry(v.radius,v.detail)}})},"./src/geometries/index.js":(k,K,f)=>{f("./src/geometries/box.js"),f("./src/geometries/circle.js"),f("./src/geometries/cone.js"),f("./src/geometries/cylinder.js"),f("./src/geometries/dodecahedron.js"),f("./src/geometries/icosahedron.js"),f("./src/geometries/octahedron.js"),f("./src/geometries/plane.js"),f("./src/geometries/ring.js"),f("./src/geometries/sphere.js"),f("./src/geometries/tetrahedron.js"),f("./src/geometries/torus.js"),f("./src/geometries/torusKnot.js"),f("./src/geometries/triangle.js")},"./src/geometries/octahedron.js":(k,K,f)=>{var y=f("./src/core/geometry.js").registerGeometry,_=f("./src/lib/three.js");y("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(v){this.geometry=new _.OctahedronGeometry(v.radius,v.detail)}})},"./src/geometries/plane.js":(k,K,f)=>{var y=f("./src/core/geometry.js").registerGeometry,_=f("./src/lib/three.js");y("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(v){this.geometry=new _.PlaneGeometry(v.width,v.height,v.segmentsWidth,v.segmentsHeight)}})},"./src/geometries/ring.js":(k,K,f)=>{var y=f("./src/core/geometry.js").registerGeometry,_=f("./src/lib/three.js"),v=_.MathUtils.degToRad;y("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(C){this.geometry=new _.RingGeometry(C.radiusInner,C.radiusOuter,C.segmentsTheta,C.segmentsPhi,v(C.thetaStart),v(C.thetaLength))}})},"./src/geometries/sphere.js":(k,K,f)=>{var y=f("./src/core/geometry.js").registerGeometry,_=f("./src/lib/three.js"),v=_.MathUtils.degToRad;y("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(C){this.geometry=new _.SphereGeometry(C.radius,C.segmentsWidth,C.segmentsHeight,v(C.phiStart),v(C.phiLength),v(C.thetaStart),v(C.thetaLength))}})},"./src/geometries/tetrahedron.js":(k,K,f)=>{var y=f("./src/core/geometry.js").registerGeometry,_=f("./src/lib/three.js");y("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(v){this.geometry=new _.TetrahedronGeometry(v.radius,v.detail)}})},"./src/geometries/torus.js":(k,K,f)=>{var y=f("./src/core/geometry.js").registerGeometry,_=f("./src/lib/three.js"),v=_.MathUtils.degToRad;y("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(C){this.geometry=new _.TorusGeometry(C.radius,C.radiusTubular*2,C.segmentsRadial,C.segmentsTubular,v(C.arc))}})},"./src/geometries/torusKnot.js":(k,K,f)=>{var y=f("./src/core/geometry.js").registerGeometry,_=f("./src/lib/three.js");y("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(v){this.geometry=new _.TorusKnotGeometry(v.radius,v.radiusTubular*2,v.segmentsTubular,v.segmentsRadial,v.p,v.q)}})},"./src/geometries/triangle.js":(k,K,f)=>{var y=f("./src/core/geometry.js").registerGeometry,_=f("./src/lib/three.js"),v=new _.Quaternion,C=new _.Vector3(0,0,1),l=new _.Vector2,u=new _.Vector2,p=new _.Vector2;y("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(c){var g,A,h,m,x,S,b,L,M;h=new _.Triangle,h.a.set(c.vertexA.x,c.vertexA.y,c.vertexA.z),h.b.set(c.vertexB.x,c.vertexB.y,c.vertexB.z),h.c.set(c.vertexC.x,c.vertexC.y,c.vertexC.z),A=h.getNormal(new _.Vector3),v.setFromUnitVectors(A,C),m=h.a.clone().applyQuaternion(v),x=h.b.clone().applyQuaternion(v),S=h.c.clone().applyQuaternion(v),l.set(Math.min(m.x,x.x,S.x),Math.min(m.y,x.y,S.y)),u.set(Math.max(m.x,x.x,S.x),Math.max(m.y,x.y,S.y)),p.set(0,0).subVectors(u,l),m=new _.Vector2().subVectors(m,l).divide(p),x=new _.Vector2().subVectors(x,l).divide(p),S=new _.Vector2().subVectors(S,l).divide(p),g=this.geometry=new _.BufferGeometry,b=[h.a.x,h.a.y,h.a.z,h.b.x,h.b.y,h.b.z,h.c.x,h.c.y,h.c.z],L=[A.x,A.y,A.z,A.x,A.y,A.z,A.x,A.y,A.z],M=[m.x,m.y,x.x,x.y,S.x,S.y],g.setAttribute("position",new _.Float32BufferAttribute(b,3)),g.setAttribute("normal",new _.Float32BufferAttribute(L,3)),g.setAttribute("uv",new _.Float32BufferAttribute(M,2))}})},"./src/index.js":(k,K,f)=>{if(window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=navigator.xr!==void 0,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var y=f("./src/utils/isIOSOlderThan10.js"),_=y(window.navigator.userAgent)?1/window.devicePixelRatio:1,v=f("./node_modules/webvr-polyfill/build/webvr-polyfill.js"),C={BUFFER_SCALE:_,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova};window.webvrpolyfill=new v(C)}var l=f("./src/utils/index.js"),u=l.debug,p=u("A-Frame:error"),c=u("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&c("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),!window.cordova&&window.location.protocol==="file:"&&p("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/1.4.0/introduction/installation.html#use-a-local-server."),l.device.isBrowserEnvironment&&(f("./src/style/aframe.css"),f("./src/style/rStats.css"));var g=f("./src/core/scene/a-scene.js").AScene,A=f("./src/core/component.js").components,h=f("./src/core/component.js").registerComponent,m=f("./src/core/geometry.js").registerGeometry,x=f("./src/extras/primitives/primitives.js").registerPrimitive,S=f("./src/core/shader.js").registerShader,b=f("./src/core/system.js").registerSystem,L=f("./src/core/shader.js").shaders,M=f("./src/core/system.js").systems,F=window.THREE=f("./src/lib/three.js"),H=f("./src/core/readyState.js"),Y=f("./package.json");f("./src/components/index.js"),f("./src/geometries/index.js"),f("./src/shaders/index.js"),f("./src/systems/index.js");var W=f("./src/core/a-node.js").ANode,te=f("./src/core/a-entity.js").AEntity;f("./src/core/a-assets.js"),f("./src/core/a-cubemap.js"),f("./src/core/a-mixin.js"),f("./src/extras/components/index.js"),f("./src/extras/primitives/index.js"),console.log("A-Frame Version: 1.6.0 (Date 2024-05-23, Commit #e6c47761)"),console.log("THREE Version (https://github.com/supermedium/three.js):",F.REVISION),console.log("WebVR Polyfill Version:",Y.dependencies["webvr-polyfill"]),window.AFRAME_ASYNC||H.waitForDocumentReadyState(),k.exports=window.AFRAME={AComponent:f("./src/core/component.js").Component,AEntity:te,ANode:W,ANIME:f("./node_modules/super-animejs/lib/anime.es.js").default,AScene:g,components:A,coreComponents:Object.keys(A),geometries:f("./src/core/geometry.js").geometries,registerComponent:h,registerGeometry:m,registerPrimitive:x,registerShader:S,registerSystem:b,primitives:{getMeshMixin:f("./src/extras/primitives/getMeshMixin.js"),primitives:f("./src/extras/primitives/primitives.js").primitives},scenes:f("./src/core/scene/scenes.js"),schema:f("./src/core/schema.js"),shaders:L,systems:M,emitReady:H.emitReady,THREE:F,utils:l,version:Y.version}},"./src/lib/rStatsAframe.js":k=>{window.aframeStats=function(K){var f=null,y=K,_={te:{caption:"Entities"},lt:{caption:"Load Time"}},v=[{caption:"A-Frame",values:["te","lt"]}];function C(){f("te").set(l()),window.performance.getEntriesByName&&f("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function l(){var g=y.querySelectorAll("*");return Array.prototype.slice.call(g).filter(function(A){return A.isEntity}),g.length}function u(){}function p(){}function c(g){f=g}return{update:C,start:u,end:p,attach:c,values:_,groups:v,fractions:[]}},k.exports={aframeStats:window.aframeStats}},"./src/lib/three.js":(k,K,f)=>{var y=f("./src/lib/three.mjs").default;f.g.THREE=y,f("./vendor/DeviceOrientationControls.js"),y.Cache&&(y.Cache.enabled=!0),k.exports=y},"./src/shaders/flat.js":(k,K,f)=>{var y=f("./src/core/shader.js").registerShader,_=f("./src/lib/three.js"),v=f("./src/utils/index.js");k.exports.Shader=y("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2},toneMapped:{default:!0}},init:function(l){this.materialData={color:new _.Color},C(l,this.materialData),this.material=new _.MeshBasicMaterial(this.materialData)},update:function(l){this.updateMaterial(l),v.material.updateMap(this,l)},updateMaterial:function(l){var u;C(l,this.materialData);for(u in this.materialData)this.material[u]=this.materialData[u]}});function C(l,u){return u.color.set(l.color),u.fog=l.fog,u.wireframe=l.wireframe,u.toneMapped=l.toneMapped,u.wireframeLinewidth=l.wireframeLinewidth,u}},"./src/shaders/index.js":(k,K,f)=>{f("./src/shaders/flat.js"),f("./src/shaders/standard.js"),f("./src/shaders/phong.js"),f("./src/shaders/sdf.js"),f("./src/shaders/msdf.js"),f("./src/shaders/shadow.js")},"./src/shaders/msdf.js":(k,K,f)=>{var y=f("./src/core/shader.js").registerShader,_=f("./src/lib/three.js"),v=["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","out vec2 vUV;","void main(void) {","  vUV = uv;","  #include <begin_vertex>","  #include <project_vertex>","  #include <logdepthbuf_vertex>","  #include <fog_vertex>","}"].join(`
`),C=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","  #include <logdepthbuf_fragment>","  #include <tonemapping_fragment>","  #include <colorspace_fragment>","  #include <fog_fragment>","}"].join(`
`);k.exports.Shader=y("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},vertexShader:v,fragmentShader:C,init:function(){return this.uniforms=_.UniformsUtils.merge([_.UniformsLib.fog,this.initUniforms()]),this.material=new _.ShaderMaterial({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,fog:!0}),this.material}})},"./src/shaders/phong.js":(k,K,f)=>{var y=f("./src/core/shader.js").registerShader,_=f("./src/lib/three.js"),v=f("./src/utils/index.js");k.exports.Shader=y("phong",{schema:{color:{type:"color"},emissive:{type:"color",default:"black"},emissiveIntensity:{default:1},specular:{type:"color",default:"#111111"},transparent:{default:!1},fog:{default:!0},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},envMap:{default:""},sphericalEnvMap:{type:"map"},shininess:{default:30},flatShading:{default:!1},wireframe:{default:!1},wireframeLinewidth:{default:2},combine:{oneOF:["multiply","mix","add"],default:"mix"},reflectivity:{default:.9},refractionRatio:{default:.98},refract:{default:!1},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},bumpMap:{type:"map"},bumpMapScale:{default:1},bumpTextureOffset:{type:"vec2"},bumpTextureRepeat:{type:"vec2",default:{x:1,y:1}}},init:function(l){this.materialData={color:new _.Color,specular:new _.Color,emissive:new _.Color},C(l,this.materialData),this.material=new _.MeshPhongMaterial(this.materialData);var u=this.el.sceneEl;Object.defineProperty(this.material,"envMap",{get:function(){return this._envMap||u.object3D.environment},set:function(p){this._envMap=p}})},update:function(l){this.updateMaterial(l),v.material.updateMap(this,l),v.material.updateDistortionMap("normal",this,l),v.material.updateDistortionMap("displacement",this,l),v.material.updateDistortionMap("ambientOcclusion",this,l),v.material.updateDistortionMap("bump",this,l),v.material.updateEnvMap(this,l)},updateMaterial:function(l){var u;C(l,this.materialData);for(u in this.materialData)this.material[u]=this.materialData[u]}});function C(l,u){switch(u.color.set(l.color),u.specular.set(l.specular),u.emissive.set(l.emissive),u.emissiveIntensity=l.emissiveIntensity,u.fog=l.fog,u.transparent=l.transparent,u.wireframe=l.wireframe,u.wireframeLinewidth=l.wireframeLinewidth,u.shininess=l.shininess,u.flatShading=l.flatShading,u.wireframe=l.wireframe,u.wireframeLinewidth=l.wireframeLinewidth,u.reflectivity=l.reflectivity,u.refractionRatio=l.refractionRatio,l.combine){case"mix":u.combine=_.MixOperation;break;case"multiply":u.combine=_.MultiplyOperation;break;case"add":u.combine=_.AddOperation;break}return l.normalMap&&(u.normalScale=l.normalScale),l.ambientOcclusionMap&&(u.aoMapIntensity=l.ambientOcclusionMapIntensity),l.bumpMap&&(u.bumpScale=l.bumpMapScale),l.displacementMap&&(u.displacementScale=l.displacementScale,u.displacementBias=l.displacementBias),u}},"./src/shaders/sdf.js":(k,K,f)=>{var y=f("./src/core/shader.js").registerShader,_=f("./src/lib/three.js"),v=["#include <common>","#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","out vec2 vUV;","void main(void) {","  vUV = uv;","  #include <begin_vertex>","  #include <project_vertex>","  #include <logdepthbuf_vertex>","  #include <fog_vertex>","}"].join(`
`),C=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","float contour(float width, float value) {","  return smoothstep(0.5 - value, 0.5 + value, width);","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec2 uv = vUV;","  vec4 texColor = texture(map, uv);","  float dist = texColor.a;","  float width = fwidth(dist);","  float alpha = contour(dist, width);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * dist;","  }","  if (isBigEnough <= BIG_ENOUGH) {","    vec4 box = vec4 (uv - duv, uv + duv);","    alpha = (alpha + 0.5 * (","      contour(texture(map, box.xy).a, width)","      + contour(texture(map, box.zw).a, width)","      + contour(texture(map, box.xw).a, width)","      + contour(texture(map, box.zy).a, width)","    )) / 3.0;","  }","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color, opacity * alpha);","  #include <logdepthbuf_fragment>","  #include <tonemapping_fragment>","  #include <colorspace_fragment>","  #include <fog_fragment>","}"].join(`
`);k.exports.Shader=y("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:v,fragmentShader:C,init:function(){return this.uniforms=_.UniformsUtils.merge([_.UniformsLib.fog,this.initUniforms()]),this.material=new _.ShaderMaterial({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader,fog:!0}),this.material}})},"./src/shaders/shadow.js":(k,K,f)=>{var y=f("./src/core/shader.js").registerShader,_=f("./src/lib/three.js");k.exports.Shader=y("shadow",{schema:{opacity:{default:.5},transparent:{default:!0},alphaToCoverage:{default:!0}},init:function(v){this.material=new _.ShadowMaterial},update:function(v){this.material.opacity=v.opacity,this.material.alphaToCoverage=v.alphaToCoverage,this.material.transparent=v.transparent}})},"./src/shaders/standard.js":(k,K,f)=>{var y=f("./src/core/shader.js").registerShader,_=f("./src/lib/three.js"),v=f("./src/utils/index.js");k.exports.Shader=y("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(l){this.materialData={color:new _.Color,emissive:new _.Color},C(l,this.materialData),this.material=new _.MeshStandardMaterial(this.materialData)},update:function(l){this.updateMaterial(l),v.material.updateMap(this,l),v.material.updateDistortionMap("normal",this,l),v.material.updateDistortionMap("displacement",this,l),v.material.updateDistortionMap("ambientOcclusion",this,l),v.material.updateDistortionMap("metalness",this,l),v.material.updateDistortionMap("roughness",this,l),v.material.updateEnvMap(this,l)},updateMaterial:function(l){var u,p=this.material;C(l,this.materialData);for(u in this.materialData)p[u]=this.materialData[u]}});function C(l,u){return u.color.set(l.color),u.emissive.set(l.emissive),u.emissiveIntensity=l.emissiveIntensity,u.fog=l.fog,u.metalness=l.metalness,u.roughness=l.roughness,u.wireframe=l.wireframe,u.wireframeLinewidth=l.wireframeLinewidth,l.normalMap&&(u.normalScale=l.normalScale),l.ambientOcclusionMap&&(u.aoMapIntensity=l.ambientOcclusionMapIntensity),l.displacementMap&&(u.displacementScale=l.displacementScale,u.displacementBias=l.displacementBias),u}},"./src/systems/camera.js":(k,K,f)=>{var y=f("./src/constants/index.js"),_=f("./src/core/system.js").registerSystem,v="data-aframe-default-camera";k.exports.System=_("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var l,u,p=this.sceneEl,c=this;if(p.camera&&!p.camera.el.getAttribute("camera").spectator){p.emit("cameraready",{cameraEl:p.camera.el});return}if(l=p.querySelectorAll("a-camera, :not(a-mixin)[camera]"),!l.length){this.createDefaultCamera();return}for(this.numUserCameras=l.length,u=0;u<l.length;u++)l[u].addEventListener("object3dset",function(g){g.detail.type==="camera"&&c.checkUserCamera(this)}),l[u].isNode?l[u].load():l[u].addEventListener("nodeready",function(){this.load()})},checkUserCamera:function(l){var u,p=this.el.sceneEl;if(this.numUserCamerasChecked++,!this.initialCameraFound){if(u=l.getAttribute("camera"),!u.active||u.spectator){this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera();return}this.initialCameraFound=!0,p.camera=l.getObject3D("camera"),p.emit("cameraready",{cameraEl:l})}},createDefaultCamera:function(){var l,u=this.sceneEl;l=document.createElement("a-entity"),l.setAttribute("camera",{active:!0}),l.setAttribute("position",{x:0,y:y.DEFAULT_CAMERA_HEIGHT,z:0}),l.setAttribute("wasd-controls",""),l.setAttribute("look-controls",""),l.setAttribute(y.AFRAME_INJECTED,""),l.addEventListener("object3dset",function(p){p.detail.type==="camera"&&(u.camera=p.detail.object,u.emit("cameraready",{cameraEl:l}))}),u.appendChild(l)},disableActiveCamera:function(){var l,u;l=this.sceneEl.querySelectorAll(":not(a-mixin)[camera]"),u=l[l.length-1],u.setAttribute("camera","active",!0)},setActiveCamera:function(l){var u,p,c,g,A=this.activeCameraEl,h=this.sceneEl;if(g=l.getObject3D("camera"),!(!g||l===this.activeCameraEl)){var m=h.querySelector("["+v+"]"),x=m&&m.querySelector(":not(a-mixin)[camera]");for(l!==x&&C(h),this.activeCameraEl=l,this.activeCameraEl.play(),h.camera=g,A&&A.setAttribute("camera","active",!1),p=h.querySelectorAll(":not(a-mixin)[camera]"),c=0;c<p.length;c++)u=p[c],!(!u.isEntity||l===u)&&(u.setAttribute("camera","active",!1),u.pause());h.emit("camera-set-active",{cameraEl:l})}},setSpectatorCamera:function(l){var u,p=this.spectatorCameraEl,c=this.sceneEl,g;u=l.getObject3D("camera"),!(!u||l===this.spectatorCameraEl)&&(p&&p.setAttribute("camera","spectator",!1),g=this.spectatorCameraEl=l,c.addEventListener("enter-vr",this.wrapRender),c.addEventListener("exit-vr",this.unwrapRender),g.setAttribute("camera","active",!1),g.play(),c.emit("camera-set-spectator",{cameraEl:l}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){!this.spectatorCameraEl||this.originalRender||(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){!this.originalRender||(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(l,u){var p,c=this.sceneEl,g;p=c.renderer.xr.enabled,this.originalRender.call(c.renderer,l,u),!(!this.spectatorCameraEl||c.isMobile||!p)&&(g=this.spectatorCameraEl.components.camera.camera,c.renderer.xr.enabled=!1,this.originalRender.call(c.renderer,l,g),c.renderer.xr.enabled=p)}});function C(l){var u,p=l.camera;!p||(u=l.querySelector("["+v+"]"),!!u&&l.removeChild(u))}},"./src/systems/geometry.js":(k,K,f)=>{var y=f("./src/core/geometry.js").geometries,_=f("./src/core/system.js").registerSystem;k.exports.System=_("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(u){var p=this.cache,c,g;return u.skipCache?v(u):(g=this.hash(u),c=p[g],l(this.cacheCount,g),c||(c=v(u),p[g]=c,c))},unuseGeometry:function(u){var p=this.cache,c=this.cacheCount,g,A;u.skipCache||(A=this.hash(u),!!p[A]&&(C(c,A),!(c[A]>0)&&(g=p[A],g.dispose(),delete p[A],delete c[A])))},hash:function(u){return JSON.stringify(u)}});function v(u){var p=u.primitive,c=y[p]&&y[p].Geometry,g=new c;if(!c)throw new Error("Unknown geometry `"+p+"`");return g.init(u),g.geometry}function C(u,p){u[p]--}function l(u,p){u[p]=u[p]===void 0?1:u[p]+1}},"./src/systems/gltf-model.js":(k,K,f)=>{var y=f("./src/core/system.js").registerSystem,_=f("./src/lib/three.js");function v(C){return new Promise(function(l,u){var p=document.createElement("script");document.body.appendChild(p),p.onload=l,p.onerror=u,p.async=!0,p.src=C})}k.exports.System=y("gltf-model",{schema:{dracoDecoderPath:{default:"https://www.gstatic.com/draco/versioned/decoders/1.5.6/"},basisTranscoderPath:{default:""},meshoptDecoderPath:{default:""}},init:function(){this.update()},update:function(){var C=this.data.dracoDecoderPath,l=this.data.basisTranscoderPath,u=this.data.meshoptDecoderPath;!this.dracoLoader&&C&&(this.dracoLoader=new _.DRACOLoader,this.dracoLoader.setDecoderPath(C)),!this.ktx2Loader&&l&&(this.ktx2Loader=new _.KTX2Loader,this.ktx2Loader.setTranscoderPath(l).detectSupport(this.el.renderer)),!this.meshoptDecoder&&u&&(this.meshoptDecoder=v(u).then(function(){return window.MeshoptDecoder.ready}).then(function(){return window.MeshoptDecoder}))},getDRACOLoader:function(){return this.dracoLoader},getKTX2Loader:function(){return this.ktx2Loader},getMeshoptDecoder:function(){return this.meshoptDecoder}})},"./src/systems/index.js":(k,K,f)=>{f("./src/systems/camera.js"),f("./src/systems/geometry.js"),f("./src/systems/gltf-model.js"),f("./src/systems/light.js"),f("./src/systems/material.js"),f("./src/systems/obb-collider.js"),f("./src/systems/renderer.js"),f("./src/systems/shadow.js"),f("./src/systems/tracked-controls-webvr.js"),f("./src/systems/tracked-controls-webxr.js"),f("./src/systems/webxr.js")},"./src/systems/light.js":(k,K,f)=>{var y=f("./src/core/system.js").registerSystem,_=f("./src/constants/index.js"),v="data-aframe-default-light";k.exports.System=y("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",this.setupDefaultLights.bind(this))},registerLight:function(C){C.hasAttribute(v)||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var C,l=this.sceneEl;if(!!this.defaultLights){C=document.querySelectorAll("["+v+"]");for(var u=0;u<C.length;u++)l.removeChild(C[u]);this.defaultLights=!1}},setupDefaultLights:function(){var C=this.sceneEl,l,u;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||(l=document.createElement("a-entity"),l.setAttribute("light",{color:"#BBB",type:"ambient"}),l.setAttribute(v,""),l.setAttribute(_.AFRAME_INJECTED,""),C.appendChild(l),u=document.createElement("a-entity"),u.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),u.setAttribute("position",{x:-.5,y:1,z:1}),u.setAttribute(v,""),u.setAttribute(_.AFRAME_INJECTED,""),C.appendChild(u),this.defaultLights=!0)}})},"./src/systems/material.js":(k,K,f)=>{var y=f("./src/core/system.js").registerSystem,_=f("./src/lib/three.js"),v=f("./src/utils/index.js"),C=f("./src/utils/material.js").setTextureProperties,l=f("./src/utils/material.js").createCompatibleTexture,u=v.debug,p=u("components:texture:error"),c=u("components:texture:warn"),g=new _.ImageLoader;k.exports.System=y("material",{init:function(){this.materials={},this.sourceCache={}},clearTextureSourceCache:function(){this.sourceCache={}},loadTexture:function(x,S,b){this.loadTextureSource(x,function(M){var F=l(M);C(F,S),b(F)})},loadTextureSource:function(x,S){var b=this,L=this.sourceCache,M=this.hash(x);if(L[M]){L[M].then(S);return}if(x.tagName==="CANVAS"){H(new _.Source(x));return}H(new Promise(F));function F(Y,W){v.srcLoader.validateSrc(x,te,re);function te(X){b.loadImage(X,Y)}function re(X){b.loadVideo(X,Y)}}function H(Y){L[M]=Promise.resolve(Y),L[M].then(S)}},loadCubeMapTexture:function(x,S){var b=this,L=0,M=new _.CubeTexture;M.colorSpace=_.SRGBColorSpace;function F(Y){b.loadTextureSource(x[Y],function(W){M.images[Y]=W,L++,L===6&&(M.needsUpdate=!0,S(M))})}if(x.length!==6){c("Cube map texture requires exactly 6 sources, got only %s sources",x.length);return}for(var H=0;H<x.length;H++)F(H)},loadImage:function(x,S){if(typeof x!="string"){S(new _.Source(x));return}S(A(x))},loadVideo:function(x,S){var b;typeof x!="string"&&(b=x,m(b)),b=b||h(x),S(new _.Source(b))},hash:function(x){return x.tagName&&(x.id||x.src)||x},registerMaterial:function(x){this.materials[x.uuid]=x},unregisterMaterial:function(x){delete this.materials[x.uuid]}});function A(x){return new Promise(S);function S(b,L){g.load(x,M,function(){},function(F){p("`$s` could not be fetched (Error code: %s; Response: %s)",F.status,F.statusText)});function M(F){b(new _.Source(F))}}}function h(x){var S=document.createElement("video");return S.setAttribute("playsinline",""),S.setAttribute("webkit-playsinline",""),S.autoplay=!0,S.loop=!0,S.crossOrigin="anonymous",S.addEventListener("error",function(){c("`%s` is not a valid video",x)},!0),S.src=x,S}function m(x){return x.autoplay=x.hasAttribute("autoplay")&&x.getAttribute("autoplay")!=="false",x.controls=x.hasAttribute("controls")&&x.getAttribute("controls")!=="false",x.getAttribute("loop")==="false"&&x.removeAttribute("loop"),x.getAttribute("preload")==="false"&&(x.preload="none"),x.crossOrigin=x.crossOrigin||"anonymous",x.setAttribute("playsinline",""),x.setAttribute("webkit-playsinline",""),x}},"./src/systems/obb-collider.js":(k,K,f)=>{var y=f("./src/core/system.js").registerSystem;y("obb-collider",{schema:{showColliders:{default:!1}},init:function(){this.collisions=[],this.colliderEls=[]},addCollider:function(_){this.colliderEls.push(_),this.data.showColliders?_.components["obb-collider"].showCollider():_.components["obb-collider"].hideCollider(),this.tick=this.detectCollisions},removeCollider:function(_){var v=this.colliderEls,C=v.indexOf(_);_.components["obb-collider"].hideCollider(),C>-1&&v.splice(C,1),v.length===0&&(this.tick=void 0)},registerCollision:function(_,v){var C=this.collisions,l=!1,u=_.obb,p=v.obb,c=_.renderColliderMesh,g=v.renderColliderMesh;c&&c.material.color.set(16711680),g&&g.material.color.set(16711680);for(var A=0;A<C.length;A++)if(C[A].componentA.obb===u&&C[A].componentB.obb===p||C[A].componentA.obb===p&&C[A].componentB.obb===u){l=!0,C[A].detected=!0;break}l||(C.push({componentA:_,componentB:v,detected:!0}),_.el.emit("obbcollisionstarted",{trackedObject3D:_.trackedObject3D,withEl:v.el}),v.el.emit("obbcollisionstarted",{trackedObject3D:v.trackedObject3D,withEl:_.el}))},resetCollisions:function(){for(var _=this.collisions,v=0;v<_.length;v++)_[v].detected=!1},clearCollisions:function(){for(var _=this.collisions,v=[],C,l,u,p,c=0;c<_.length;c++)_[c].detected?v.push(_[c]):(C=_[c].componentA,l=_[c].componentB,u=C.renderColliderMesh,p=l.renderColliderMesh,u&&u.material.color.set(65280),C.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:l.el}),p&&p.material.color.set(65280),l.el.emit("obbcollisionended",{trackedObject3D:this.trackedObject3D,withEl:C.el}));this.collisions=v},detectCollisions:function(){var _,v,C,l,u=this.colliderEls;if(!(u.length<2)){this.resetCollisions();for(var p=0;p<u.length;p++)if(C=u[p].components["obb-collider"],_=u[p].components["obb-collider"].obb,!(_.halfSize.x===0||_.halfSize.y===0||_.halfSize.z===0))for(var c=p+1;c<u.length;c++)l=u[c].components["obb-collider"],v=l.obb,!(v.halfSize.x===0||v.halfSize.y===0||v.halfSize.z===0)&&_.intersectsOBB(v)&&this.registerCollision(C,l);this.clearCollisions()}}})},"./src/systems/renderer.js":(k,K,f)=>{var y=f("./src/core/system.js").registerSystem,_=f("./src/utils/index.js"),v=f("./src/lib/three.js"),C=_.debug,l=C("components:renderer:warn");k.exports.System=y("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:_.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:-1},maxCanvasHeight:{default:-1},multiviewStereo:{default:!1},physicallyCorrectLights:{default:!1},exposure:{default:1,if:{toneMapping:["ACESFilmic","linear","reinhard","cineon"]}},toneMapping:{default:"no",oneOf:["no","ACESFilmic","linear","reinhard","cineon"]},precision:{default:"high",oneOf:["high","medium","low"]},anisotropy:{default:1},sortTransparentObjects:{default:!1},colorManagement:{default:!0},alpha:{default:!0},stencil:{default:!1},foveationLevel:{default:1}},init:function(){var g=this.data,A=this.el,h=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1),m=A.renderer;g.physicallyCorrectLights||(m.useLegacyLights=!g.physicallyCorrectLights),m.toneMapping=v[h+"ToneMapping"],v.Texture.DEFAULT_ANISOTROPY=g.anisotropy,v.ColorManagement.enabled=g.colorManagement,m.outputColorSpace=g.colorManagement?v.SRGBColorSpace:v.LinearSRGBColorSpace,A.hasAttribute("antialias")&&l('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),A.hasAttribute("logarithmicDepthBuffer")&&l('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.'),m.sortObjects=!0,m.setOpaqueSort(u)},update:function(){var g=this.data,A=this.el,h=A.renderer,m=this.data.toneMapping.charAt(0).toUpperCase()+this.data.toneMapping.slice(1);h.toneMapping=v[m+"ToneMapping"],h.toneMappingExposure=g.exposure,h.xr.setFoveation(g.foveationLevel),g.sortObjects&&l('`sortObjects` property is deprecated. Use `renderer="sortTransparentObjects: true"` instead.'),g.sortTransparentObjects?h.setTransparentSort(c):h.setTransparentSort(p)},applyColorCorrection:function(g){!this.data.colorManagement||!g||g.isTexture&&g.colorSpace!==v.SRGBColorSpace&&(g.colorSpace=v.SRGBColorSpace,g.needsUpdate=!0)},setWebXRFrameRate:function(g){var A=this.data,h=g.supportedFrameRates;if(h&&g.updateTargetFrameRate){var m;h.includes(90)?m=A.highRefreshRate?90:72:m=A.highRefreshRate?72:60,g.updateTargetFrameRate(m).catch(function(x){console.warn("failed to set target frame rate of "+m+". Error info: "+x)})}}});function u(g,A){return g.groupOrder!==A.groupOrder?g.groupOrder-A.groupOrder:g.renderOrder!==A.renderOrder?g.renderOrder-A.renderOrder:g.z-A.z}function p(g,A){return g.groupOrder!==A.groupOrder?g.groupOrder-A.groupOrder:g.renderOrder-A.renderOrder}function c(g,A){return g.groupOrder!==A.groupOrder?g.groupOrder-A.groupOrder:g.renderOrder!==A.renderOrder?g.renderOrder-A.renderOrder:A.z-g.z}k.exports.sortFrontToBack=u,k.exports.sortRenderOrderOnly=p,k.exports.sortBackToFront=c},"./src/systems/shadow.js":(k,K,f)=>{var y=f("./src/core/system.js").registerSystem,_=f("./src/lib/three.js"),v={basic:_.BasicShadowMap,pcf:_.PCFShadowMap,pcfsoft:_.PCFSoftShadowMap};k.exports.System=y("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var l=this.sceneEl,u=this.data;this.shadowMapEnabled=!1,l.renderer.shadowMap.type=v[u.type],l.renderer.shadowMap.autoUpdate=u.autoUpdate},update:function(l){l.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.shadowMapEnabled)},setShadowMapEnabled:function(l){var u=this.sceneEl,p=this.sceneEl.renderer;this.shadowMapEnabled=l;var c=this.data.enabled&&this.shadowMapEnabled;p&&c!==p.shadowMap.enabled&&(p.shadowMap.enabled=c,C(u))}});function C(l){!l.hasLoaded||l.object3D.traverse(function(u){if(u.material)for(var p=Array.isArray(u.material)?u.material:[u.material],c=0;c<p.length;c++)p[c].needsUpdate=!0})}},"./src/systems/tracked-controls-webvr.js":(k,K,f)=>{var y=f("./src/core/system.js").registerSystem,_=f("./src/utils/index.js"),v=_.device.isWebXRAvailable;k.exports.System=y("tracked-controls-webvr",{init:function(){var C=this;this.controllers=[],this.isChrome=navigator.userAgent.indexOf("Chrome")!==-1,this.updateControllerList(),this.throttledUpdateControllerList=_.throttle(this.updateControllerList,500,this),!v&&(!navigator.getVRDisplays||this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(l){l.length&&(C.vrDisplay=l[0])})}))},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var C=this.controllers,l,u,p,c;if(u=navigator.getGamepads&&navigator.getGamepads(),!!u){for(c=C.length,C.length=0,p=0;p<u.length;++p)l=u[p],l&&l.pose&&C.push(l);C.length!==c&&this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/tracked-controls-webxr.js":(k,K,f)=>{var y=f("./src/core/system.js").registerSystem,_=f("./src/utils/index.js");k.exports.System=y("tracked-controls-webxr",{init:function(){this.controllers=[],this.oldControllers=[],this.oldControllersLength=0,this.throttledUpdateControllerList=_.throttle(this.updateControllerList,500,this),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var v=this,C=this.el.xrSession;if(!C){this.referenceSpace=void 0,this.controllers=[],this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1));return}var l=v.el.sceneEl.systems.webxr.sessionReferenceSpaceType;C.requestReferenceSpace(l).then(function(u){v.referenceSpace=u}).catch(function(u){throw v.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(l,'tracked-controls-webxr uses reference space "'+l+'".'),u})},updateControllerList:function(){var v=this.el.xrSession,C=this.oldControllers,l;if(!v){if(this.oldControllersLength===0)return;this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1);return}if(!!v.inputSources){if(this.controllers=v.inputSources,this.oldControllersLength===this.controllers.length){var u=!0;for(l=0;l<this.controllers.length;++l)if(!(this.controllers[l]===C[l]&&this.controllers[l].gamepad===C[l].gamepad)){u=!1;break}if(u)return}for(C.length=0,l=0;l<this.controllers.length;l++)C.push(this.controllers[l]);this.oldControllersLength=this.controllers.length,this.el.emit("controllersupdated",void 0,!1)}}})},"./src/systems/webxr.js":(k,K,f)=>{var y=f("./src/core/system.js").registerSystem,_=f("./src/utils/index.js"),v=_.debug("systems:webxr:warn");k.exports.System=y("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var C=this.data;this.sessionConfiguration={requiredFeatures:C.requiredFeatures,optionalFeatures:C.optionalFeatures},this.sessionReferenceSpaceType=C.referenceSpaceType,C.overlayElement&&(C.overlayElement.classList.remove("a-dom-overlay"),C.optionalFeatures.includes("dom-overlay")||(C.optionalFeatures.push("dom-overlay"),this.el.setAttribute("webxr",C)),this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:C.overlayElement},C.overlayElement.classList.add("a-dom-overlay"))},wasFeatureRequested:function(C){return!!(C==="viewer"||C==="local"||this.sessionConfiguration.requiredFeatures.includes(C)||this.sessionConfiguration.optionalFeatures.includes(C))},warnIfFeatureNotRequested:function(C,l){if(!this.wasFeatureRequested(C)){var u='Please add the feature "'+C+`" to a-scene's webxr system options in requiredFeatures/optionalFeatures.`;v((l?l+" ":"")+u)}}})},"./src/utils/coordinates.js":(k,K,f)=>{var y=f("./src/utils/debug.js"),_=y("utils:coordinates:warn"),v=["x","y","z","w"],C=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;k.exports.regex=C;var l=/\s+/g;function u(h,m,x){var S,b,L,M,F=x&&typeof x=="object"?x:{},H,Y,W,te;if(h&&h instanceof Object)return H=h.x===void 0?m&&m.x:h.x,Y=h.y===void 0?m&&m.y:h.y,W=h.z===void 0?m&&m.z:h.z,te=h.w===void 0?m&&m.w:h.w,H!=null&&(F.x=A(H)),Y!=null&&(F.y=A(Y)),W!=null&&(F.z=A(W)),te!=null&&(F.w=A(te)),F;if(h==null)return typeof m=="object"?Object.assign(F,m):m;for(S=h.trim().split(l),M=0;M<v.length;M++)if(L=v[M],S[M])F[L]=parseFloat(S[M],10);else{if(b=m&&m[L],b===void 0)continue;F[L]=A(b)}return F}k.exports.parse=u;function p(h){var m;return typeof h!="object"?h:(m=h.x+" "+h.y,h.z!=null&&(m+=" "+h.z),h.w!=null&&(m+=" "+h.w),m)}k.exports.stringify=p;function c(h,m){return typeof h!="object"||typeof m!="object"?h===m:h.x===m.x&&h.y===m.y&&h.z===m.z&&h.w===m.w}k.exports.equals=c;function g(h){return C.test(h)}k.exports.isCoordinates=g,k.exports.isCoordinate=function(h){return _("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),g(h)};function A(h){return h!=null&&h.constructor===String?parseFloat(h,10):h}k.exports.toVector3=function(h){return new THREE.Vector3(h.x,h.y,h.z)}},"./src/utils/debug.js":(k,K,f)=>{var y=f("./node_modules/debug/src/browser.js"),_=f("./src/utils/device.js").isBrowserEnvironment,v={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}};y.formatArgs=C;function C(g){if(g[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+g[0]+(this.useColors?"%c ":" "),!!this.useColors){this.color=u(this.namespace);var A="color: "+this.color;g.splice(1,0,A,"color: inherit");var h=0,m=0;g[0].replace(/%[a-zA-Z%]/g,function(x){x!=="%%"&&(h++,x==="%c"&&(m=h))}),g.splice(m,0,A)}}function l(g){var A=g.split(":");return A[A.length-1]}function u(g){var A=l(g),h=v.colors&&v.colors[A];return h||null}function p(){try{return window.localStorage}catch(g){}}var c=p();c&&(parseInt(c.logs,10)||c.logs==="true")?y.enable("*"):y.enable("*:error,*:info,*:warn"),_&&(window.logs=y),k.exports=y},"./src/utils/device.js":(k,K,f)=>{var y=f("./node_modules/debug/src/browser.js")("device:error"),_,v=!1,C=!1,l=k.exports.isWebXRAvailable=navigator.xr!==void 0;if(window.addEventListener("vrdisplayactivate",function(W){var te;l||(te=document.createElement("canvas"),_=W.display,te.getContext("webgl",{}),_.requestPresent([{source:te}]).then(function(){},function(){}))}),l){var u=function(){var W=document.querySelector("a-scene");if(!W){window.addEventListener("DOMContentLoaded",u);return}W.hasLoaded?W.components["xr-mode-ui"].updateEnterInterfaces():W.addEventListener("loaded",u)},p=function(W){y("WebXR session support error: "+W.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(W){v=W,u()}).catch(p),navigator.xr.isSessionSupported("immersive-ar").then(function(W){C=W,u()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){v=!0,u()}).catch(p),navigator.xr.supportsSession("immersive-ar").then(function(){C=!0,u()}).catch(function(){})):y("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&navigator.getVRDisplays().then(function(W){var te=document.querySelector("a-scene");_=W.length&&W[0],te&&te.emit("displayconnected",{vrDisplay:_})});function c(){return _}k.exports.getVRDisplay=c;function g(){return v||C||!!c()}k.exports.checkHeadsetConnected=g;function A(){return C}k.exports.checkARSupport=A;function h(){return v}k.exports.checkVRSupport=h;var m=function(){var W=!1;return function(te){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(te)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(te.substr(0,4)))&&(W=!0),(b()||x()||Y())&&(W=!0),H()&&(W=!1)}(window.navigator.userAgent||window.navigator.vendor||window.opera),function(){return W}}();k.exports.isMobile=m;function x(W){var te=W||window.navigator.userAgent,re=/Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(te);return re||S()}k.exports.isTablet=x;function S(W,te,re){var X=W||window.navigator.userAgent,V=te||window.navigator.platform,O=re||window.navigator.maxTouchPoints||0;return(V==="iPad"||V==="MacIntel")&&O>0&&/Macintosh|Intel|iPad|ipad/i.test(X)&&!window.MSStream}k.exports.isIpad=S;function b(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}k.exports.isIOS=b;function L(){return!m()&&!H()&&window.orientation!==void 0}k.exports.isMobileDeviceRequestingDesktopSite=L;function M(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}k.exports.isOculusBrowser=M;function F(){return/(Mobile VR)/i.test(window.navigator.userAgent)}k.exports.isFirefoxReality=F;function H(){return M()||F()}k.exports.isMobileVR=H;function Y(){return/R7 Build/.test(window.navigator.userAgent)}k.exports.isR7=Y,k.exports.isLandscape=function(){var W=window.orientation;return Y()&&(W+=90),W===90||W===-90},k.exports.isBrowserEnvironment=typeof process=="undefined"||process.browser===!0,k.exports.isNodeEnvironment=!k.exports.isBrowserEnvironment},"./src/utils/entity.js":(k,K,f)=>{var y=f("./src/utils/split.js").split;function _(v,C){C=C||".";var l=y(v,C);return l.length===1?l[0]:l}k.exports.getComponentPropertyPath=_,k.exports.getComponentProperty=function(v,C,l){var u;return l=l||".",C.indexOf(l)!==-1?(u=_(C,l),u.constructor===String?v.getAttribute(u):v.getAttribute(u[0])[u[1]]):v.getAttribute(C)},k.exports.setComponentProperty=function(v,C,l,u){var p;if(u=u||".",C.indexOf(u)!==-1){p=_(C,u),p.constructor===String?v.setAttribute(p,l):v.setAttribute(p[0],p[1],l);return}v.setAttribute(C,l)}},"./src/utils/forceCanvasResizeSafariMobile.js":k=>{k.exports=function(f){var y=f.style.width,_=f.style.height;f.style.width=parseInt(y,10)+1+"px",f.style.height=parseInt(_,10)+1+"px",setTimeout(function(){f.style.width=y,f.style.height=_},200)}},"./src/utils/index.js":(k,K,f)=>{var y=f("./src/utils/debug.js"),_=f("./node_modules/deep-assign/index.js"),v=f("./src/utils/device.js"),C=f("./src/utils/object-pool.js"),l=y("utils:warn");k.exports.bind=function(p){return p.bind.apply(p,Array.prototype.slice.call(arguments,1))},k.exports.coordinates=f("./src/utils/coordinates.js"),k.exports.debug=y,k.exports.device=v,k.exports.entity=f("./src/utils/entity.js"),k.exports.forceCanvasResizeSafariMobile=f("./src/utils/forceCanvasResizeSafariMobile.js"),k.exports.material=f("./src/utils/material.js"),k.exports.objectPool=C,k.exports.split=f("./src/utils/split.js").split,k.exports.styleParser=f("./src/utils/styleParser.js"),k.exports.trackedControls=f("./src/utils/tracked-controls.js"),k.exports.checkHeadsetConnected=function(){return l("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),v.checkHeadsetConnected(arguments)},k.exports.isGearVR=k.exports.device.isGearVR=function(){l("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},k.exports.isIOS=function(){return l("`utils.isIOS` has moved to `utils.device.isIOS`"),v.isIOS(arguments)},k.exports.isOculusGo=k.exports.device.isOculusGo=function(){l("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},k.exports.isMobile=function(){return l("`utils.isMobile has moved to `utils.device.isMobile`"),v.isMobile(arguments)},k.exports.throttle=function(p,c,g){var A;return g&&(p=p.bind(g)),function(){var h=Date.now(),m=typeof A=="undefined"?c:h-A;(typeof A=="undefined"||m>=c)&&(A=h,p.apply(null,arguments))}},k.exports.throttleLeadingAndTrailing=function(p,c,g){var A,h;g&&(p=p.bind(g));var m,x=function(){A=Date.now(),p.apply(this,m),h=void 0};return function(){var S=Date.now(),b=typeof A=="undefined"?c:S-A;b>=c?(clearTimeout(h),h=void 0,A=S,p.apply(null,arguments)):(h=h||setTimeout(x,c-b),m=arguments)}},k.exports.throttleTick=function(p,c,g){var A;return g&&(p=p.bind(g)),function(h,m){var x=typeof A=="undefined"?m:h-A;(typeof A=="undefined"||x>=c)&&(A=h,p(h,x))}},k.exports.debounce=function(p,c,g){var A;return function(){var h=this,m=arguments,x=function(){A=null,g||p.apply(h,m)},S=g&&!A;clearTimeout(A),A=setTimeout(x,c),S&&p.apply(h,m)}},k.exports.extend=Object.assign,k.exports.extendDeep=_,k.exports.clone=function(p){return JSON.parse(JSON.stringify(p))};var u=function(){var p=C.createPool(function(){return[]});return function(c,g){var A,h,m,x,S,b;if(c===void 0||g===void 0||c===null||g===null||!(c&&g&&c.constructor===Object&&g.constructor===Object||c.constructor===Array&&g.constructor===Array))return c===g;h=p.use(),m=p.use(),h.length=0,m.length=0;for(A in c)h.push(A);for(A in g)m.push(A);if(h.length!==m.length)return p.recycle(h),p.recycle(m),!1;for(x=0;x<h.length;++x)if(S=c[h[x]],b=g[h[x]],typeof S=="object"||typeof b=="object"||Array.isArray(S)&&Array.isArray(b)){if(S===b)continue;if(!u(S,b))return p.recycle(h),p.recycle(m),!1}else if(S!==b)return p.recycle(h),p.recycle(m),!1;return p.recycle(h),p.recycle(m),!0}}();k.exports.deepEqual=u,k.exports.diff=function(){var p=[];return function(c,g,A){var h,m,x,S,b,L,M;S=A||{},p.length=0;for(b in c)p.push(b);if(!g)return S;for(x in g)p.indexOf(x)===-1&&p.push(x);for(L=0;L<p.length;L++)b=p[L],h=c[b],m=g[b],M=h&&m&&h.constructor===Object&&m.constructor===Object,(M&&!u(h,m)||!M&&h!==m)&&(S[b]=m);return S}}(),k.exports.shouldCaptureKeyEvent=function(p){return p.metaKey?!1:document.activeElement===document.body},k.exports.splitString=function(p,c){typeof c=="undefined"&&(c=" ");var g=new RegExp(c,"g");return p=(p||"").replace(g,c),p.split(c)},k.exports.getElData=function(p,c){c=c||{};var g={};Object.keys(c).forEach(A);function A(h){p.hasAttribute(h)&&(g[h]=p.getAttribute(h))}return g},k.exports.getUrlParameter=function(p){p=p.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=new RegExp("[\\?&]"+p+"=([^&#]*)"),g=c.exec(location.search);return g===null?"":decodeURIComponent(g[1].replace(/\+/g," "))},k.exports.isIframed=function(){return window.top!==window.self},k.exports.findAllScenes=function(p){for(var c=[],g=p.getElementsByTagName("*"),A=0,h=g.length;A<h;A++)g[A].isScene&&c.push(g[A]);return c},k.exports.srcLoader=f("./src/utils/src-loader.js")},"./src/utils/ios-orientationchange-blank-bug.js":()=>{window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial",setTimeout(function(){document.documentElement.style.height="100%",setTimeout(function(){window.scrollTo(0,1)},500)},500)})},"./src/utils/isIOSOlderThan10.js":k=>{k.exports=function(f){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(f)}},"./src/utils/material.js":(k,K,f)=>{var y=f("./src/lib/three.js"),_=f("./src/utils/src-loader.js"),v=f("./src/utils/debug.js"),C=v("utils:material:warn"),l=new Set(["emissiveMap","envMap","map","specularMap"]);function u(h,m){var x=m.offset||{x:0,y:0},S=m.repeat||{x:1,y:1},b=m.npot||!1,L=m.anisotropy||y.Texture.DEFAULT_ANISOTROPY,M=h.wrapS,F=h.wrapT,H=h.magFilter,Y=h.minFilter;b&&(M=y.ClampToEdgeWrapping,F=y.ClampToEdgeWrapping,H=y.LinearFilter,Y=y.LinearFilter),(S.x!==1||S.y!==1)&&(M=y.RepeatWrapping,F=y.RepeatWrapping),h.offset.set(x.x,x.y),h.repeat.set(S.x,S.y),(h.wrapS!==M||h.wrapT!==F||h.magFilter!==H||h.minFilter!==Y||h.anisotropy!==L)&&(h.wrapS=M,h.wrapT=F,h.magFilter=H,h.minFilter=Y,h.anisotropy=L,h.needsUpdate=!0)}k.exports.setTextureProperties=u,k.exports.updateMapMaterialFromData=function(h,m,x,S){var b=x.el,L=x.material,M=b.sceneEl.systems.renderer,F=S[m];if(x.materialSrcs||(x.materialSrcs={}),!F){delete x.materialSrcs[h],Y(null);return}if(F===x.materialSrcs[h]&&L[h]){u(L[h],S);return}x.materialSrcs[h]=F,F instanceof y.Texture?Y(F):b.sceneEl.systems.material.loadTextureSource(F,H);function H(W){if(x.materialSrcs[h]===F){var te=L[h];te&&(W===null||!g(te,W))&&(te=null),!te&&W&&(te=A(W)),te&&(te.source!==W&&(te.source=W,te.needsUpdate=!0),l.has(h)&&M.applyColorCorrection(te),u(te,S)),Y(te)}}function Y(W){L[h]!==W&&(L[h]&&L[h].dispose(),L[h]=W,L.needsUpdate=!0,c(b,W))}},k.exports.updateMap=function(h,m){return k.exports.updateMapMaterialFromData("map","src",h,m)},k.exports.updateDistortionMap=function(h,m,x){var S=h;h==="ambientOcclusion"&&(S="ao");var b={};return b.src=x[h+"Map"],b.offset=x[h+"TextureOffset"],b.repeat=x[h+"TextureRepeat"],b.wrap=x[h+"TextureWrap"],k.exports.updateMapMaterialFromData(S+"Map","src",m,b)};var p={};k.exports.updateEnvMap=function(h,m){var x=h.material,S=h.el,b="envMap",L=m.envMap,M=m.sphericalEnvMap,F=m.refract;if(M&&(L=M,C("`sphericalEnvMap` property is deprecated, using spherical map as equirectangular map instead. Use `envMap` property with a CubeMap or Equirectangular image instead.")),h.materialSrcs||(h.materialSrcs={}),!L){delete h.materialSrcs[b],x.envMap=null,x.needsUpdate=!0;return}if(h.materialSrcs[b]=L,p[L]){p[L].then(H);return}p[L]=new Promise(function(Y){_.validateEnvMapSrc(L,function(te){S.sceneEl.systems.material.loadCubeMapTexture(te,function(re){re.mapping=F?y.CubeRefractionMapping:y.CubeReflectionMapping,H(re),Y(re)})},function(te){S.sceneEl.systems.material.loadTexture(te,{src:te},function(re){re.mapping=F?y.EquirectangularRefractionMapping:y.EquirectangularReflectionMapping,H(re),Y(re)})})});function H(Y){h.materialSrcs[b]===L&&(x.envMap=Y,x.needsUpdate=!0,c(S,Y))}};function c(h,m){if(!m||(h.emit("materialtextureloaded",{src:m.image,texture:m}),!m.image||m.image.tagName!=="VIDEO"))return;m.image.addEventListener("loadeddata",x),m.image.addEventListener("ended",S);function x(){h.emit("materialvideoloadeddata",{src:m.image,texture:m})}function S(){h.emit("materialvideoended",{src:m.image,texture:m})}m.addEventListener("dispose",function(){m.image.removeEventListener("loadeddata",x),m.image.removeEventListener("ended",S)})}k.exports.handleTextureEvents=c;function g(h,m){return m.data instanceof HTMLCanvasElement?h.isCanvasTexture:m.data instanceof HTMLVideoElement?h.isVideoTexture&&h.source===m:h.isTexture&&!h.isCanvasTexture&&!h.isVideoTexture}k.exports.isCompatibleTexture=g;function A(h){var m;return h.data instanceof HTMLCanvasElement?m=new y.CanvasTexture:h.data instanceof HTMLVideoElement?m=new y.VideoTexture(h.data):m=new y.Texture,m.source=h,m.needsUpdate=!0,m}k.exports.createCompatibleTexture=A},"./src/utils/math.js":k=>{function K(y,_,v){var C=_.dot(y);return(C-_.dot(v))/_.length()}function f(y,_,v,C){var l=K(y,_,v);return C.copy(_),C.multiplyScalar(l),C.add(v),C}k.exports.distanceOfPointFromPlane=K,k.exports.nearestPointInPlane=f},"./src/utils/object-pool.js":k=>{var K=Object.freeze(Object.create(null));function f(){return{}}k.exports.createPool=function(C){var l=[],u=null;C=C||f;function p(){var h;return(u===null||u===l.length)&&g(l.length||5),h=l[u],l[u++]=K,y(h),h}function c(h){if(h instanceof Object){if(u===null||u===-1){l[l.length]=h;return}l[--u]=h}}function g(h){var m,x;if(h=h===void 0?l.length:h,h>0&&u==null&&(u=0),h>0)for(m=l.length,l.length+=Number(h),x=m;x<l.length;x++)l[x]=C();return l.length}function A(){return l.length}return{grow:g,pool:l,recycle:c,size:A,use:p}};function y(v){var C;if(!(!v||v.constructor!==Object))for(C in v)v[C]=void 0}k.exports.clearObject=y;function _(v,C){var l;if(!(!v||v.constructor!==Object))for(l in v)l in C||delete v[l]}k.exports.removeUnusedKeys=_},"./src/utils/split.js":k=>{k.exports.split=function(){var K={};return function(f,y){return y in K||(K[y]={}),f in K[y]||(K[y][f]=f.split(y)),K[y][f]}}()},"./src/utils/src-loader.js":(k,K,f)=>{var y=f("./src/utils/debug.js"),_=y("utils:src-loader:warn");function v(A,h,m){p(A,function(S){if(S){h(A);return}m(A)})}function C(A,h,m){var x,S="",b,L,M=[];if(typeof A=="string"){let Y=function(W){M.push(W),M.length===6&&h(M)};var H=Y;for(b=0;b<5;b++)S+="(url\\((?:[^\\)]+)\\),\\s*)";if(S+="(url\\((?:[^\\)]+)\\)\\s*)",L=A.match(new RegExp(S)),L){for(b=1;b<7;b++)v(u(L[b]),Y);return}if(!A.startsWith("#")){var F=u(A);v(F||A,m);return}}if(A.tagName?x=A:x=g(A),!!x){if(x.tagName==="A-CUBEMAP"&&x.srcs)return h(x.srcs);if(x.tagName==="IMG")return m(x);_('Selector "%s" does not point to <a-cubemap> or <img>',A)}}function l(A,h){return C(A,h,function(){_("Expected cubemap but got image")})}function u(A){var h=A.match(/url\((.+)\)/);if(!!h)return h[1]}function p(A,h){var m;if(A.tagName){h(A.tagName==="IMG");return}m=new XMLHttpRequest,m.open("HEAD",A),m.addEventListener("load",function(x){var S;m.status>=200&&m.status<300?(S=m.getResponseHeader("Content-Type"),S==null?c(A,h):S.startsWith("image")?h(!0):h(!1)):c(A,h),m.abort()}),m.send()}function c(A,h){var m=new Image;m.addEventListener("load",x);function x(){h(!0)}m.addEventListener("error",S);function S(){h(!1)}m.src=A}function g(A){try{var h=document.querySelector(A);return h||_('No element was found matching the selector: "%s"',A),h}catch(m){_('"%s" is not a valid selector',A);return}}k.exports={parseUrl:u,validateSrc:v,validateCubemapSrc:l,validateEnvMapSrc:C}},"./src/utils/styleParser.js":k=>{var K=/-([a-z])/g;k.exports.parse=function(l,u){var p;return typeof l!="string"||(p=_(l,u),p[""])?l:p},k.exports.stringify=function(l){return typeof l=="string"?l:v(l)};function f(l){return l.replace(K,C)}k.exports.toCamelCase=f;var y=function(){var l=[],u=/url\([^)]+$/;return function(c){var g="",A,h=0,m=";";for(l.length=0;h<c.length;){if(A=c.indexOf(m,h),A===-1&&(A=c.length),g+=c.substring(h,A),u.test(g)){g+=";",h=A+1;continue}l.push(g.trim()),g="",h=A+1}return l}}();function _(l,u){var p,c,g,A,h,m;for(u=u||{},p=y(l),c=0;c<p.length;c++)g=p[c],!!g&&(A=g.indexOf(":"),h=g.substr(0,A).trim(),m=g.substr(A+1).trim(),u[f(h)]=m);return u}function v(l){var u,p=0,c=0,g="";for(u in l)p++;for(u in l)g+=u+": "+l[u],c<p-1&&(g+="; "),c++;return g}function C(l){return l[1].toUpperCase()}},"./src/utils/tracked-controls.js":(k,K,f)=>{var y=f("./src/constants/index.js").DEFAULT_HANDEDNESS,_=["x","y","z","w"],v=2;k.exports.checkControllerPresentAndSetup=function(c,g,A){var h=c.el,m,x=h.sceneEl.hasWebXR,S=x?l:C,b;if(m=S(c,g,A),b=!!m,c.controllerPresent&&!c.controllerEventsActive&&!x&&c.addEventListeners(),b===c.controllerPresent)return b;c.controllerPresent=b,b?(c.addEventListeners(),c.injectTrackedControls(m),h.emit("controllerconnected",{name:c.name,component:c})):(c.removeEventListeners(),h.emit("controllerdisconnected",{name:c.name,component:c}))};function C(c,g,A){var h,m=c.el.sceneEl,x,S=A.index||0;return!g||(x=m&&m.systems["tracked-controls-webvr"],!x)||(h=x.controllers,!h.length)?!1:!!u(h,null,g,A.hand,S)}function l(c,g,A){var h,m=c.el.sceneEl,x=m&&m.systems["tracked-controls-webxr"];return!x||(h=x.controllers,!h||!h.length)?!1:p(h,g,A.hand,A.index,A.iterateControllerProfiles,A.handTracking)}k.exports.isControllerPresentWebVR=C,k.exports.isControllerPresentWebXR=l;function u(c,g,A,h,m){var x,S,b=0,L=m>=0?m:0;for(S=0;S<c.length;S++)if(x=c[S],!(A&&!x.id.startsWith(A))&&!(!A&&x.id!==g)&&!(h&&x.hand&&h!==x.hand)){if(h&&!x.hand)L=v*m+(h===y?0:1);else return x;if(b===L)return x;++b}}function p(c,g,A,h,m,x){var S,b,L,M=!1,F,H;for(S=0;S<c.length;S++){if(L=c[S],H=L.profiles,x)M=L.hand;else if(m)for(b=0;b<H.length&&(M=H[b].startsWith(g),!M);b++);else M=H.length>0&&H[0].startsWith(g);if(!!M){if(F=L.handedness==="right"||L.handedness==="left",F){if(L.handedness===A)return c[S]}else if(S===h)return c[S]}}}k.exports.findMatchingControllerWebVR=u,k.exports.findMatchingControllerWebXR=p,k.exports.emitIfAxesChanged=function(c,g,A){var h,m,x,S,b;for(m in g){for(h=g[m],x=!1,b=0;b<h.length;b++)A.detail.changed[h[b]]&&(x=!0);if(!!x){for(S={},b=0;b<h.length;b++)S[_[b]]=A.detail.axis[h[b]];c.el.emit(m+"moved",S)}}},k.exports.onButtonEvent=function(c,g,A,h){var m=h?A.mapping[h]:A.mapping,x=m.buttons[c];A.el.emit(x+g),A.updateModel&&A.updateModel(x,g)}},"./vendor/DeviceOrientationControls.js":()=>{THREE.DeviceOrientationControls=function(k){var K=this;this.object=k,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var f=function(v){K.deviceOrientation=v},y=function(){K.screenOrientation=window.orientation||0},_=function(){var v=new THREE.Vector3(0,0,1),C=new THREE.Euler,l=new THREE.Quaternion,u=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(p,c,g,A,h){C.set(g,c,-A,"YXZ"),p.setFromEuler(C),p.multiply(u),p.multiply(l.setFromAxisAngle(v,-h))}}();this.connect=function(){y(),window.addEventListener("orientationchange",y,!1),window.addEventListener("deviceorientation",f,!1),K.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",y,!1),window.removeEventListener("deviceorientation",f,!1),K.enabled=!1},this.update=function(){if(K.enabled!==!1){var v=K.deviceOrientation;if(v){var C=v.alpha?THREE.MathUtils.degToRad(v.alpha)+K.alphaOffset:0,l=v.beta?THREE.MathUtils.degToRad(v.beta):0,u=v.gamma?THREE.MathUtils.degToRad(v.gamma):0,p=K.screenOrientation?THREE.MathUtils.degToRad(K.screenOrientation):0;_(K.object.quaternion,C,l,u,p)}}},this.dispose=function(){K.disconnect()},this.connect()}},"./vendor/rStats.extras.js":k=>{window.glStats=function(){var K=null,f=0,y=0,_=0,v=0,C=0,l=0,u=0;function p(b,L){return function(){L.apply(this,arguments),b.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=p(WebGLRenderingContext.prototype.drawArrays,function(){f++,arguments[0]==this.POINTS?l+=arguments[2]:C+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=p(WebGLRenderingContext.prototype.drawElements,function(){y++,v+=arguments[1]/3,C+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=p(WebGLRenderingContext.prototype.useProgram,function(){_++}),WebGLRenderingContext.prototype.bindTexture=p(WebGLRenderingContext.prototype.bindTexture,function(){u++});var c={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},g=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],A=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function h(){K("allcalls").set(f+y),K("drawElements").set(y),K("drawArrays").set(f),K("bindTexture").set(u),K("useProgram").set(_),K("glfaces").set(v),K("glvertices").set(C),K("glpoints").set(l)}function m(){f=0,y=0,_=0,v=0,C=0,l=0,u=0}function x(){}function S(b){K=b}return{update:h,start:m,end:x,attach:S,values:c,groups:g,fractions:A}},window.threeStats=function(K){var f=null,y={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},_=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],v=[];function C(){f("renderer.info.memory.geometries").set(K.info.memory.geometries),f("renderer.info.programs").set(K.info.programs.length),f("renderer.info.memory.textures").set(K.info.memory.textures),f("renderer.info.render.calls").set(K.info.render.calls),f("renderer.info.render.triangles").set(K.info.render.triangles),f("renderer.info.render.points").set(K.info.render.points)}function l(){}function u(){}function p(c){f=c}return{update:C,start:l,end:u,attach:p,values:y,groups:_,fractions:v}},window.BrowserStats=function(){var K=null,f=0,y=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var _={memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},v=[{caption:"Browser",values:["memory","total"]}],C=[{base:"total",steps:["memory"]}],l=Math.log(1024);function u(h){var m=100,x=Math.floor(Math.log(h)/l);return Math.round(h*m/Math.pow(1024,x))/m}function p(){f=u(performance.memory.usedJSHeapSize),y=u(performance.memory.totalJSHeapSize),K("memory").set(f),K("total").set(y)}function c(){f=0}function g(){}function A(h){K=h}return{update:p,start:c,end:g,attach:A,values:_,groups:v,fractions:C}},k.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats}},"./vendor/rStats.js":k=>{"use strict";(function(){"performance"in window||(window.performance={});var K=window.performance;if(!("now"in K)){var f=Date.now();K.timing&&K.timing.navigationStart&&(f=K.timing.navigationStart),K.now=function(){return Date.now()-f}}K.mark||(K.mark=function(){}),K.measure||(K.measure=function(){})})(),window.rStats=function(f){function y(Y,W){for(var te=Object.keys(Y),re=0,X=te.length;re<X;re++)W(te[re])}function _(Y){var W=document.createElement("link");W.href=Y,W.rel="stylesheet",W.type="text/css",document.getElementsByTagName("head")[0].appendChild(W)}var v=f||{},C=v.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],l="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",u=(v.CSSPath?v.CSSPath:"")+"rStats.css",p=v.css||[l,u];p.forEach(function(Y){_(Y)}),v.values||(v.values={});var c,g,A=10,h=200,m={};function x(Y,W,te){var re=te||{},X=document.createElement("canvas"),V=X.getContext("2d"),O=0,Z=0,ne=re.color?re.color:"#666666",pe=document.createElement("canvas"),be=pe.getContext("2d");pe.width=1,pe.height=2*A,be.fillStyle="#444444",be.fillRect(0,0,1,2*A),be.fillStyle=ne,be.fillRect(0,A,1,A),be.fillStyle="#ffffff",be.globalAlpha=.5,be.fillRect(0,A,1,1),be.globalAlpha=1;var Re=document.createElement("canvas"),Ue=Re.getContext("2d");Re.width=1,Re.height=2*A,Ue.fillStyle="#444444",Ue.fillRect(0,0,1,2*A),Ue.fillStyle="#b70000",Ue.fillRect(0,A,1,A),Ue.globalAlpha=.5,Ue.fillStyle="#ffffff",Ue.fillRect(0,A,1,1),Ue.globalAlpha=1;function je(){X.width=h,X.height=A,X.style.width=X.width+"px",X.style.height=X.height+"px",X.className="rs-canvas",Y.appendChild(X),V.fillStyle="#444444",V.fillRect(0,0,X.width,X.height)}function nt(mt,Dt){Z+=(mt-Z)*.1,O*=.99,Z>O&&(O=Z),V.drawImage(X,1,0,X.width-1,X.height,0,0,X.width-1,X.height),Dt?V.drawImage(Re,X.width-1,X.height-Z*X.height/O-A):V.drawImage(pe,X.width-1,X.height-Z*X.height/O-A)}return je(),{draw:nt}}function S(Y,W){var te=document.createElement("canvas"),re=te.getContext("2d");function X(){te.width=h,te.height=A*W,te.style.width=te.width+"px",te.style.height=te.height+"px",te.className="rs-canvas",Y.appendChild(te),re.fillStyle="#444444",re.fillRect(0,0,te.width,te.height)}function V(O){re.drawImage(te,1,0,te.width-1,te.height,0,0,te.width-1,te.height);var Z=0;y(O,function(ne){var pe=O[ne]*te.height;re.fillStyle=C[ne],re.fillRect(te.width-1,Z,1,pe),Z+=pe})}return X(),{draw:V}}function b(Y,W){var te=Y,re,X=0,V=0,O=0,Z=0,ne=performance.now(),pe=0,be=document.createElement("div"),Re=document.createElement("span"),Ue=document.createElement("div"),je=document.createTextNode(""),nt=v?v.values[te.toLowerCase()]:null,mt=new x(be,te,nt),Dt=!1;Re.className="rs-counter-id",Re.textContent=nt&&nt.caption?nt.caption:te,Ue.className="rs-counter-value",Ue.appendChild(je),be.appendChild(Re),be.appendChild(Ue),W?W.div.appendChild(be):g.appendChild(be),re=performance.now();function pt(ln){if(nt&&nt.average){Z+=ln,pe++;var En=performance.now();En-ne>=(nt.avgMs||1e3)&&(O=Z/pe,Z=0,ne=En,pe=0)}}function Tt(){re=performance.now(),v.userTimingAPI&&performance.mark(te+"-start"),Dt=!0}function kt(){X=performance.now()-re,v.userTimingAPI&&(performance.mark(te+"-end"),Dt&&performance.measure(te,te+"-start",te+"-end")),pt(X)}function un(){kt(),Tt()}function yn(){var ln=nt&&nt.average?O:X;je.nodeValue=Math.round(ln*100)/100;var En=nt&&(nt.below&&X<nt.below||nt.over&&X>nt.over);mt.draw(X,En),be.className=En?"rs-counter-base alarm":"rs-counter-base"}function Sn(){var ln=performance.now(),En=ln-re;V++,En>1e3&&(nt&&nt.interpolate===!1?X=V:X=V*1e3/En,V=0,re=ln,pt(X))}function Nn(ln){X=ln,pt(X)}return{set:Nn,start:Tt,tick:un,end:kt,frame:Sn,value:function(){return X},draw:yn}}function L(){var Y=0;function W(te){Y=te}return{set:W,value:function(){return Y}}}function M(Y){var W=Y.toLowerCase();if(W===void 0&&(W="default"),m[W])return m[W];var te=null;v&&v.groups&&y(v.groups,function(X){var V=v.groups[parseInt(X,10)];!te&&V.values.indexOf(W.toLowerCase())!==-1&&(te=V)});var re=new b(W,te);return m[W]=re,re}function F(){if(v.plugins){v.values||(v.values={}),v.groups||(v.groups=[]),v.fractions||(v.fractions=[]);for(var Y=0;Y<v.plugins.length;Y++)v.plugins[Y].attach(M),y(v.plugins[Y].values,function(W){v.values[W]=v.plugins[Y].values[W]}),v.groups=v.groups.concat(v.plugins[Y].groups),v.fractions=v.fractions.concat(v.plugins[Y].fractions)}else v.plugins={};c=document.createElement("div"),c.className="rs-base",g=document.createElement("div"),g.className="rs-container",g.style.height="auto",c.appendChild(g),document.body.appendChild(c),!!v&&(v.groups&&y(v.groups,function(W){var te=v.groups[parseInt(W,10)],re=document.createElement("div");re.className="rs-group",te.div=re;var X=document.createElement("h1");X.textContent=te.caption,X.addEventListener("click",function(V){this.classList.toggle("hidden"),V.preventDefault()}.bind(re)),g.appendChild(X),g.appendChild(re)}),v.fractions&&y(v.fractions,function(W){var te=v.fractions[parseInt(W,10)],re=document.createElement("div");re.className="rs-fraction";var X=document.createElement("div");X.className="rs-legend";var V=0;y(v.fractions[W].steps,function(Z){var ne=document.createElement("p");ne.textContent=v.fractions[W].steps[Z],ne.style.color=C[V],X.appendChild(ne),V++}),re.appendChild(X),re.style.height=V*A+"px",te.div=re;var O=new S(re,V);te.graph=O,g.appendChild(re)}))}function H(){y(v.plugins,function(Y){v.plugins[Y].update()}),y(m,function(Y){m[Y].draw()}),v&&v.fractions&&y(v.fractions,function(Y){var W=v.fractions[parseInt(Y,10)],te=[],re=m[W.base.toLowerCase()];re&&(re=re.value(),y(v.fractions[Y].steps,function(X){var V=v.fractions[Y].steps[parseInt(X,10)].toLowerCase(),O=m[V];O&&te.push(O.value()/re)})),W.graph.draw(te)})}return F(),function(Y){return Y?M(Y):{element:c,update:H}}},k.exports=window.rStats},"./vendor/wakelock/util.js":k=>{var K={};K.base64=function(f,y){return"data:"+f+";base64,"+y},K.isMobile=function(){var f=!1;return function(y){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(y)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(y.substr(0,4)))&&(f=!0)}(navigator.userAgent||navigator.vendor||window.opera),f},K.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},K.isIFrame=function(){try{return window.self!==window.top}catch(f){return!0}},K.appendQueryParameter=function(f,y,_){var v=f.indexOf("?")<0?"?":"&";return f+=v+y+"="+_,f},K.getQueryParameter=function(f){f=f.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var y=new RegExp("[\\?&]"+f+"=([^&#]*)"),_=y.exec(location.search);return _===null?"":decodeURIComponent(_[1].replace(/\+/g," "))},K.isLandscapeMode=function(){return window.orientation==90||window.orientation==-90},k.exports=K},"./vendor/wakelock/wakelock.js":(k,K,f)=>{var y=f("./vendor/wakelock/util.js");function _(){var l=document.createElement("video");l.addEventListener("ended",function(){l.play()}),this.request=function(){l.paused&&(l.src=y.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),l.play())},this.release=function(){l.pause(),l.src=""}}function v(){var l=null;this.request=function(){l||(l=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){l&&(clearInterval(l),l=null)}}function C(){var l=navigator.userAgent||navigator.vendor||window.opera;return l.match(/iPhone/i)||l.match(/iPod/i)?v:_}k.exports=C()},"./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css":(k,K,f)=>{"use strict";f.r(K),f.d(K,{default:()=>F});var y=f("./node_modules/css-loader/dist/runtime/sourceMaps.js"),_=f.n(y),v=f("./node_modules/css-loader/dist/runtime/api.js"),C=f.n(v),l=f("./node_modules/css-loader/dist/runtime/getUrl.js"),u=f.n(l),p=new URL(f("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),f.b),c=new URL(f("data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"),f.b),g=new URL(f("data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"),f.b),A=new URL(f("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"),f.b),h=new URL(f("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"),f.b),m=C()(_()),x=u()(p),S=u()(c),b=u()(g),L=u()(A),M=u()(h);m.push([k.id,`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url(`+x+`) 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url(`+S+`) 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url(`+b+`);
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(`+L+`) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(`+M+`) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`,"",{version:3,sources:["webpack://./src/style/aframe.css"],names:[],mappings:"AAAA,sCAAsC;AACtC;EACE,SAAS;EACT,OAAO;EACP,eAAe;EACf,QAAQ;EACR,MAAM;AACR;;AAEA;EACE,YAAY;EACZ,SAAS;EACT,gBAAgB;EAChB,UAAU;EACV,WAAW;AACb;;AAEA,oDAAoD;AACpD;EACE,sBAAsB;EACtB,uBAAuB;EACvB,iBAAiB;EACjB,kBAAkB;EAClB,mBAAmB;EACnB,oBAAoB;EACpB,0BAA0B;AAC5B;;AAEA;;EAEE,UAAU;EACV,WAAW;AACb;;AAEA;EACE,WAAW;AACb;;AAEA,gEAAgE;AAChE;EACE,6BAA6B;AAC/B;;AAEA;EACE,wBAAwB;AAC1B;;AAEA;EACE,YAAY;EACZ,OAAO;EACP,kBAAkB;EAClB,MAAM;EACN,WAAW;AACb;;AAEA;EACE,YAAY;EACZ,iBAAiB;EACjB,oBAAoB;AACtB;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,yBAAyB;EACzB,eAAe;EACf,SAAS;EACT,QAAQ;EACR,iBAAiB;EACjB,WAAW;EACX,qBAAqB;EACrB,eAAe;EACf,8BAA8B;EAC9B,kBAAkB;EAClB,cAAc;EACd,YAAY;AACd;;AAEA,+BAA+B;AAC/B,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,oBAAoB,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AAC7D,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;AACrE,4BAA4B,OAAO,UAAU,EAAE,EAAE,MAAM,UAAU,EAAE,EAAE;;AAErE;EACE,sCAAsC;EACtC,8CAA8C;AAChD;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,sBAAsB;EACtB,8BAA8B;AAChC;;AAEA;EACE,cAAc;EACd,kBAAkB;EAClB,YAAY;EACZ,WAAW;AACb;;AAEA;;;;EAIE,aAAa;AACf;;AAEA;;EAEE,0DAA0D;AAC5D;;AAEA;EACE,6BAA6B;EAC7B,cAAc;EACd,qBAAqB;EACrB,6BAA6B;AAC/B;;AAEA;EACE,sBAAsB;EACtB,WAAW;EACX,gBAAgB;EAChB,kBAAkB;EAClB,UAAU;AACZ;;AAEA;;EAEE,kCAAkC;EAClC,eAAe;EACf,WAAW;EACX,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,WAAW;AACb;;AAEA;;;EAGE,WAAW;EACX,iBAAiB;EACjB,aAAa;AACf;;AAEA;EACE,yFAA4qB;AAC9qB;;AAEA;EACE,yFAAkzB;AACpzB;;AAEA;EACE,yDAA2qK;AAC7qK;;AAEA;;EAEE,wBAAwB;EACxB,SAAS;EACT,SAAS;EACT,eAAe;EACf,eAAe;EACf,gBAAgB;EAChB,kBAAkB;EAClB;;;;GAIC;EACD,gBAAgB;EAChB,cAAc;EACd,kBAAkB;EAClB,QAAQ;EACR,sCAAsC;EACtC,8CAA8C;EAC9C,aAAa;EACb,kBAAkB;EAClB,0BAA0B,EAAE,8CAA8C;AAC5E;;AAEA;EACE,yBAAyB;EACzB,kBAAkB;AACpB;;AAEA;;;;EAIE,yBAAyB;AAC3B;;AAEA;EACE,qCAAqC;AACvC;;AAEA;EACE,sBAAsB;EACtB,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,kBAAkB;EAClB,YAAY;EACZ,YAAY;EACZ,SAAS;EACT,kBAAkB;AACpB;;AAEA;EACE,qCAAqC;EACrC,4BAA4B;EAC5B,kCAAkC;EAClC,qBAAqB;EACrB,WAAW;EACX,kBAAkB;EAClB,WAAW;EACX,QAAQ;EACR,QAAQ;EACR,SAAS;AACX;;AAEA;;EAEE,eAAe;AACjB;;AAEA;EACE,SAAS;AACX;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,2FAAivF;EACjvF,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,WAAW;EACX,8CAA8C;EAC9C,cAAc;EACd,kBAAkB;EAClB,kBAAkB;EAClB,QAAQ;EACR,2BAA2B;EAC3B,WAAW;AACb;;AAEA;EACE,6DAA25B;EAC35B,YAAY;EACZ,YAAY;EACZ,oBAAoB;EACpB,WAAW;AACb;;AAEA;EACE,oCAAoC;EACpC,kCAAkC;EAClC,kBAAkB;EAClB,eAAe;EACf,YAAY;EACZ,gBAAgB;EAChB,iBAAiB;EACjB,kBAAkB;EAClB,UAAU;EACV,SAAS;EACT,QAAQ;EACR,YAAY;AACd;;AAEA;EACE,kBAAkB;EAClB,+BAA+B;EAC/B,wBAAwB;EACxB,SAAS;EACT,eAAe;EACf,gBAAgB;EAChB,OAAO;EACP,iBAAiB;EACjB,QAAQ;EACR,eAAe;EACf,MAAM;EACN,gBAAgB;AAClB;;AAEA;EACE,kBAAkB;EAClB,SAAS;EACT,QAAQ;EACR,gCAAgC;EAChC,eAAe;EACf,YAAY;EACZ,aAAa;EACb,wBAAwB;EACxB,uBAAuB;EACvB,kCAAkC;EAClC,eAAe;EACf,kBAAkB;EAClB,YAAY;AACd;;AAEA;EACE,WAAW;EACX,WAAW;EACX,sBAAsB;EACtB,aAAa;EACb,uBAAuB;EACvB,qBAAqB;EACrB,sBAAsB;AACxB;;AAEA;EACE,qBAAqB;EACrB,mBAAmB;EACnB,eAAe;EACf,WAAW;AACb;;AAEA;EACE,oBAAoB;EACpB,oBAAoB;EACpB,WAAW;EACX,WAAW;AACb;;AAEA;EACE,eAAe;EACf,kBAAkB;EAClB,YAAY;EACZ,WAAW;EACX,UAAU;EACV,eAAe;EACf,WAAW;EACX,kBAAkB;EAClB,iBAAiB;EACjB,YAAY;EACZ,qBAAqB;EACrB,yCAAyC;EACzC,iCAAiC;EACjC,wEAAwE;EACxE,iBAAiB;AACnB;;AAEA;EACE,mEAAmE;AACrE;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yBAAyB;EACzB,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,kBAAkB;EAClB,oBAAoB;EACpB,sBAAsB;EACtB,SAAS;EACT,OAAO;EACP,QAAQ;EACR,MAAM;EACN,YAAY;AACd;;AAEA;EACE,oBAAoB;AACtB",sourcesContent:[`/* .a-fullscreen means not embedded. */
html.a-fullscreen {
  bottom: 0;
  left: 0;
  position: fixed;
  right: 0;
  top: 0;
}

html.a-fullscreen body {
  height: 100%;
  margin: 0;
  overflow: hidden;
  padding: 0;
  width: 100%;
}

/* Class is removed when doing <a-scene embedded>. */
html.a-fullscreen .a-canvas {
  width: 100% !important;
  height: 100% !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
}

html:not(.a-fullscreen) .a-enter-vr,
html:not(.a-fullscreen) .a-enter-ar {
  right: 5px;
  bottom: 5px;
}

html:not(.a-fullscreen) .a-enter-ar {
  right: 60px;
}

/* In chrome mobile the user agent stylesheet set it to white  */
:-webkit-full-screen {
  background-color: transparent;
}

.a-hidden {
  display: none !important;
}

.a-canvas {
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
}

.a-canvas.a-grab-cursor:hover {
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

canvas.a-canvas.a-mouse-cursor-hover:hover {
  cursor: pointer;
}

.a-inspector-loader {
  background-color: #ed3160;
  position: fixed;
  left: 3px;
  top: 3px;
  padding: 6px 10px;
  color: #fff;
  text-decoration: none;
  font-size: 12px;
  font-family: Roboto,sans-serif;
  text-align: center;
  z-index: 99999;
  width: 204px;
}

/* Inspector loader animation */
@keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }
@-webkit-keyframes dots-1 { from { opacity: 0; } 25% { opacity: 1; } }
@-webkit-keyframes dots-2 { from { opacity: 0; } 50% { opacity: 1; } }
@-webkit-keyframes dots-3 { from { opacity: 0; } 75% { opacity: 1; } }

.a-inspector-loader .dots span {
  animation: dots-1 2s infinite steps(1);
  -webkit-animation: dots-1 2s infinite steps(1);
}

.a-inspector-loader .dots span:first-child + span {
  animation-name: dots-2;
  -webkit-animation-name: dots-2;
}

.a-inspector-loader .dots span:first-child + span + span {
  animation-name: dots-3;
  -webkit-animation-name: dots-3;
}

a-scene {
  display: block;
  position: relative;
  height: 100%;
  width: 100%;
}

a-assets,
a-scene video,
a-scene img,
a-scene audio {
  display: none;
}

.a-enter-vr-modal,
.a-orientation-modal {
  font-family: Consolas, Andale Mono, Courier New, monospace;
}

.a-enter-vr-modal a {
  border-bottom: 1px solid #fff;
  padding: 2px 0;
  text-decoration: none;
  transition: .1s color ease-in;
}

.a-enter-vr-modal a:hover {
  background-color: #fff;
  color: #111;
  padding: 2px 4px;
  position: relative;
  left: -4px;
}

.a-enter-vr,
.a-enter-ar {
  font-family: sans-serif, monospace;
  font-size: 13px;
  width: 100%;
  font-weight: 200;
  line-height: 16px;
  position: absolute;
  right: 20px;
  bottom: 20px;
}

.a-enter-ar.xr {
  right: 90px;
}

.a-enter-vr-button,
.a-enter-vr-modal,
.a-enter-vr-modal a {
  color: #fff;
  user-select: none;
  outline: none;
}

.a-enter-vr-button {
  background: rgba(0, 0, 0, 0.35) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-ar-button {
  background: rgba(0, 0, 0, 0.20) url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat;
}

.a-enter-vr.fullscreen .a-enter-vr-button {
  background-image: url("data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8' standalone='no'%3F%3E%3Csvg width='108' height='62' viewBox='0 0 108 62' version='1.1' id='svg320' sodipodi:docname='fullscreen-aframe.svg' xml:space='preserve' inkscape:version='1.2.1 (9c6d41e  2022-07-14)' xmlns:inkscape='http://www.inkscape.org/namespaces/inkscape' xmlns:sodipodi='http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg' xmlns:rdf='http://www.w3.org/1999/02/22-rdf-syntax-ns%23' xmlns:cc='http://creativecommons.org/ns%23' xmlns:dc='http://purl.org/dc/elements/1.1/'%3E%3Cdefs id='defs324' /%3E%3Csodipodi:namedview id='namedview322' pagecolor='%23ffffff' bordercolor='%23000000' borderopacity='0.25' inkscape:showpageshadow='2' inkscape:pageopacity='0.0' inkscape:pagecheckerboard='0' inkscape:deskcolor='%23d1d1d1' showgrid='false' inkscape:zoom='3.8064516' inkscape:cx='91.423729' inkscape:cy='-1.4449153' inkscape:window-width='1440' inkscape:window-height='847' inkscape:window-x='32' inkscape:window-y='25' inkscape:window-maximized='0' inkscape:current-layer='svg320' /%3E%3Ctitle id='title312'%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z' fill='%23fff' id='path314' style='fill:%23ffffff' /%3E%3Cg id='g356' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g358' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g360' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g362' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g364' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g366' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g368' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g370' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g372' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g374' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g376' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g378' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g380' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g382' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cg id='g384' transform='translate(-206.61017 -232.61864)'%3E%3C/g%3E%3Cmetadata id='metadata561'%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=''%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d='m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4' id='path596' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4' id='path598' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4' id='path600' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3Cpath d='m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616' id='path602' style='fill:%23ffffff%3Bstroke-width:1.50194' /%3E%3C/svg%3E");
}

.a-enter-vr-button,
.a-enter-ar-button {
  background-size: 90% 90%;
  border: 0;
  bottom: 0;
  cursor: pointer;
  min-width: 58px;
  min-height: 34px;
  /* 1.74418604651 */
  /*
    In order to keep the aspect ratio when resizing
    padding-top percentages are relative to the containing block's width.
    http://stackoverflow.com/questions/12121090/responsively-change-div-size-keeping-aspect-ratio
  */
  padding-right: 0;
  padding-top: 0;
  position: absolute;
  right: 0;
  transition: background-color .05s ease;
  -webkit-transition: background-color .05s ease;
  z-index: 9999;
  border-radius: 8px;
  touch-action: manipulation; /* Prevent iOS double tap zoom on the button */
}

.a-enter-ar-button {
  background-size: 100% 90%;
  border-radius: 7px;
}

.a-enter-ar-button:active,
.a-enter-ar-button:hover,
.a-enter-vr-button:active,
.a-enter-vr-button:hover {
  background-color: #ef2d5e;
}

.a-enter-vr-button.resethover {
  background-color: rgba(0, 0, 0, 0.35);
}

.a-enter-vr-modal {
  background-color: #666;
  border-radius: 0;
  display: none;
  min-height: 32px;
  margin-right: 70px;
  padding: 9px;
  width: 280px;
  right: 2%;
  position: absolute;
}

.a-enter-vr-modal:after {
  border-bottom: 10px solid transparent;
  border-left: 10px solid #666;
  border-top: 10px solid transparent;
  display: inline-block;
  content: '';
  position: absolute;
  right: -5px;
  top: 5px;
  width: 0;
  height: 0;
}

.a-enter-vr-modal p,
.a-enter-vr-modal a {
  display: inline;
}

.a-enter-vr-modal p {
  margin: 0;
}

.a-enter-vr-modal p:after {
  content: ' ';
}

.a-orientation-modal {
  background: rgba(244, 244, 244, 1) url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center no-repeat;
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-orientation-modal:after {
  color: #666;
  content: "Insert phone into Cardboard holder.";
  display: block;
  position: absolute;
  text-align: center;
  top: 70%;
  transform: translateY(-70%);
  width: 100%;
}

.a-orientation-modal button {
  background: url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;
  border: none;
  height: 50px;
  text-indent: -9999px;
  width: 50px;
}

.a-loader-title {
  background-color: rgba(0, 0, 0, 0.6);
  font-family: sans-serif, monospace;
  text-align: center;
  font-size: 20px;
  height: 50px;
  font-weight: 300;
  line-height: 50px;
  position: absolute;
  right: 0px;
  left: 0px;
  top: 0px;
  color: white;
}

.a-modal {
  position: absolute;
  background: rgba(0, 0, 0, 0.60);
  background-size: 50% 50%;
  bottom: 0;
  font-size: 14px;
  font-weight: 600;
  left: 0;
  line-height: 20px;
  right: 0;
  position: fixed;
  top: 0;
  z-index: 9999999;
}

.a-dialog {
  position: relative;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  z-index: 199995;
  width: 300px;
  height: 200px;
  background-size: contain;
  background-color: white;
  font-family: sans-serif, monospace;
  font-size: 20px;
  border-radius: 3px;
  padding: 6px;
}

.a-dialog-text-container {
  width: 100%;
  height: 70%;
  align-self: flex-start;
  display: flex;
  justify-content: center;
  align-content: center;
  flex-direction: column;
}

.a-dialog-text {
  display: inline-block;
  font-weight: normal;
  font-size: 14pt;
  margin: 8px;
}

.a-dialog-buttons-container {
  display: inline-flex;
  align-self: flex-end;
  width: 100%;
  height: 30%;
}

.a-dialog-button {
  cursor: pointer;
  align-self: center;
  opacity: 0.9;
  height: 80%;
  width: 50%;
  font-size: 12pt;
  margin: 4px;
  border-radius: 2px;
  text-align:center;
  border: none;
  display: inline-block;
  -webkit-transition: all 0.25s ease-in-out;
  transition: all 0.25s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.10), 0 1px 2px rgba(0, 0, 0, 0.20);
  user-select: none;
}

.a-dialog-permission-button:hover {
  box-shadow: 0 7px 14px rgba(0,0,0,0.20), 0 2px 2px rgba(0,0,0,0.20);
}

.a-dialog-allow-button {
  background-color: #00ceff;
}

.a-dialog-deny-button {
  background-color: #ff005b;
}

.a-dialog-ok-button {
  background-color: #00ceff;
  width: 100%;
}

.a-dom-overlay:not(.a-no-style) {
  overflow: hidden;
  position: absolute;
  pointer-events: none;
  box-sizing: border-box;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  padding: 1em;
}

.a-dom-overlay:not(.a-no-style)>* {
  pointer-events: auto;
}
`],sourceRoot:""}]);let F=m},"./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css":(k,K,f)=>{"use strict";f.r(K),f.d(K,{default:()=>u});var y=f("./node_modules/css-loader/dist/runtime/sourceMaps.js"),_=f.n(y),v=f("./node_modules/css-loader/dist/runtime/api.js"),C=f.n(v),l=C()(_());l.push([k.id,`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`,"",{version:3,sources:["webpack://./src/style/rStats.css"],names:[],mappings:"AAAA;EACE,sBAAsB;EACtB,cAAc;EACd,gBAAgB;EAChB,oBAAoB;EACpB,SAAS;EACT,gBAAgB;EAChB,aAAa;EACb,gBAAgB;EAChB,aAAa;EACb,eAAe;EACf,QAAQ;EACR,YAAY;EACZ,cAAc;AAChB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,WAAW;EACX,eAAe;EACf,gBAAgB;EAChB,gBAAgB;EAChB,eAAe;EACf,UAAU;AACZ;;AAEA;EACE,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,sCAAsC;EACtC,8BAA8B;EAC9B,kBAAkB;AACpB;;AAEA;EACE,gBAAgB;AAClB;;AAEA;EACE,mBAAmB;EACnB,oBAAoB;EACpB,qBAAqB;EACrB,aAAa;EACb,YAAY;EACZ,sCAAsC;EACtC,8BAA8B;EAC9B,aAAa;AACf;;AAEA;EACE,cAAc;EACd;;;;;;;;2BAQyB;AAC3B;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,WAAW;AACb;;AAEA;EACE,gBAAgB;EAChB,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;EACR,iBAAiB;EACjB,WAAW;AACb;;AAEA;EACE,4BAA4B;EAC5B,gBAAgB;EAChB,QAAQ;AACV;;AAEA;EACE;IACE,UAAU;IACV,SAAS;EACX;AACF",sourcesContent:[`.rs-base {
  background-color: #333;
  color: #fafafa;
  border-radius: 0;
  font: 10px monospace;
  left: 5px;
  line-height: 1em;
  opacity: 0.85;
  overflow: hidden;
  padding: 10px;
  position: fixed;
  top: 5px;
  width: 300px;
  z-index: 10000;
}

.rs-base div.hidden {
  display: none;
}

.rs-base h1 {
  color: #fff;
  cursor: pointer;
  font-size: 1.4em;
  font-weight: 300;
  margin: 0 0 5px;
  padding: 0;
}

.rs-group {
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-direction: column-reverse;
  flex-direction: column-reverse;
  margin-bottom: 5px;
}

.rs-group:last-child {
  margin-bottom: 0;
}

.rs-counter-base {
  align-items: center;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  height: 10px;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  margin: 2px 0;
}

.rs-counter-base.alarm {
  color: #b70000;
  text-shadow: 0 0 0 #b70000,
               0 0 1px #fff,
               0 0 1px #fff,
               0 0 2px #fff,
               0 0 2px #fff,
               0 0 3px #fff,
               0 0 3px #fff,
               0 0 4px #fff,
               0 0 4px #fff;
}

.rs-counter-id {
  font-weight: 300;
  -webkit-box-ordinal-group: 0;
  -webkit-order: 0;
  order: 0;
  width: 54px;
}

.rs-counter-value {
  font-weight: 300;
  -webkit-box-ordinal-group: 1;
  -webkit-order: 1;
  order: 1;
  text-align: right;
  width: 35px;
}

.rs-canvas {
  -webkit-box-ordinal-group: 2;
  -webkit-order: 2;
  order: 2;
}

@media (min-width: 480px) {
  .rs-base {
    left: 20px;
    top: 20px;
  }
}
`],sourceRoot:""}]);let u=l},"./src/style/aframe.css":(k,K,f)=>{"use strict";f.r(K),f.d(K,{default:()=>L});var y=f("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),_=f.n(y),v=f("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),C=f.n(v),l=f("./node_modules/style-loader/dist/runtime/insertBySelector.js"),u=f.n(l),p=f("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),c=f.n(p),g=f("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),A=f.n(g),h=f("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=f.n(h),x=f("./node_modules/css-loader/dist/cjs.js!./src/style/aframe.css"),S={};S.styleTagTransform=m(),S.setAttributes=c(),S.insert=u().bind(null,"head"),S.domAPI=C(),S.insertStyleElement=A();var b=_()(x.default,S);let L=x.default&&x.default.locals?x.default.locals:void 0},"./src/style/rStats.css":(k,K,f)=>{"use strict";f.r(K),f.d(K,{default:()=>L});var y=f("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),_=f.n(y),v=f("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),C=f.n(v),l=f("./node_modules/style-loader/dist/runtime/insertBySelector.js"),u=f.n(l),p=f("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),c=f.n(p),g=f("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),A=f.n(g),h=f("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),m=f.n(h),x=f("./node_modules/css-loader/dist/cjs.js!./src/style/rStats.css"),S={};S.styleTagTransform=m(),S.setAttributes=c(),S.insert=u().bind(null,"head"),S.domAPI=C(),S.insertStyleElement=A();var b=_()(x.default,S);let L=x.default&&x.default.locals?x.default.locals:void 0},"./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":k=>{"use strict";var K=[];function f(v){for(var C=-1,l=0;l<K.length;l++)if(K[l].identifier===v){C=l;break}return C}function y(v,C){for(var l={},u=[],p=0;p<v.length;p++){var c=v[p],g=C.base?c[0]+C.base:c[0],A=l[g]||0,h="".concat(g," ").concat(A);l[g]=A+1;var m=f(h),x={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(m!==-1)K[m].references++,K[m].updater(x);else{var S=_(x,C);C.byIndex=p,K.splice(p,0,{identifier:h,updater:S,references:1})}u.push(h)}return u}function _(v,C){var l=C.domAPI(C);l.update(v);var u=function(c){if(c){if(c.css===v.css&&c.media===v.media&&c.sourceMap===v.sourceMap&&c.supports===v.supports&&c.layer===v.layer)return;l.update(v=c)}else l.remove()};return u}k.exports=function(v,C){C=C||{},v=v||[];var l=y(v,C);return function(p){p=p||[];for(var c=0;c<l.length;c++){var g=l[c],A=f(g);K[A].references--}for(var h=y(p,C),m=0;m<l.length;m++){var x=l[m],S=f(x);K[S].references===0&&(K[S].updater(),K.splice(S,1))}l=h}}},"./node_modules/style-loader/dist/runtime/insertBySelector.js":k=>{"use strict";var K={};function f(_){if(typeof K[_]=="undefined"){var v=document.querySelector(_);if(window.HTMLIFrameElement&&v instanceof window.HTMLIFrameElement)try{v=v.contentDocument.head}catch(C){v=null}K[_]=v}return K[_]}function y(_,v){var C=f(_);if(!C)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");C.appendChild(v)}k.exports=y},"./node_modules/style-loader/dist/runtime/insertStyleElement.js":k=>{"use strict";function K(f){var y=document.createElement("style");return f.setAttributes(y,f.attributes),f.insert(y,f.options),y}k.exports=K},"./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js":(k,K,f)=>{"use strict";function y(_){var v=f.nc;v&&_.setAttribute("nonce",v)}k.exports=y},"./node_modules/style-loader/dist/runtime/styleDomAPI.js":k=>{"use strict";function K(_,v,C){var l="";C.supports&&(l+="@supports (".concat(C.supports,") {")),C.media&&(l+="@media ".concat(C.media," {"));var u=typeof C.layer!="undefined";u&&(l+="@layer".concat(C.layer.length>0?" ".concat(C.layer):""," {")),l+=C.css,u&&(l+="}"),C.media&&(l+="}"),C.supports&&(l+="}");var p=C.sourceMap;p&&typeof btoa!="undefined"&&(l+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(p))))," */")),v.styleTagTransform(l,_,v.options)}function f(_){if(_.parentNode===null)return!1;_.parentNode.removeChild(_)}function y(_){if(typeof document=="undefined")return{update:function(){},remove:function(){}};var v=_.insertStyleElement(_);return{update:function(l){K(v,_,l)},remove:function(){f(v)}}}k.exports=y},"./node_modules/style-loader/dist/runtime/styleTagTransform.js":k=>{"use strict";function K(f,y){if(y.styleSheet)y.styleSheet.cssText=f;else{for(;y.firstChild;)y.removeChild(y.firstChild);y.appendChild(document.createTextNode(f))}}k.exports=K},"data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E":k=>{"use strict";k.exports="data:image/svg+xml,%3C%3Fxml version=%271.0%27 encoding=%27UTF-8%27 standalone=%27no%27%3F%3E%3Csvg width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27 version=%271.1%27 id=%27svg320%27 sodipodi:docname=%27fullscreen-aframe.svg%27 xml:space=%27preserve%27 inkscape:version=%271.2.1 %289c6d41e  2022-07-14%29%27 xmlns:inkscape=%27http://www.inkscape.org/namespaces/inkscape%27 xmlns:sodipodi=%27http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd%27 xmlns=%27http://www.w3.org/2000/svg%27 xmlns:svg=%27http://www.w3.org/2000/svg%27 xmlns:rdf=%27http://www.w3.org/1999/02/22-rdf-syntax-ns%23%27 xmlns:cc=%27http://creativecommons.org/ns%23%27 xmlns:dc=%27http://purl.org/dc/elements/1.1/%27%3E%3Cdefs id=%27defs324%27 /%3E%3Csodipodi:namedview id=%27namedview322%27 pagecolor=%27%23ffffff%27 bordercolor=%27%23000000%27 borderopacity=%270.25%27 inkscape:showpageshadow=%272%27 inkscape:pageopacity=%270.0%27 inkscape:pagecheckerboard=%270%27 inkscape:deskcolor=%27%23d1d1d1%27 showgrid=%27false%27 inkscape:zoom=%273.8064516%27 inkscape:cx=%2791.423729%27 inkscape:cy=%27-1.4449153%27 inkscape:window-width=%271440%27 inkscape:window-height=%27847%27 inkscape:window-x=%2732%27 inkscape:window-y=%2725%27 inkscape:window-maximized=%270%27 inkscape:current-layer=%27svg320%27 /%3E%3Ctitle id=%27title312%27%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96 0H12A12 12 0 0 0 0 12V50A12 12 0 0 0 12 62H96a12 12 0 0 0 12-12V12A12 12 0 0 0 96 0Zm8 50a8 8 0 0 1-8 8H12a8 8 0 0 1-8-8V12a8 8 0 0 1 8-8H96a8 8 0 0 1 8 8Z%27 fill=%27%23fff%27 id=%27path314%27 style=%27fill:%23ffffff%27 /%3E%3Cg id=%27g356%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g358%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g360%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g362%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g364%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g366%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g368%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g370%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g372%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g374%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g376%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g378%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g380%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g382%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cg id=%27g384%27 transform=%27translate%28-206.61017 -232.61864%29%27%3E%3C/g%3E%3Cmetadata id=%27metadata561%27%3E%3Crdf:RDF%3E%3Ccc:Work rdf:about=%27%27%3E%3Cdc:title%3Eaframe-armode-noborder-reduced-tracking%3C/dc:title%3E%3C/cc:Work%3E%3C/rdf:RDF%3E%3C/metadata%3E%3Cpath d=%27m 98.168511 40.083649 c 0 -1.303681 -0.998788 -2.358041 -2.239389 -2.358041 -1.230088 0.0031 -2.240892 1.05436 -2.240892 2.358041 v 4.881296 l -9.041661 -9.041662 c -0.874129 -0.875631 -2.288954 -0.875631 -3.16308 0 -0.874129 0.874126 -0.874129 2.293459 0 3.167585 l 8.995101 8.992101 h -4.858767 c -1.323206 0.0031 -2.389583 1.004796 -2.389583 2.239386 0 1.237598 1.066377 2.237888 2.389583 2.237888 h 10.154599 c 1.323206 0 2.388082 -0.998789 2.392587 -2.237888 -0.0044 -0.03305 -0.009 -0.05858 -0.0134 -0.09161 0.0046 -0.04207 0.0134 -0.08712 0.0134 -0.13066 V 40.085172 h -1.52e-4%27 id=%27path596%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 23.091002 35.921781 -9.026643 9.041662 v -4.881296 c 0 -1.303681 -1.009302 -2.355037 -2.242393 -2.358041 -1.237598 0 -2.237888 1.05436 -2.237888 2.358041 l -0.0031 10.016421 c 0 0.04356 0.01211 0.08862 0.0015 0.130659 -0.0031 0.03153 -0.009 0.05709 -0.01211 0.09161 0.0031 1.239099 1.069379 2.237888 2.391085 2.237888 h 10.156101 c 1.320202 0 2.388079 -1.000291 2.388079 -2.237888 0 -1.234591 -1.067877 -2.236383 -2.388079 -2.239387 h -4.858767 l 8.995101 -8.9921 c 0.871126 -0.874127 0.871126 -2.293459 0 -3.167586 -0.875628 -0.877132 -2.291957 -0.877132 -3.169087 -1.52e-4%27 id=%27path598%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 84.649572 25.978033 9.041662 -9.041664 v 4.881298 c 0 1.299176 1.010806 2.350532 2.240891 2.355037 1.240601 0 2.23939 -1.055861 2.23939 -2.355037 V 11.798242 c 0 -0.04356 -0.009 -0.08862 -0.0134 -0.127671 0.0044 -0.03153 0.009 -0.06157 0.0134 -0.09313 -0.0044 -1.240598 -1.069379 -2.2393873 -2.391085 -2.2393873 h -10.1546 c -1.323205 0 -2.38958 0.9987893 -2.38958 2.2393873 0 1.233091 1.066375 2.237887 2.38958 2.240891 h 4.858768 l -8.995102 8.9921 c -0.874129 0.872625 -0.874129 2.288954 0 3.161578 0.874127 0.880137 2.288951 0.880137 3.16308 1.5e-4%27 id=%27path600%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3Cpath d=%27m 17.264988 13.822853 h 4.857265 c 1.320202 -0.0031 2.388079 -1.0078 2.388079 -2.240889 0 -1.240601 -1.067877 -2.2393893 -2.388079 -2.2393893 H 11.967654 c -1.321707 0 -2.388082 0.9987883 -2.391085 2.2393893 0.0031 0.03153 0.009 0.06157 0.01211 0.09313 -0.0031 0.03905 -0.0015 0.08262 -0.0015 0.127671 l 0.0031 10.020926 c 0 1.299176 1.00029 2.355038 2.237887 2.355038 1.233092 -0.0044 2.242393 -1.055862 2.242393 -2.355038 v -4.881295 l 9.026644 9.041661 c 0.877132 0.878635 2.293459 0.878635 3.169087 0 0.871125 -0.872624 0.871125 -2.288953 0 -3.161577 l -8.995282 -8.993616%27 id=%27path602%27 style=%27fill:%23ffffff%3Bstroke-width:1.50194%27 /%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":k=>{"use strict";k.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E":k=>{"use strict";k.exports="data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27108%27 height=%2762%27 viewBox=%270 0 108 62%27%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d=%27M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z%27 fill=%27%23fff%27/%3E%3Cpath d=%27M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z%27 fill=%27%23fff%27/%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E":k=>{"use strict";k.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E"},"data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E":k=>{"use strict";k.exports="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E"},"./node_modules/three/build/three.module.js":(k,K,f)=>{"use strict";f.r(K),f.d(K,{ACESFilmicToneMapping:()=>vt,AddEquation:()=>W,AddOperation:()=>Fi,AdditiveAnimationBlendMode:()=>as,AdditiveBlending:()=>M,AgXToneMapping:()=>oe,AlphaFormat:()=>ps,AlwaysCompare:()=>ol,AlwaysDepth:()=>Sn,AlwaysStencilFunc:()=>ga,AmbientLight:()=>op,AnimationAction:()=>xp,AnimationClip:()=>qa,AnimationLoader:()=>sE,AnimationMixer:()=>PE,AnimationObjectGroup:()=>LE,AnimationUtils:()=>tE,ArcCurve:()=>xf,ArrayCamera:()=>Kh,ArrowHelper:()=>n1,AttachedBindMode:()=>fe,Audio:()=>Ep,AudioAnalyser:()=>xE,AudioContext:()=>Sd,AudioListener:()=>EE,AudioLoader:()=>mE,AxesHelper:()=>i1,BackSide:()=>x,BasicDepthPacking:()=>As,BasicShadowMap:()=>c,BatchedMesh:()=>ff,Bone:()=>$h,BooleanKeyframeTrack:()=>To,Box2:()=>VE,Box3:()=>ji,Box3Helper:()=>e1,BoxGeometry:()=>go,BoxHelper:()=>$E,BufferAttribute:()=>Si,BufferGeometry:()=>zn,BufferGeometryLoader:()=>dp,ByteType:()=>es,Cache:()=>Us,Camera:()=>Tl,CameraHelper:()=>ZE,CanvasTexture:()=>wv,CapsuleGeometry:()=>rc,CatmullRomCurve3:()=>bf,CineonToneMapping:()=>Ei,CircleGeometry:()=>sc,ClampToEdgeWrapping:()=>De,Clock:()=>mp,Color:()=>qt,ColorKeyframeTrack:()=>Cd,ColorManagement:()=>Ai,CompressedArrayTexture:()=>bv,CompressedCubeTexture:()=>_v,CompressedTexture:()=>ec,CompressedTextureLoader:()=>oE,ConeGeometry:()=>oc,ConstantAlphaFactor:()=>kt,ConstantColorFactor:()=>pt,CubeCamera:()=>pu,CubeReflectionMapping:()=>z,CubeRefractionMapping:()=>I,CubeTexture:()=>Ia,CubeTextureLoader:()=>aE,CubeUVReflectionMapping:()=>he,CubicBezierCurve:()=>cd,CubicBezierCurve3:()=>wf,CubicInterpolant:()=>Yf,CullFaceBack:()=>l,CullFaceFront:()=>u,CullFaceFrontBack:()=>p,CullFaceNone:()=>C,Curve:()=>us,CurvePath:()=>Sf,CustomBlending:()=>Y,CustomToneMapping:()=>ae,CylinderGeometry:()=>pa,Cylindrical:()=>QE,Data3DTexture:()=>Rn,DataArrayTexture:()=>Qo,DataTexture:()=>$s,DataTextureLoader:()=>lE,DataUtils:()=>Zp,DecrementStencilOp:()=>Nc,DecrementWrapStencilOp:()=>Gc,DefaultLoadingManager:()=>Zf,DepthFormat:()=>We,DepthStencilFormat:()=>st,DepthTexture:()=>Vh,DetachedBindMode:()=>Ee,DirectionalLight:()=>sp,DirectionalLightHelper:()=>JE,DiscreteInterpolant:()=>qf,DisplayP3ColorSpace:()=>Uo,DodecahedronGeometry:()=>ac,DoubleSide:()=>S,DstAlphaFactor:()=>Ue,DstColorFactor:()=>nt,DynamicCopyUsage:()=>th,DynamicDrawUsage:()=>Yc,DynamicReadUsage:()=>Zc,EdgesGeometry:()=>If,EllipseCurve:()=>tc,EqualCompare:()=>nl,EqualDepth:()=>En,EqualStencilFunc:()=>zc,EquirectangularReflectionMapping:()=>R,EquirectangularRefractionMapping:()=>ee,Euler:()=>qr,EventDispatcher:()=>Dr,ExtrudeGeometry:()=>pc,FileLoader:()=>ks,Float16BufferAttribute:()=>rA,Float32BufferAttribute:()=>an,FloatType:()=>Ni,Fog:()=>Ul,FogExp2:()=>Ol,FramebufferTexture:()=>xv,FrontSide:()=>m,Frustum:()=>Ta,GLBufferAttribute:()=>NE,GLSL1:()=>ih,GLSL3:()=>Ea,GreaterCompare:()=>il,GreaterDepth:()=>si,GreaterEqualCompare:()=>sl,GreaterEqualDepth:()=>fi,GreaterEqualStencilFunc:()=>Xc,GreaterStencilFunc:()=>Wc,GridHelper:()=>YE,Group:()=>xo,HalfFloatType:()=>Ci,HemisphereLight:()=>$f,HemisphereLightHelper:()=>XE,IcosahedronGeometry:()=>Ac,ImageBitmapLoader:()=>AE,ImageLoader:()=>Ja,ImageUtils:()=>Ws,IncrementStencilOp:()=>Uc,IncrementWrapStencilOp:()=>kc,InstancedBufferAttribute:()=>da,InstancedBufferGeometry:()=>hp,InstancedInterleavedBuffer:()=>UE,InstancedMesh:()=>hf,Int16BufferAttribute:()=>nA,Int32BufferAttribute:()=>iA,Int8BufferAttribute:()=>$p,IntType:()=>ts,InterleavedBuffer:()=>Nl,InterleavedBufferAttribute:()=>_o,Interpolant:()=>Ka,InterpolateDiscrete:()=>nr,InterpolateLinear:()=>ir,InterpolateSmooth:()=>sr,InvertStencilOp:()=>Qc,KeepStencilOp:()=>Is,KeyframeTrack:()=>fs,LOD:()=>$u,LatheGeometry:()=>Qa,Layers:()=>gl,LessCompare:()=>tl,LessDepth:()=>Nn,LessEqualCompare:()=>va,LessEqualDepth:()=>ln,LessEqualStencilFunc:()=>jc,LessStencilFunc:()=>Hc,Light:()=>io,LightProbe:()=>cp,Line:()=>to,Line3:()=>HE,LineBasicMaterial:()=>Nr,LineCurve:()=>hd,LineCurve3:()=>Mf,LineDashedMaterial:()=>Wf,LineLoop:()=>vf,LineSegments:()=>ys,LinearDisplayP3ColorSpace:()=>ao,LinearFilter:()=>pn,LinearInterpolant:()=>yd,LinearMipMapLinearFilter:()=>kr,LinearMipMapNearestFilter:()=>ti,LinearMipmapLinearFilter:()=>yi,LinearMipmapNearestFilter:()=>Oi,LinearSRGBColorSpace:()=>ls,LinearToneMapping:()=>mr,LinearTransfer:()=>lo,Loader:()=>zr,LoaderUtils:()=>Md,LoadingManager:()=>xd,LoopOnce:()=>Ri,LoopPingPong:()=>tr,LoopRepeat:()=>wi,LuminanceAlphaFormat:()=>$e,LuminanceFormat:()=>Ne,MOUSE:()=>_,Material:()=>Tr,MaterialLoader:()=>xc,MathUtils:()=>yh,Matrix3:()=>Bn,Matrix4:()=>rn,MaxEquation:()=>V,Mesh:()=>ar,MeshBasicMaterial:()=>qs,MeshDepthMaterial:()=>jh,MeshDistanceMaterial:()=>Wh,MeshLambertMaterial:()=>zf,MeshMatcapMaterial:()=>jf,MeshNormalMaterial:()=>Hf,MeshPhongMaterial:()=>Qf,MeshPhysicalMaterial:()=>Gf,MeshStandardMaterial:()=>gd,MeshToonMaterial:()=>Vf,MinEquation:()=>X,MirroredRepeatWrapping:()=>Ct,MixOperation:()=>Jn,MultiplyBlending:()=>H,MultiplyOperation:()=>pi,NearestFilter:()=>Bt,NearestMipMapLinearFilter:()=>Qi,NearestMipMapNearestFilter:()=>Mt,NearestMipmapLinearFilter:()=>Xt,NearestMipmapNearestFilter:()=>_t,NeutralToneMapping:()=>Ce,NeverCompare:()=>el,NeverDepth:()=>yn,NeverStencilFunc:()=>Vc,NoBlending:()=>b,NoColorSpace:()=>br,NoToneMapping:()=>vi,NormalAnimationBlendMode:()=>ns,NormalBlending:()=>L,NotEqualCompare:()=>rl,NotEqualDepth:()=>qi,NotEqualStencilFunc:()=>Kc,NumberKeyframeTrack:()=>Xa,Object3D:()=>hi,ObjectLoader:()=>fE,ObjectSpaceNormalMap:()=>gs,OctahedronGeometry:()=>ja,OneFactor:()=>Z,OneMinusConstantAlphaFactor:()=>un,OneMinusConstantColorFactor:()=>Tt,OneMinusDstAlphaFactor:()=>je,OneMinusDstColorFactor:()=>mt,OneMinusSrcAlphaFactor:()=>Re,OneMinusSrcColorFactor:()=>pe,OrthographicCamera:()=>Ll,P3Primaries:()=>ho,PCFShadowMap:()=>g,PCFSoftShadowMap:()=>A,PMREMGenerator:()=>Gh,Path:()=>Ga,PerspectiveCamera:()=>dr,Plane:()=>Zs,PlaneGeometry:()=>ia,PlaneHelper:()=>t1,PointLight:()=>rp,PointLightHelper:()=>WE,Points:()=>yf,PointsMaterial:()=>id,PolarGridHelper:()=>qE,PolyhedronGeometry:()=>no,PositionalAudio:()=>CE,PropertyBinding:()=>ai,PropertyMixer:()=>Cp,QuadraticBezierCurve:()=>dd,QuadraticBezierCurve3:()=>ud,Quaternion:()=>ci,QuaternionKeyframeTrack:()=>ma,QuaternionLinearInterpolant:()=>Jf,RED_GREEN_RGTC2_Format:()=>li,RED_RGTC1_Format:()=>_n,REVISION:()=>y,RGBADepthPacking:()=>ms,RGBAFormat:()=>Me,RGBAIntegerFormat:()=>on,RGBA_ASTC_10x10_Format:()=>et,RGBA_ASTC_10x5_Format:()=>lt,RGBA_ASTC_10x6_Format:()=>at,RGBA_ASTC_10x8_Format:()=>Ve,RGBA_ASTC_12x10_Format:()=>Et,RGBA_ASTC_12x12_Format:()=>zt,RGBA_ASTC_4x4_Format:()=>$n,RGBA_ASTC_5x4_Format:()=>U,RGBA_ASTC_5x5_Format:()=>Q,RGBA_ASTC_6x5_Format:()=>q,RGBA_ASTC_6x6_Format:()=>ie,RGBA_ASTC_8x5_Format:()=>Ae,RGBA_ASTC_8x6_Format:()=>Pe,RGBA_ASTC_8x8_Format:()=>ze,RGBA_BPTC_Format:()=>tn,RGBA_ETC2_EAC_Format:()=>Hi,RGBA_PVRTC_2BPPV1_Format:()=>er,RGBA_PVRTC_4BPPV1_Format:()=>Bi,RGBA_S3TC_DXT1_Format:()=>Cn,RGBA_S3TC_DXT3_Format:()=>xi,RGBA_S3TC_DXT5_Format:()=>Fn,RGBFormat:()=>ue,RGB_BPTC_SIGNED_Format:()=>mn,RGB_BPTC_UNSIGNED_Format:()=>Ln,RGB_ETC1_Format:()=>Qt,RGB_ETC2_Format:()=>On,RGB_PVRTC_2BPPV1_Format:()=>Yn,RGB_PVRTC_4BPPV1_Format:()=>In,RGB_S3TC_DXT1_Format:()=>An,RGFormat:()=>Gt,RGIntegerFormat:()=>ot,RawShaderMaterial:()=>kf,Ray:()=>hr,Raycaster:()=>kE,Rec709Primaries:()=>co,RectAreaLight:()=>ap,RedFormat:()=>yt,RedIntegerFormat:()=>$t,ReinhardToneMapping:()=>Ji,RenderTarget:()=>Go,RepeatWrapping:()=>_e,ReplaceStencilOp:()=>Oc,ReverseSubtractEquation:()=>re,RingGeometry:()=>mc,SIGNED_RED_GREEN_RGTC2_Format:()=>_i,SIGNED_RED_RGTC1_Format:()=>vn,SRGBColorSpace:()=>ni,SRGBTransfer:()=>Ii,Scene:()=>Ku,ShaderChunk:()=>Qn,ShaderLib:()=>ds,ShaderMaterial:()=>hs,ShadowMaterial:()=>Nf,Shape:()=>Mo,ShapeGeometry:()=>gc,ShapePath:()=>r1,ShapeUtils:()=>Cs,ShortType:()=>Zi,Skeleton:()=>zl,SkeletonHelper:()=>jE,SkinnedMesh:()=>of,Source:()=>ki,Sphere:()=>cr,SphereGeometry:()=>Wa,Spherical:()=>GE,SphericalHarmonics3:()=>lp,SplineCurve:()=>fd,SpotLight:()=>np,SpotLightHelper:()=>zE,Sprite:()=>Ju,SpriteMaterial:()=>Yh,SrcAlphaFactor:()=>be,SrcAlphaSaturateFactor:()=>Dt,SrcColorFactor:()=>ne,StaticCopyUsage:()=>eh,StaticDrawUsage:()=>uo,StaticReadUsage:()=>Jc,StereoCamera:()=>gE,StreamCopyUsage:()=>nh,StreamDrawUsage:()=>qc,StreamReadUsage:()=>$c,StringKeyframeTrack:()=>Bo,SubtractEquation:()=>te,SubtractiveBlending:()=>F,TOUCH:()=>v,TangentSpaceNormalMap:()=>Mr,TetrahedronGeometry:()=>vc,Texture:()=>Li,TextureLoader:()=>cE,TorusGeometry:()=>Ec,TorusKnotGeometry:()=>yc,Triangle:()=>Jr,TriangleFanDrawMode:()=>Ss,TriangleStripDrawMode:()=>Ms,TrianglesDrawMode:()=>ws,TubeGeometry:()=>Cc,UVMapping:()=>xe,Uint16BufferAttribute:()=>Th,Uint32BufferAttribute:()=>Bh,Uint8BufferAttribute:()=>eA,Uint8ClampedBufferAttribute:()=>tA,Uniform:()=>Bd,UniformsGroup:()=>OE,UniformsLib:()=>Ut,UniformsUtils:()=>du,UnsignedByteType:()=>Ui,UnsignedInt248Type:()=>jr,UnsignedInt5999Type:()=>Vs,UnsignedIntType:()=>xr,UnsignedShort4444Type:()=>$i,UnsignedShort5551Type:()=>_s,UnsignedShortType:()=>Lr,VSMShadowMap:()=>h,Vector2:()=>ht,Vector3:()=>ve,Vector4:()=>oi,VectorKeyframeTrack:()=>Ya,VideoTexture:()=>Cv,WebGL3DRenderTarget:()=>ei,WebGLArrayRenderTarget:()=>en,WebGLCoordinateSystem:()=>is,WebGLCubeRenderTarget:()=>Au,WebGLMultipleRenderTargets:()=>s1,WebGLRenderTarget:()=>Gr,WebGLRenderer:()=>uv,WebGLUtils:()=>Vu,WebGPUCoordinateSystem:()=>fo,WireframeGeometry:()=>Ff,WrapAroundEnding:()=>Wr,ZeroCurvatureEnding:()=>zi,ZeroFactor:()=>O,ZeroSlopeEnding:()=>gr,ZeroStencilOp:()=>Fc,createCanvasElement:()=>cl});let y="164",_={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},v={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},C=0,l=1,u=2,p=3,c=0,g=1,A=2,h=3,m=0,x=1,S=2,b=0,L=1,M=2,F=3,H=4,Y=5,W=100,te=101,re=102,X=103,V=104,O=200,Z=201,ne=202,pe=203,be=204,Re=205,Ue=206,je=207,nt=208,mt=209,Dt=210,pt=211,Tt=212,kt=213,un=214,yn=0,Sn=1,Nn=2,ln=3,En=4,fi=5,si=6,qi=7,pi=0,Jn=1,Fi=2,vi=0,mr=1,Ji=2,Ei=3,vt=4,ae=5,oe=6,Ce=7,fe="attached",Ee="detached",xe=300,z=301,I=302,R=303,ee=304,he=306,_e=1e3,De=1001,Ct=1002,Bt=1003,_t=1004,Mt=1004,Xt=1005,Qi=1005,pn=1006,Oi=1007,ti=1007,yi=1008,kr=1008,Ui=1009,es=1010,Zi=1011,Lr=1012,ts=1013,xr=1014,Ni=1015,Ci=1016,$i=1017,_s=1018,jr=1020,Vs=35902,ps=1021,ue=1022,Me=1023,Ne=1024,$e=1025,We=1026,st=1027,yt=1028,$t=1029,Gt=1030,ot=1031,on=1033,An=33776,Cn=33777,xi=33778,Fn=33779,In=35840,Yn=35841,Bi=35842,er=35843,Qt=36196,On=37492,Hi=37496,$n=37808,U=37809,Q=37810,q=37811,ie=37812,Ae=37813,Pe=37814,ze=37815,lt=37816,at=37817,Ve=37818,et=37819,Et=37820,zt=37821,tn=36492,mn=36494,Ln=36495,_n=36283,vn=36284,li=36285,_i=36286,Ri=2200,wi=2201,tr=2202,nr=2300,ir=2301,sr=2302,zi=2400,gr=2401,Wr=2402,ns=2500,as=2501,ws=0,Ms=1,Ss=2,As=3200,ms=3201,Mr=0,gs=1,br="",ni="srgb",ls="srgb-linear",Uo="display-p3",ao="display-p3-linear",lo="linear",Ii="srgb",co="rec709",ho="p3",Fc=0,Is=7680,Oc=7681,Uc=7682,Nc=7683,kc=34055,Gc=34056,Qc=5386,Vc=512,Hc=513,zc=514,jc=515,Wc=516,Kc=517,Xc=518,ga=519,el=512,tl=513,nl=514,va=515,il=516,rl=517,sl=518,ol=519,uo=35044,Yc=35048,qc=35040,Jc=35045,Zc=35049,$c=35041,eh=35046,th=35050,nh=35042,ih="100",Ea="300 es",is=2e3,fo=2001;class Dr{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let i=this._listeners[e];if(i!==void 0){let r=i.indexOf(t);r!==-1&&i.splice(r,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let n=this._listeners[e.type];if(n!==void 0){e.target=this;let i=n.slice(0);for(let r=0,o=i.length;r<o;r++)i[r].call(this,e);e.target=null}}}let vr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],al=1234567,Ts=Math.PI/180,Hs=180/Math.PI;function Pr(){let s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(vr[s&255]+vr[s>>8&255]+vr[s>>16&255]+vr[s>>24&255]+"-"+vr[e&255]+vr[e>>8&255]+"-"+vr[e>>16&15|64]+vr[e>>24&255]+"-"+vr[t&63|128]+vr[t>>8&255]+"-"+vr[t>>16&255]+vr[t>>24&255]+vr[n&255]+vr[n>>8&255]+vr[n>>16&255]+vr[n>>24&255]).toLowerCase()}function Vi(s,e,t){return Math.max(e,Math.min(t,s))}function ya(s,e){return(s%e+e)%e}function rh(s,e,t,n,i){return n+(s-e)*(i-n)/(t-e)}function sh(s,e,t){return s!==e?(t-s)/(e-s):0}function po(s,e,t){return(1-t)*s+t*e}function oh(s,e,t,n){return po(s,e,1-Math.exp(-t*n))}function ah(s,e=1){return e-Math.abs(ya(s,e*2)-e)}function lh(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*(3-2*s))}function ch(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*s*(s*(s*6-15)+10))}function hh(s,e){return s+Math.floor(Math.random()*(e-s+1))}function dh(s,e){return s+Math.random()*(e-s)}function uh(s){return s*(.5-Math.random())}function fh(s){s!==void 0&&(al=s);let e=al+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function ph(s){return s*Ts}function Ah(s){return s*Hs}function mh(s){return(s&s-1)==0&&s!==0}function gh(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function vh(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function Eh(s,e,t,n,i){let r=Math.cos,o=Math.sin,a=r(t/2),d=o(t/2),E=r((e+n)/2),w=o((e+n)/2),T=r((e-n)/2),B=o((e-n)/2),D=r((n-e)/2),N=o((n-e)/2);switch(i){case"XYX":s.set(a*w,d*T,d*B,a*E);break;case"YZY":s.set(d*B,a*w,d*T,a*E);break;case"ZXZ":s.set(d*T,d*B,a*w,a*E);break;case"XZX":s.set(a*w,d*N,d*D,a*E);break;case"YXY":s.set(d*D,a*w,d*N,a*E);break;case"ZYZ":s.set(d*N,d*D,a*w,a*E);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function _r(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function Dn(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}let yh={DEG2RAD:Ts,RAD2DEG:Hs,generateUUID:Pr,clamp:Vi,euclideanModulo:ya,mapLinear:rh,inverseLerp:sh,lerp:po,damp:oh,pingpong:ah,smoothstep:lh,smootherstep:ch,randInt:hh,randFloat:dh,randFloatSpread:uh,seededRandom:fh,degToRad:ph,radToDeg:Ah,isPowerOfTwo:mh,ceilPowerOfTwo:gh,floorPowerOfTwo:vh,setQuaternionFromProperEuler:Eh,normalize:Dn,denormalize:_r};class ht{constructor(e=0,t=0){ht.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(Vi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*n-o*i+e.x,this.y=r*i+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Bn{constructor(e,t,n,i,r,o,a,d,E){Bn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,i,r,o,a,d,E)}set(e,t,n,i,r,o,a,d,E){let w=this.elements;return w[0]=e,w[1]=i,w[2]=a,w[3]=t,w[4]=r,w[5]=d,w[6]=n,w[7]=o,w[8]=E,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,i=t.elements,r=this.elements,o=n[0],a=n[3],d=n[6],E=n[1],w=n[4],T=n[7],B=n[2],D=n[5],N=n[8],j=i[0],G=i[3],P=i[6],se=i[1],$=i[4],J=i[7],Be=i[2],ge=i[5],we=i[8];return r[0]=o*j+a*se+d*Be,r[3]=o*G+a*$+d*ge,r[6]=o*P+a*J+d*we,r[1]=E*j+w*se+T*Be,r[4]=E*G+w*$+T*ge,r[7]=E*P+w*J+T*we,r[2]=B*j+D*se+N*Be,r[5]=B*G+D*$+N*ge,r[8]=B*P+D*J+N*we,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],d=e[6],E=e[7],w=e[8];return t*o*w-t*a*E-n*r*w+n*a*d+i*r*E-i*o*d}invert(){let e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],d=e[6],E=e[7],w=e[8],T=w*o-a*E,B=a*d-w*r,D=E*r-o*d,N=t*T+n*B+i*D;if(N===0)return this.set(0,0,0,0,0,0,0,0,0);let j=1/N;return e[0]=T*j,e[1]=(i*E-w*n)*j,e[2]=(a*n-i*o)*j,e[3]=B*j,e[4]=(w*t-i*d)*j,e[5]=(i*r-a*t)*j,e[6]=D*j,e[7]=(n*d-E*t)*j,e[8]=(o*t-n*r)*j,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,r,o,a){let d=Math.cos(r),E=Math.sin(r);return this.set(n*d,n*E,-n*(d*o+E*a)+o+e,-i*E,i*d,-i*(-E*o+d*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(Ca.makeScale(e,t)),this}rotate(e){return this.premultiply(Ca.makeRotation(-e)),this}translate(e,t){return this.premultiply(Ca.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){let n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}let Ca=new Bn;function ll(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}let Ch={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function zs(s,e){return new Ch[s](e)}function Ao(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function cl(){let s=Ao("canvas");return s.style.display="block",s}let hl={};function dl(s){s in hl||(hl[s]=!0,console.warn(s))}let ul=new Bn().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),fl=new Bn().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),No={[ls]:{transfer:lo,primaries:co,toReference:s=>s,fromReference:s=>s},[ni]:{transfer:Ii,primaries:co,toReference:s=>s.convertSRGBToLinear(),fromReference:s=>s.convertLinearToSRGB()},[ao]:{transfer:lo,primaries:ho,toReference:s=>s.applyMatrix3(fl),fromReference:s=>s.applyMatrix3(ul)},[Uo]:{transfer:Ii,primaries:ho,toReference:s=>s.convertSRGBToLinear().applyMatrix3(fl),fromReference:s=>s.applyMatrix3(ul).convertLinearToSRGB()}},xh=new Set([ls,ao]),Ai={enabled:!0,_workingColorSpace:ls,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(s){if(!xh.has(s))throw new Error(`Unsupported working color space, "${s}".`);this._workingColorSpace=s},convert:function(s,e,t){if(this.enabled===!1||e===t||!e||!t)return s;let n=No[e].toReference;return No[t].fromReference(n(s))},fromWorkingColorSpace:function(s,e){return this.convert(s,this._workingColorSpace,e)},toWorkingColorSpace:function(s,e){return this.convert(s,e,this._workingColorSpace)},getPrimaries:function(s){return No[s].primaries},getTransfer:function(s){return s===br?lo:No[s].transfer}};function js(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function xa(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}let Bs;class Ws{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement=="undefined")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Bs===void 0&&(Bs=Ao("canvas")),Bs.width=e.width,Bs.height=e.height;let n=Bs.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Bs}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement!="undefined"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&e instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&e instanceof ImageBitmap){let t=Ao("canvas");t.width=e.width,t.height=e.height;let n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);let i=n.getImageData(0,0,e.width,e.height),r=i.data;for(let o=0;o<r.length;o++)r[o]=js(r[o]/255)*255;return n.putImageData(i,0,0),t}else if(e.data){let t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(js(t[n]/255)*255):t[n]=js(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let pl=0;class ki{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:pl++}),this.uuid=Pr(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let r;if(Array.isArray(i)){r=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?r.push(ko(i[o].image)):r.push(ko(i[o]))}else r=ko(i);n.url=r}return t||(e.images[this.uuid]=n),n}}function ko(s){return typeof HTMLImageElement!="undefined"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&s instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&s instanceof ImageBitmap?Ws.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Al=0;class Li extends Dr{constructor(e=Li.DEFAULT_IMAGE,t=Li.DEFAULT_MAPPING,n=De,i=De,r=pn,o=yi,a=Me,d=Ui,E=Li.DEFAULT_ANISOTROPY,w=br){super();this.isTexture=!0,Object.defineProperty(this,"id",{value:Al++}),this.uuid=Pr(),this.name="",this.source=new ki(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=o,this.anisotropy=E,this.format=a,this.internalFormat=null,this.type=d,this.offset=new ht(0,0),this.repeat=new ht(1,1),this.center=new ht(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Bn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=w,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==xe)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case _e:e.x=e.x-Math.floor(e.x);break;case De:e.x=e.x<0?0:1;break;case Ct:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case _e:e.y=e.y-Math.floor(e.y);break;case De:e.y=e.y<0?0:1;break;case Ct:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Li.DEFAULT_IMAGE=null,Li.DEFAULT_MAPPING=xe,Li.DEFAULT_ANISOTROPY=1;class oi{constructor(e=0,t=0,n=0,i=1){oi.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,n=this.y,i=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*i+o[12]*r,this.y=o[1]*t+o[5]*n+o[9]*i+o[13]*r,this.z=o[2]*t+o[6]*n+o[10]*i+o[14]*r,this.w=o[3]*t+o[7]*n+o[11]*i+o[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,r,o=.01,a=.1,d=e.elements,E=d[0],w=d[4],T=d[8],B=d[1],D=d[5],N=d[9],j=d[2],G=d[6],P=d[10];if(Math.abs(w-B)<o&&Math.abs(T-j)<o&&Math.abs(N-G)<o){if(Math.abs(w+B)<a&&Math.abs(T+j)<a&&Math.abs(N+G)<a&&Math.abs(E+D+P-3)<a)return this.set(1,0,0,0),this;t=Math.PI;let $=(E+1)/2,J=(D+1)/2,Be=(P+1)/2,ge=(w+B)/4,we=(T+j)/4,Te=(N+G)/4;return $>J&&$>Be?$<o?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt($),i=ge/n,r=we/n):J>Be?J<o?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(J),n=ge/i,r=Te/i):Be<o?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(Be),n=we/r,i=Te/r),this.set(n,i,r,t),this}let se=Math.sqrt((G-N)*(G-N)+(T-j)*(T-j)+(B-w)*(B-w));return Math.abs(se)<.001&&(se=1),this.x=(G-N)/se,this.y=(T-j)/se,this.z=(B-w)/se,this.w=Math.acos((E+D+P-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Go extends Dr{constructor(e=1,t=1,n={}){super();this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new oi(0,0,e,t),this.scissorTest=!1,this.viewport=new oi(0,0,e,t);let i={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:pn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);let r=new Li(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);r.flipY=!1,r.generateMipmaps=n.generateMipmaps,r.internalFormat=n.internalFormat,this.textures=[];let o=n.count;for(let a=0;a<o;a++)this.textures[a]=r.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,r=this.textures.length;i<r;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new ki(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Gr extends Go{constructor(e=1,t=1,n={}){super(e,t,n);this.isWebGLRenderTarget=!0}}class Qo extends Li{constructor(e=null,t=1,n=1,i=1){super(null);this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Bt,this.minFilter=Bt,this.wrapR=De,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class en extends Gr{constructor(e=1,t=1,n=1,i={}){super(e,t,i);this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Qo(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class Rn extends Li{constructor(e=null,t=1,n=1,i=1){super(null);this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Bt,this.minFilter=Bt,this.wrapR=De,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ei extends Gr{constructor(e=1,t=1,n=1,i={}){super(e,t,i);this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Rn(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class ci{constructor(e=0,t=0,n=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,r,o,a){let d=n[i+0],E=n[i+1],w=n[i+2],T=n[i+3],B=r[o+0],D=r[o+1],N=r[o+2],j=r[o+3];if(a===0){e[t+0]=d,e[t+1]=E,e[t+2]=w,e[t+3]=T;return}if(a===1){e[t+0]=B,e[t+1]=D,e[t+2]=N,e[t+3]=j;return}if(T!==j||d!==B||E!==D||w!==N){let G=1-a,P=d*B+E*D+w*N+T*j,se=P>=0?1:-1,$=1-P*P;if($>Number.EPSILON){let Be=Math.sqrt($),ge=Math.atan2(Be,P*se);G=Math.sin(G*ge)/Be,a=Math.sin(a*ge)/Be}let J=a*se;if(d=d*G+B*J,E=E*G+D*J,w=w*G+N*J,T=T*G+j*J,G===1-a){let Be=1/Math.sqrt(d*d+E*E+w*w+T*T);d*=Be,E*=Be,w*=Be,T*=Be}}e[t]=d,e[t+1]=E,e[t+2]=w,e[t+3]=T}static multiplyQuaternionsFlat(e,t,n,i,r,o){let a=n[i],d=n[i+1],E=n[i+2],w=n[i+3],T=r[o],B=r[o+1],D=r[o+2],N=r[o+3];return e[t]=a*N+w*T+d*D-E*B,e[t+1]=d*N+w*B+E*T-a*D,e[t+2]=E*N+w*D+a*B-d*T,e[t+3]=w*N-a*T-d*B-E*D,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){let n=e._x,i=e._y,r=e._z,o=e._order,a=Math.cos,d=Math.sin,E=a(n/2),w=a(i/2),T=a(r/2),B=d(n/2),D=d(i/2),N=d(r/2);switch(o){case"XYZ":this._x=B*w*T+E*D*N,this._y=E*D*T-B*w*N,this._z=E*w*N+B*D*T,this._w=E*w*T-B*D*N;break;case"YXZ":this._x=B*w*T+E*D*N,this._y=E*D*T-B*w*N,this._z=E*w*N-B*D*T,this._w=E*w*T+B*D*N;break;case"ZXY":this._x=B*w*T-E*D*N,this._y=E*D*T+B*w*N,this._z=E*w*N+B*D*T,this._w=E*w*T-B*D*N;break;case"ZYX":this._x=B*w*T-E*D*N,this._y=E*D*T+B*w*N,this._z=E*w*N-B*D*T,this._w=E*w*T+B*D*N;break;case"YZX":this._x=B*w*T+E*D*N,this._y=E*D*T+B*w*N,this._z=E*w*N-B*D*T,this._w=E*w*T-B*D*N;break;case"XZY":this._x=B*w*T-E*D*N,this._y=E*D*T-B*w*N,this._z=E*w*N+B*D*T,this._w=E*w*T+B*D*N;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,n=t[0],i=t[4],r=t[8],o=t[1],a=t[5],d=t[9],E=t[2],w=t[6],T=t[10],B=n+a+T;if(B>0){let D=.5/Math.sqrt(B+1);this._w=.25/D,this._x=(w-d)*D,this._y=(r-E)*D,this._z=(o-i)*D}else if(n>a&&n>T){let D=2*Math.sqrt(1+n-a-T);this._w=(w-d)/D,this._x=.25*D,this._y=(i+o)/D,this._z=(r+E)/D}else if(a>T){let D=2*Math.sqrt(1+a-n-T);this._w=(r-E)/D,this._x=(i+o)/D,this._y=.25*D,this._z=(d+w)/D}else{let D=2*Math.sqrt(1+T-n-a);this._w=(o-i)/D,this._x=(r+E)/D,this._y=(d+w)/D,this._z=.25*D}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Vi(this.dot(e),-1,1)))}rotateTowards(e,t){let n=this.angleTo(e);if(n===0)return this;let i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let n=e._x,i=e._y,r=e._z,o=e._w,a=t._x,d=t._y,E=t._z,w=t._w;return this._x=n*w+o*a+i*E-r*d,this._y=i*w+o*d+r*a-n*E,this._z=r*w+o*E+n*d-i*a,this._w=o*w-n*a-i*d-r*E,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let n=this._x,i=this._y,r=this._z,o=this._w,a=o*e._w+n*e._x+i*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=i,this._z=r,this;let d=1-a*a;if(d<=Number.EPSILON){let D=1-t;return this._w=D*o+t*this._w,this._x=D*n+t*this._x,this._y=D*i+t*this._y,this._z=D*r+t*this._z,this.normalize(),this}let E=Math.sqrt(d),w=Math.atan2(E,a),T=Math.sin((1-t)*w)/E,B=Math.sin(t*w)/E;return this._w=o*T+this._w*B,this._x=n*T+this._x*B,this._y=i*T+this._y*B,this._z=r*T+this._z*B,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){let e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),r=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ve{constructor(e=0,t=0,n=0){ve.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Xi.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Xi.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,n=this.y,i=this.z,r=e.elements,o=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*o,this}applyQuaternion(e){let t=this.x,n=this.y,i=this.z,r=e.x,o=e.y,a=e.z,d=e.w,E=2*(o*i-a*n),w=2*(a*t-r*i),T=2*(r*n-o*t);return this.x=t+d*E+o*T-a*w,this.y=n+d*w+a*E-r*T,this.z=i+d*T+r*w-o*E,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let n=e.x,i=e.y,r=e.z,o=t.x,a=t.y,d=t.z;return this.x=i*d-r*a,this.y=r*o-n*d,this.z=n*a-i*o,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Kr.copy(this).projectOnVector(e),this.sub(Kr)}reflect(e){return this.sub(Kr.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(Vi(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){let i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}let Kr=new ve,Xi=new ci;class ji{constructor(e=new ve(1/0,1/0,1/0),t=new ve(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Sr.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Sr.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=Sr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let n=e.geometry;if(n!==void 0){let r=n.getAttribute("position");if(t===!0&&r!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=r.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Sr):Sr.fromBufferAttribute(r,o),Sr.applyMatrix4(e.matrixWorld),this.expandByPoint(Sr);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),vs.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),vs.copy(n.boundingBox)),vs.applyMatrix4(e.matrixWorld),this.union(vs)}let i=e.children;for(let r=0,o=i.length;r<o;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Sr),Sr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(ii),Mi.subVectors(this.max,ii),Qr.subVectors(e.a,ii),Er.subVectors(e.b,ii),kn.subVectors(e.c,ii),wr.subVectors(Er,Qr),Xr.subVectors(kn,Er),yr.subVectors(Qr,kn);let t=[0,-wr.z,wr.y,0,-Xr.z,Xr.y,0,-yr.z,yr.y,wr.z,0,-wr.x,Xr.z,0,-Xr.x,yr.z,0,-yr.x,-wr.y,wr.x,0,-Xr.y,Xr.x,0,-yr.y,yr.x,0];return!Fr(t,Qr,Er,kn,Mi)||(t=[1,0,0,0,1,0,0,0,1],!Fr(t,Qr,Er,kn,Mi))?!1:(Gn.crossVectors(wr,Xr),t=[Gn.x,Gn.y,Gn.z],Fr(t,Qr,Er,kn,Mi))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Sr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Sr).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Zn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Zn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Zn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Zn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Zn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Zn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Zn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Zn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Zn),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}let Zn=[new ve,new ve,new ve,new ve,new ve,new ve,new ve,new ve],Sr=new ve,vs=new ji,Qr=new ve,Er=new ve,kn=new ve,wr=new ve,Xr=new ve,yr=new ve,ii=new ve,Mi=new ve,Gn=new ve,ri=new ve;function Fr(s,e,t,n,i){for(let r=0,o=s.length-3;r<=o;r+=3){ri.fromArray(s,r);let a=i.x*Math.abs(ri.x)+i.y*Math.abs(ri.y)+i.z*Math.abs(ri.z),d=e.dot(ri),E=t.dot(ri),w=n.dot(ri);if(Math.max(-Math.max(d,E,w),Math.min(d,E,w))>a)return!1}return!0}let Ks=new ji,Rs=new ve,Vo=new ve;class cr{constructor(e=new ve,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let n=this.center;t!==void 0?n.copy(t):Ks.setFromPoints(e).getCenter(n);let i=0;for(let r=0,o=e.length;r<o;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Rs.subVectors(e,this.center);let t=Rs.lengthSq();if(t>this.radius*this.radius){let n=Math.sqrt(t),i=(n-this.radius)*.5;this.center.addScaledVector(Rs,i/n),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Vo.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Rs.copy(e.center).add(Vo)),this.expandByPoint(Rs.copy(e.center).sub(Vo))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}let rs=new ve,Ho=new ve,zo=new ve,Es=new ve,ba=new ve,jo=new ve,_a=new ve;class hr{constructor(e=new ve,t=new ve(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,rs)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=rs.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(rs.copy(this.origin).addScaledVector(this.direction,t),rs.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){Ho.copy(e).add(t).multiplyScalar(.5),zo.copy(t).sub(e).normalize(),Es.copy(this.origin).sub(Ho);let r=e.distanceTo(t)*.5,o=-this.direction.dot(zo),a=Es.dot(this.direction),d=-Es.dot(zo),E=Es.lengthSq(),w=Math.abs(1-o*o),T,B,D,N;if(w>0)if(T=o*d-a,B=o*a-d,N=r*w,T>=0)if(B>=-N)if(B<=N){let j=1/w;T*=j,B*=j,D=T*(T+o*B+2*a)+B*(o*T+B+2*d)+E}else B=r,T=Math.max(0,-(o*B+a)),D=-T*T+B*(B+2*d)+E;else B=-r,T=Math.max(0,-(o*B+a)),D=-T*T+B*(B+2*d)+E;else B<=-N?(T=Math.max(0,-(-o*r+a)),B=T>0?-r:Math.min(Math.max(-r,-d),r),D=-T*T+B*(B+2*d)+E):B<=N?(T=0,B=Math.min(Math.max(-r,-d),r),D=B*(B+2*d)+E):(T=Math.max(0,-(o*r+a)),B=T>0?r:Math.min(Math.max(-r,-d),r),D=-T*T+B*(B+2*d)+E);else B=o>0?-r:r,T=Math.max(0,-(o*B+a)),D=-T*T+B*(B+2*d)+E;return n&&n.copy(this.origin).addScaledVector(this.direction,T),i&&i.copy(Ho).addScaledVector(zo,B),D}intersectSphere(e,t){rs.subVectors(e.center,this.origin);let n=rs.dot(this.direction),i=rs.dot(rs)-n*n,r=e.radius*e.radius;if(i>r)return null;let o=Math.sqrt(r-i),a=n-o,d=n+o;return d<0?null:a<0?this.at(d,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){let n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,r,o,a,d,E=1/this.direction.x,w=1/this.direction.y,T=1/this.direction.z,B=this.origin;return E>=0?(n=(e.min.x-B.x)*E,i=(e.max.x-B.x)*E):(n=(e.max.x-B.x)*E,i=(e.min.x-B.x)*E),w>=0?(r=(e.min.y-B.y)*w,o=(e.max.y-B.y)*w):(r=(e.max.y-B.y)*w,o=(e.min.y-B.y)*w),n>o||r>i||((r>n||isNaN(n))&&(n=r),(o<i||isNaN(i))&&(i=o),T>=0?(a=(e.min.z-B.z)*T,d=(e.max.z-B.z)*T):(a=(e.max.z-B.z)*T,d=(e.min.z-B.z)*T),n>d||a>i)||((a>n||n!==n)&&(n=a),(d<i||i!==i)&&(i=d),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return this.intersectBox(e,rs)!==null}intersectTriangle(e,t,n,i,r){ba.subVectors(t,e),jo.subVectors(n,e),_a.crossVectors(ba,jo);let o=this.direction.dot(_a),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Es.subVectors(this.origin,e);let d=a*this.direction.dot(jo.crossVectors(Es,jo));if(d<0)return null;let E=a*this.direction.dot(ba.cross(Es));if(E<0||d+E>o)return null;let w=-a*Es.dot(_a);return w<0?null:this.at(w/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class rn{constructor(e,t,n,i,r,o,a,d,E,w,T,B,D,N,j,G){rn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,i,r,o,a,d,E,w,T,B,D,N,j,G)}set(e,t,n,i,r,o,a,d,E,w,T,B,D,N,j,G){let P=this.elements;return P[0]=e,P[4]=t,P[8]=n,P[12]=i,P[1]=r,P[5]=o,P[9]=a,P[13]=d,P[2]=E,P[6]=w,P[10]=T,P[14]=B,P[3]=D,P[7]=N,P[11]=j,P[15]=G,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new rn().fromArray(this.elements)}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){let t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,n=e.elements,i=1/Ls.setFromMatrixColumn(e,0).length(),r=1/Ls.setFromMatrixColumn(e,1).length(),o=1/Ls.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,n=e.x,i=e.y,r=e.z,o=Math.cos(n),a=Math.sin(n),d=Math.cos(i),E=Math.sin(i),w=Math.cos(r),T=Math.sin(r);if(e.order==="XYZ"){let B=o*w,D=o*T,N=a*w,j=a*T;t[0]=d*w,t[4]=-d*T,t[8]=E,t[1]=D+N*E,t[5]=B-j*E,t[9]=-a*d,t[2]=j-B*E,t[6]=N+D*E,t[10]=o*d}else if(e.order==="YXZ"){let B=d*w,D=d*T,N=E*w,j=E*T;t[0]=B+j*a,t[4]=N*a-D,t[8]=o*E,t[1]=o*T,t[5]=o*w,t[9]=-a,t[2]=D*a-N,t[6]=j+B*a,t[10]=o*d}else if(e.order==="ZXY"){let B=d*w,D=d*T,N=E*w,j=E*T;t[0]=B-j*a,t[4]=-o*T,t[8]=N+D*a,t[1]=D+N*a,t[5]=o*w,t[9]=j-B*a,t[2]=-o*E,t[6]=a,t[10]=o*d}else if(e.order==="ZYX"){let B=o*w,D=o*T,N=a*w,j=a*T;t[0]=d*w,t[4]=N*E-D,t[8]=B*E+j,t[1]=d*T,t[5]=j*E+B,t[9]=D*E-N,t[2]=-E,t[6]=a*d,t[10]=o*d}else if(e.order==="YZX"){let B=o*d,D=o*E,N=a*d,j=a*E;t[0]=d*w,t[4]=j-B*T,t[8]=N*T+D,t[1]=T,t[5]=o*w,t[9]=-a*w,t[2]=-E*w,t[6]=D*T+N,t[10]=B-j*T}else if(e.order==="XZY"){let B=o*d,D=o*E,N=a*d,j=a*E;t[0]=d*w,t[4]=-T,t[8]=E*w,t[1]=B*T+j,t[5]=o*w,t[9]=D*T-N,t[2]=N*T-D,t[6]=a*w,t[10]=j*T+B}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(zp,e,jp)}lookAt(e,t,n){let i=this.elements;return Yr.subVectors(e,t),Yr.lengthSq()===0&&(Yr.z=1),Yr.normalize(),Xs.crossVectors(n,Yr),Xs.lengthSq()===0&&(Math.abs(n.z)===1?Yr.x+=1e-4:Yr.z+=1e-4,Yr.normalize(),Xs.crossVectors(n,Yr)),Xs.normalize(),ml.crossVectors(Yr,Xs),i[0]=Xs.x,i[4]=ml.x,i[8]=Yr.x,i[1]=Xs.y,i[5]=ml.y,i[9]=Yr.y,i[2]=Xs.z,i[6]=ml.z,i[10]=Yr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,i=t.elements,r=this.elements,o=n[0],a=n[4],d=n[8],E=n[12],w=n[1],T=n[5],B=n[9],D=n[13],N=n[2],j=n[6],G=n[10],P=n[14],se=n[3],$=n[7],J=n[11],Be=n[15],ge=i[0],we=i[4],Te=i[8],de=i[12],le=i[1],Ie=i[5],ke=i[9],Fe=i[13],Ge=i[2],qe=i[6],ct=i[10],Pt=i[14],Ze=i[3],It=i[7],Rt=i[11],nn=i[15];return r[0]=o*ge+a*le+d*Ge+E*Ze,r[4]=o*we+a*Ie+d*qe+E*It,r[8]=o*Te+a*ke+d*ct+E*Rt,r[12]=o*de+a*Fe+d*Pt+E*nn,r[1]=w*ge+T*le+B*Ge+D*Ze,r[5]=w*we+T*Ie+B*qe+D*It,r[9]=w*Te+T*ke+B*ct+D*Rt,r[13]=w*de+T*Fe+B*Pt+D*nn,r[2]=N*ge+j*le+G*Ge+P*Ze,r[6]=N*we+j*Ie+G*qe+P*It,r[10]=N*Te+j*ke+G*ct+P*Rt,r[14]=N*de+j*Fe+G*Pt+P*nn,r[3]=se*ge+$*le+J*Ge+Be*Ze,r[7]=se*we+$*Ie+J*qe+Be*It,r[11]=se*Te+$*ke+J*ct+Be*Rt,r[15]=se*de+$*Fe+J*Pt+Be*nn,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],o=e[1],a=e[5],d=e[9],E=e[13],w=e[2],T=e[6],B=e[10],D=e[14],N=e[3],j=e[7],G=e[11],P=e[15];return N*(+r*d*T-i*E*T-r*a*B+n*E*B+i*a*D-n*d*D)+j*(+t*d*D-t*E*B+r*o*B-i*o*D+i*E*w-r*d*w)+G*(+t*E*T-t*a*D-r*o*T+n*o*D+r*a*w-n*E*w)+P*(-i*a*w-t*d*T+t*a*B+i*o*T-n*o*B+n*d*w)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){let i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){let e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],d=e[6],E=e[7],w=e[8],T=e[9],B=e[10],D=e[11],N=e[12],j=e[13],G=e[14],P=e[15],se=T*G*E-j*B*E+j*d*D-a*G*D-T*d*P+a*B*P,$=N*B*E-w*G*E-N*d*D+o*G*D+w*d*P-o*B*P,J=w*j*E-N*T*E+N*a*D-o*j*D-w*a*P+o*T*P,Be=N*T*d-w*j*d-N*a*B+o*j*B+w*a*G-o*T*G,ge=t*se+n*$+i*J+r*Be;if(ge===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let we=1/ge;return e[0]=se*we,e[1]=(j*B*r-T*G*r-j*i*D+n*G*D+T*i*P-n*B*P)*we,e[2]=(a*G*r-j*d*r+j*i*E-n*G*E-a*i*P+n*d*P)*we,e[3]=(T*d*r-a*B*r-T*i*E+n*B*E+a*i*D-n*d*D)*we,e[4]=$*we,e[5]=(w*G*r-N*B*r+N*i*D-t*G*D-w*i*P+t*B*P)*we,e[6]=(N*d*r-o*G*r-N*i*E+t*G*E+o*i*P-t*d*P)*we,e[7]=(o*B*r-w*d*r+w*i*E-t*B*E-o*i*D+t*d*D)*we,e[8]=J*we,e[9]=(N*T*r-w*j*r-N*n*D+t*j*D+w*n*P-t*T*P)*we,e[10]=(o*j*r-N*a*r+N*n*E-t*j*E-o*n*P+t*a*P)*we,e[11]=(w*a*r-o*T*r-w*n*E+t*T*E+o*n*D-t*a*D)*we,e[12]=Be*we,e[13]=(w*j*i-N*T*i+N*n*B-t*j*B-w*n*G+t*T*G)*we,e[14]=(N*a*i-o*j*i-N*n*d+t*j*d+o*n*G-t*a*G)*we,e[15]=(o*T*i-w*a*i+w*n*d-t*T*d-o*n*B+t*a*B)*we,this}scale(e){let t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let n=Math.cos(t),i=Math.sin(t),r=1-n,o=e.x,a=e.y,d=e.z,E=r*o,w=r*a;return this.set(E*o+n,E*a-i*d,E*d+i*a,0,E*a+i*d,w*a+n,w*d-i*o,0,E*d-i*a,w*d+i*o,r*d*d+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,r,o){return this.set(1,n,r,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){let i=this.elements,r=t._x,o=t._y,a=t._z,d=t._w,E=r+r,w=o+o,T=a+a,B=r*E,D=r*w,N=r*T,j=o*w,G=o*T,P=a*T,se=d*E,$=d*w,J=d*T,Be=n.x,ge=n.y,we=n.z;return i[0]=(1-(j+P))*Be,i[1]=(D+J)*Be,i[2]=(N-$)*Be,i[3]=0,i[4]=(D-J)*ge,i[5]=(1-(B+P))*ge,i[6]=(G+se)*ge,i[7]=0,i[8]=(N+$)*we,i[9]=(G-se)*we,i[10]=(1-(B+j))*we,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){let i=this.elements,r=Ls.set(i[0],i[1],i[2]).length(),o=Ls.set(i[4],i[5],i[6]).length(),a=Ls.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],Vr.copy(this);let E=1/r,w=1/o,T=1/a;return Vr.elements[0]*=E,Vr.elements[1]*=E,Vr.elements[2]*=E,Vr.elements[4]*=w,Vr.elements[5]*=w,Vr.elements[6]*=w,Vr.elements[8]*=T,Vr.elements[9]*=T,Vr.elements[10]*=T,t.setFromRotationMatrix(Vr),n.x=r,n.y=o,n.z=a,this}makePerspective(e,t,n,i,r,o,a=is){let d=this.elements,E=2*r/(t-e),w=2*r/(n-i),T=(t+e)/(t-e),B=(n+i)/(n-i),D,N;if(a===is)D=-(o+r)/(o-r),N=-2*o*r/(o-r);else if(a===fo)D=-o/(o-r),N=-o*r/(o-r);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return d[0]=E,d[4]=0,d[8]=T,d[12]=0,d[1]=0,d[5]=w,d[9]=B,d[13]=0,d[2]=0,d[6]=0,d[10]=D,d[14]=N,d[3]=0,d[7]=0,d[11]=-1,d[15]=0,this}makeOrthographic(e,t,n,i,r,o,a=is){let d=this.elements,E=1/(t-e),w=1/(n-i),T=1/(o-r),B=(t+e)*E,D=(n+i)*w,N,j;if(a===is)N=(o+r)*T,j=-2*T;else if(a===fo)N=r*T,j=-1*T;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return d[0]=2*E,d[4]=0,d[8]=0,d[12]=-B,d[1]=0,d[5]=2*w,d[9]=0,d[13]=-D,d[2]=0,d[6]=0,d[10]=j,d[14]=-N,d[3]=0,d[7]=0,d[11]=0,d[15]=1,this}equals(e){let t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){let n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}let Ls=new ve,Vr=new rn,zp=new ve(0,0,0),jp=new ve(1,1,1),Xs=new ve,ml=new ve,Yr=new ve,qd=new rn,Jd=new ci;class qr{constructor(e=0,t=0,n=0,i=qr.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){let i=e.elements,r=i[0],o=i[4],a=i[8],d=i[1],E=i[5],w=i[9],T=i[2],B=i[6],D=i[10];switch(t){case"XYZ":this._y=Math.asin(Vi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-w,D),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(B,E),this._z=0);break;case"YXZ":this._x=Math.asin(-Vi(w,-1,1)),Math.abs(w)<.9999999?(this._y=Math.atan2(a,D),this._z=Math.atan2(d,E)):(this._y=Math.atan2(-T,r),this._z=0);break;case"ZXY":this._x=Math.asin(Vi(B,-1,1)),Math.abs(B)<.9999999?(this._y=Math.atan2(-T,D),this._z=Math.atan2(-o,E)):(this._y=0,this._z=Math.atan2(d,r));break;case"ZYX":this._y=Math.asin(-Vi(T,-1,1)),Math.abs(T)<.9999999?(this._x=Math.atan2(B,D),this._z=Math.atan2(d,r)):(this._x=0,this._z=Math.atan2(-o,E));break;case"YZX":this._z=Math.asin(Vi(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-w,E),this._y=Math.atan2(-T,r)):(this._x=0,this._y=Math.atan2(a,D));break;case"XZY":this._z=Math.asin(-Vi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(B,E),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-w,D),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return qd.makeRotationFromQuaternion(e),this.setFromRotationMatrix(qd,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Jd.setFromEuler(this),this.setFromQuaternion(Jd,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}qr.DEFAULT_ORDER="XYZ";class gl{constructor(){this.mask=1|0}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=4294967295|0}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!=0}isEnabled(e){return(this.mask&(1<<e|0))!=0}}let Wp=0,Zd=new ve,Wo=new ci,Ds=new rn,vl=new ve,wa=new ve,Kp=new ve,Xp=new ci,$d=new ve(1,0,0),eu=new ve(0,1,0),tu=new ve(0,0,1),nu={type:"added"},Yp={type:"removed"},Ko={type:"childadded",child:null},bh={type:"childremoved",child:null};class hi extends Dr{constructor(){super();this.isObject3D=!0,Object.defineProperty(this,"id",{value:Wp++}),this.uuid=Pr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=hi.DEFAULT_UP.clone();let e=new ve,t=new qr,n=new ci,i=new ve(1,1,1);function r(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(r),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new rn},normalMatrix:{value:new Bn}}),this.matrix=new rn,this.matrixWorld=new rn,this.matrixAutoUpdate=hi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=hi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new gl,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Wo.setFromAxisAngle(e,t),this.quaternion.multiply(Wo),this}rotateOnWorldAxis(e,t){return Wo.setFromAxisAngle(e,t),this.quaternion.premultiply(Wo),this}rotateX(e){return this.rotateOnAxis($d,e)}rotateY(e){return this.rotateOnAxis(eu,e)}rotateZ(e){return this.rotateOnAxis(tu,e)}translateOnAxis(e,t){return Zd.copy(e).applyQuaternion(this.quaternion),this.position.add(Zd.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis($d,e)}translateY(e){return this.translateOnAxis(eu,e)}translateZ(e){return this.translateOnAxis(tu,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ds.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?vl.copy(e):vl.set(e,t,n);let i=this.parent;this.updateWorldMatrix(!0,!1),wa.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ds.lookAt(wa,vl,this.up):Ds.lookAt(vl,wa,this.up),this.quaternion.setFromRotationMatrix(Ds),i&&(Ds.extractRotation(i.matrixWorld),Wo.setFromRotationMatrix(Ds),this.quaternion.premultiply(Wo.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(nu),Ko.child=e,this.dispatchEvent(Ko),Ko.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Yp),bh.child=e,this.dispatchEvent(bh),bh.child=null),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Ds.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ds.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ds),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(nu),Ko.child=e,this.dispatchEvent(Ko),Ko.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){let o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);let i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(wa,e,Kp),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(wa,Xp,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let n=0,i=t.length;n<i;n++){let r=t[n];(r.matrixWorldAutoUpdate===!0||e===!0)&&r.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let i=this.children;for(let r=0,o=i.length;r<o;r++){let a=i[r];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function r(a,d){return a[d.uuid]===void 0&&(a[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);let a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){let d=a.shapes;if(Array.isArray(d))for(let E=0,w=d.length;E<w;E++){let T=d[E];r(e.shapes,T)}else r(e.shapes,d)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let a=[];for(let d=0,E=this.material.length;d<E;d++)a.push(r(e.materials,this.material[d]));i.material=a}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){let d=this.animations[a];i.animations.push(r(e.animations,d))}}if(t){let a=o(e.geometries),d=o(e.materials),E=o(e.textures),w=o(e.images),T=o(e.shapes),B=o(e.skeletons),D=o(e.animations),N=o(e.nodes);a.length>0&&(n.geometries=a),d.length>0&&(n.materials=d),E.length>0&&(n.textures=E),w.length>0&&(n.images=w),T.length>0&&(n.shapes=T),B.length>0&&(n.skeletons=B),D.length>0&&(n.animations=D),N.length>0&&(n.nodes=N)}return n.object=i,n;function o(a){let d=[];for(let E in a){let w=a[E];delete w.metadata,d.push(w)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){let i=e.children[n];this.add(i.clone())}return this}}hi.DEFAULT_UP=new ve(0,1,0),hi.DEFAULT_MATRIX_AUTO_UPDATE=!0,hi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;let cs=new ve,Ps=new ve,_h=new ve,Fs=new ve,Xo=new ve,Yo=new ve,iu=new ve,wh=new ve,Mh=new ve,Sh=new ve;class Jr{constructor(e=new ve,t=new ve,n=new ve){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),cs.subVectors(e,t),i.cross(cs);let r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(e,t,n,i,r){cs.subVectors(i,t),Ps.subVectors(n,t),_h.subVectors(e,t);let o=cs.dot(cs),a=cs.dot(Ps),d=cs.dot(_h),E=Ps.dot(Ps),w=Ps.dot(_h),T=o*E-a*a;if(T===0)return r.set(0,0,0),null;let B=1/T,D=(E*d-a*w)*B,N=(o*w-a*d)*B;return r.set(1-D-N,N,D)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,Fs)===null?!1:Fs.x>=0&&Fs.y>=0&&Fs.x+Fs.y<=1}static getInterpolation(e,t,n,i,r,o,a,d){return this.getBarycoord(e,t,n,i,Fs)===null?(d.x=0,d.y=0,"z"in d&&(d.z=0),"w"in d&&(d.w=0),null):(d.setScalar(0),d.addScaledVector(r,Fs.x),d.addScaledVector(o,Fs.y),d.addScaledVector(a,Fs.z),d)}static isFrontFacing(e,t,n,i){return cs.subVectors(n,t),Ps.subVectors(e,t),cs.cross(Ps).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return cs.subVectors(this.c,this.b),Ps.subVectors(this.a,this.b),cs.cross(Ps).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Jr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Jr.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,i,r){return Jr.getInterpolation(e,this.a,this.b,this.c,t,n,i,r)}containsPoint(e){return Jr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Jr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let n=this.a,i=this.b,r=this.c,o,a;Xo.subVectors(i,n),Yo.subVectors(r,n),wh.subVectors(e,n);let d=Xo.dot(wh),E=Yo.dot(wh);if(d<=0&&E<=0)return t.copy(n);Mh.subVectors(e,i);let w=Xo.dot(Mh),T=Yo.dot(Mh);if(w>=0&&T<=w)return t.copy(i);let B=d*T-w*E;if(B<=0&&d>=0&&w<=0)return o=d/(d-w),t.copy(n).addScaledVector(Xo,o);Sh.subVectors(e,r);let D=Xo.dot(Sh),N=Yo.dot(Sh);if(N>=0&&D<=N)return t.copy(r);let j=D*E-d*N;if(j<=0&&E>=0&&N<=0)return a=E/(E-N),t.copy(n).addScaledVector(Yo,a);let G=w*N-D*T;if(G<=0&&T-w>=0&&D-N>=0)return iu.subVectors(r,i),a=(T-w)/(T-w+(D-N)),t.copy(i).addScaledVector(iu,a);let P=1/(G+j+B);return o=j*P,a=B*P,t.copy(n).addScaledVector(Xo,o).addScaledVector(Yo,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let ru={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ys={h:0,s:0,l:0},El={h:0,s:0,l:0};function Ih(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(e-s)*6*t:t<1/2?e:t<2/3?s+(e-s)*6*(2/3-t):s}class qt{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){let i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=ni){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ai.toWorkingColorSpace(this,t),this}setRGB(e,t,n,i=Ai.workingColorSpace){return this.r=e,this.g=t,this.b=n,Ai.toWorkingColorSpace(this,i),this}setHSL(e,t,n,i=Ai.workingColorSpace){if(e=ya(e,1),t=Vi(t,0,1),n=Vi(n,0,1),t===0)this.r=this.g=this.b=n;else{let r=n<=.5?n*(1+t):n+t-n*t,o=2*n-r;this.r=Ih(o,r,e+1/3),this.g=Ih(o,r,e),this.b=Ih(o,r,e-1/3)}return Ai.toWorkingColorSpace(this,i),this}setStyle(e,t=ni){function n(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let r,o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){let r=i[1],o=r.length;if(o===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(r,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=ni){let n=ru[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=js(e.r),this.g=js(e.g),this.b=js(e.b),this}copyLinearToSRGB(e){return this.r=xa(e.r),this.g=xa(e.g),this.b=xa(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ni){return Ai.fromWorkingColorSpace(Ir.copy(this),e),Math.round(Vi(Ir.r*255,0,255))*65536+Math.round(Vi(Ir.g*255,0,255))*256+Math.round(Vi(Ir.b*255,0,255))}getHexString(e=ni){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ai.workingColorSpace){Ai.fromWorkingColorSpace(Ir.copy(this),t);let n=Ir.r,i=Ir.g,r=Ir.b,o=Math.max(n,i,r),a=Math.min(n,i,r),d,E,w=(a+o)/2;if(a===o)d=0,E=0;else{let T=o-a;switch(E=w<=.5?T/(o+a):T/(2-o-a),o){case n:d=(i-r)/T+(i<r?6:0);break;case i:d=(r-n)/T+2;break;case r:d=(n-i)/T+4;break}d/=6}return e.h=d,e.s=E,e.l=w,e}getRGB(e,t=Ai.workingColorSpace){return Ai.fromWorkingColorSpace(Ir.copy(this),t),e.r=Ir.r,e.g=Ir.g,e.b=Ir.b,e}getStyle(e=ni){Ai.fromWorkingColorSpace(Ir.copy(this),e);let t=Ir.r,n=Ir.g,i=Ir.b;return e!==ni?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(i*255)})`}offsetHSL(e,t,n){return this.getHSL(Ys),this.setHSL(Ys.h+e,Ys.s+t,Ys.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Ys),e.getHSL(El);let n=po(Ys.h,El.h,t),i=po(Ys.s,El.s,t),r=po(Ys.l,El.l,t);return this.setHSL(n,i,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,n=this.g,i=this.b,r=e.elements;return this.r=r[0]*t+r[3]*n+r[6]*i,this.g=r[1]*t+r[4]*n+r[7]*i,this.b=r[2]*t+r[5]*n+r[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let Ir=new qt;qt.NAMES=ru;let qp=0;class Tr extends Dr{constructor(){super();this.isMaterial=!0,Object.defineProperty(this,"id",{value:qp++}),this.uuid=Pr(),this.name="",this.type="Material",this.blending=L,this.side=m,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=be,this.blendDst=Re,this.blendEquation=W,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new qt(0,0,0),this.blendAlpha=0,this.depthFunc=ln,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ga,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Is,this.stencilZFail=Is,this.stencilZPass=Is,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}let i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==L&&(n.blending=this.blending),this.side!==m&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==be&&(n.blendSrc=this.blendSrc),this.blendDst!==Re&&(n.blendDst=this.blendDst),this.blendEquation!==W&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==ln&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==ga&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Is&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Is&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Is&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function i(r){let o=[];for(let a in r){let d=r[a];delete d.metadata,o.push(d)}return o}if(t){let r=i(e.textures),o=i(e.images);r.length>0&&(n.textures=r),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,n=null;if(t!==null){let i=t.length;n=new Array(i);for(let r=0;r!==i;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class qs extends Tr{constructor(e){super();this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new qt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new qr,this.combine=pi,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}let Os=Jp();function Jp(){let s=new ArrayBuffer(4),e=new Float32Array(s),t=new Uint32Array(s),n=new Uint32Array(512),i=new Uint32Array(512);for(let d=0;d<256;++d){let E=d-127;E<-27?(n[d]=0,n[d|256]=32768,i[d]=24,i[d|256]=24):E<-14?(n[d]=1024>>-E-14,n[d|256]=1024>>-E-14|32768,i[d]=-E-1,i[d|256]=-E-1):E<=15?(n[d]=E+15<<10,n[d|256]=E+15<<10|32768,i[d]=13,i[d|256]=13):E<128?(n[d]=31744,n[d|256]=64512,i[d]=24,i[d|256]=24):(n[d]=31744,n[d|256]=64512,i[d]=13,i[d|256]=13)}let r=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let d=1;d<1024;++d){let E=d<<13,w=0;for(;(E&8388608)==0;)E<<=1,w-=8388608;E&=~8388608,w+=947912704,r[d]=E|w}for(let d=1024;d<2048;++d)r[d]=939524096+(d-1024<<13);for(let d=1;d<31;++d)o[d]=d<<23;o[31]=1199570944,o[32]=2147483648;for(let d=33;d<63;++d)o[d]=2147483648+(d-32<<23);o[63]=3347054592;for(let d=1;d<64;++d)d!==32&&(a[d]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:i,mantissaTable:r,exponentTable:o,offsetTable:a}}function Hr(s){Math.abs(s)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),s=Vi(s,-65504,65504),Os.floatView[0]=s;let e=Os.uint32View[0],t=e>>23&511;return Os.baseTable[t]+((e&8388607)>>Os.shiftTable[t])}function Ma(s){let e=s>>10;return Os.uint32View[0]=Os.mantissaTable[Os.offsetTable[e]+(s&1023)]+Os.exponentTable[e],Os.floatView[0]}let Zp={toHalfFloat:Hr,fromHalfFloat:Ma},or=new ve,yl=new ht;class Si{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=uo,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Ni,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return dl("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)yl.fromBufferAttribute(this,t),yl.applyMatrix3(e),this.setXY(t,yl.x,yl.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)or.fromBufferAttribute(this,t),or.applyMatrix3(e),this.setXYZ(t,or.x,or.y,or.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)or.fromBufferAttribute(this,t),or.applyMatrix4(e),this.setXYZ(t,or.x,or.y,or.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)or.fromBufferAttribute(this,t),or.applyNormalMatrix(e),this.setXYZ(t,or.x,or.y,or.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)or.fromBufferAttribute(this,t),or.transformDirection(e),this.setXYZ(t,or.x,or.y,or.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=_r(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Dn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=_r(t,this.array)),t}setX(e,t){return this.normalized&&(t=Dn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=_r(t,this.array)),t}setY(e,t){return this.normalized&&(t=Dn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=_r(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Dn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=_r(t,this.array)),t}setW(e,t){return this.normalized&&(t=Dn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Dn(t,this.array),n=Dn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=Dn(t,this.array),n=Dn(n,this.array),i=Dn(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=Dn(t,this.array),n=Dn(n,this.array),i=Dn(i,this.array),r=Dn(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==uo&&(e.usage=this.usage),e}}class $p extends Si{constructor(e,t,n){super(new Int8Array(e),t,n)}}class eA extends Si{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class tA extends Si{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class nA extends Si{constructor(e,t,n){super(new Int16Array(e),t,n)}}class Th extends Si{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class iA extends Si{constructor(e,t,n){super(new Int32Array(e),t,n)}}class Bh extends Si{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class rA extends Si{constructor(e,t,n){super(new Uint16Array(e),t,n);this.isFloat16BufferAttribute=!0}getX(e){let t=Ma(this.array[e*this.itemSize]);return this.normalized&&(t=_r(t,this.array)),t}setX(e,t){return this.normalized&&(t=Dn(t,this.array)),this.array[e*this.itemSize]=Hr(t),this}getY(e){let t=Ma(this.array[e*this.itemSize+1]);return this.normalized&&(t=_r(t,this.array)),t}setY(e,t){return this.normalized&&(t=Dn(t,this.array)),this.array[e*this.itemSize+1]=Hr(t),this}getZ(e){let t=Ma(this.array[e*this.itemSize+2]);return this.normalized&&(t=_r(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Dn(t,this.array)),this.array[e*this.itemSize+2]=Hr(t),this}getW(e){let t=Ma(this.array[e*this.itemSize+3]);return this.normalized&&(t=_r(t,this.array)),t}setW(e,t){return this.normalized&&(t=Dn(t,this.array)),this.array[e*this.itemSize+3]=Hr(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Dn(t,this.array),n=Dn(n,this.array)),this.array[e+0]=Hr(t),this.array[e+1]=Hr(n),this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=Dn(t,this.array),n=Dn(n,this.array),i=Dn(i,this.array)),this.array[e+0]=Hr(t),this.array[e+1]=Hr(n),this.array[e+2]=Hr(i),this}setXYZW(e,t,n,i,r){return e*=this.itemSize,this.normalized&&(t=Dn(t,this.array),n=Dn(n,this.array),i=Dn(i,this.array),r=Dn(r,this.array)),this.array[e+0]=Hr(t),this.array[e+1]=Hr(n),this.array[e+2]=Hr(i),this.array[e+3]=Hr(r),this}}class an extends Si{constructor(e,t,n){super(new Float32Array(e),t,n)}}let sA=0,ss=new rn,Rh=new hi,qo=new ve,Zr=new ji,Sa=new ji,Cr=new ve;class zn extends Dr{constructor(){super();this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:sA++}),this.uuid=Pr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(ll(e)?Bh:Th)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let n=this.attributes.normal;if(n!==void 0){let r=new Bn().getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}let i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ss.makeRotationFromQuaternion(e),this.applyMatrix4(ss),this}rotateX(e){return ss.makeRotationX(e),this.applyMatrix4(ss),this}rotateY(e){return ss.makeRotationY(e),this.applyMatrix4(ss),this}rotateZ(e){return ss.makeRotationZ(e),this.applyMatrix4(ss),this}translate(e,t,n){return ss.makeTranslation(e,t,n),this.applyMatrix4(ss),this}scale(e,t,n){return ss.makeScale(e,t,n),this.applyMatrix4(ss),this}lookAt(e){return Rh.lookAt(e),Rh.updateMatrix(),this.applyMatrix4(Rh.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(qo).negate(),this.translate(qo.x,qo.y,qo.z),this}setFromPoints(e){let t=[];for(let n=0,i=e.length;n<i;n++){let r=e[n];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new an(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ji);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ve(-1/0,-1/0,-1/0),new ve(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){let r=t[n];Zr.setFromBufferAttribute(r),this.morphTargetsRelative?(Cr.addVectors(this.boundingBox.min,Zr.min),this.boundingBox.expandByPoint(Cr),Cr.addVectors(this.boundingBox.max,Zr.max),this.boundingBox.expandByPoint(Cr)):(this.boundingBox.expandByPoint(Zr.min),this.boundingBox.expandByPoint(Zr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new cr);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ve,1/0);return}if(e){let n=this.boundingSphere.center;if(Zr.setFromBufferAttribute(e),t)for(let r=0,o=t.length;r<o;r++){let a=t[r];Sa.setFromBufferAttribute(a),this.morphTargetsRelative?(Cr.addVectors(Zr.min,Sa.min),Zr.expandByPoint(Cr),Cr.addVectors(Zr.max,Sa.max),Zr.expandByPoint(Cr)):(Zr.expandByPoint(Sa.min),Zr.expandByPoint(Sa.max))}Zr.getCenter(n);let i=0;for(let r=0,o=e.count;r<o;r++)Cr.fromBufferAttribute(e,r),i=Math.max(i,n.distanceToSquared(Cr));if(t)for(let r=0,o=t.length;r<o;r++){let a=t[r],d=this.morphTargetsRelative;for(let E=0,w=a.count;E<w;E++)Cr.fromBufferAttribute(a,E),d&&(qo.fromBufferAttribute(e,E),Cr.add(qo)),i=Math.max(i,n.distanceToSquared(Cr))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let n=t.position,i=t.normal,r=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Si(new Float32Array(4*n.count),4));let o=this.getAttribute("tangent"),a=[],d=[];for(let Te=0;Te<n.count;Te++)a[Te]=new ve,d[Te]=new ve;let E=new ve,w=new ve,T=new ve,B=new ht,D=new ht,N=new ht,j=new ve,G=new ve;function P(Te,de,le){E.fromBufferAttribute(n,Te),w.fromBufferAttribute(n,de),T.fromBufferAttribute(n,le),B.fromBufferAttribute(r,Te),D.fromBufferAttribute(r,de),N.fromBufferAttribute(r,le),w.sub(E),T.sub(E),D.sub(B),N.sub(B);let Ie=1/(D.x*N.y-N.x*D.y);!isFinite(Ie)||(j.copy(w).multiplyScalar(N.y).addScaledVector(T,-D.y).multiplyScalar(Ie),G.copy(T).multiplyScalar(D.x).addScaledVector(w,-N.x).multiplyScalar(Ie),a[Te].add(j),a[de].add(j),a[le].add(j),d[Te].add(G),d[de].add(G),d[le].add(G))}let se=this.groups;se.length===0&&(se=[{start:0,count:e.count}]);for(let Te=0,de=se.length;Te<de;++Te){let le=se[Te],Ie=le.start,ke=le.count;for(let Fe=Ie,Ge=Ie+ke;Fe<Ge;Fe+=3)P(e.getX(Fe+0),e.getX(Fe+1),e.getX(Fe+2))}let $=new ve,J=new ve,Be=new ve,ge=new ve;function we(Te){Be.fromBufferAttribute(i,Te),ge.copy(Be);let de=a[Te];$.copy(de),$.sub(Be.multiplyScalar(Be.dot(de))).normalize(),J.crossVectors(ge,de);let Ie=J.dot(d[Te])<0?-1:1;o.setXYZW(Te,$.x,$.y,$.z,Ie)}for(let Te=0,de=se.length;Te<de;++Te){let le=se[Te],Ie=le.start,ke=le.count;for(let Fe=Ie,Ge=Ie+ke;Fe<Ge;Fe+=3)we(e.getX(Fe+0)),we(e.getX(Fe+1)),we(e.getX(Fe+2))}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Si(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let B=0,D=n.count;B<D;B++)n.setXYZ(B,0,0,0);let i=new ve,r=new ve,o=new ve,a=new ve,d=new ve,E=new ve,w=new ve,T=new ve;if(e)for(let B=0,D=e.count;B<D;B+=3){let N=e.getX(B+0),j=e.getX(B+1),G=e.getX(B+2);i.fromBufferAttribute(t,N),r.fromBufferAttribute(t,j),o.fromBufferAttribute(t,G),w.subVectors(o,r),T.subVectors(i,r),w.cross(T),a.fromBufferAttribute(n,N),d.fromBufferAttribute(n,j),E.fromBufferAttribute(n,G),a.add(w),d.add(w),E.add(w),n.setXYZ(N,a.x,a.y,a.z),n.setXYZ(j,d.x,d.y,d.z),n.setXYZ(G,E.x,E.y,E.z)}else for(let B=0,D=t.count;B<D;B+=3)i.fromBufferAttribute(t,B+0),r.fromBufferAttribute(t,B+1),o.fromBufferAttribute(t,B+2),w.subVectors(o,r),T.subVectors(i,r),w.cross(T),n.setXYZ(B+0,w.x,w.y,w.z),n.setXYZ(B+1,w.x,w.y,w.z),n.setXYZ(B+2,w.x,w.y,w.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Cr.fromBufferAttribute(e,t),Cr.normalize(),e.setXYZ(t,Cr.x,Cr.y,Cr.z)}toNonIndexed(){function e(a,d){let E=a.array,w=a.itemSize,T=a.normalized,B=new E.constructor(d.length*w),D=0,N=0;for(let j=0,G=d.length;j<G;j++){a.isInterleavedBufferAttribute?D=d[j]*a.data.stride+a.offset:D=d[j]*w;for(let P=0;P<w;P++)B[N++]=E[D++]}return new Si(B,w,T)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new zn,n=this.index.array,i=this.attributes;for(let a in i){let d=i[a],E=e(d,n);t.setAttribute(a,E)}let r=this.morphAttributes;for(let a in r){let d=[],E=r[a];for(let w=0,T=E.length;w<T;w++){let B=E[w],D=e(B,n);d.push(D)}t.morphAttributes[a]=d}t.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let a=0,d=o.length;a<d;a++){let E=o[a];t.addGroup(E.start,E.count,E.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let d=this.parameters;for(let E in d)d[E]!==void 0&&(e[E]=d[E]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let n=this.attributes;for(let d in n){let E=n[d];e.data.attributes[d]=E.toJSON(e.data)}let i={},r=!1;for(let d in this.morphAttributes){let E=this.morphAttributes[d],w=[];for(let T=0,B=E.length;T<B;T++){let D=E[T];w.push(D.toJSON(e.data))}w.length>0&&(i[d]=w,r=!0)}r&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let n=e.index;n!==null&&this.setIndex(n.clone(t));let i=e.attributes;for(let E in i){let w=i[E];this.setAttribute(E,w.clone(t))}let r=e.morphAttributes;for(let E in r){let w=[],T=r[E];for(let B=0,D=T.length;B<D;B++)w.push(T[B].clone(t));this.morphAttributes[E]=w}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let E=0,w=o.length;E<w;E++){let T=o[E];this.addGroup(T.start,T.count,T.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}let su=new rn,mo=new hr,Cl=new cr,ou=new ve,Jo=new ve,Zo=new ve,$o=new ve,Lh=new ve,xl=new ve,bl=new ht,_l=new ht,wl=new ht,au=new ve,lu=new ve,cu=new ve,Ml=new ve,Sl=new ve;class ar extends hi{constructor(e=new zn,t=new qs){super();this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=i.length;r<o;r++){let a=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}getVertexPosition(e,t){let n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(i,e);let a=this.morphTargetInfluences;if(r&&a){xl.set(0,0,0);for(let d=0,E=r.length;d<E;d++){let w=a[d],T=r[d];w!==0&&(Lh.fromBufferAttribute(T,e),o?xl.addScaledVector(Lh,w):xl.addScaledVector(Lh.sub(t),w))}t.add(xl)}return t}raycast(e,t){let n=this.geometry,i=this.material,r=this.matrixWorld;i!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Cl.copy(n.boundingSphere),Cl.applyMatrix4(r),mo.copy(e.ray).recast(e.near),!(Cl.containsPoint(mo.origin)===!1&&(mo.intersectSphere(Cl,ou)===null||mo.origin.distanceToSquared(ou)>(e.far-e.near)**2))&&(su.copy(r).invert(),mo.copy(e.ray).applyMatrix4(su),!(n.boundingBox!==null&&mo.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,mo)))}_computeIntersections(e,t,n){let i,r=this.geometry,o=this.material,a=r.index,d=r.attributes.position,E=r.attributes.uv,w=r.attributes.uv1,T=r.attributes.normal,B=r.groups,D=r.drawRange;if(a!==null)if(Array.isArray(o))for(let N=0,j=B.length;N<j;N++){let G=B[N],P=o[G.materialIndex],se=Math.max(G.start,D.start),$=Math.min(a.count,Math.min(G.start+G.count,D.start+D.count));for(let J=se,Be=$;J<Be;J+=3){let ge=a.getX(J),we=a.getX(J+1),Te=a.getX(J+2);i=Il(this,P,e,n,E,w,T,ge,we,Te),i&&(i.faceIndex=Math.floor(J/3),i.face.materialIndex=G.materialIndex,t.push(i))}}else{let N=Math.max(0,D.start),j=Math.min(a.count,D.start+D.count);for(let G=N,P=j;G<P;G+=3){let se=a.getX(G),$=a.getX(G+1),J=a.getX(G+2);i=Il(this,o,e,n,E,w,T,se,$,J),i&&(i.faceIndex=Math.floor(G/3),t.push(i))}}else if(d!==void 0)if(Array.isArray(o))for(let N=0,j=B.length;N<j;N++){let G=B[N],P=o[G.materialIndex],se=Math.max(G.start,D.start),$=Math.min(d.count,Math.min(G.start+G.count,D.start+D.count));for(let J=se,Be=$;J<Be;J+=3){let ge=J,we=J+1,Te=J+2;i=Il(this,P,e,n,E,w,T,ge,we,Te),i&&(i.faceIndex=Math.floor(J/3),i.face.materialIndex=G.materialIndex,t.push(i))}}else{let N=Math.max(0,D.start),j=Math.min(d.count,D.start+D.count);for(let G=N,P=j;G<P;G+=3){let se=G,$=G+1,J=G+2;i=Il(this,o,e,n,E,w,T,se,$,J),i&&(i.faceIndex=Math.floor(G/3),t.push(i))}}}}function oA(s,e,t,n,i,r,o,a){let d;if(e.side===x?d=n.intersectTriangle(o,r,i,!0,a):d=n.intersectTriangle(i,r,o,e.side===m,a),d===null)return null;Sl.copy(a),Sl.applyMatrix4(s.matrixWorld);let E=t.ray.origin.distanceTo(Sl);return E<t.near||E>t.far?null:{distance:E,point:Sl.clone(),object:s}}function Il(s,e,t,n,i,r,o,a,d,E){s.getVertexPosition(a,Jo),s.getVertexPosition(d,Zo),s.getVertexPosition(E,$o);let w=oA(s,e,t,n,Jo,Zo,$o,Ml);if(w){i&&(bl.fromBufferAttribute(i,a),_l.fromBufferAttribute(i,d),wl.fromBufferAttribute(i,E),w.uv=Jr.getInterpolation(Ml,Jo,Zo,$o,bl,_l,wl,new ht)),r&&(bl.fromBufferAttribute(r,a),_l.fromBufferAttribute(r,d),wl.fromBufferAttribute(r,E),w.uv1=Jr.getInterpolation(Ml,Jo,Zo,$o,bl,_l,wl,new ht)),o&&(au.fromBufferAttribute(o,a),lu.fromBufferAttribute(o,d),cu.fromBufferAttribute(o,E),w.normal=Jr.getInterpolation(Ml,Jo,Zo,$o,au,lu,cu,new ve),w.normal.dot(n.direction)>0&&w.normal.multiplyScalar(-1));let T={a,b:d,c:E,normal:new ve,materialIndex:0};Jr.getNormal(Jo,Zo,$o,T.normal),w.face=T}return w}class go extends zn{constructor(e=1,t=1,n=1,i=1,r=1,o=1){super();this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:r,depthSegments:o};let a=this;i=Math.floor(i),r=Math.floor(r),o=Math.floor(o);let d=[],E=[],w=[],T=[],B=0,D=0;N("z","y","x",-1,-1,n,t,e,o,r,0),N("z","y","x",1,-1,n,t,-e,o,r,1),N("x","z","y",1,1,e,n,t,i,o,2),N("x","z","y",1,-1,e,n,-t,i,o,3),N("x","y","z",1,-1,e,t,n,i,r,4),N("x","y","z",-1,-1,e,t,-n,i,r,5),this.setIndex(d),this.setAttribute("position",new an(E,3)),this.setAttribute("normal",new an(w,3)),this.setAttribute("uv",new an(T,2));function N(j,G,P,se,$,J,Be,ge,we,Te,de){let le=J/we,Ie=Be/Te,ke=J/2,Fe=Be/2,Ge=ge/2,qe=we+1,ct=Te+1,Pt=0,Ze=0,It=new ve;for(let Rt=0;Rt<ct;Rt++){let nn=Rt*Ie-Fe;for(let jn=0;jn<qe;jn++){let mi=jn*le-ke;It[j]=mi*se,It[G]=nn*$,It[P]=Ge,E.push(It.x,It.y,It.z),It[j]=0,It[G]=0,It[P]=ge>0?1:-1,w.push(It.x,It.y,It.z),T.push(jn/we),T.push(1-Rt/Te),Pt+=1}}for(let Rt=0;Rt<Te;Rt++)for(let nn=0;nn<we;nn++){let jn=B+nn+qe*Rt,mi=B+nn+qe*(Rt+1),Di=B+(nn+1)+qe*(Rt+1),di=B+(nn+1)+qe*Rt;d.push(jn,mi,di),d.push(mi,Di,di),Ze+=6}a.addGroup(D,Ze,de),D+=Ze,B+=Pt}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new go(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ea(s){let e={};for(let t in s){e[t]={};for(let n in s[t]){let i=s[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=i.clone():Array.isArray(i)?e[t][n]=i.slice():e[t][n]=i}}return e}function Or(s){let e={};for(let t=0;t<s.length;t++){let n=ea(s[t]);for(let i in n)e[i]=n[i]}return e}function aA(s){let e=[];for(let t=0;t<s.length;t++)e.push(s[t].clone());return e}function hu(s){let e=s.getRenderTarget();return e===null?s.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Ai.workingColorSpace}let du={clone:ea,merge:Or};var lA=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,cA=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class hs extends Tr{constructor(e){super();this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=lA,this.fragmentShader=cA,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ea(e.uniforms),this.uniformsGroups=aA(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let i in this.uniforms){let o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let n={};for(let i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Tl extends hi{constructor(){super();this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new rn,this.projectionMatrix=new rn,this.projectionMatrixInverse=new rn,this.coordinateSystem=is}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}let Js=new ve,uu=new ht,fu=new ht;class dr extends Tl{constructor(e=50,t=1,n=.1,i=2e3){super();this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=Hs*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Ts*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Hs*2*Math.atan(Math.tan(Ts*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Js.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Js.x,Js.y).multiplyScalar(-e/Js.z),Js.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Js.x,Js.y).multiplyScalar(-e/Js.z)}getViewSize(e,t){return this.getViewBounds(e,uu,fu),t.subVectors(fu,uu)}setViewOffset(e,t,n,i,r,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Ts*.5*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i,o=this.view;if(this.view!==null&&this.view.enabled){let d=o.fullWidth,E=o.fullHeight;r+=o.offsetX*i/d,t-=o.offsetY*n/E,i*=o.width/d,n*=o.height/E}let a=this.filmOffset;a!==0&&(r+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}let ta=-90,na=1;class pu extends hi{constructor(e,t,n){super();this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;let i=new dr(ta,na,e,t);i.layers=this.layers,this.add(i);let r=new dr(ta,na,e,t);r.layers=this.layers,this.add(r);let o=new dr(ta,na,e,t);o.layers=this.layers,this.add(o);let a=new dr(ta,na,e,t);a.layers=this.layers,this.add(a);let d=new dr(ta,na,e,t);d.layers=this.layers,this.add(d);let E=new dr(ta,na,e,t);E.layers=this.layers,this.add(E)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[n,i,r,o,a,d]=t;for(let E of t)this.remove(E);if(e===is)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else if(e===fo)n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let E of t)this.add(E),E.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();let{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[r,o,a,d,E,w]=this.children,T=e.getRenderTarget(),B=e.getActiveCubeFace(),D=e.getActiveMipmapLevel(),N=e.xr.enabled;e.xr.enabled=!1;let j=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(t,r),e.setRenderTarget(n,1,i),e.render(t,o),e.setRenderTarget(n,2,i),e.render(t,a),e.setRenderTarget(n,3,i),e.render(t,d),e.setRenderTarget(n,4,i),e.render(t,E),n.texture.generateMipmaps=j,e.setRenderTarget(n,5,i),e.render(t,w),e.setRenderTarget(T,B,D),e.xr.enabled=N,n.texture.needsPMREMUpdate=!0}}class Ia extends Li{constructor(e,t,n,i,r,o,a,d,E,w){e=e!==void 0?e:[],t=t!==void 0?t:z;super(e,t,n,i,r,o,a,d,E,w);this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Au extends Gr{constructor(e=1,t={}){super(e,e,t);this.isWebGLCubeRenderTarget=!0;let n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new Ia(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:pn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new go(5,5,5),r=new hs({name:"CubemapFromEquirect",uniforms:ea(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:x,blending:b});r.uniforms.tEquirect.value=t;let o=new ar(i,r),a=t.minFilter;return t.minFilter===yi&&(t.minFilter=pn),new pu(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,i){let r=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,i);e.setRenderTarget(r)}}let Dh=new ve,hA=new ve,dA=new Bn;class Zs{constructor(e=new ve(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){let i=Dh.subVectors(n,t).cross(hA.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let n=e.delta(Dh),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let r=-(e.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:t.copy(e.start).addScaledVector(n,r)}intersectsLine(e){let t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let n=t||dA.getNormalMatrix(e),i=this.coplanarPoint(Dh).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}let vo=new cr,Bl=new ve;class Ta{constructor(e=new Zs,t=new Zs,n=new Zs,i=new Zs,r=new Zs,o=new Zs){this.planes=[e,t,n,i,r,o]}set(e,t,n,i,r,o){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(o),this}copy(e){let t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=is){let n=this.planes,i=e.elements,r=i[0],o=i[1],a=i[2],d=i[3],E=i[4],w=i[5],T=i[6],B=i[7],D=i[8],N=i[9],j=i[10],G=i[11],P=i[12],se=i[13],$=i[14],J=i[15];if(n[0].setComponents(d-r,B-E,G-D,J-P).normalize(),n[1].setComponents(d+r,B+E,G+D,J+P).normalize(),n[2].setComponents(d+o,B+w,G+N,J+se).normalize(),n[3].setComponents(d-o,B-w,G-N,J-se).normalize(),n[4].setComponents(d-a,B-T,G-j,J-$).normalize(),t===is)n[5].setComponents(d+a,B+T,G+j,J+$).normalize();else if(t===fo)n[5].setComponents(a,T,j,$).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),vo.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),vo.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(vo)}intersectsSprite(e){return vo.center.set(0,0,0),vo.radius=.7071067811865476,vo.applyMatrix4(e.matrixWorld),this.intersectsSphere(vo)}intersectsSphere(e){let t=this.planes,n=e.center,i=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){let t=this.planes;for(let n=0;n<6;n++){let i=t[n];if(Bl.x=i.normal.x>0?e.max.x:e.min.x,Bl.y=i.normal.y>0?e.max.y:e.min.y,Bl.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Bl)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Ph(){let s=null,e=!1,t=null,n=null;function i(r,o){t(r,o),n=s.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(n=s.requestAnimationFrame(i),e=!0)},stop:function(){s.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(r){t=r},setContext:function(r){s=r}}}function uA(s){let e=new WeakMap;function t(a,d){let E=a.array,w=a.usage,T=E.byteLength,B=s.createBuffer();s.bindBuffer(d,B),s.bufferData(d,E,w),a.onUploadCallback();let D;if(E instanceof Float32Array)D=s.FLOAT;else if(E instanceof Uint16Array)a.isFloat16BufferAttribute?D=s.HALF_FLOAT:D=s.UNSIGNED_SHORT;else if(E instanceof Int16Array)D=s.SHORT;else if(E instanceof Uint32Array)D=s.UNSIGNED_INT;else if(E instanceof Int32Array)D=s.INT;else if(E instanceof Int8Array)D=s.BYTE;else if(E instanceof Uint8Array)D=s.UNSIGNED_BYTE;else if(E instanceof Uint8ClampedArray)D=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+E);return{buffer:B,type:D,bytesPerElement:E.BYTES_PER_ELEMENT,version:a.version,size:T}}function n(a,d,E){let w=d.array,T=d._updateRange,B=d.updateRanges;if(s.bindBuffer(E,a),T.count===-1&&B.length===0&&s.bufferSubData(E,0,w),B.length!==0){for(let D=0,N=B.length;D<N;D++){let j=B[D];s.bufferSubData(E,j.start*w.BYTES_PER_ELEMENT,w,j.start,j.count)}d.clearUpdateRanges()}T.count!==-1&&(s.bufferSubData(E,T.offset*w.BYTES_PER_ELEMENT,w,T.offset,T.count),T.count=-1),d.onUploadCallback()}function i(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function r(a){a.isInterleavedBufferAttribute&&(a=a.data);let d=e.get(a);d&&(s.deleteBuffer(d.buffer),e.delete(a))}function o(a,d){if(a.isGLBufferAttribute){let w=e.get(a);(!w||w.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}a.isInterleavedBufferAttribute&&(a=a.data);let E=e.get(a);if(E===void 0)e.set(a,t(a,d));else if(E.version<a.version){if(E.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(E.buffer,a,d),E.version=a.version}}return{get:i,remove:r,update:o}}class ia extends zn{constructor(e=1,t=1,n=1,i=1){super();this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};let r=e/2,o=t/2,a=Math.floor(n),d=Math.floor(i),E=a+1,w=d+1,T=e/a,B=t/d,D=[],N=[],j=[],G=[];for(let P=0;P<w;P++){let se=P*B-o;for(let $=0;$<E;$++){let J=$*T-r;N.push(J,-se,0),j.push(0,0,1),G.push($/a),G.push(1-P/d)}}for(let P=0;P<d;P++)for(let se=0;se<a;se++){let $=se+E*P,J=se+E*(P+1),Be=se+1+E*(P+1),ge=se+1+E*P;D.push($,J,ge),D.push(J,Be,ge)}this.setIndex(D),this.setAttribute("position",new an(N,3)),this.setAttribute("normal",new an(j,3)),this.setAttribute("uv",new an(G,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ia(e.width,e.height,e.widthSegments,e.heightSegments)}}var fA=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,pA=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,AA=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,mA=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,gA=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,vA=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,EA=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,yA=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,CA=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,xA=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,bA=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,_A=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,wA=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,MA=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,SA=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,IA=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,TA=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,BA=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,RA=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,LA=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,DA=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,PA=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,FA=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,OA=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,UA=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,NA=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,kA=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,GA=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,QA=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,VA=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,HA="gl_FragColor = linearToOutputTexel( gl_FragColor );",zA=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,jA=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,WA=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,KA=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,XA=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,YA=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,qA=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,JA=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,ZA=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,$A=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,em=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,tm=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,nm=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,im=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,rm=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,sm=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,om=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,am=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lm=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,cm=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,hm=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,dm=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,um=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,fm=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,pm=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Am=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,mm=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,gm=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,vm=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,Em=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,ym=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Cm=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,xm=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,bm=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,_m=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,wm=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,Mm=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Sm=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Im=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Tm=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Bm=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Rm=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Lm=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Dm=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Pm=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Fm=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Om=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Um=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Nm=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,km=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Gm=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Qm=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Vm=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Hm=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,zm=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,jm=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Wm=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Km=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Xm=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return shadow;
	}
#endif`,Ym=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,qm=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Jm=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Zm=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,$m=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,e0=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,t0=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,n0=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,i0=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,r0=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,s0=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,o0=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,a0=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,l0=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,c0=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,h0=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,d0=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;let Qn={alphahash_fragment:fA,alphahash_pars_fragment:pA,alphamap_fragment:AA,alphamap_pars_fragment:mA,alphatest_fragment:gA,alphatest_pars_fragment:vA,aomap_fragment:EA,aomap_pars_fragment:yA,batching_pars_vertex:CA,batching_vertex:xA,begin_vertex:bA,beginnormal_vertex:_A,bsdfs:wA,iridescence_fragment:MA,bumpmap_pars_fragment:SA,clipping_planes_fragment:IA,clipping_planes_pars_fragment:TA,clipping_planes_pars_vertex:BA,clipping_planes_vertex:RA,color_fragment:LA,color_pars_fragment:DA,color_pars_vertex:PA,color_vertex:FA,common:OA,cube_uv_reflection_fragment:UA,defaultnormal_vertex:NA,displacementmap_pars_vertex:kA,displacementmap_vertex:GA,emissivemap_fragment:QA,emissivemap_pars_fragment:VA,colorspace_fragment:HA,colorspace_pars_fragment:zA,envmap_fragment:jA,envmap_common_pars_fragment:WA,envmap_pars_fragment:KA,envmap_pars_vertex:XA,envmap_physical_pars_fragment:sm,envmap_vertex:YA,fog_vertex:qA,fog_pars_vertex:JA,fog_fragment:ZA,fog_pars_fragment:$A,gradientmap_pars_fragment:em,lightmap_pars_fragment:tm,lights_lambert_fragment:nm,lights_lambert_pars_fragment:im,lights_pars_begin:rm,lights_toon_fragment:om,lights_toon_pars_fragment:am,lights_phong_fragment:lm,lights_phong_pars_fragment:cm,lights_physical_fragment:hm,lights_physical_pars_fragment:dm,lights_fragment_begin:um,lights_fragment_maps:fm,lights_fragment_end:pm,logdepthbuf_fragment:Am,logdepthbuf_pars_fragment:mm,logdepthbuf_pars_vertex:gm,logdepthbuf_vertex:vm,map_fragment:Em,map_pars_fragment:ym,map_particle_fragment:Cm,map_particle_pars_fragment:xm,metalnessmap_fragment:bm,metalnessmap_pars_fragment:_m,morphinstance_vertex:wm,morphcolor_vertex:Mm,morphnormal_vertex:Sm,morphtarget_pars_vertex:Im,morphtarget_vertex:Tm,normal_fragment_begin:Bm,normal_fragment_maps:Rm,normal_pars_fragment:Lm,normal_pars_vertex:Dm,normal_vertex:Pm,normalmap_pars_fragment:Fm,clearcoat_normal_fragment_begin:Om,clearcoat_normal_fragment_maps:Um,clearcoat_pars_fragment:Nm,iridescence_pars_fragment:km,opaque_fragment:Gm,packing:Qm,premultiplied_alpha_fragment:Vm,project_vertex:Hm,dithering_fragment:zm,dithering_pars_fragment:jm,roughnessmap_fragment:Wm,roughnessmap_pars_fragment:Km,shadowmap_pars_fragment:Xm,shadowmap_pars_vertex:Ym,shadowmap_vertex:qm,shadowmask_pars_fragment:Jm,skinbase_vertex:Zm,skinning_pars_vertex:$m,skinning_vertex:e0,skinnormal_vertex:t0,specularmap_fragment:n0,specularmap_pars_fragment:i0,tonemapping_fragment:r0,tonemapping_pars_fragment:s0,transmission_fragment:o0,transmission_pars_fragment:a0,uv_pars_fragment:l0,uv_pars_vertex:c0,uv_vertex:h0,worldpos_vertex:d0,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,background_frag:`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,backgroundCube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,backgroundCube_frag:`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cube_frag:`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,depth_vert:`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,shadow_vert:`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`},Ut={common:{diffuse:{value:new qt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Bn},alphaMap:{value:null},alphaMapTransform:{value:new Bn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Bn}},envmap:{envMap:{value:null},envMapRotation:{value:new Bn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Bn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Bn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Bn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Bn},normalScale:{value:new ht(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Bn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Bn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Bn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Bn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new qt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new qt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Bn},alphaTest:{value:0},uvTransform:{value:new Bn}},sprite:{diffuse:{value:new qt(16777215)},opacity:{value:1},center:{value:new ht(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Bn},alphaMap:{value:null},alphaMapTransform:{value:new Bn},alphaTest:{value:0}}},ds={basic:{uniforms:Or([Ut.common,Ut.specularmap,Ut.envmap,Ut.aomap,Ut.lightmap,Ut.fog]),vertexShader:Qn.meshbasic_vert,fragmentShader:Qn.meshbasic_frag},lambert:{uniforms:Or([Ut.common,Ut.specularmap,Ut.envmap,Ut.aomap,Ut.lightmap,Ut.emissivemap,Ut.bumpmap,Ut.normalmap,Ut.displacementmap,Ut.fog,Ut.lights,{emissive:{value:new qt(0)}}]),vertexShader:Qn.meshlambert_vert,fragmentShader:Qn.meshlambert_frag},phong:{uniforms:Or([Ut.common,Ut.specularmap,Ut.envmap,Ut.aomap,Ut.lightmap,Ut.emissivemap,Ut.bumpmap,Ut.normalmap,Ut.displacementmap,Ut.fog,Ut.lights,{emissive:{value:new qt(0)},specular:{value:new qt(1118481)},shininess:{value:30}}]),vertexShader:Qn.meshphong_vert,fragmentShader:Qn.meshphong_frag},standard:{uniforms:Or([Ut.common,Ut.envmap,Ut.aomap,Ut.lightmap,Ut.emissivemap,Ut.bumpmap,Ut.normalmap,Ut.displacementmap,Ut.roughnessmap,Ut.metalnessmap,Ut.fog,Ut.lights,{emissive:{value:new qt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Qn.meshphysical_vert,fragmentShader:Qn.meshphysical_frag},toon:{uniforms:Or([Ut.common,Ut.aomap,Ut.lightmap,Ut.emissivemap,Ut.bumpmap,Ut.normalmap,Ut.displacementmap,Ut.gradientmap,Ut.fog,Ut.lights,{emissive:{value:new qt(0)}}]),vertexShader:Qn.meshtoon_vert,fragmentShader:Qn.meshtoon_frag},matcap:{uniforms:Or([Ut.common,Ut.bumpmap,Ut.normalmap,Ut.displacementmap,Ut.fog,{matcap:{value:null}}]),vertexShader:Qn.meshmatcap_vert,fragmentShader:Qn.meshmatcap_frag},points:{uniforms:Or([Ut.points,Ut.fog]),vertexShader:Qn.points_vert,fragmentShader:Qn.points_frag},dashed:{uniforms:Or([Ut.common,Ut.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Qn.linedashed_vert,fragmentShader:Qn.linedashed_frag},depth:{uniforms:Or([Ut.common,Ut.displacementmap]),vertexShader:Qn.depth_vert,fragmentShader:Qn.depth_frag},normal:{uniforms:Or([Ut.common,Ut.bumpmap,Ut.normalmap,Ut.displacementmap,{opacity:{value:1}}]),vertexShader:Qn.meshnormal_vert,fragmentShader:Qn.meshnormal_frag},sprite:{uniforms:Or([Ut.sprite,Ut.fog]),vertexShader:Qn.sprite_vert,fragmentShader:Qn.sprite_frag},background:{uniforms:{uvTransform:{value:new Bn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Qn.background_vert,fragmentShader:Qn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Bn}},vertexShader:Qn.backgroundCube_vert,fragmentShader:Qn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Qn.cube_vert,fragmentShader:Qn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Qn.equirect_vert,fragmentShader:Qn.equirect_frag},distanceRGBA:{uniforms:Or([Ut.common,Ut.displacementmap,{referencePosition:{value:new ve},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Qn.distanceRGBA_vert,fragmentShader:Qn.distanceRGBA_frag},shadow:{uniforms:Or([Ut.lights,Ut.fog,{color:{value:new qt(0)},opacity:{value:1}}]),vertexShader:Qn.shadow_vert,fragmentShader:Qn.shadow_frag}};ds.physical={uniforms:Or([ds.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Bn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Bn},clearcoatNormalScale:{value:new ht(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Bn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Bn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Bn},sheen:{value:0},sheenColor:{value:new qt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Bn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Bn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Bn},transmissionSamplerSize:{value:new ht},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Bn},attenuationDistance:{value:0},attenuationColor:{value:new qt(0)},specularColor:{value:new qt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Bn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Bn},anisotropyVector:{value:new ht},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Bn}}]),vertexShader:Qn.meshphysical_vert,fragmentShader:Qn.meshphysical_frag};let Rl={r:0,b:0,g:0},Eo=new qr,u0=new rn;function f0(s,e,t,n,i,r,o){let a=new qt(0),d=r===!0?0:1,E,w,T=null,B=0,D=null;function N(se){let $=se.isScene===!0?se.background:null;return $&&$.isTexture&&($=(se.backgroundBlurriness>0?t:e).get($)),$}function j(se){let $=!1,J=N(se);J===null?P(a,d):J&&J.isColor&&(P(J,1),$=!0);let Be=s.xr.getEnvironmentBlendMode();Be==="additive"?n.buffers.color.setClear(0,0,0,1,o):Be==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(s.autoClear||$)&&s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil)}function G(se,$){let J=N($);J&&(J.isCubeTexture||J.mapping===he)?(w===void 0&&(w=new ar(new go(1e4,1e4,1e4),new hs({name:"BackgroundCubeMaterial",uniforms:ea(ds.backgroundCube.uniforms),vertexShader:ds.backgroundCube.vertexShader,fragmentShader:ds.backgroundCube.fragmentShader,side:x,depthTest:!1,depthWrite:!1,fog:!1})),w.geometry.deleteAttribute("normal"),w.geometry.deleteAttribute("uv"),w.onBeforeRender=function(Be,ge,we){this.matrixWorld.copyPosition(we.matrixWorld)},Object.defineProperty(w.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(w)),Eo.copy($.backgroundRotation),Eo.x*=-1,Eo.y*=-1,Eo.z*=-1,J.isCubeTexture&&J.isRenderTargetTexture===!1&&(Eo.y*=-1,Eo.z*=-1),w.material.uniforms.envMap.value=J,w.material.uniforms.flipEnvMap.value=J.isCubeTexture&&J.isRenderTargetTexture===!1?-1:1,w.material.uniforms.backgroundBlurriness.value=$.backgroundBlurriness,w.material.uniforms.backgroundIntensity.value=$.backgroundIntensity,w.material.uniforms.backgroundRotation.value.setFromMatrix4(u0.makeRotationFromEuler(Eo)),w.material.toneMapped=Ai.getTransfer(J.colorSpace)!==Ii,(T!==J||B!==J.version||D!==s.toneMapping)&&(w.material.needsUpdate=!0,T=J,B=J.version,D=s.toneMapping),w.layers.enableAll(),se.unshift(w,w.geometry,w.material,0,0,null)):J&&J.isTexture&&(E===void 0&&(E=new ar(new ia(2,2),new hs({name:"BackgroundMaterial",uniforms:ea(ds.background.uniforms),vertexShader:ds.background.vertexShader,fragmentShader:ds.background.fragmentShader,side:m,depthTest:!1,depthWrite:!1,fog:!1})),E.geometry.deleteAttribute("normal"),Object.defineProperty(E.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(E)),E.material.uniforms.t2D.value=J,E.material.uniforms.backgroundIntensity.value=$.backgroundIntensity,E.material.toneMapped=Ai.getTransfer(J.colorSpace)!==Ii,J.matrixAutoUpdate===!0&&J.updateMatrix(),E.material.uniforms.uvTransform.value.copy(J.matrix),(T!==J||B!==J.version||D!==s.toneMapping)&&(E.material.needsUpdate=!0,T=J,B=J.version,D=s.toneMapping),E.layers.enableAll(),se.unshift(E,E.geometry,E.material,0,0,null))}function P(se,$){se.getRGB(Rl,hu(s)),n.buffers.color.setClear(Rl.r,Rl.g,Rl.b,$,o)}return{getClearColor:function(){return a},setClearColor:function(se,$=1){a.set(se),d=$,P(a,d)},getClearAlpha:function(){return d},setClearAlpha:function(se){d=se,P(a,d)},render:j,addToRenderList:G}}function p0(s,e){let t=s.getParameter(s.MAX_VERTEX_ATTRIBS),n={},i=B(null),r=i,o=!1;function a(le,Ie,ke,Fe,Ge){let qe=!1,ct=T(Fe,ke,Ie);r!==ct&&(r=ct,E(r.object)),qe=D(le,Fe,ke,Ge),qe&&N(le,Fe,ke,Ge),Ge!==null&&e.update(Ge,s.ELEMENT_ARRAY_BUFFER),(qe||o)&&(o=!1,J(le,Ie,ke,Fe),Ge!==null&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e.get(Ge).buffer))}function d(){return s.createVertexArray()}function E(le){return s.bindVertexArray(le)}function w(le){return s.deleteVertexArray(le)}function T(le,Ie,ke){let Fe=ke.wireframe===!0,Ge=n[le.id];Ge===void 0&&(Ge={},n[le.id]=Ge);let qe=Ge[Ie.id];qe===void 0&&(qe={},Ge[Ie.id]=qe);let ct=qe[Fe];return ct===void 0&&(ct=B(d()),qe[Fe]=ct),ct}function B(le){let Ie=[],ke=[],Fe=[];for(let Ge=0;Ge<t;Ge++)Ie[Ge]=0,ke[Ge]=0,Fe[Ge]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Ie,enabledAttributes:ke,attributeDivisors:Fe,object:le,attributes:{},index:null}}function D(le,Ie,ke,Fe){let Ge=r.attributes,qe=Ie.attributes,ct=0,Pt=ke.getAttributes();for(let Ze in Pt)if(Pt[Ze].location>=0){let Rt=Ge[Ze],nn=qe[Ze];if(nn===void 0&&(Ze==="instanceMatrix"&&le.instanceMatrix&&(nn=le.instanceMatrix),Ze==="instanceColor"&&le.instanceColor&&(nn=le.instanceColor)),Rt===void 0||Rt.attribute!==nn||nn&&Rt.data!==nn.data)return!0;ct++}return r.attributesNum!==ct||r.index!==Fe}function N(le,Ie,ke,Fe){let Ge={},qe=Ie.attributes,ct=0,Pt=ke.getAttributes();for(let Ze in Pt)if(Pt[Ze].location>=0){let Rt=qe[Ze];Rt===void 0&&(Ze==="instanceMatrix"&&le.instanceMatrix&&(Rt=le.instanceMatrix),Ze==="instanceColor"&&le.instanceColor&&(Rt=le.instanceColor));let nn={};nn.attribute=Rt,Rt&&Rt.data&&(nn.data=Rt.data),Ge[Ze]=nn,ct++}r.attributes=Ge,r.attributesNum=ct,r.index=Fe}function j(){let le=r.newAttributes;for(let Ie=0,ke=le.length;Ie<ke;Ie++)le[Ie]=0}function G(le){P(le,0)}function P(le,Ie){let ke=r.newAttributes,Fe=r.enabledAttributes,Ge=r.attributeDivisors;ke[le]=1,Fe[le]===0&&(s.enableVertexAttribArray(le),Fe[le]=1),Ge[le]!==Ie&&(s.vertexAttribDivisor(le,Ie),Ge[le]=Ie)}function se(){let le=r.newAttributes,Ie=r.enabledAttributes;for(let ke=0,Fe=Ie.length;ke<Fe;ke++)Ie[ke]!==le[ke]&&(s.disableVertexAttribArray(ke),Ie[ke]=0)}function $(le,Ie,ke,Fe,Ge,qe,ct){ct===!0?s.vertexAttribIPointer(le,Ie,ke,Ge,qe):s.vertexAttribPointer(le,Ie,ke,Fe,Ge,qe)}function J(le,Ie,ke,Fe){j();let Ge=Fe.attributes,qe=ke.getAttributes(),ct=Ie.defaultAttributeValues;for(let Pt in qe){let Ze=qe[Pt];if(Ze.location>=0){let It=Ge[Pt];if(It===void 0&&(Pt==="instanceMatrix"&&le.instanceMatrix&&(It=le.instanceMatrix),Pt==="instanceColor"&&le.instanceColor&&(It=le.instanceColor)),It!==void 0){let Rt=It.normalized,nn=It.itemSize,jn=e.get(It);if(jn===void 0)continue;let mi=jn.buffer,Di=jn.type,di=jn.bytesPerElement,Ti=Di===s.INT||Di===s.UNSIGNED_INT||It.gpuType===ts;if(It.isInterleavedBufferAttribute){let sn=It.data,ut=sn.stride,Ot=It.offset;if(sn.isInstancedInterleavedBuffer){for(let Nt=0;Nt<Ze.locationSize;Nt++)P(Ze.location+Nt,sn.meshPerAttribute);le.isInstancedMesh!==!0&&Fe._maxInstanceCount===void 0&&(Fe._maxInstanceCount=sn.meshPerAttribute*sn.count)}else for(let Nt=0;Nt<Ze.locationSize;Nt++)G(Ze.location+Nt);s.bindBuffer(s.ARRAY_BUFFER,mi);for(let Nt=0;Nt<Ze.locationSize;Nt++)$(Ze.location+Nt,nn/Ze.locationSize,Di,Rt,ut*di,(Ot+nn/Ze.locationSize*Nt)*di,Ti)}else{if(It.isInstancedBufferAttribute){for(let sn=0;sn<Ze.locationSize;sn++)P(Ze.location+sn,It.meshPerAttribute);le.isInstancedMesh!==!0&&Fe._maxInstanceCount===void 0&&(Fe._maxInstanceCount=It.meshPerAttribute*It.count)}else for(let sn=0;sn<Ze.locationSize;sn++)G(Ze.location+sn);s.bindBuffer(s.ARRAY_BUFFER,mi);for(let sn=0;sn<Ze.locationSize;sn++)$(Ze.location+sn,nn/Ze.locationSize,Di,Rt,nn*di,nn/Ze.locationSize*sn*di,Ti)}}else if(ct!==void 0){let Rt=ct[Pt];if(Rt!==void 0)switch(Rt.length){case 2:s.vertexAttrib2fv(Ze.location,Rt);break;case 3:s.vertexAttrib3fv(Ze.location,Rt);break;case 4:s.vertexAttrib4fv(Ze.location,Rt);break;default:s.vertexAttrib1fv(Ze.location,Rt)}}}}se()}function Be(){Te();for(let le in n){let Ie=n[le];for(let ke in Ie){let Fe=Ie[ke];for(let Ge in Fe)w(Fe[Ge].object),delete Fe[Ge];delete Ie[ke]}delete n[le]}}function ge(le){if(n[le.id]===void 0)return;let Ie=n[le.id];for(let ke in Ie){let Fe=Ie[ke];for(let Ge in Fe)w(Fe[Ge].object),delete Fe[Ge];delete Ie[ke]}delete n[le.id]}function we(le){for(let Ie in n){let ke=n[Ie];if(ke[le.id]===void 0)continue;let Fe=ke[le.id];for(let Ge in Fe)w(Fe[Ge].object),delete Fe[Ge];delete ke[le.id]}}function Te(){de(),o=!0,r!==i&&(r=i,E(r.object))}function de(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:a,reset:Te,resetDefaultState:de,dispose:Be,releaseStatesOfGeometry:ge,releaseStatesOfProgram:we,initAttributes:j,enableAttribute:G,disableUnusedAttributes:se}}function A0(s,e,t){let n;function i(E){n=E}function r(E,w){s.drawArrays(n,E,w),t.update(w,n,1)}function o(E,w,T){T!==0&&(s.drawArraysInstanced(n,E,w,T),t.update(w,n,T))}function a(E,w,T){if(T===0)return;let B=e.get("WEBGL_multi_draw");if(B===null)for(let D=0;D<T;D++)this.render(E[D],w[D]);else{B.multiDrawArraysWEBGL(n,E,0,w,0,T);let D=0;for(let N=0;N<T;N++)D+=w[N];t.update(D,n,1)}}function d(E,w,T,B){if(T===0)return;let D=e.get("WEBGL_multi_draw");if(D===null)for(let N=0;N<E.length;N++)o(E[N],w[N],B[N]);else{D.multiDrawArraysInstancedWEBGL(n,E,0,w,0,B,0,T);let N=0;for(let j=0;j<T;j++)N+=w[j];for(let j=0;j<B.length;j++)t.update(N,n,B[j])}}this.setMode=i,this.render=r,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=d}function m0(s,e,t,n){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){let ge=e.get("EXT_texture_filter_anisotropic");i=s.getParameter(ge.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(ge){return!(ge!==Me&&n.convert(ge)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(ge){let we=ge===Ci&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(ge!==Ui&&n.convert(ge)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_TYPE)&&ge!==Ni&&!we)}function d(ge){if(ge==="highp"){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";ge="mediump"}return ge==="mediump"&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let E=t.precision!==void 0?t.precision:"highp",w=d(E);w!==E&&(console.warn("THREE.WebGLRenderer:",E,"not supported, using",w,"instead."),E=w);let T=t.logarithmicDepthBuffer===!0,B=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),D=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),N=s.getParameter(s.MAX_TEXTURE_SIZE),j=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),G=s.getParameter(s.MAX_VERTEX_ATTRIBS),P=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),se=s.getParameter(s.MAX_VARYING_VECTORS),$=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),J=D>0,Be=s.getParameter(s.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:r,getMaxPrecision:d,textureFormatReadable:o,textureTypeReadable:a,precision:E,logarithmicDepthBuffer:T,maxTextures:B,maxVertexTextures:D,maxTextureSize:N,maxCubemapSize:j,maxAttributes:G,maxVertexUniforms:P,maxVaryings:se,maxFragmentUniforms:$,vertexTextures:J,maxSamples:Be}}function g0(s){let e=this,t=null,n=0,i=!1,r=!1,o=new Zs,a=new Bn,d={value:null,needsUpdate:!1};this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(T,B){let D=T.length!==0||B||n!==0||i;return i=B,n=T.length,D},this.beginShadows=function(){r=!0,w(null)},this.endShadows=function(){r=!1},this.setGlobalState=function(T,B){t=w(T,B,0)},this.setState=function(T,B,D){let N=T.clippingPlanes,j=T.clipIntersection,G=T.clipShadows,P=s.get(T);if(!i||N===null||N.length===0||r&&!G)r?w(null):E();else{let se=r?0:n,$=se*4,J=P.clippingState||null;d.value=J,J=w(N,B,$,D);for(let Be=0;Be!==$;++Be)J[Be]=t[Be];P.clippingState=J,this.numIntersection=j?this.numPlanes:0,this.numPlanes+=se}};function E(){d.value!==t&&(d.value=t,d.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function w(T,B,D,N){let j=T!==null?T.length:0,G=null;if(j!==0){if(G=d.value,N!==!0||G===null){let P=D+j*4,se=B.matrixWorldInverse;a.getNormalMatrix(se),(G===null||G.length<P)&&(G=new Float32Array(P));for(let $=0,J=D;$!==j;++$,J+=4)o.copy(T[$]).applyMatrix4(se,a),o.normal.toArray(G,J),G[J+3]=o.constant}d.value=G,d.needsUpdate=!0}return e.numPlanes=j,e.numIntersection=0,G}}function v0(s){let e=new WeakMap;function t(o,a){return a===R?o.mapping=z:a===ee&&(o.mapping=I),o}function n(o){if(o&&o.isTexture){let a=o.mapping;if(a===R||a===ee)if(e.has(o)){let d=e.get(o).texture;return t(d,o.mapping)}else{let d=o.image;if(d&&d.height>0){let E=new Au(d.height);return E.fromEquirectangularTexture(s,o),e.set(o,E),o.addEventListener("dispose",i),t(E.texture,o.mapping)}else return null}}return o}function i(o){let a=o.target;a.removeEventListener("dispose",i);let d=e.get(a);d!==void 0&&(e.delete(a),d.dispose())}function r(){e=new WeakMap}return{get:n,dispose:r}}class Ll extends Tl{constructor(e=-1,t=1,n=1,i=-1,r=.1,o=2e3){super();this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,r,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-e,o=n+e,a=i+t,d=i-t;if(this.view!==null&&this.view.enabled){let E=(this.right-this.left)/this.view.fullWidth/this.zoom,w=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=E*this.view.offsetX,o=r+E*this.view.width,a-=w*this.view.offsetY,d=a-w*this.view.height}this.projectionMatrix.makeOrthographic(r,o,a,d,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}let ra=4,mu=[.125,.215,.35,.446,.526,.582],yo=20,Fh=new Ll,gu=new qt,Oh=null,Uh=0,Nh=0,kh=!1,Co=(1+Math.sqrt(5))/2,sa=1/Co,vu=[new ve(-Co,sa,0),new ve(Co,sa,0),new ve(-sa,0,Co),new ve(sa,0,Co),new ve(0,Co,-sa),new ve(0,Co,sa),new ve(-1,1,-1),new ve(1,1,-1),new ve(-1,1,1),new ve(1,1,1)];class Gh{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100){Oh=this._renderer.getRenderTarget(),Uh=this._renderer.getActiveCubeFace(),Nh=this._renderer.getActiveMipmapLevel(),kh=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);let r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,n,i,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Cu(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=yu(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Oh,Uh,Nh),this._renderer.xr.enabled=kh,e.scissorTest=!1,Dl(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===z||e.mapping===I?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Oh=this._renderer.getRenderTarget(),Uh=this._renderer.getActiveCubeFace(),Nh=this._renderer.getActiveMipmapLevel(),kh=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){let e=3*Math.max(this._cubeSize,16*7),t=4*this._cubeSize,n={magFilter:pn,minFilter:pn,generateMipmaps:!1,type:Ci,format:Me,colorSpace:ls,depthBuffer:!1},i=Eu(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Eu(e,t,n);let{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=E0(r)),this._blurMaterial=y0(r,e,t)}return i}_compileMaterial(e){let t=new ar(this._lodPlanes[0],e);this._renderer.compile(t,Fh)}_sceneToCubeUV(e,t,n,i){let r=90,o=1,a=new dr(r,o,t,n),d=[1,-1,1,1,1,1],E=[1,1,1,-1,-1,-1],w=this._renderer,T=w.autoClear,B=w.toneMapping;w.getClearColor(gu),w.toneMapping=vi,w.autoClear=!1;let D=new qs({name:"PMREM.Background",side:x,depthWrite:!1,depthTest:!1}),N=new ar(new go,D),j=!1,G=e.background;G?G.isColor&&(D.color.copy(G),e.background=null,j=!0):(D.color.copy(gu),j=!0);for(let P=0;P<6;P++){let se=P%3;se===0?(a.up.set(0,d[P],0),a.lookAt(E[P],0,0)):se===1?(a.up.set(0,0,d[P]),a.lookAt(0,E[P],0)):(a.up.set(0,d[P],0),a.lookAt(0,0,E[P]));let $=this._cubeSize;Dl(i,se*$,P>2?$:0,$,$),w.setRenderTarget(i),j&&w.render(N,a),w.render(e,a)}N.geometry.dispose(),N.material.dispose(),w.toneMapping=B,w.autoClear=T,e.background=G}_textureToCubeUV(e,t){let n=this._renderer,i=e.mapping===z||e.mapping===I;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=Cu()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=yu());let r=i?this._cubemapMaterial:this._equirectMaterial,o=new ar(this._lodPlanes[0],r),a=r.uniforms;a.envMap.value=e;let d=this._cubeSize;Dl(t,0,0,3*d,2*d),n.setRenderTarget(t),n.render(o,Fh)}_applyPMREM(e){let t=this._renderer,n=t.autoClear;t.autoClear=!1;let i=this._lodPlanes.length;for(let r=1;r<i;r++){let o=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),a=vu[(i-r-1)%vu.length];this._blur(e,r-1,r,o,a)}t.autoClear=n}_blur(e,t,n,i,r){let o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,i,"latitudinal",r),this._halfBlur(o,e,n,n,i,"longitudinal",r)}_halfBlur(e,t,n,i,r,o,a){let d=this._renderer,E=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let w=3,T=new ar(this._lodPlanes[i],E),B=E.uniforms,D=this._sizeLods[n]-1,N=isFinite(r)?Math.PI/(2*D):2*Math.PI/(2*yo-1),j=r/N,G=isFinite(r)?1+Math.floor(w*j):yo;G>yo&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${G} samples when the maximum is set to ${yo}`);let P=[],se=0;for(let we=0;we<yo;++we){let Te=we/j,de=Math.exp(-Te*Te/2);P.push(de),we===0?se+=de:we<G&&(se+=2*de)}for(let we=0;we<P.length;we++)P[we]=P[we]/se;B.envMap.value=e.texture,B.samples.value=G,B.weights.value=P,B.latitudinal.value=o==="latitudinal",a&&(B.poleAxis.value=a);let{_lodMax:$}=this;B.dTheta.value=N,B.mipInt.value=$-n;let J=this._sizeLods[i],Be=3*J*(i>$-ra?i-$+ra:0),ge=4*(this._cubeSize-J);Dl(t,Be,ge,3*J,2*J),d.setRenderTarget(t),d.render(T,Fh)}}function E0(s){let e=[],t=[],n=[],i=s,r=s-ra+1+mu.length;for(let o=0;o<r;o++){let a=Math.pow(2,i);t.push(a);let d=1/a;o>s-ra?d=mu[o-s+ra-1]:o===0&&(d=0),n.push(d);let E=1/(a-2),w=-E,T=1+E,B=[w,w,T,w,T,T,w,w,T,T,w,T],D=6,N=6,j=3,G=2,P=1,se=new Float32Array(j*N*D),$=new Float32Array(G*N*D),J=new Float32Array(P*N*D);for(let ge=0;ge<D;ge++){let we=ge%3*2/3-1,Te=ge>2?0:-1,de=[we,Te,0,we+2/3,Te,0,we+2/3,Te+1,0,we,Te,0,we+2/3,Te+1,0,we,Te+1,0];se.set(de,j*N*ge),$.set(B,G*N*ge);let le=[ge,ge,ge,ge,ge,ge];J.set(le,P*N*ge)}let Be=new zn;Be.setAttribute("position",new Si(se,j)),Be.setAttribute("uv",new Si($,G)),Be.setAttribute("faceIndex",new Si(J,P)),e.push(Be),i>ra&&i--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function Eu(s,e,t){let n=new Gr(s,e,t);return n.texture.mapping=he,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Dl(s,e,t,n,i){s.viewport.set(e,t,n,i),s.scissor.set(e,t,n,i)}function y0(s,e,t){let n=new Float32Array(yo),i=new ve(0,1,0);return new hs({name:"SphericalGaussianBlur",defines:{n:yo,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:Qh(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:b,depthTest:!1,depthWrite:!1})}function yu(){return new hs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Qh(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:b,depthTest:!1,depthWrite:!1})}function Cu(){return new hs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Qh(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:b,depthTest:!1,depthWrite:!1})}function Qh(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function C0(s){let e=new WeakMap,t=null;function n(a){if(a&&a.isTexture){let d=a.mapping,E=d===R||d===ee,w=d===z||d===I;if(E||w){let T=e.get(a),B=T!==void 0?T.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==B)return t===null&&(t=new Gh(s)),T=E?t.fromEquirectangular(a,T):t.fromCubemap(a,T),T.texture.pmremVersion=a.pmremVersion,e.set(a,T),T.texture;if(T!==void 0)return T.texture;{let D=a.image;return E&&D&&D.height>0||w&&D&&i(D)?(t===null&&(t=new Gh(s)),T=E?t.fromEquirectangular(a):t.fromCubemap(a),T.texture.pmremVersion=a.pmremVersion,e.set(a,T),a.addEventListener("dispose",r),T.texture):null}}}return a}function i(a){let d=0,E=6;for(let w=0;w<E;w++)a[w]!==void 0&&d++;return d===E}function r(a){let d=a.target;d.removeEventListener("dispose",r);let E=e.get(d);E!==void 0&&(e.delete(d),E.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function x0(s){let e={};function t(n){if(e[n]!==void 0)return e[n];let i;switch(n){case"WEBGL_depth_texture":i=s.getExtension("WEBGL_depth_texture")||s.getExtension("MOZ_WEBGL_depth_texture")||s.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=s.getExtension("WEBGL_compressed_texture_s3tc")||s.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=s.getExtension("WEBGL_compressed_texture_pvrtc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=s.getExtension(n)}return e[n]=i,i}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){let i=t(n);return i===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function b0(s,e,t,n){let i={},r=new WeakMap;function o(T){let B=T.target;B.index!==null&&e.remove(B.index);for(let N in B.attributes)e.remove(B.attributes[N]);for(let N in B.morphAttributes){let j=B.morphAttributes[N];for(let G=0,P=j.length;G<P;G++)e.remove(j[G])}B.removeEventListener("dispose",o),delete i[B.id];let D=r.get(B);D&&(e.remove(D),r.delete(B)),n.releaseStatesOfGeometry(B),B.isInstancedBufferGeometry===!0&&delete B._maxInstanceCount,t.memory.geometries--}function a(T,B){return i[B.id]===!0||(B.addEventListener("dispose",o),i[B.id]=!0,t.memory.geometries++),B}function d(T){let B=T.attributes;for(let N in B)e.update(B[N],s.ARRAY_BUFFER);let D=T.morphAttributes;for(let N in D){let j=D[N];for(let G=0,P=j.length;G<P;G++)e.update(j[G],s.ARRAY_BUFFER)}}function E(T){let B=[],D=T.index,N=T.attributes.position,j=0;if(D!==null){let se=D.array;j=D.version;for(let $=0,J=se.length;$<J;$+=3){let Be=se[$+0],ge=se[$+1],we=se[$+2];B.push(Be,ge,ge,we,we,Be)}}else if(N!==void 0){let se=N.array;j=N.version;for(let $=0,J=se.length/3-1;$<J;$+=3){let Be=$+0,ge=$+1,we=$+2;B.push(Be,ge,ge,we,we,Be)}}else return;let G=new(ll(B)?Bh:Th)(B,1);G.version=j;let P=r.get(T);P&&e.remove(P),r.set(T,G)}function w(T){let B=r.get(T);if(B){let D=T.index;D!==null&&B.version<D.version&&E(T)}else E(T);return r.get(T)}return{get:a,update:d,getWireframeAttribute:w}}function _0(s,e,t){let n;function i(B){n=B}let r,o;function a(B){r=B.type,o=B.bytesPerElement}function d(B,D){s.drawElements(n,D,r,B*o),t.update(D,n,1)}function E(B,D,N){N!==0&&(s.drawElementsInstanced(n,D,r,B*o,N),t.update(D,n,N))}function w(B,D,N){if(N===0)return;let j=e.get("WEBGL_multi_draw");if(j===null)for(let G=0;G<N;G++)this.render(B[G]/o,D[G]);else{j.multiDrawElementsWEBGL(n,D,0,r,B,0,N);let G=0;for(let P=0;P<N;P++)G+=D[P];t.update(G,n,1)}}function T(B,D,N,j){if(N===0)return;let G=e.get("WEBGL_multi_draw");if(G===null)for(let P=0;P<B.length;P++)E(B[P]/o,D[P],j[P]);else{G.multiDrawElementsInstancedWEBGL(n,D,0,r,B,0,j,0,N);let P=0;for(let se=0;se<N;se++)P+=D[se];for(let se=0;se<j.length;se++)t.update(P,n,j[se])}}this.setMode=i,this.setIndex=a,this.render=d,this.renderInstances=E,this.renderMultiDraw=w,this.renderMultiDrawInstances=T}function w0(s){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(r,o,a){switch(t.calls++,o){case s.TRIANGLES:t.triangles+=a*(r/3);break;case s.LINES:t.lines+=a*(r/2);break;case s.LINE_STRIP:t.lines+=a*(r-1);break;case s.LINE_LOOP:t.lines+=a*r;break;case s.POINTS:t.points+=a*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:n}}function M0(s,e,t){let n=new WeakMap,i=new oi;function r(o,a,d){let E=o.morphTargetInfluences,w=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,T=w!==void 0?w.length:0,B=n.get(a);if(B===void 0||B.count!==T){let de=function(){we.dispose(),n.delete(a),a.removeEventListener("dispose",de)};B!==void 0&&B.texture.dispose();let D=a.morphAttributes.position!==void 0,N=a.morphAttributes.normal!==void 0,j=a.morphAttributes.color!==void 0,G=a.morphAttributes.position||[],P=a.morphAttributes.normal||[],se=a.morphAttributes.color||[],$=0;D===!0&&($=1),N===!0&&($=2),j===!0&&($=3);let J=a.attributes.position.count*$,Be=1;J>e.maxTextureSize&&(Be=Math.ceil(J/e.maxTextureSize),J=e.maxTextureSize);let ge=new Float32Array(J*Be*4*T),we=new Qo(ge,J,Be,T);we.type=Ni,we.needsUpdate=!0;let Te=$*4;for(let le=0;le<T;le++){let Ie=G[le],ke=P[le],Fe=se[le],Ge=J*Be*4*le;for(let qe=0;qe<Ie.count;qe++){let ct=qe*Te;D===!0&&(i.fromBufferAttribute(Ie,qe),ge[Ge+ct+0]=i.x,ge[Ge+ct+1]=i.y,ge[Ge+ct+2]=i.z,ge[Ge+ct+3]=0),N===!0&&(i.fromBufferAttribute(ke,qe),ge[Ge+ct+4]=i.x,ge[Ge+ct+5]=i.y,ge[Ge+ct+6]=i.z,ge[Ge+ct+7]=0),j===!0&&(i.fromBufferAttribute(Fe,qe),ge[Ge+ct+8]=i.x,ge[Ge+ct+9]=i.y,ge[Ge+ct+10]=i.z,ge[Ge+ct+11]=Fe.itemSize===4?i.w:1)}}B={count:T,texture:we,size:new ht(J,Be)},n.set(a,B),a.addEventListener("dispose",de)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)d.getUniforms().setValue(s,"morphTexture",o.morphTexture,t);else{let D=0;for(let j=0;j<E.length;j++)D+=E[j];let N=a.morphTargetsRelative?1:1-D;d.getUniforms().setValue(s,"morphTargetBaseInfluence",N),d.getUniforms().setValue(s,"morphTargetInfluences",E)}d.getUniforms().setValue(s,"morphTargetsTexture",B.texture,t),d.getUniforms().setValue(s,"morphTargetsTextureSize",B.size)}return{update:r}}class S0{constructor(e,t,n){if(this.renderer=e,this.DEFAULT_NUMVIEWS=2,this.maxNumViews=0,this.gl=n,this.extensions=t,this.available=this.extensions.has("OCULUS_multiview"),this.available){let r=this.extensions.get("OCULUS_multiview");this.maxNumViews=this.gl.getParameter(r.MAX_VIEWS_OVR),this.mat4=[],this.mat3=[],this.cameraArray=[];for(var i=0;i<this.maxNumViews;i++)this.mat4[i]=new rn,this.mat3[i]=new Bn}}getCameraArray(e){return e.isArrayCamera?e.cameras:(this.cameraArray[0]=e,this.cameraArray)}updateCameraProjectionMatricesUniform(e,t){for(var n=this.getCameraArray(e),i=0;i<n.length;i++)this.mat4[i].copy(n[i].projectionMatrix);t.setValue(this.gl,"projectionMatrices",this.mat4)}updateCameraViewMatricesUniform(e,t){for(var n=this.getCameraArray(e),i=0;i<n.length;i++)this.mat4[i].copy(n[i].matrixWorldInverse);t.setValue(this.gl,"viewMatrices",this.mat4)}updateObjectMatricesUniforms(e,t,n){for(var i=this.getCameraArray(t),r=0;r<i.length;r++)this.mat4[r].multiplyMatrices(i[r].matrixWorldInverse,e.matrixWorld),this.mat3[r].getNormalMatrix(this.mat4[r]);n.setValue(this.gl,"modelViewMatrices",this.mat4),n.setValue(this.gl,"normalMatrices",this.mat3)}}function I0(s,e,t,n){let i=new WeakMap;function r(d){let E=n.render.frame,w=d.geometry,T=e.get(d,w);if(i.get(T)!==E&&(e.update(T),i.set(T,E)),d.isInstancedMesh&&(d.hasEventListener("dispose",a)===!1&&d.addEventListener("dispose",a),i.get(d)!==E&&(t.update(d.instanceMatrix,s.ARRAY_BUFFER),d.instanceColor!==null&&t.update(d.instanceColor,s.ARRAY_BUFFER),i.set(d,E))),d.isSkinnedMesh){let B=d.skeleton;i.get(B)!==E&&(B.update(),i.set(B,E))}return T}function o(){i=new WeakMap}function a(d){let E=d.target;E.removeEventListener("dispose",a),t.remove(E.instanceMatrix),E.instanceColor!==null&&t.remove(E.instanceColor)}return{update:r,dispose:o}}class Vh extends Li{constructor(e,t,n,i,r,o,a,d,E,w){if(w=w!==void 0?w:We,w!==We&&w!==st)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&w===We&&(n=xr),n===void 0&&w===st&&(n=jr);super(null,i,r,o,a,d,w,n,E);this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Bt,this.minFilter=d!==void 0?d:Bt,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}let xu=new Li,bu=new Vh(1,1);bu.compareFunction=va;let _u=new Qo,wu=new Rn,Mu=new Ia,Su=[],Iu=[],Tu=new Float32Array(16),Bu=new Float32Array(9),Ru=new Float32Array(4);function oa(s,e,t){let n=s[0];if(n<=0||n>0)return s;let i=e*t,r=Su[i];if(r===void 0&&(r=new Float32Array(i),Su[i]=r),e!==0){n.toArray(r,0);for(let o=1,a=0;o!==e;++o)a+=t,s[o].toArray(r,a)}return r}function ur(s,e){if(s.length!==e.length)return!1;for(let t=0,n=s.length;t<n;t++)if(s[t]!==e[t])return!1;return!0}function fr(s,e){for(let t=0,n=e.length;t<n;t++)s[t]=e[t]}function Pl(s,e){let t=Iu[e];t===void 0&&(t=new Int32Array(e),Iu[e]=t);for(let n=0;n!==e;++n)t[n]=s.allocateTextureUnit();return t}function T0(s,e){let t=this.cache;t[0]!==e&&(s.uniform1f(this.addr,e),t[0]=e)}function B0(s,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ur(t,e))return;s.uniform2fv(this.addr,e),fr(t,e)}}function R0(s,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(s.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ur(t,e))return;s.uniform3fv(this.addr,e),fr(t,e)}}function L0(s,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ur(t,e))return;s.uniform4fv(this.addr,e),fr(t,e)}}function D0(s,e){let t=this.cache,n=e.elements;if(n===void 0){if(ur(t,e))return;s.uniformMatrix2fv(this.addr,!1,e),fr(t,e)}else{if(ur(t,n))return;Ru.set(n),s.uniformMatrix2fv(this.addr,!1,Ru),fr(t,n)}}function P0(s,e){let t=this.cache,n=e.elements;if(n===void 0){if(ur(t,e))return;s.uniformMatrix3fv(this.addr,!1,e),fr(t,e)}else{if(ur(t,n))return;Bu.set(n),s.uniformMatrix3fv(this.addr,!1,Bu),fr(t,n)}}function F0(s,e){let t=this.cache,n=e.elements;if(n===void 0){if(ur(t,e))return;s.uniformMatrix4fv(this.addr,!1,e),fr(t,e)}else{if(ur(t,n))return;Tu.set(n),s.uniformMatrix4fv(this.addr,!1,Tu),fr(t,n)}}function O0(s,e){let t=this.cache;t[0]!==e&&(s.uniform1i(this.addr,e),t[0]=e)}function U0(s,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ur(t,e))return;s.uniform2iv(this.addr,e),fr(t,e)}}function N0(s,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ur(t,e))return;s.uniform3iv(this.addr,e),fr(t,e)}}function k0(s,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ur(t,e))return;s.uniform4iv(this.addr,e),fr(t,e)}}function G0(s,e){let t=this.cache;t[0]!==e&&(s.uniform1ui(this.addr,e),t[0]=e)}function Q0(s,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ur(t,e))return;s.uniform2uiv(this.addr,e),fr(t,e)}}function V0(s,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ur(t,e))return;s.uniform3uiv(this.addr,e),fr(t,e)}}function H0(s,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ur(t,e))return;s.uniform4uiv(this.addr,e),fr(t,e)}}function z0(s,e,t){let n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i);let r=this.type===s.SAMPLER_2D_SHADOW?bu:xu;t.setTexture2D(e||r,i)}function j0(s,e,t){let n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||wu,i)}function W0(s,e,t){let n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTextureCube(e||Mu,i)}function K0(s,e,t){let n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||_u,i)}function X0(s){switch(s){case 5126:return T0;case 35664:return B0;case 35665:return R0;case 35666:return L0;case 35674:return D0;case 35675:return P0;case 35676:return F0;case 5124:case 35670:return O0;case 35667:case 35671:return U0;case 35668:case 35672:return N0;case 35669:case 35673:return k0;case 5125:return G0;case 36294:return Q0;case 36295:return V0;case 36296:return H0;case 35678:case 36198:case 36298:case 36306:case 35682:return z0;case 35679:case 36299:case 36307:return j0;case 35680:case 36300:case 36308:case 36293:return W0;case 36289:case 36303:case 36311:case 36292:return K0}}function Y0(s,e){s.uniform1fv(this.addr,e)}function q0(s,e){let t=oa(e,this.size,2);s.uniform2fv(this.addr,t)}function J0(s,e){let t=oa(e,this.size,3);s.uniform3fv(this.addr,t)}function Z0(s,e){let t=oa(e,this.size,4);s.uniform4fv(this.addr,t)}function $0(s,e){let t=oa(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,t)}function eg(s,e){let t=oa(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,t)}function tg(s,e){let t=oa(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,t)}function ng(s,e){s.uniform1iv(this.addr,e)}function ig(s,e){s.uniform2iv(this.addr,e)}function rg(s,e){s.uniform3iv(this.addr,e)}function sg(s,e){s.uniform4iv(this.addr,e)}function og(s,e){s.uniform1uiv(this.addr,e)}function ag(s,e){s.uniform2uiv(this.addr,e)}function lg(s,e){s.uniform3uiv(this.addr,e)}function cg(s,e){s.uniform4uiv(this.addr,e)}function hg(s,e,t){let n=this.cache,i=e.length,r=Pl(t,i);ur(n,r)||(s.uniform1iv(this.addr,r),fr(n,r));for(let o=0;o!==i;++o)t.setTexture2D(e[o]||xu,r[o])}function dg(s,e,t){let n=this.cache,i=e.length,r=Pl(t,i);ur(n,r)||(s.uniform1iv(this.addr,r),fr(n,r));for(let o=0;o!==i;++o)t.setTexture3D(e[o]||wu,r[o])}function ug(s,e,t){let n=this.cache,i=e.length,r=Pl(t,i);ur(n,r)||(s.uniform1iv(this.addr,r),fr(n,r));for(let o=0;o!==i;++o)t.setTextureCube(e[o]||Mu,r[o])}function fg(s,e,t){let n=this.cache,i=e.length,r=Pl(t,i);ur(n,r)||(s.uniform1iv(this.addr,r),fr(n,r));for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||_u,r[o])}function pg(s){switch(s){case 5126:return Y0;case 35664:return q0;case 35665:return J0;case 35666:return Z0;case 35674:return $0;case 35675:return eg;case 35676:return tg;case 5124:case 35670:return ng;case 35667:case 35671:return ig;case 35668:case 35672:return rg;case 35669:case 35673:return sg;case 5125:return og;case 36294:return ag;case 36295:return lg;case 36296:return cg;case 35678:case 36198:case 36298:case 36306:case 35682:return hg;case 35679:case 36299:case 36307:return dg;case 35680:case 36300:case 36308:case 36293:return ug;case 36289:case 36303:case 36311:case 36292:return fg}}class Ag{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=X0(t.type)}}class mg{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=pg(t.type)}}class gg{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){let i=this.seq;for(let r=0,o=i.length;r!==o;++r){let a=i[r];a.setValue(e,t[a.id],n)}}}let Hh=/(\w+)(\])?(\[|\.)?/g;function Lu(s,e){s.seq.push(e),s.map[e.id]=e}function vg(s,e,t){let n=s.name,i=n.length;for(Hh.lastIndex=0;;){let r=Hh.exec(n),o=Hh.lastIndex,a=r[1],d=r[2]==="]",E=r[3];if(d&&(a=a|0),E===void 0||E==="["&&o+2===i){Lu(t,E===void 0?new Ag(a,s,e):new mg(a,s,e));break}else{let T=t.map[a];T===void 0&&(T=new gg(a),Lu(t,T)),t=T}}}class Fl{constructor(e,t){this.seq=[],this.map={};let n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){let r=e.getActiveUniform(t,i),o=e.getUniformLocation(t,r.name);vg(r,o,this)}}setValue(e,t,n,i){let r=this.map[t];r!==void 0&&r.setValue(e,n,i)}setOptional(e,t,n){let i=t[n];i!==void 0&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let r=0,o=t.length;r!==o;++r){let a=t[r],d=n[a.id];d.needsUpdate!==!1&&a.setValue(e,d.value,i)}}static seqWithValue(e,t){let n=[];for(let i=0,r=e.length;i!==r;++i){let o=e[i];o.id in t&&n.push(o)}return n}}function Du(s,e,t){let n=s.createShader(e);return s.shaderSource(n,t),s.compileShader(n),n}let Eg=37297,yg=0;function Cg(s,e){let t=s.split(`
`),n=[],i=Math.max(e-6,0),r=Math.min(e+6,t.length);for(let o=i;o<r;o++){let a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join(`
`)}function xg(s){let e=Ai.getPrimaries(Ai.workingColorSpace),t=Ai.getPrimaries(s),n;switch(e===t?n="":e===ho&&t===co?n="LinearDisplayP3ToLinearSRGB":e===co&&t===ho&&(n="LinearSRGBToLinearDisplayP3"),s){case ls:case ao:return[n,"LinearTransferOETF"];case ni:case Uo:return[n,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",s),[n,"LinearTransferOETF"]}}function Pu(s,e,t){let n=s.getShaderParameter(e,s.COMPILE_STATUS),i=s.getShaderInfoLog(e).trim();if(n&&i==="")return"";let r=/ERROR: 0:(\d+)/.exec(i);if(r){let o=parseInt(r[1]);return t.toUpperCase()+`

`+i+`

`+Cg(s.getShaderSource(e),o)}else return i}function bg(s,e){let t=xg(e);return`vec4 ${s}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function _g(s,e){let t;switch(e){case mr:t="Linear";break;case Ji:t="Reinhard";break;case Ei:t="OptimizedCineon";break;case vt:t="ACESFilmic";break;case oe:t="AgX";break;case Ce:t="Neutral";break;case ae:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+s+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function wg(s){return[s.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",s.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Ba).join(`
`)}function Mg(s){let e=[];for(let t in s){let n=s[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function Sg(s,e){let t={},n=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){let r=s.getActiveAttrib(e,i),o=r.name,a=1;r.type===s.FLOAT_MAT2&&(a=2),r.type===s.FLOAT_MAT3&&(a=3),r.type===s.FLOAT_MAT4&&(a=4),t[o]={type:r.type,location:s.getAttribLocation(e,o),locationSize:a}}return t}function Ba(s){return s!==""}function Fu(s,e){let t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Ou(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}let Ig=/^[ \t]*#include +<([\w\d./]+)>/gm;function zh(s){return s.replace(Ig,Bg)}let Tg=new Map;function Bg(s,e){let t=Qn[e];if(t===void 0){let n=Tg.get(e);if(n!==void 0)t=Qn[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return zh(t)}let Rg=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Uu(s){return s.replace(Rg,Lg)}function Lg(s,e,t,n){let i="";for(let r=parseInt(e);r<parseInt(t);r++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return i}function Nu(s){let e=`precision ${s.precision} float;
	precision ${s.precision} int;
	precision ${s.precision} sampler2D;
	precision ${s.precision} samplerCube;
	precision ${s.precision} sampler3D;
	precision ${s.precision} sampler2DArray;
	precision ${s.precision} sampler2DShadow;
	precision ${s.precision} samplerCubeShadow;
	precision ${s.precision} sampler2DArrayShadow;
	precision ${s.precision} isampler2D;
	precision ${s.precision} isampler3D;
	precision ${s.precision} isamplerCube;
	precision ${s.precision} isampler2DArray;
	precision ${s.precision} usampler2D;
	precision ${s.precision} usampler3D;
	precision ${s.precision} usamplerCube;
	precision ${s.precision} usampler2DArray;
	`;return s.precision==="highp"?e+=`
#define HIGH_PRECISION`:s.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:s.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Dg(s){let e="SHADOWMAP_TYPE_BASIC";return s.shadowMapType===g?e="SHADOWMAP_TYPE_PCF":s.shadowMapType===A?e="SHADOWMAP_TYPE_PCF_SOFT":s.shadowMapType===h&&(e="SHADOWMAP_TYPE_VSM"),e}function Pg(s){let e="ENVMAP_TYPE_CUBE";if(s.envMap)switch(s.envMapMode){case z:case I:e="ENVMAP_TYPE_CUBE";break;case he:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Fg(s){let e="ENVMAP_MODE_REFLECTION";if(s.envMap)switch(s.envMapMode){case I:e="ENVMAP_MODE_REFRACTION";break}return e}function Og(s){let e="ENVMAP_BLENDING_NONE";if(s.envMap)switch(s.combine){case pi:e="ENVMAP_BLENDING_MULTIPLY";break;case Jn:e="ENVMAP_BLENDING_MIX";break;case Fi:e="ENVMAP_BLENDING_ADD";break}return e}function Ug(s){let e=s.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function Ng(s,e,t,n){let i=s.getContext(),r=t.defines,o=t.vertexShader,a=t.fragmentShader,d=Dg(t),E=Pg(t),w=Fg(t),T=Og(t),B=Ug(t),D=wg(t),N=Mg(r),j=i.createProgram(),G,P,se=t.glslVersion?"#version "+t.glslVersion+`
`:"",$=t.numMultiviewViews;t.isRawShaderMaterial?(G=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,N].filter(Ba).join(`
`),G.length>0&&(G+=`
`),P=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,N].filter(Ba).join(`
`),P.length>0&&(P+=`
`)):(G=[Nu(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,N,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+w:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ba).join(`
`),P=[Nu(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,N,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+E:"",t.envMap?"#define "+w:"",t.envMap?"#define "+T:"",B?"#define CUBEUV_TEXEL_WIDTH "+B.texelWidth:"",B?"#define CUBEUV_TEXEL_HEIGHT "+B.texelHeight:"",B?"#define CUBEUV_MAX_MIP "+B.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==vi?"#define TONE_MAPPING":"",t.toneMapping!==vi?Qn.tonemapping_pars_fragment:"",t.toneMapping!==vi?_g("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Qn.colorspace_pars_fragment,bg("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Ba).join(`
`)),o=zh(o),o=Fu(o,t),o=Ou(o,t),a=zh(a),a=Fu(a,t),a=Ou(a,t),o=Uu(o),a=Uu(a),t.isRawShaderMaterial!==!0&&(se=`#version 300 es
`,G=[D,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+G,P=["#define varying in",t.glslVersion===Ea?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Ea?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+P,$>0&&(G=["#extension GL_OVR_multiview : require","layout(num_views = "+$+") in;","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+G,G=G.replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join(`
`),["uniform mat4 modelViewMatrices["+$+"];","uniform mat4 projectionMatrices["+$+"];","uniform mat4 viewMatrices["+$+"];","uniform mat3 normalMatrices["+$+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join(`
`)),P=["#extension GL_OVR_multiview : require","#define VIEW_ID gl_ViewID_OVR"].join(`
`)+`
`+P,P=P.replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+$+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join(`
`))));let J=se+G+o,Be=se+P+a,ge=Du(i,i.VERTEX_SHADER,J),we=Du(i,i.FRAGMENT_SHADER,Be);i.attachShader(j,ge),i.attachShader(j,we),t.index0AttributeName!==void 0?i.bindAttribLocation(j,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(j,0,"position"),i.linkProgram(j);function Te(ke){if(s.debug.checkShaderErrors){let Fe=i.getProgramInfoLog(j).trim(),Ge=i.getShaderInfoLog(ge).trim(),qe=i.getShaderInfoLog(we).trim(),ct=!0,Pt=!0;if(i.getProgramParameter(j,i.LINK_STATUS)===!1)if(ct=!1,typeof s.debug.onShaderError=="function")s.debug.onShaderError(i,j,ge,we);else{let Ze=Pu(i,ge,"vertex"),It=Pu(i,we,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(j,i.VALIDATE_STATUS)+`

Material Name: `+ke.name+`
Material Type: `+ke.type+`

Program Info Log: `+Fe+`
`+Ze+`
`+It)}else Fe!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Fe):(Ge===""||qe==="")&&(Pt=!1);Pt&&(ke.diagnostics={runnable:ct,programLog:Fe,vertexShader:{log:Ge,prefix:G},fragmentShader:{log:qe,prefix:P}})}i.deleteShader(ge),i.deleteShader(we),de=new Fl(i,j),le=Sg(i,j)}let de;this.getUniforms=function(){return de===void 0&&Te(this),de};let le;this.getAttributes=function(){return le===void 0&&Te(this),le};let Ie=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return Ie===!1&&(Ie=i.getProgramParameter(j,Eg)),Ie},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(j),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=yg++,this.cacheKey=e,this.usedTimes=1,this.program=j,this.vertexShader=ge,this.fragmentShader=we,this.numMultiviewViews=$,this}let kg=0;class Gg{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),r=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(r)===!1&&(o.add(r),r.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){let t=this.shaderCache,n=t.get(e);return n===void 0&&(n=new Qg(e),t.set(e,n)),n}}class Qg{constructor(e){this.id=kg++,this.code=e,this.usedTimes=0}}function Vg(s,e,t,n,i,r,o){let a=new gl,d=new Gg,E=new Set,w=[],T=i.logarithmicDepthBuffer,B=i.vertexTextures,D=i.precision,N={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function j(de){return E.add(de),de===0?"uv":`uv${de}`}function G(de,le,Ie,ke,Fe){let Ge=ke.fog,qe=Fe.geometry,ct=de.isMeshStandardMaterial?ke.environment:null,Pt=(de.isMeshStandardMaterial?t:e).get(de.envMap||ct),Ze=!!Pt&&Pt.mapping===he?Pt.image.height:null,It=N[de.type];de.precision!==null&&(D=i.getMaxPrecision(de.precision),D!==de.precision&&console.warn("THREE.WebGLProgram.getParameters:",de.precision,"not supported, using",D,"instead."));let Rt=qe.morphAttributes.position||qe.morphAttributes.normal||qe.morphAttributes.color,nn=Rt!==void 0?Rt.length:0,jn=0;qe.morphAttributes.position!==void 0&&(jn=1),qe.morphAttributes.normal!==void 0&&(jn=2),qe.morphAttributes.color!==void 0&&(jn=3);let mi,Di,di,Ti;if(It){let pr=ds[It];mi=pr.vertexShader,Di=pr.fragmentShader}else mi=de.vertexShader,Di=de.fragmentShader,d.update(de),di=d.getVertexShaderID(de),Ti=d.getFragmentShaderID(de);let sn=s.getRenderTarget(),ut=sn&&sn.isWebGLMultiviewRenderTarget?sn.numViews:0,Ot=Fe.isInstancedMesh===!0,Nt=Fe.isBatchedMesh===!0,Qe=!!de.map,ft=!!de.matcap,rt=!!Pt,St=!!de.aoMap,wt=!!de.lightMap,xt=!!de.bumpMap,Vt=!!de.normalMap,Yt=!!de.displacementMap,Tn=!!de.emissiveMap,Pn=!!de.metalnessMap,ui=!!de.roughnessMap,Ki=de.anisotropy>0,Pi=de.clearcoat>0,Se=de.dispersion>0,ce=de.iridescence>0,tt=de.sheen>0,dt=de.transmission>0,gt=Ki&&!!de.anisotropyMap,At=Pi&&!!de.clearcoatMap,cn=Pi&&!!de.clearcoatNormalMap,Ft=Pi&&!!de.clearcoatRoughnessMap,Jt=ce&&!!de.iridescenceMap,bi=ce&&!!de.iridescenceThicknessMap,Zt=tt&&!!de.sheenColorMap,dn=tt&&!!de.sheenRoughnessMap,Vn=!!de.specularMap,bn=!!de.specularColorMap,Le=!!de.specularIntensityMap,bt=dt&&!!de.transmissionMap,Lt=dt&&!!de.thicknessMap,hn=!!de.gradientMap,Wt=!!de.alphaMap,Hn=de.alphaTest>0,Kt=!!de.alphaHash,Ht=!!de.extensions,Kn=vi;de.toneMapped&&(sn===null||sn.isXRRenderTarget===!0)&&(Kn=s.toneMapping);let wn={shaderID:It,shaderType:de.type,shaderName:de.name,vertexShader:mi,fragmentShader:Di,defines:de.defines,customVertexShaderID:di,customFragmentShaderID:Ti,isRawShaderMaterial:de.isRawShaderMaterial===!0,glslVersion:de.glslVersion,precision:D,batching:Nt,instancing:Ot,instancingColor:Ot&&Fe.instanceColor!==null,instancingMorph:Ot&&Fe.morphTexture!==null,supportsVertexTextures:B,numMultiviewViews:ut,outputColorSpace:sn===null?s.outputColorSpace:sn.isXRRenderTarget===!0?sn.texture.colorSpace:ls,alphaToCoverage:!!de.alphaToCoverage,map:Qe,matcap:ft,envMap:rt,envMapMode:rt&&Pt.mapping,envMapCubeUVHeight:Ze,aoMap:St,lightMap:wt,bumpMap:xt,normalMap:Vt,displacementMap:B&&Yt,emissiveMap:Tn,normalMapObjectSpace:Vt&&de.normalMapType===gs,normalMapTangentSpace:Vt&&de.normalMapType===Mr,metalnessMap:Pn,roughnessMap:ui,anisotropy:Ki,anisotropyMap:gt,clearcoat:Pi,clearcoatMap:At,clearcoatNormalMap:cn,clearcoatRoughnessMap:Ft,dispersion:Se,iridescence:ce,iridescenceMap:Jt,iridescenceThicknessMap:bi,sheen:tt,sheenColorMap:Zt,sheenRoughnessMap:dn,specularMap:Vn,specularColorMap:bn,specularIntensityMap:Le,transmission:dt,transmissionMap:bt,thicknessMap:Lt,gradientMap:hn,opaque:de.transparent===!1&&de.blending===L&&de.alphaToCoverage===!1,alphaMap:Wt,alphaTest:Hn,alphaHash:Kt,combine:de.combine,mapUv:Qe&&j(de.map.channel),aoMapUv:St&&j(de.aoMap.channel),lightMapUv:wt&&j(de.lightMap.channel),bumpMapUv:xt&&j(de.bumpMap.channel),normalMapUv:Vt&&j(de.normalMap.channel),displacementMapUv:Yt&&j(de.displacementMap.channel),emissiveMapUv:Tn&&j(de.emissiveMap.channel),metalnessMapUv:Pn&&j(de.metalnessMap.channel),roughnessMapUv:ui&&j(de.roughnessMap.channel),anisotropyMapUv:gt&&j(de.anisotropyMap.channel),clearcoatMapUv:At&&j(de.clearcoatMap.channel),clearcoatNormalMapUv:cn&&j(de.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ft&&j(de.clearcoatRoughnessMap.channel),iridescenceMapUv:Jt&&j(de.iridescenceMap.channel),iridescenceThicknessMapUv:bi&&j(de.iridescenceThicknessMap.channel),sheenColorMapUv:Zt&&j(de.sheenColorMap.channel),sheenRoughnessMapUv:dn&&j(de.sheenRoughnessMap.channel),specularMapUv:Vn&&j(de.specularMap.channel),specularColorMapUv:bn&&j(de.specularColorMap.channel),specularIntensityMapUv:Le&&j(de.specularIntensityMap.channel),transmissionMapUv:bt&&j(de.transmissionMap.channel),thicknessMapUv:Lt&&j(de.thicknessMap.channel),alphaMapUv:Wt&&j(de.alphaMap.channel),vertexTangents:!!qe.attributes.tangent&&(Vt||Ki),vertexColors:de.vertexColors,vertexAlphas:de.vertexColors===!0&&!!qe.attributes.color&&qe.attributes.color.itemSize===4,pointsUvs:Fe.isPoints===!0&&!!qe.attributes.uv&&(Qe||Wt),fog:!!Ge,useFog:de.fog===!0,fogExp2:!!Ge&&Ge.isFogExp2,flatShading:de.flatShading===!0,sizeAttenuation:de.sizeAttenuation===!0,logarithmicDepthBuffer:T,skinning:Fe.isSkinnedMesh===!0,morphTargets:qe.morphAttributes.position!==void 0,morphNormals:qe.morphAttributes.normal!==void 0,morphColors:qe.morphAttributes.color!==void 0,morphTargetsCount:nn,morphTextureStride:jn,numDirLights:le.directional.length,numPointLights:le.point.length,numSpotLights:le.spot.length,numSpotLightMaps:le.spotLightMap.length,numRectAreaLights:le.rectArea.length,numHemiLights:le.hemi.length,numDirLightShadows:le.directionalShadowMap.length,numPointLightShadows:le.pointShadowMap.length,numSpotLightShadows:le.spotShadowMap.length,numSpotLightShadowsWithMaps:le.numSpotLightShadowsWithMaps,numLightProbes:le.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:de.dithering,shadowMapEnabled:s.shadowMap.enabled&&Ie.length>0,shadowMapType:s.shadowMap.type,toneMapping:Kn,useLegacyLights:s._useLegacyLights,decodeVideoTexture:Qe&&de.map.isVideoTexture===!0&&Ai.getTransfer(de.map.colorSpace)===Ii,premultipliedAlpha:de.premultipliedAlpha,doubleSided:de.side===S,flipSided:de.side===x,useDepthPacking:de.depthPacking>=0,depthPacking:de.depthPacking||0,index0AttributeName:de.index0AttributeName,extensionClipCullDistance:Ht&&de.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Ht&&de.extensions.multiDraw===!0&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:de.customProgramCacheKey()};return wn.vertexUv1s=E.has(1),wn.vertexUv2s=E.has(2),wn.vertexUv3s=E.has(3),E.clear(),wn}function P(de){let le=[];if(de.shaderID?le.push(de.shaderID):(le.push(de.customVertexShaderID),le.push(de.customFragmentShaderID)),de.defines!==void 0)for(let Ie in de.defines)le.push(Ie),le.push(de.defines[Ie]);return de.isRawShaderMaterial===!1&&(se(le,de),$(le,de),le.push(s.outputColorSpace)),le.push(de.customProgramCacheKey),le.join()}function se(de,le){de.push(le.precision),de.push(le.outputColorSpace),de.push(le.envMapMode),de.push(le.envMapCubeUVHeight),de.push(le.mapUv),de.push(le.alphaMapUv),de.push(le.lightMapUv),de.push(le.aoMapUv),de.push(le.bumpMapUv),de.push(le.normalMapUv),de.push(le.displacementMapUv),de.push(le.emissiveMapUv),de.push(le.metalnessMapUv),de.push(le.roughnessMapUv),de.push(le.anisotropyMapUv),de.push(le.clearcoatMapUv),de.push(le.clearcoatNormalMapUv),de.push(le.clearcoatRoughnessMapUv),de.push(le.iridescenceMapUv),de.push(le.iridescenceThicknessMapUv),de.push(le.sheenColorMapUv),de.push(le.sheenRoughnessMapUv),de.push(le.specularMapUv),de.push(le.specularColorMapUv),de.push(le.specularIntensityMapUv),de.push(le.transmissionMapUv),de.push(le.thicknessMapUv),de.push(le.combine),de.push(le.fogExp2),de.push(le.sizeAttenuation),de.push(le.morphTargetsCount),de.push(le.morphAttributeCount),de.push(le.numDirLights),de.push(le.numPointLights),de.push(le.numSpotLights),de.push(le.numSpotLightMaps),de.push(le.numHemiLights),de.push(le.numRectAreaLights),de.push(le.numDirLightShadows),de.push(le.numPointLightShadows),de.push(le.numSpotLightShadows),de.push(le.numSpotLightShadowsWithMaps),de.push(le.numLightProbes),de.push(le.shadowMapType),de.push(le.toneMapping),de.push(le.numClippingPlanes),de.push(le.numClipIntersection),de.push(le.depthPacking)}function $(de,le){a.disableAll(),le.supportsVertexTextures&&a.enable(0),le.instancing&&a.enable(1),le.instancingColor&&a.enable(2),le.instancingMorph&&a.enable(3),le.matcap&&a.enable(4),le.envMap&&a.enable(5),le.normalMapObjectSpace&&a.enable(6),le.normalMapTangentSpace&&a.enable(7),le.clearcoat&&a.enable(8),le.iridescence&&a.enable(9),le.alphaTest&&a.enable(10),le.vertexColors&&a.enable(11),le.vertexAlphas&&a.enable(12),le.vertexUv1s&&a.enable(13),le.vertexUv2s&&a.enable(14),le.vertexUv3s&&a.enable(15),le.vertexTangents&&a.enable(16),le.anisotropy&&a.enable(17),le.alphaHash&&a.enable(18),le.batching&&a.enable(19),le.dispersion&&a.enable(20),de.push(a.mask),a.disableAll(),le.fog&&a.enable(0),le.useFog&&a.enable(1),le.flatShading&&a.enable(2),le.logarithmicDepthBuffer&&a.enable(3),le.skinning&&a.enable(4),le.morphTargets&&a.enable(5),le.morphNormals&&a.enable(6),le.morphColors&&a.enable(7),le.premultipliedAlpha&&a.enable(8),le.shadowMapEnabled&&a.enable(9),le.useLegacyLights&&a.enable(10),le.doubleSided&&a.enable(11),le.flipSided&&a.enable(12),le.useDepthPacking&&a.enable(13),le.dithering&&a.enable(14),le.transmission&&a.enable(15),le.sheen&&a.enable(16),le.opaque&&a.enable(17),le.pointsUvs&&a.enable(18),le.decodeVideoTexture&&a.enable(19),le.alphaToCoverage&&a.enable(20),le.numMultiviewViews&&a.enable(21),de.push(a.mask)}function J(de){let le=N[de.type],Ie;if(le){let ke=ds[le];Ie=du.clone(ke.uniforms)}else Ie=de.uniforms;return Ie}function Be(de,le){let Ie;for(let ke=0,Fe=w.length;ke<Fe;ke++){let Ge=w[ke];if(Ge.cacheKey===le){Ie=Ge,++Ie.usedTimes;break}}return Ie===void 0&&(Ie=new Ng(s,le,de,r),w.push(Ie)),Ie}function ge(de){if(--de.usedTimes==0){let le=w.indexOf(de);w[le]=w[w.length-1],w.pop(),de.destroy()}}function we(de){d.remove(de)}function Te(){d.dispose()}return{getParameters:G,getProgramCacheKey:P,getUniforms:J,acquireProgram:Be,releaseProgram:ge,releaseShaderCache:we,programs:w,dispose:Te}}function Hg(){let s=new WeakMap;function e(r){let o=s.get(r);return o===void 0&&(o={},s.set(r,o)),o}function t(r){s.delete(r)}function n(r,o,a){s.get(r)[o]=a}function i(){s=new WeakMap}return{get:e,remove:t,update:n,dispose:i}}function zg(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function ku(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function Gu(){let s=[],e=0,t=[],n=[],i=[];function r(){e=0,t.length=0,n.length=0,i.length=0}function o(T,B,D,N,j,G){let P=s[e];return P===void 0?(P={id:T.id,object:T,geometry:B,material:D,groupOrder:N,renderOrder:T.renderOrder,z:j,group:G},s[e]=P):(P.id=T.id,P.object=T,P.geometry=B,P.material=D,P.groupOrder=N,P.renderOrder=T.renderOrder,P.z=j,P.group=G),e++,P}function a(T,B,D,N,j,G){let P=o(T,B,D,N,j,G);D.transmission>0?n.push(P):D.transparent===!0?i.push(P):t.push(P)}function d(T,B,D,N,j,G){let P=o(T,B,D,N,j,G);D.transmission>0?n.unshift(P):D.transparent===!0?i.unshift(P):t.unshift(P)}function E(T,B){t.length>1&&t.sort(T||zg),n.length>1&&n.sort(B||ku),i.length>1&&i.sort(B||ku)}function w(){for(let T=e,B=s.length;T<B;T++){let D=s[T];if(D.id===null)break;D.id=null,D.object=null,D.geometry=null,D.material=null,D.group=null}}return{opaque:t,transmissive:n,transparent:i,init:r,push:a,unshift:d,finish:w,sort:E}}function jg(){let s=new WeakMap;function e(n,i){let r=s.get(n),o;return r===void 0?(o=new Gu,s.set(n,[o])):i>=r.length?(o=new Gu,r.push(o)):o=r[i],o}function t(){s=new WeakMap}return{get:e,dispose:t}}function Wg(){let s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ve,color:new qt};break;case"SpotLight":t={position:new ve,direction:new ve,color:new qt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ve,color:new qt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ve,skyColor:new qt,groundColor:new qt};break;case"RectAreaLight":t={color:new qt,position:new ve,halfWidth:new ve,halfHeight:new ve};break}return s[e.id]=t,t}}}function Kg(){let s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ht,shadowCameraNear:1,shadowCameraFar:1e3};break}return s[e.id]=t,t}}}let Xg=0;function Yg(s,e){return(e.castShadow?2:0)-(s.castShadow?2:0)+(e.map?1:0)-(s.map?1:0)}function qg(s){let e=new Wg,t=Kg(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let E=0;E<9;E++)n.probe.push(new ve);let i=new ve,r=new rn,o=new rn;function a(E,w){let T=0,B=0,D=0;for(let Ie=0;Ie<9;Ie++)n.probe[Ie].set(0,0,0);let N=0,j=0,G=0,P=0,se=0,$=0,J=0,Be=0,ge=0,we=0,Te=0;E.sort(Yg);let de=w===!0?Math.PI:1;for(let Ie=0,ke=E.length;Ie<ke;Ie++){let Fe=E[Ie],Ge=Fe.color,qe=Fe.intensity,ct=Fe.distance,Pt=Fe.shadow&&Fe.shadow.map?Fe.shadow.map.texture:null;if(Fe.isAmbientLight)T+=Ge.r*qe*de,B+=Ge.g*qe*de,D+=Ge.b*qe*de;else if(Fe.isLightProbe){for(let Ze=0;Ze<9;Ze++)n.probe[Ze].addScaledVector(Fe.sh.coefficients[Ze],qe);Te++}else if(Fe.isDirectionalLight){let Ze=e.get(Fe);if(Ze.color.copy(Fe.color).multiplyScalar(Fe.intensity*de),Fe.castShadow){let It=Fe.shadow,Rt=t.get(Fe);Rt.shadowBias=It.bias,Rt.shadowNormalBias=It.normalBias,Rt.shadowRadius=It.radius,Rt.shadowMapSize=It.mapSize,n.directionalShadow[N]=Rt,n.directionalShadowMap[N]=Pt,n.directionalShadowMatrix[N]=Fe.shadow.matrix,$++}n.directional[N]=Ze,N++}else if(Fe.isSpotLight){let Ze=e.get(Fe);Ze.position.setFromMatrixPosition(Fe.matrixWorld),Ze.color.copy(Ge).multiplyScalar(qe*de),Ze.distance=ct,Ze.coneCos=Math.cos(Fe.angle),Ze.penumbraCos=Math.cos(Fe.angle*(1-Fe.penumbra)),Ze.decay=Fe.decay,n.spot[G]=Ze;let It=Fe.shadow;if(Fe.map&&(n.spotLightMap[ge]=Fe.map,ge++,It.updateMatrices(Fe),Fe.castShadow&&we++),n.spotLightMatrix[G]=It.matrix,Fe.castShadow){let Rt=t.get(Fe);Rt.shadowBias=It.bias,Rt.shadowNormalBias=It.normalBias,Rt.shadowRadius=It.radius,Rt.shadowMapSize=It.mapSize,n.spotShadow[G]=Rt,n.spotShadowMap[G]=Pt,Be++}G++}else if(Fe.isRectAreaLight){let Ze=e.get(Fe);Ze.color.copy(Ge).multiplyScalar(qe),Ze.halfWidth.set(Fe.width*.5,0,0),Ze.halfHeight.set(0,Fe.height*.5,0),n.rectArea[P]=Ze,P++}else if(Fe.isPointLight){let Ze=e.get(Fe);if(Ze.color.copy(Fe.color).multiplyScalar(Fe.intensity*de),Ze.distance=Fe.distance,Ze.decay=Fe.decay,Fe.castShadow){let It=Fe.shadow,Rt=t.get(Fe);Rt.shadowBias=It.bias,Rt.shadowNormalBias=It.normalBias,Rt.shadowRadius=It.radius,Rt.shadowMapSize=It.mapSize,Rt.shadowCameraNear=It.camera.near,Rt.shadowCameraFar=It.camera.far,n.pointShadow[j]=Rt,n.pointShadowMap[j]=Pt,n.pointShadowMatrix[j]=Fe.shadow.matrix,J++}n.point[j]=Ze,j++}else if(Fe.isHemisphereLight){let Ze=e.get(Fe);Ze.skyColor.copy(Fe.color).multiplyScalar(qe*de),Ze.groundColor.copy(Fe.groundColor).multiplyScalar(qe*de),n.hemi[se]=Ze,se++}}P>0&&(s.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Ut.LTC_FLOAT_1,n.rectAreaLTC2=Ut.LTC_FLOAT_2):(n.rectAreaLTC1=Ut.LTC_HALF_1,n.rectAreaLTC2=Ut.LTC_HALF_2)),n.ambient[0]=T,n.ambient[1]=B,n.ambient[2]=D;let le=n.hash;(le.directionalLength!==N||le.pointLength!==j||le.spotLength!==G||le.rectAreaLength!==P||le.hemiLength!==se||le.numDirectionalShadows!==$||le.numPointShadows!==J||le.numSpotShadows!==Be||le.numSpotMaps!==ge||le.numLightProbes!==Te)&&(n.directional.length=N,n.spot.length=G,n.rectArea.length=P,n.point.length=j,n.hemi.length=se,n.directionalShadow.length=$,n.directionalShadowMap.length=$,n.pointShadow.length=J,n.pointShadowMap.length=J,n.spotShadow.length=Be,n.spotShadowMap.length=Be,n.directionalShadowMatrix.length=$,n.pointShadowMatrix.length=J,n.spotLightMatrix.length=Be+ge-we,n.spotLightMap.length=ge,n.numSpotLightShadowsWithMaps=we,n.numLightProbes=Te,le.directionalLength=N,le.pointLength=j,le.spotLength=G,le.rectAreaLength=P,le.hemiLength=se,le.numDirectionalShadows=$,le.numPointShadows=J,le.numSpotShadows=Be,le.numSpotMaps=ge,le.numLightProbes=Te,n.version=Xg++)}function d(E,w){let T=0,B=0,D=0,N=0,j=0,G=w.matrixWorldInverse;for(let P=0,se=E.length;P<se;P++){let $=E[P];if($.isDirectionalLight){let J=n.directional[T];J.direction.setFromMatrixPosition($.matrixWorld),i.setFromMatrixPosition($.target.matrixWorld),J.direction.sub(i),J.direction.transformDirection(G),T++}else if($.isSpotLight){let J=n.spot[D];J.position.setFromMatrixPosition($.matrixWorld),J.position.applyMatrix4(G),J.direction.setFromMatrixPosition($.matrixWorld),i.setFromMatrixPosition($.target.matrixWorld),J.direction.sub(i),J.direction.transformDirection(G),D++}else if($.isRectAreaLight){let J=n.rectArea[N];J.position.setFromMatrixPosition($.matrixWorld),J.position.applyMatrix4(G),o.identity(),r.copy($.matrixWorld),r.premultiply(G),o.extractRotation(r),J.halfWidth.set($.width*.5,0,0),J.halfHeight.set(0,$.height*.5,0),J.halfWidth.applyMatrix4(o),J.halfHeight.applyMatrix4(o),N++}else if($.isPointLight){let J=n.point[B];J.position.setFromMatrixPosition($.matrixWorld),J.position.applyMatrix4(G),B++}else if($.isHemisphereLight){let J=n.hemi[j];J.direction.setFromMatrixPosition($.matrixWorld),J.direction.transformDirection(G),j++}}}return{setup:a,setupView:d,state:n}}function Qu(s){let e=new qg(s),t=[],n=[];function i(w){E.camera=w,t.length=0,n.length=0}function r(w){t.push(w)}function o(w){n.push(w)}function a(w){e.setup(t,w)}function d(w){e.setupView(t,w)}let E={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:E,setupLights:a,setupLightsView:d,pushLight:r,pushShadow:o}}function Jg(s){let e=new WeakMap;function t(i,r=0){let o=e.get(i),a;return o===void 0?(a=new Qu(s),e.set(i,[a])):r>=o.length?(a=new Qu(s),o.push(a)):a=o[r],a}function n(){e=new WeakMap}return{get:t,dispose:n}}class jh extends Tr{constructor(e){super();this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=As,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Wh extends Tr{constructor(e){super();this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}let Zg=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,$g=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function ev(s,e,t){let n=new Ta,i=new ht,r=new ht,o=new oi,a=new jh({depthPacking:ms}),d=new Wh,E={},w=t.maxTextureSize,T={[m]:x,[x]:m,[S]:S},B=new hs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ht},radius:{value:4}},vertexShader:Zg,fragmentShader:$g}),D=B.clone();D.defines.HORIZONTAL_PASS=1;let N=new zn;N.setAttribute("position",new Si(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let j=new ar(N,B),G=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=g;let P=this.type;this.render=function(ge,we,Te){if(G.enabled===!1||G.autoUpdate===!1&&G.needsUpdate===!1||ge.length===0)return;let de=s.getRenderTarget(),le=s.getActiveCubeFace(),Ie=s.getActiveMipmapLevel(),ke=s.state;ke.setBlending(b),ke.buffers.color.setClear(1,1,1,1),ke.buffers.depth.setTest(!0),ke.setScissorTest(!1);let Fe=P!==h&&this.type===h,Ge=P===h&&this.type!==h;for(let qe=0,ct=ge.length;qe<ct;qe++){let Pt=ge[qe],Ze=Pt.shadow;if(Ze===void 0){console.warn("THREE.WebGLShadowMap:",Pt,"has no shadow.");continue}if(Ze.autoUpdate===!1&&Ze.needsUpdate===!1)continue;i.copy(Ze.mapSize);let It=Ze.getFrameExtents();if(i.multiply(It),r.copy(Ze.mapSize),(i.x>w||i.y>w)&&(i.x>w&&(r.x=Math.floor(w/It.x),i.x=r.x*It.x,Ze.mapSize.x=r.x),i.y>w&&(r.y=Math.floor(w/It.y),i.y=r.y*It.y,Ze.mapSize.y=r.y)),Ze.map===null||Fe===!0||Ge===!0){let nn=this.type!==h?{minFilter:Bt,magFilter:Bt}:{};Ze.map!==null&&Ze.map.dispose(),Ze.map=new Gr(i.x,i.y,nn),Ze.map.texture.name=Pt.name+".shadowMap",Ze.camera.updateProjectionMatrix()}s.setRenderTarget(Ze.map),s.clear();let Rt=Ze.getViewportCount();for(let nn=0;nn<Rt;nn++){let jn=Ze.getViewport(nn);o.set(r.x*jn.x,r.y*jn.y,r.x*jn.z,r.y*jn.w),ke.viewport(o),Ze.updateMatrices(Pt,nn),n=Ze.getFrustum(),J(we,Te,Ze.camera,Pt,this.type)}Ze.isPointLightShadow!==!0&&this.type===h&&se(Ze,Te),Ze.needsUpdate=!1}P=this.type,G.needsUpdate=!1,s.setRenderTarget(de,le,Ie)};function se(ge,we){let Te=e.update(j);B.defines.VSM_SAMPLES!==ge.blurSamples&&(B.defines.VSM_SAMPLES=ge.blurSamples,D.defines.VSM_SAMPLES=ge.blurSamples,B.needsUpdate=!0,D.needsUpdate=!0),ge.mapPass===null&&(ge.mapPass=new Gr(i.x,i.y)),B.uniforms.shadow_pass.value=ge.map.texture,B.uniforms.resolution.value=ge.mapSize,B.uniforms.radius.value=ge.radius,s.setRenderTarget(ge.mapPass),s.clear(),s.renderBufferDirect(we,null,Te,B,j,null),D.uniforms.shadow_pass.value=ge.mapPass.texture,D.uniforms.resolution.value=ge.mapSize,D.uniforms.radius.value=ge.radius,s.setRenderTarget(ge.map),s.clear(),s.renderBufferDirect(we,null,Te,D,j,null)}function $(ge,we,Te,de){let le=null,Ie=Te.isPointLight===!0?ge.customDistanceMaterial:ge.customDepthMaterial;if(Ie!==void 0)le=Ie;else if(le=Te.isPointLight===!0?d:a,s.localClippingEnabled&&we.clipShadows===!0&&Array.isArray(we.clippingPlanes)&&we.clippingPlanes.length!==0||we.displacementMap&&we.displacementScale!==0||we.alphaMap&&we.alphaTest>0||we.map&&we.alphaTest>0){let ke=le.uuid,Fe=we.uuid,Ge=E[ke];Ge===void 0&&(Ge={},E[ke]=Ge);let qe=Ge[Fe];qe===void 0&&(qe=le.clone(),Ge[Fe]=qe,we.addEventListener("dispose",Be)),le=qe}if(le.visible=we.visible,le.wireframe=we.wireframe,de===h?le.side=we.shadowSide!==null?we.shadowSide:we.side:le.side=we.shadowSide!==null?we.shadowSide:T[we.side],le.alphaMap=we.alphaMap,le.alphaTest=we.alphaTest,le.map=we.map,le.clipShadows=we.clipShadows,le.clippingPlanes=we.clippingPlanes,le.clipIntersection=we.clipIntersection,le.displacementMap=we.displacementMap,le.displacementScale=we.displacementScale,le.displacementBias=we.displacementBias,le.wireframeLinewidth=we.wireframeLinewidth,le.linewidth=we.linewidth,Te.isPointLight===!0&&le.isMeshDistanceMaterial===!0){let ke=s.properties.get(le);ke.light=Te}return le}function J(ge,we,Te,de,le){if(ge.visible===!1)return;if(ge.layers.test(we.layers)&&(ge.isMesh||ge.isLine||ge.isPoints)&&(ge.castShadow||ge.receiveShadow&&le===h)&&(!ge.frustumCulled||n.intersectsObject(ge))){ge.modelViewMatrix.multiplyMatrices(Te.matrixWorldInverse,ge.matrixWorld);let Fe=e.update(ge),Ge=ge.material;if(Array.isArray(Ge)){let qe=Fe.groups;for(let ct=0,Pt=qe.length;ct<Pt;ct++){let Ze=qe[ct],It=Ge[Ze.materialIndex];if(It&&It.visible){let Rt=$(ge,It,de,le);ge.onBeforeShadow(s,ge,we,Te,Fe,Rt,Ze),s.renderBufferDirect(Te,null,Fe,Rt,ge,Ze),ge.onAfterShadow(s,ge,we,Te,Fe,Rt,Ze)}}}else if(Ge.visible){let qe=$(ge,Ge,de,le);ge.onBeforeShadow(s,ge,we,Te,Fe,qe,null),s.renderBufferDirect(Te,null,Fe,qe,ge,null),ge.onAfterShadow(s,ge,we,Te,Fe,qe,null)}}let ke=ge.children;for(let Fe=0,Ge=ke.length;Fe<Ge;Fe++)J(ke[Fe],we,Te,de,le)}function Be(ge){ge.target.removeEventListener("dispose",Be);for(let Te in E){let de=E[Te],le=ge.target.uuid;le in de&&(de[le].dispose(),delete de[le])}}}function tv(s){function e(){let Le=!1,bt=new oi,Lt=null,hn=new oi(0,0,0,0);return{setMask:function(Wt){Lt!==Wt&&!Le&&(s.colorMask(Wt,Wt,Wt,Wt),Lt=Wt)},setLocked:function(Wt){Le=Wt},setClear:function(Wt,Hn,Kt,Ht,Kn){Kn===!0&&(Wt*=Ht,Hn*=Ht,Kt*=Ht),bt.set(Wt,Hn,Kt,Ht),hn.equals(bt)===!1&&(s.clearColor(Wt,Hn,Kt,Ht),hn.copy(bt))},reset:function(){Le=!1,Lt=null,hn.set(-1,0,0,0)}}}function t(){let Le=!1,bt=null,Lt=null,hn=null;return{setTest:function(Wt){Wt?Ti(s.DEPTH_TEST):sn(s.DEPTH_TEST)},setMask:function(Wt){bt!==Wt&&!Le&&(s.depthMask(Wt),bt=Wt)},setFunc:function(Wt){if(Lt!==Wt){switch(Wt){case yn:s.depthFunc(s.NEVER);break;case Sn:s.depthFunc(s.ALWAYS);break;case Nn:s.depthFunc(s.LESS);break;case ln:s.depthFunc(s.LEQUAL);break;case En:s.depthFunc(s.EQUAL);break;case fi:s.depthFunc(s.GEQUAL);break;case si:s.depthFunc(s.GREATER);break;case qi:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}Lt=Wt}},setLocked:function(Wt){Le=Wt},setClear:function(Wt){hn!==Wt&&(s.clearDepth(Wt),hn=Wt)},reset:function(){Le=!1,bt=null,Lt=null,hn=null}}}function n(){let Le=!1,bt=null,Lt=null,hn=null,Wt=null,Hn=null,Kt=null,Ht=null,Kn=null;return{setTest:function(wn){Le||(wn?Ti(s.STENCIL_TEST):sn(s.STENCIL_TEST))},setMask:function(wn){bt!==wn&&!Le&&(s.stencilMask(wn),bt=wn)},setFunc:function(wn,pr,xs){(Lt!==wn||hn!==pr||Wt!==xs)&&(s.stencilFunc(wn,pr,xs),Lt=wn,hn=pr,Wt=xs)},setOp:function(wn,pr,xs){(Hn!==wn||Kt!==pr||Ht!==xs)&&(s.stencilOp(wn,pr,xs),Hn=wn,Kt=pr,Ht=xs)},setLocked:function(wn){Le=wn},setClear:function(wn){Kn!==wn&&(s.clearStencil(wn),Kn=wn)},reset:function(){Le=!1,bt=null,Lt=null,hn=null,Wt=null,Hn=null,Kt=null,Ht=null,Kn=null}}}let i=new e,r=new t,o=new n,a=new WeakMap,d=new WeakMap,E={},w={},T=new WeakMap,B=[],D=null,N=!1,j=null,G=null,P=null,se=null,$=null,J=null,Be=null,ge=new qt(0,0,0),we=0,Te=!1,de=null,le=null,Ie=null,ke=null,Fe=null,Ge=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS),qe=!1,ct=0,Pt=s.getParameter(s.VERSION);Pt.indexOf("WebGL")!==-1?(ct=parseFloat(/^WebGL (\d)/.exec(Pt)[1]),qe=ct>=1):Pt.indexOf("OpenGL ES")!==-1&&(ct=parseFloat(/^OpenGL ES (\d)/.exec(Pt)[1]),qe=ct>=2);let Ze=null,It={},Rt=s.getParameter(s.SCISSOR_BOX),nn=s.getParameter(s.VIEWPORT),jn=new oi().fromArray(Rt),mi=new oi().fromArray(nn);function Di(Le,bt,Lt,hn){let Wt=new Uint8Array(4),Hn=s.createTexture();s.bindTexture(Le,Hn),s.texParameteri(Le,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(Le,s.TEXTURE_MAG_FILTER,s.NEAREST);for(let Kt=0;Kt<Lt;Kt++)Le===s.TEXTURE_3D||Le===s.TEXTURE_2D_ARRAY?s.texImage3D(bt,0,s.RGBA,1,1,hn,0,s.RGBA,s.UNSIGNED_BYTE,Wt):s.texImage2D(bt+Kt,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,Wt);return Hn}let di={};di[s.TEXTURE_2D]=Di(s.TEXTURE_2D,s.TEXTURE_2D,1),di[s.TEXTURE_CUBE_MAP]=Di(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),di[s.TEXTURE_2D_ARRAY]=Di(s.TEXTURE_2D_ARRAY,s.TEXTURE_2D_ARRAY,1,1),di[s.TEXTURE_3D]=Di(s.TEXTURE_3D,s.TEXTURE_3D,1,1),i.setClear(0,0,0,1),r.setClear(1),o.setClear(0),Ti(s.DEPTH_TEST),r.setFunc(ln),wt(!1),xt(l),Ti(s.CULL_FACE),rt(b);function Ti(Le){E[Le]!==!0&&(s.enable(Le),E[Le]=!0)}function sn(Le){E[Le]!==!1&&(s.disable(Le),E[Le]=!1)}function ut(Le,bt){return w[Le]!==bt?(s.bindFramebuffer(Le,bt),w[Le]=bt,Le===s.DRAW_FRAMEBUFFER&&(w[s.FRAMEBUFFER]=bt),Le===s.FRAMEBUFFER&&(w[s.DRAW_FRAMEBUFFER]=bt),!0):!1}function Ot(Le,bt){let Lt=B,hn=!1;if(Le){Lt=T.get(bt),Lt===void 0&&(Lt=[],T.set(bt,Lt));let Wt=Le.textures;if(Lt.length!==Wt.length||Lt[0]!==s.COLOR_ATTACHMENT0){for(let Hn=0,Kt=Wt.length;Hn<Kt;Hn++)Lt[Hn]=s.COLOR_ATTACHMENT0+Hn;Lt.length=Wt.length,hn=!0}}else Lt[0]!==s.BACK&&(Lt[0]=s.BACK,hn=!0);hn&&s.drawBuffers(Lt)}function Nt(Le){return D!==Le?(s.useProgram(Le),D=Le,!0):!1}let Qe={[W]:s.FUNC_ADD,[te]:s.FUNC_SUBTRACT,[re]:s.FUNC_REVERSE_SUBTRACT};Qe[X]=s.MIN,Qe[V]=s.MAX;let ft={[O]:s.ZERO,[Z]:s.ONE,[ne]:s.SRC_COLOR,[be]:s.SRC_ALPHA,[Dt]:s.SRC_ALPHA_SATURATE,[nt]:s.DST_COLOR,[Ue]:s.DST_ALPHA,[pe]:s.ONE_MINUS_SRC_COLOR,[Re]:s.ONE_MINUS_SRC_ALPHA,[mt]:s.ONE_MINUS_DST_COLOR,[je]:s.ONE_MINUS_DST_ALPHA,[pt]:s.CONSTANT_COLOR,[Tt]:s.ONE_MINUS_CONSTANT_COLOR,[kt]:s.CONSTANT_ALPHA,[un]:s.ONE_MINUS_CONSTANT_ALPHA};function rt(Le,bt,Lt,hn,Wt,Hn,Kt,Ht,Kn,wn){if(Le===b){N===!0&&(sn(s.BLEND),N=!1);return}if(N===!1&&(Ti(s.BLEND),N=!0),Le!==Y){if(Le!==j||wn!==Te){if((G!==W||$!==W)&&(s.blendEquation(s.FUNC_ADD),G=W,$=W),wn)switch(Le){case L:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case M:s.blendFunc(s.ONE,s.ONE);break;case F:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case H:s.blendFuncSeparate(s.ZERO,s.SRC_COLOR,s.ZERO,s.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Le);break}else switch(Le){case L:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case M:s.blendFunc(s.SRC_ALPHA,s.ONE);break;case F:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case H:s.blendFunc(s.ZERO,s.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Le);break}P=null,se=null,J=null,Be=null,ge.set(0,0,0),we=0,j=Le,Te=wn}return}Wt=Wt||bt,Hn=Hn||Lt,Kt=Kt||hn,(bt!==G||Wt!==$)&&(s.blendEquationSeparate(Qe[bt],Qe[Wt]),G=bt,$=Wt),(Lt!==P||hn!==se||Hn!==J||Kt!==Be)&&(s.blendFuncSeparate(ft[Lt],ft[hn],ft[Hn],ft[Kt]),P=Lt,se=hn,J=Hn,Be=Kt),(Ht.equals(ge)===!1||Kn!==we)&&(s.blendColor(Ht.r,Ht.g,Ht.b,Kn),ge.copy(Ht),we=Kn),j=Le,Te=!1}function St(Le,bt){Le.side===S?sn(s.CULL_FACE):Ti(s.CULL_FACE);let Lt=Le.side===x;bt&&(Lt=!Lt),wt(Lt),Le.blending===L&&Le.transparent===!1?rt(b):rt(Le.blending,Le.blendEquation,Le.blendSrc,Le.blendDst,Le.blendEquationAlpha,Le.blendSrcAlpha,Le.blendDstAlpha,Le.blendColor,Le.blendAlpha,Le.premultipliedAlpha),r.setFunc(Le.depthFunc),r.setTest(Le.depthTest),r.setMask(Le.depthWrite),i.setMask(Le.colorWrite);let hn=Le.stencilWrite;o.setTest(hn),hn&&(o.setMask(Le.stencilWriteMask),o.setFunc(Le.stencilFunc,Le.stencilRef,Le.stencilFuncMask),o.setOp(Le.stencilFail,Le.stencilZFail,Le.stencilZPass)),Yt(Le.polygonOffset,Le.polygonOffsetFactor,Le.polygonOffsetUnits),Le.alphaToCoverage===!0?Ti(s.SAMPLE_ALPHA_TO_COVERAGE):sn(s.SAMPLE_ALPHA_TO_COVERAGE)}function wt(Le){de!==Le&&(Le?s.frontFace(s.CW):s.frontFace(s.CCW),de=Le)}function xt(Le){Le!==C?(Ti(s.CULL_FACE),Le!==le&&(Le===l?s.cullFace(s.BACK):Le===u?s.cullFace(s.FRONT):s.cullFace(s.FRONT_AND_BACK))):sn(s.CULL_FACE),le=Le}function Vt(Le){Le!==Ie&&(qe&&s.lineWidth(Le),Ie=Le)}function Yt(Le,bt,Lt){Le?(Ti(s.POLYGON_OFFSET_FILL),(ke!==bt||Fe!==Lt)&&(s.polygonOffset(bt,Lt),ke=bt,Fe=Lt)):sn(s.POLYGON_OFFSET_FILL)}function Tn(Le){Le?Ti(s.SCISSOR_TEST):sn(s.SCISSOR_TEST)}function Pn(Le){Le===void 0&&(Le=s.TEXTURE0+Ge-1),Ze!==Le&&(s.activeTexture(Le),Ze=Le)}function ui(Le,bt,Lt){Lt===void 0&&(Ze===null?Lt=s.TEXTURE0+Ge-1:Lt=Ze);let hn=It[Lt];hn===void 0&&(hn={type:void 0,texture:void 0},It[Lt]=hn),(hn.type!==Le||hn.texture!==bt)&&(Ze!==Lt&&(s.activeTexture(Lt),Ze=Lt),s.bindTexture(Le,bt||di[Le]),hn.type=Le,hn.texture=bt)}function Ki(){let Le=It[Ze];Le!==void 0&&Le.type!==void 0&&(s.bindTexture(Le.type,null),Le.type=void 0,Le.texture=void 0)}function Pi(){try{s.compressedTexImage2D.apply(s,arguments)}catch(Le){console.error("THREE.WebGLState:",Le)}}function Se(){try{s.compressedTexImage3D.apply(s,arguments)}catch(Le){console.error("THREE.WebGLState:",Le)}}function ce(){try{s.texSubImage2D.apply(s,arguments)}catch(Le){console.error("THREE.WebGLState:",Le)}}function tt(){try{s.texSubImage3D.apply(s,arguments)}catch(Le){console.error("THREE.WebGLState:",Le)}}function dt(){try{s.compressedTexSubImage2D.apply(s,arguments)}catch(Le){console.error("THREE.WebGLState:",Le)}}function gt(){try{s.compressedTexSubImage3D.apply(s,arguments)}catch(Le){console.error("THREE.WebGLState:",Le)}}function At(){try{s.texStorage2D.apply(s,arguments)}catch(Le){console.error("THREE.WebGLState:",Le)}}function cn(){try{s.texStorage3D.apply(s,arguments)}catch(Le){console.error("THREE.WebGLState:",Le)}}function Ft(){try{s.texImage2D.apply(s,arguments)}catch(Le){console.error("THREE.WebGLState:",Le)}}function Jt(){try{s.texImage3D.apply(s,arguments)}catch(Le){console.error("THREE.WebGLState:",Le)}}function bi(Le){jn.equals(Le)===!1&&(s.scissor(Le.x,Le.y,Le.z,Le.w),jn.copy(Le))}function Zt(Le){mi.equals(Le)===!1&&(s.viewport(Le.x,Le.y,Le.z,Le.w),mi.copy(Le))}function dn(Le,bt){let Lt=d.get(bt);Lt===void 0&&(Lt=new WeakMap,d.set(bt,Lt));let hn=Lt.get(Le);hn===void 0&&(hn=s.getUniformBlockIndex(bt,Le.name),Lt.set(Le,hn))}function Vn(Le,bt){let hn=d.get(bt).get(Le);a.get(bt)!==hn&&(s.uniformBlockBinding(bt,hn,Le.__bindingPointIndex),a.set(bt,hn))}function bn(){s.disable(s.BLEND),s.disable(s.CULL_FACE),s.disable(s.DEPTH_TEST),s.disable(s.POLYGON_OFFSET_FILL),s.disable(s.SCISSOR_TEST),s.disable(s.STENCIL_TEST),s.disable(s.SAMPLE_ALPHA_TO_COVERAGE),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ONE,s.ZERO),s.blendFuncSeparate(s.ONE,s.ZERO,s.ONE,s.ZERO),s.blendColor(0,0,0,0),s.colorMask(!0,!0,!0,!0),s.clearColor(0,0,0,0),s.depthMask(!0),s.depthFunc(s.LESS),s.clearDepth(1),s.stencilMask(4294967295),s.stencilFunc(s.ALWAYS,0,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),s.clearStencil(0),s.cullFace(s.BACK),s.frontFace(s.CCW),s.polygonOffset(0,0),s.activeTexture(s.TEXTURE0),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.useProgram(null),s.lineWidth(1),s.scissor(0,0,s.canvas.width,s.canvas.height),s.viewport(0,0,s.canvas.width,s.canvas.height),E={},Ze=null,It={},w={},T=new WeakMap,B=[],D=null,N=!1,j=null,G=null,P=null,se=null,$=null,J=null,Be=null,ge=new qt(0,0,0),we=0,Te=!1,de=null,le=null,Ie=null,ke=null,Fe=null,jn.set(0,0,s.canvas.width,s.canvas.height),mi.set(0,0,s.canvas.width,s.canvas.height),i.reset(),r.reset(),o.reset()}return{buffers:{color:i,depth:r,stencil:o},enable:Ti,disable:sn,bindFramebuffer:ut,drawBuffers:Ot,useProgram:Nt,setBlending:rt,setMaterial:St,setFlipSided:wt,setCullFace:xt,setLineWidth:Vt,setPolygonOffset:Yt,setScissorTest:Tn,activeTexture:Pn,bindTexture:ui,unbindTexture:Ki,compressedTexImage2D:Pi,compressedTexImage3D:Se,texImage2D:Ft,texImage3D:Jt,updateUBOMapping:dn,uniformBlockBinding:Vn,texStorage2D:At,texStorage3D:cn,texSubImage2D:ce,texSubImage3D:tt,compressedTexSubImage2D:dt,compressedTexSubImage3D:gt,scissor:bi,viewport:Zt,reset:bn}}function nv(s,e,t,n,i,r,o){let a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d=typeof navigator=="undefined"?!1:/OculusBrowser/g.test(navigator.userAgent),E=e.has("OCULUS_multiview")?e.get("OCULUS_multiview"):null,w=new ht,T=new WeakMap,B,D=new WeakMap,N=[],j=!1,G=!1;try{G=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch(Se){}function P(Se,ce){return G?new OffscreenCanvas(Se,ce):Ao("canvas")}function se(Se,ce,tt){let dt=1,gt=Pi(Se);if((gt.width>tt||gt.height>tt)&&(dt=tt/Math.max(gt.width,gt.height)),dt<1)if(typeof HTMLImageElement!="undefined"&&Se instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&Se instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&Se instanceof ImageBitmap||typeof VideoFrame!="undefined"&&Se instanceof VideoFrame){let At=Math.floor(dt*gt.width),cn=Math.floor(dt*gt.height);B===void 0&&(B=P(At,cn));let Ft=ce?P(At,cn):B;return Ft.width=At,Ft.height=cn,Ft.getContext("2d").drawImage(Se,0,0,At,cn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+gt.width+"x"+gt.height+") to ("+At+"x"+cn+")."),Ft}else return"data"in Se&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+gt.width+"x"+gt.height+")."),Se;return Se}function $(Se){return Se.generateMipmaps&&Se.minFilter!==Bt&&Se.minFilter!==pn}function J(Se){s.generateMipmap(Se)}function Be(Se,ce,tt,dt,gt=!1){if(Se!==null){if(s[Se]!==void 0)return s[Se];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Se+"'")}let At=ce;if(ce===s.RED&&(tt===s.FLOAT&&(At=s.R32F),tt===s.HALF_FLOAT&&(At=s.R16F),tt===s.UNSIGNED_BYTE&&(At=s.R8)),ce===s.RED_INTEGER&&(tt===s.UNSIGNED_BYTE&&(At=s.R8UI),tt===s.UNSIGNED_SHORT&&(At=s.R16UI),tt===s.UNSIGNED_INT&&(At=s.R32UI),tt===s.BYTE&&(At=s.R8I),tt===s.SHORT&&(At=s.R16I),tt===s.INT&&(At=s.R32I)),ce===s.RG&&(tt===s.FLOAT&&(At=s.RG32F),tt===s.HALF_FLOAT&&(At=s.RG16F),tt===s.UNSIGNED_BYTE&&(At=s.RG8)),ce===s.RG_INTEGER&&(tt===s.UNSIGNED_BYTE&&(At=s.RG8UI),tt===s.UNSIGNED_SHORT&&(At=s.RG16UI),tt===s.UNSIGNED_INT&&(At=s.RG32UI),tt===s.BYTE&&(At=s.RG8I),tt===s.SHORT&&(At=s.RG16I),tt===s.INT&&(At=s.RG32I)),ce===s.RGB&&tt===s.UNSIGNED_INT_5_9_9_9_REV&&(At=s.RGB9_E5),ce===s.RGBA){let cn=gt?lo:Ai.getTransfer(dt);tt===s.FLOAT&&(At=s.RGBA32F),tt===s.HALF_FLOAT&&(At=s.RGBA16F),tt===s.UNSIGNED_BYTE&&(At=cn===Ii?s.SRGB8_ALPHA8:s.RGBA8),tt===s.UNSIGNED_SHORT_4_4_4_4&&(At=s.RGBA4),tt===s.UNSIGNED_SHORT_5_5_5_1&&(At=s.RGB5_A1)}return(At===s.R16F||At===s.R32F||At===s.RG16F||At===s.RG32F||At===s.RGBA16F||At===s.RGBA32F)&&e.get("EXT_color_buffer_float"),At}function ge(Se,ce){return $(Se)===!0||Se.isFramebufferTexture&&Se.minFilter!==Bt&&Se.minFilter!==pn?Math.log2(Math.max(ce.width,ce.height))+1:Se.mipmaps!==void 0&&Se.mipmaps.length>0?Se.mipmaps.length:Se.isCompressedTexture&&Array.isArray(Se.image)?ce.mipmaps.length:1}function we(Se){let ce=Se.target;ce.removeEventListener("dispose",we),de(ce),ce.isVideoTexture&&T.delete(ce)}function Te(Se){let ce=Se.target;ce.removeEventListener("dispose",Te),Ie(ce)}function de(Se){let ce=n.get(Se);if(ce.__webglInit===void 0)return;let tt=Se.source,dt=D.get(tt);if(dt){let gt=dt[ce.__cacheKey];gt.usedTimes--,gt.usedTimes===0&&le(Se),Object.keys(dt).length===0&&D.delete(tt)}n.remove(Se)}function le(Se){let ce=n.get(Se);s.deleteTexture(ce.__webglTexture);let tt=Se.source,dt=D.get(tt);delete dt[ce.__cacheKey],o.memory.textures--}function Ie(Se){let ce=n.get(Se);if(Se.depthTexture&&Se.depthTexture.dispose(),Se.isWebGLCubeRenderTarget)for(let dt=0;dt<6;dt++){if(Array.isArray(ce.__webglFramebuffer[dt]))for(let gt=0;gt<ce.__webglFramebuffer[dt].length;gt++)s.deleteFramebuffer(ce.__webglFramebuffer[dt][gt]);else s.deleteFramebuffer(ce.__webglFramebuffer[dt]);ce.__webglDepthbuffer&&s.deleteRenderbuffer(ce.__webglDepthbuffer[dt])}else{if(Array.isArray(ce.__webglFramebuffer))for(let dt=0;dt<ce.__webglFramebuffer.length;dt++)s.deleteFramebuffer(ce.__webglFramebuffer[dt]);else s.deleteFramebuffer(ce.__webglFramebuffer);if(ce.__webglDepthbuffer&&s.deleteRenderbuffer(ce.__webglDepthbuffer),ce.__webglMultisampledFramebuffer&&s.deleteFramebuffer(ce.__webglMultisampledFramebuffer),ce.__webglColorRenderbuffer)for(let dt=0;dt<ce.__webglColorRenderbuffer.length;dt++)ce.__webglColorRenderbuffer[dt]&&s.deleteRenderbuffer(ce.__webglColorRenderbuffer[dt]);ce.__webglDepthRenderbuffer&&s.deleteRenderbuffer(ce.__webglDepthRenderbuffer)}let tt=Se.textures;for(let dt=0,gt=tt.length;dt<gt;dt++){let At=n.get(tt[dt]);At.__webglTexture&&(s.deleteTexture(At.__webglTexture),o.memory.textures--),n.remove(tt[dt])}n.remove(Se)}let ke=0;function Fe(){ke=0}function Ge(){let Se=ke;return Se>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Se+" texture units while this GPU supports only "+i.maxTextures),ke+=1,Se}function qe(Se){let ce=[];return ce.push(Se.wrapS),ce.push(Se.wrapT),ce.push(Se.wrapR||0),ce.push(Se.magFilter),ce.push(Se.minFilter),ce.push(Se.anisotropy),ce.push(Se.internalFormat),ce.push(Se.format),ce.push(Se.type),ce.push(Se.generateMipmaps),ce.push(Se.premultiplyAlpha),ce.push(Se.flipY),ce.push(Se.unpackAlignment),ce.push(Se.colorSpace),ce.join()}function ct(Se,ce){let tt=n.get(Se);if(Se.isVideoTexture&&ui(Se),Se.isRenderTargetTexture===!1&&Se.version>0&&tt.__version!==Se.version){let dt=Se.image;if(dt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(dt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else if(sn(tt,Se,ce))return}t.bindTexture(s.TEXTURE_2D,tt.__webglTexture,s.TEXTURE0+ce)}function Pt(Se,ce){let tt=n.get(Se);if(Se.version>0&&tt.__version!==Se.version){sn(tt,Se,ce);return}t.bindTexture(s.TEXTURE_2D_ARRAY,tt.__webglTexture,s.TEXTURE0+ce)}function Ze(Se,ce){let tt=n.get(Se);if(Se.version>0&&tt.__version!==Se.version){sn(tt,Se,ce);return}t.bindTexture(s.TEXTURE_3D,tt.__webglTexture,s.TEXTURE0+ce)}function It(Se,ce){let tt=n.get(Se);if(Se.version>0&&tt.__version!==Se.version){ut(tt,Se,ce);return}t.bindTexture(s.TEXTURE_CUBE_MAP,tt.__webglTexture,s.TEXTURE0+ce)}let Rt={[_e]:s.REPEAT,[De]:s.CLAMP_TO_EDGE,[Ct]:s.MIRRORED_REPEAT},nn={[Bt]:s.NEAREST,[_t]:s.NEAREST_MIPMAP_NEAREST,[Xt]:s.NEAREST_MIPMAP_LINEAR,[pn]:s.LINEAR,[Oi]:s.LINEAR_MIPMAP_NEAREST,[yi]:s.LINEAR_MIPMAP_LINEAR},jn={[el]:s.NEVER,[ol]:s.ALWAYS,[tl]:s.LESS,[va]:s.LEQUAL,[nl]:s.EQUAL,[sl]:s.GEQUAL,[il]:s.GREATER,[rl]:s.NOTEQUAL};function mi(Se,ce){if(ce.type===Ni&&e.has("OES_texture_float_linear")===!1&&(ce.magFilter===pn||ce.magFilter===Oi||ce.magFilter===Xt||ce.magFilter===yi||ce.minFilter===pn||ce.minFilter===Oi||ce.minFilter===Xt||ce.minFilter===yi)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),s.texParameteri(Se,s.TEXTURE_WRAP_S,Rt[ce.wrapS]),s.texParameteri(Se,s.TEXTURE_WRAP_T,Rt[ce.wrapT]),(Se===s.TEXTURE_3D||Se===s.TEXTURE_2D_ARRAY)&&s.texParameteri(Se,s.TEXTURE_WRAP_R,Rt[ce.wrapR]),s.texParameteri(Se,s.TEXTURE_MAG_FILTER,nn[ce.magFilter]),s.texParameteri(Se,s.TEXTURE_MIN_FILTER,nn[ce.minFilter]),ce.compareFunction&&(s.texParameteri(Se,s.TEXTURE_COMPARE_MODE,s.COMPARE_REF_TO_TEXTURE),s.texParameteri(Se,s.TEXTURE_COMPARE_FUNC,jn[ce.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(ce.magFilter===Bt||ce.minFilter!==Xt&&ce.minFilter!==yi||ce.type===Ni&&e.has("OES_texture_float_linear")===!1)return;if(ce.anisotropy>1||n.get(ce).__currentAnisotropy){let tt=e.get("EXT_texture_filter_anisotropic");s.texParameterf(Se,tt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ce.anisotropy,i.getMaxAnisotropy())),n.get(ce).__currentAnisotropy=ce.anisotropy}}}function Di(Se,ce){let tt=!1;Se.__webglInit===void 0&&(Se.__webglInit=!0,ce.addEventListener("dispose",we));let dt=ce.source,gt=D.get(dt);gt===void 0&&(gt={},D.set(dt,gt));let At=qe(ce);if(At!==Se.__cacheKey){gt[At]===void 0&&(gt[At]={texture:s.createTexture(),usedTimes:0},o.memory.textures++,tt=!0),gt[At].usedTimes++;let cn=gt[Se.__cacheKey];cn!==void 0&&(gt[Se.__cacheKey].usedTimes--,cn.usedTimes===0&&le(ce)),Se.__cacheKey=At,Se.__webglTexture=gt[At].texture}return tt}function di(Se){j=Se}function Ti(){let Se=j;j=!1;for(let ce of N)sn(ce.textureProperties,ce.texture,ce.slot),ce.texture.isPendingDeferredUpload=!1;N=[],j=Se}function sn(Se,ce,tt){if(j)return ce.isPendingDeferredUpload||(ce.isPendingDeferredUpload=!0,N.push({textureProperties:Se,texture:ce,slot:tt})),!1;let dt=s.TEXTURE_2D;(ce.isDataArrayTexture||ce.isCompressedArrayTexture)&&(dt=s.TEXTURE_2D_ARRAY),ce.isData3DTexture&&(dt=s.TEXTURE_3D);let gt=Di(Se,ce),At=ce.source;t.bindTexture(dt,Se.__webglTexture,s.TEXTURE0+tt);let cn=n.get(At);if(At.version!==cn.__version||gt===!0){t.activeTexture(s.TEXTURE0+tt);let Ft=Ai.getPrimaries(Ai.workingColorSpace),Jt=ce.colorSpace===br?null:Ai.getPrimaries(ce.colorSpace),bi=ce.colorSpace===br||Ft===Jt?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,ce.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ce.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,ce.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,bi);let Zt=se(ce.image,!1,i.maxTextureSize);Zt=Ki(ce,Zt);let dn=r.convert(ce.format,ce.colorSpace),Vn=r.convert(ce.type),bn=Be(ce.internalFormat,dn,Vn,ce.colorSpace,ce.isVideoTexture);mi(dt,ce);let Le,bt=ce.mipmaps,Lt=ce.isVideoTexture!==!0,hn=cn.__version===void 0||gt===!0,Wt=At.dataReady,Hn=ge(ce,Zt);if(ce.isDepthTexture)bn=s.DEPTH_COMPONENT16,ce.type===Ni?bn=s.DEPTH_COMPONENT32F:ce.type===xr?bn=s.DEPTH_COMPONENT24:ce.type===jr&&(bn=s.DEPTH24_STENCIL8),hn&&(Lt?t.texStorage2D(s.TEXTURE_2D,1,bn,Zt.width,Zt.height):t.texImage2D(s.TEXTURE_2D,0,bn,Zt.width,Zt.height,0,dn,Vn,null));else if(ce.isDataTexture)if(bt.length>0){Lt&&hn&&t.texStorage2D(s.TEXTURE_2D,Hn,bn,bt[0].width,bt[0].height);for(let Kt=0,Ht=bt.length;Kt<Ht;Kt++)Le=bt[Kt],Lt?Wt&&t.texSubImage2D(s.TEXTURE_2D,Kt,0,0,Le.width,Le.height,dn,Vn,Le.data):t.texImage2D(s.TEXTURE_2D,Kt,bn,Le.width,Le.height,0,dn,Vn,Le.data);ce.generateMipmaps=!1}else Lt?(hn&&t.texStorage2D(s.TEXTURE_2D,Hn,bn,Zt.width,Zt.height),Wt&&t.texSubImage2D(s.TEXTURE_2D,0,0,0,Zt.width,Zt.height,dn,Vn,Zt.data)):t.texImage2D(s.TEXTURE_2D,0,bn,Zt.width,Zt.height,0,dn,Vn,Zt.data);else if(ce.isCompressedTexture)if(ce.isCompressedArrayTexture){Lt&&hn&&t.texStorage3D(s.TEXTURE_2D_ARRAY,Hn,bn,bt[0].width,bt[0].height,Zt.depth);for(let Kt=0,Ht=bt.length;Kt<Ht;Kt++)Le=bt[Kt],ce.format!==Me?dn!==null?Lt?Wt&&t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,Kt,0,0,0,Le.width,Le.height,Zt.depth,dn,Le.data,0,0):t.compressedTexImage3D(s.TEXTURE_2D_ARRAY,Kt,bn,Le.width,Le.height,Zt.depth,0,Le.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Lt?Wt&&t.texSubImage3D(s.TEXTURE_2D_ARRAY,Kt,0,0,0,Le.width,Le.height,Zt.depth,dn,Vn,Le.data):t.texImage3D(s.TEXTURE_2D_ARRAY,Kt,bn,Le.width,Le.height,Zt.depth,0,dn,Vn,Le.data)}else{Lt&&hn&&t.texStorage2D(s.TEXTURE_2D,Hn,bn,bt[0].width,bt[0].height);for(let Kt=0,Ht=bt.length;Kt<Ht;Kt++)Le=bt[Kt],ce.format!==Me?dn!==null?Lt?Wt&&t.compressedTexSubImage2D(s.TEXTURE_2D,Kt,0,0,Le.width,Le.height,dn,Le.data):t.compressedTexImage2D(s.TEXTURE_2D,Kt,bn,Le.width,Le.height,0,Le.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Lt?Wt&&t.texSubImage2D(s.TEXTURE_2D,Kt,0,0,Le.width,Le.height,dn,Vn,Le.data):t.texImage2D(s.TEXTURE_2D,Kt,bn,Le.width,Le.height,0,dn,Vn,Le.data)}else if(ce.isDataArrayTexture)Lt?(hn&&t.texStorage3D(s.TEXTURE_2D_ARRAY,Hn,bn,Zt.width,Zt.height,Zt.depth),Wt&&t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,0,Zt.width,Zt.height,Zt.depth,dn,Vn,Zt.data)):t.texImage3D(s.TEXTURE_2D_ARRAY,0,bn,Zt.width,Zt.height,Zt.depth,0,dn,Vn,Zt.data);else if(ce.isData3DTexture)Lt?(hn&&t.texStorage3D(s.TEXTURE_3D,Hn,bn,Zt.width,Zt.height,Zt.depth),Wt&&t.texSubImage3D(s.TEXTURE_3D,0,0,0,0,Zt.width,Zt.height,Zt.depth,dn,Vn,Zt.data)):t.texImage3D(s.TEXTURE_3D,0,bn,Zt.width,Zt.height,Zt.depth,0,dn,Vn,Zt.data);else if(ce.isFramebufferTexture){if(hn)if(Lt)t.texStorage2D(s.TEXTURE_2D,Hn,bn,Zt.width,Zt.height);else{let Kt=Zt.width,Ht=Zt.height;for(let Kn=0;Kn<Hn;Kn++)t.texImage2D(s.TEXTURE_2D,Kn,bn,Kt,Ht,0,dn,Vn,null),Kt>>=1,Ht>>=1}}else if(bt.length>0){if(Lt&&hn){let Kt=Pi(bt[0]);t.texStorage2D(s.TEXTURE_2D,Hn,bn,Kt.width,Kt.height)}for(let Kt=0,Ht=bt.length;Kt<Ht;Kt++)Le=bt[Kt],Lt?Wt&&t.texSubImage2D(s.TEXTURE_2D,Kt,0,0,dn,Vn,Le):t.texImage2D(s.TEXTURE_2D,Kt,bn,dn,Vn,Le);ce.generateMipmaps=!1}else if(Lt){if(hn){let Kt=Pi(Zt);t.texStorage2D(s.TEXTURE_2D,Hn,bn,Kt.width,Kt.height)}Wt&&t.texSubImage2D(s.TEXTURE_2D,0,0,0,dn,Vn,Zt)}else t.texImage2D(s.TEXTURE_2D,0,bn,dn,Vn,Zt);$(ce)&&J(dt),cn.__version=At.version,ce.onUpdate&&ce.onUpdate(ce)}return Se.__version=ce.version,!0}function ut(Se,ce,tt){if(ce.image.length!==6)return;let dt=Di(Se,ce),gt=ce.source;t.bindTexture(s.TEXTURE_CUBE_MAP,Se.__webglTexture,s.TEXTURE0+tt);let At=n.get(gt);if(gt.version!==At.__version||dt===!0){t.activeTexture(s.TEXTURE0+tt);let cn=Ai.getPrimaries(Ai.workingColorSpace),Ft=ce.colorSpace===br?null:Ai.getPrimaries(ce.colorSpace),Jt=ce.colorSpace===br||cn===Ft?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,ce.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ce.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,ce.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,Jt);let bi=ce.isCompressedTexture||ce.image[0].isCompressedTexture,Zt=ce.image[0]&&ce.image[0].isDataTexture,dn=[];for(let Ht=0;Ht<6;Ht++)!bi&&!Zt?dn[Ht]=se(ce.image[Ht],!0,i.maxCubemapSize):dn[Ht]=Zt?ce.image[Ht].image:ce.image[Ht],dn[Ht]=Ki(ce,dn[Ht]);let Vn=dn[0],bn=r.convert(ce.format,ce.colorSpace),Le=r.convert(ce.type),bt=Be(ce.internalFormat,bn,Le,ce.colorSpace),Lt=ce.isVideoTexture!==!0,hn=At.__version===void 0||dt===!0,Wt=gt.dataReady,Hn=ge(ce,Vn);mi(s.TEXTURE_CUBE_MAP,ce);let Kt;if(bi){Lt&&hn&&t.texStorage2D(s.TEXTURE_CUBE_MAP,Hn,bt,Vn.width,Vn.height);for(let Ht=0;Ht<6;Ht++){Kt=dn[Ht].mipmaps;for(let Kn=0;Kn<Kt.length;Kn++){let wn=Kt[Kn];ce.format!==Me?bn!==null?Lt?Wt&&t.compressedTexSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,Kn,0,0,wn.width,wn.height,bn,wn.data):t.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,Kn,bt,wn.width,wn.height,0,wn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Lt?Wt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,Kn,0,0,wn.width,wn.height,bn,Le,wn.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,Kn,bt,wn.width,wn.height,0,bn,Le,wn.data)}}}else{if(Kt=ce.mipmaps,Lt&&hn){Kt.length>0&&Hn++;let Ht=Pi(dn[0]);t.texStorage2D(s.TEXTURE_CUBE_MAP,Hn,bt,Ht.width,Ht.height)}for(let Ht=0;Ht<6;Ht++)if(Zt){Lt?Wt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,0,0,0,dn[Ht].width,dn[Ht].height,bn,Le,dn[Ht].data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,0,bt,dn[Ht].width,dn[Ht].height,0,bn,Le,dn[Ht].data);for(let Kn=0;Kn<Kt.length;Kn++){let pr=Kt[Kn].image[Ht].image;Lt?Wt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,Kn+1,0,0,pr.width,pr.height,bn,Le,pr.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,Kn+1,bt,pr.width,pr.height,0,bn,Le,pr.data)}}else{Lt?Wt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,0,0,0,bn,Le,dn[Ht]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,0,bt,bn,Le,dn[Ht]);for(let Kn=0;Kn<Kt.length;Kn++){let wn=Kt[Kn];Lt?Wt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,Kn+1,0,0,bn,Le,wn.image[Ht]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ht,Kn+1,bt,bn,Le,wn.image[Ht])}}}$(ce)&&J(s.TEXTURE_CUBE_MAP),At.__version=gt.version,ce.onUpdate&&ce.onUpdate(ce)}Se.__version=ce.version}function Ot(Se,ce,tt,dt,gt,At){let cn=r.convert(tt.format,tt.colorSpace),Ft=r.convert(tt.type),Jt=Be(tt.internalFormat,cn,Ft,tt.colorSpace);if(!n.get(ce).__hasExternalTextures){let dn=Math.max(1,ce.width>>At),Vn=Math.max(1,ce.height>>At);ce.isWebGLMultiviewRenderTarget===!0?t.texStorage3D(s.TEXTURE_2D_ARRAY,0,Jt,ce.width,ce.height,ce.numViews):gt===s.TEXTURE_3D||gt===s.TEXTURE_2D_ARRAY?t.texImage3D(gt,At,Jt,dn,Vn,ce.depth,0,cn,Ft,null):t.texImage2D(gt,At,Jt,dn,Vn,0,cn,Ft,null)}t.bindFramebuffer(s.FRAMEBUFFER,Se);let Zt=Pn(ce);ce.isWebGLMultiviewRenderTarget===!0?Zt?E.framebufferTextureMultisampleMultiviewOVR(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,n.get(tt).__webglTexture,0,Tn(ce),0,ce.numViews):E.framebufferTextureMultiviewOVR(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,n.get(tt).__webglTexture,0,0,ce.numViews):(gt===s.TEXTURE_2D||gt>=s.TEXTURE_CUBE_MAP_POSITIVE_X&&gt<=s.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&(Zt?a.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,dt,gt,n.get(tt).__webglTexture,0,Tn(ce)):s.framebufferTexture2D(s.FRAMEBUFFER,dt,gt,n.get(tt).__webglTexture,At)),t.bindFramebuffer(s.FRAMEBUFFER,null)}function Nt(Se,ce,tt){if(s.bindRenderbuffer(s.RENDERBUFFER,Se),ce.isWebGLMultiviewRenderTarget===!0){let dt=Pn(ce),gt=ce.numViews,At=ce.depthTexture,cn=s.DEPTH_COMPONENT24,Ft=s.DEPTH_ATTACHMENT;At&&At.isDepthTexture&&(At.type===Ni?cn=s.DEPTH_COMPONENT32F:At.type===jr&&(cn=s.DEPTH24_STENCIL8,Ft=s.DEPTH_STENCIL_ATTACHMENT));let Jt=n.get(ce.depthTexture).__webglTexture;Jt===void 0&&(Jt=s.createTexture(),s.bindTexture(s.TEXTURE_2D_ARRAY,Jt),s.texStorage3D(s.TEXTURE_2D_ARRAY,1,cn,ce.width,ce.height,gt)),dt?E.framebufferTextureMultisampleMultiviewOVR(s.FRAMEBUFFER,Ft,Jt,0,Tn(ce),0,gt):E.framebufferTextureMultiviewOVR(s.FRAMEBUFFER,Ft,Jt,0,0,gt)}else if(ce.depthBuffer&&!ce.stencilBuffer){let dt=s.DEPTH_COMPONENT24;if(tt||Pn(ce)){let gt=ce.depthTexture;gt&&gt.isDepthTexture&&(gt.type===Ni?dt=s.DEPTH_COMPONENT32F:gt.type===xr&&(dt=s.DEPTH_COMPONENT24));let At=Tn(ce);Pn(ce)?a.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,At,dt,ce.width,ce.height):s.renderbufferStorageMultisample(s.RENDERBUFFER,At,dt,ce.width,ce.height)}else s.renderbufferStorage(s.RENDERBUFFER,dt,ce.width,ce.height);s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,Se)}else if(ce.depthBuffer&&ce.stencilBuffer){let dt=Tn(ce);tt&&Pn(ce)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,dt,s.DEPTH24_STENCIL8,ce.width,ce.height):Pn(ce)?a.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,dt,s.DEPTH24_STENCIL8,ce.width,ce.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,ce.width,ce.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,Se)}else{let dt=ce.textures;for(let gt=0;gt<dt.length;gt++){let At=dt[gt],cn=r.convert(At.format,At.colorSpace),Ft=r.convert(At.type),Jt=Be(At.internalFormat,cn,Ft,At.colorSpace),bi=Tn(ce);tt&&Pn(ce)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,bi,Jt,ce.width,ce.height):Pn(ce)?a.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,bi,Jt,ce.width,ce.height):s.renderbufferStorage(s.RENDERBUFFER,Jt,ce.width,ce.height)}}s.bindRenderbuffer(s.RENDERBUFFER,null)}function Qe(Se,ce){if(ce&&ce.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(s.FRAMEBUFFER,Se),!(ce.depthTexture&&ce.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(ce.depthTexture).__webglTexture||ce.depthTexture.image.width!==ce.width||ce.depthTexture.image.height!==ce.height)&&(ce.depthTexture.image.width=ce.width,ce.depthTexture.image.height=ce.height,ce.depthTexture.needsUpdate=!0),ct(ce.depthTexture,0),ce.depthTexture.image.depth!=1?Pt(ce.depthTexture,0):ct(ce.depthTexture,0);let dt=n.get(ce.depthTexture).__webglTexture,gt=Tn(ce);if(ce.isWebGLMultiviewRenderTarget===!0){let At=Pn(ce),cn=ce.numViews;if(ce.depthTexture.format===We)At?E.framebufferTextureMultisampleMultiviewOVR(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,dt,0,gt,0,cn):E.framebufferTextureMultiviewOVR(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,dt,0,0,cn);else if(ce.depthTexture.format===st)At?E.framebufferTextureMultisampleMultiviewOVR(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,dt,0,gt,0,cn):E.framebufferTextureMultiviewOVR(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,dt,0,0,cn);else throw new Error("Unknown depthTexture format")}else if(ce.depthTexture.format===We)Pn(ce)?a.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,dt,0,gt):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,dt,0);else if(ce.depthTexture.format===st)Pn(ce)?a.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,dt,0,gt):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,dt,0);else throw new Error("Unknown depthTexture format")}function ft(Se){let ce=n.get(Se),tt=Se.isWebGLCubeRenderTarget===!0;if(Se.depthTexture&&!ce.__autoAllocateDepthBuffer){if(tt)throw new Error("target.depthTexture not supported in Cube render targets");Qe(ce.__webglFramebuffer,Se)}else if(tt){ce.__webglDepthbuffer=[];for(let dt=0;dt<6;dt++)t.bindFramebuffer(s.FRAMEBUFFER,ce.__webglFramebuffer[dt]),ce.__webglDepthbuffer[dt]=s.createRenderbuffer(),Nt(ce.__webglDepthbuffer[dt],Se,!1)}else t.bindFramebuffer(s.FRAMEBUFFER,ce.__webglFramebuffer),ce.__webglDepthbuffer=s.createRenderbuffer(),Nt(ce.__webglDepthbuffer,Se,!1);t.bindFramebuffer(s.FRAMEBUFFER,null)}function rt(Se,ce,tt){let dt=n.get(Se);ce!==void 0&&Ot(dt.__webglFramebuffer,Se,Se.texture,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,0),tt!==void 0&&ft(Se)}function St(Se){let ce=Se.texture,tt=n.get(Se),dt=n.get(ce);Se.addEventListener("dispose",Te);let gt=Se.textures,At=Se.isWebGLCubeRenderTarget===!0,cn=gt.length>1;if(cn||(dt.__webglTexture===void 0&&(dt.__webglTexture=s.createTexture()),dt.__version=ce.version,o.memory.textures++),At){tt.__webglFramebuffer=[];for(let Ft=0;Ft<6;Ft++)if(ce.mipmaps&&ce.mipmaps.length>0){tt.__webglFramebuffer[Ft]=[];for(let Jt=0;Jt<ce.mipmaps.length;Jt++)tt.__webglFramebuffer[Ft][Jt]=s.createFramebuffer()}else tt.__webglFramebuffer[Ft]=s.createFramebuffer()}else{if(ce.mipmaps&&ce.mipmaps.length>0){tt.__webglFramebuffer=[];for(let Ft=0;Ft<ce.mipmaps.length;Ft++)tt.__webglFramebuffer[Ft]=s.createFramebuffer()}else tt.__webglFramebuffer=s.createFramebuffer();if(cn)for(let Ft=0,Jt=gt.length;Ft<Jt;Ft++){let bi=n.get(gt[Ft]);bi.__webglTexture===void 0&&(bi.__webglTexture=s.createTexture(),o.memory.textures++)}if(Se.samples>0&&Pn(Se)===!1){tt.__webglMultisampledFramebuffer=s.createFramebuffer(),tt.__webglColorRenderbuffer=[],t.bindFramebuffer(s.FRAMEBUFFER,tt.__webglMultisampledFramebuffer);for(let Ft=0;Ft<gt.length;Ft++){let Jt=gt[Ft];tt.__webglColorRenderbuffer[Ft]=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,tt.__webglColorRenderbuffer[Ft]);let bi=r.convert(Jt.format,Jt.colorSpace),Zt=r.convert(Jt.type),dn=Be(Jt.internalFormat,bi,Zt,Jt.colorSpace,Se.isXRRenderTarget===!0),Vn=Tn(Se);s.renderbufferStorageMultisample(s.RENDERBUFFER,Vn,dn,Se.width,Se.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Ft,s.RENDERBUFFER,tt.__webglColorRenderbuffer[Ft])}s.bindRenderbuffer(s.RENDERBUFFER,null),Se.depthBuffer&&(tt.__webglDepthRenderbuffer=s.createRenderbuffer(),Nt(tt.__webglDepthRenderbuffer,Se,!0)),t.bindFramebuffer(s.FRAMEBUFFER,null)}}if(At){t.bindTexture(s.TEXTURE_CUBE_MAP,dt.__webglTexture),mi(s.TEXTURE_CUBE_MAP,ce);for(let Ft=0;Ft<6;Ft++)if(ce.mipmaps&&ce.mipmaps.length>0)for(let Jt=0;Jt<ce.mipmaps.length;Jt++)Ot(tt.__webglFramebuffer[Ft][Jt],Se,ce,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,Jt);else Ot(tt.__webglFramebuffer[Ft],Se,ce,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+Ft,0);$(ce)&&J(s.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(cn){for(let Ft=0,Jt=gt.length;Ft<Jt;Ft++){let bi=gt[Ft],Zt=n.get(bi);t.bindTexture(s.TEXTURE_2D,Zt.__webglTexture),mi(s.TEXTURE_2D,bi),Ot(tt.__webglFramebuffer,Se,bi,s.COLOR_ATTACHMENT0+Ft,s.TEXTURE_2D,0),$(bi)&&J(s.TEXTURE_2D)}t.unbindTexture()}else{let Ft=s.TEXTURE_2D;if((Se.isWebGL3DRenderTarget||Se.isWebGLArrayRenderTarget)&&(Ft=Se.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY),Se.isWebGLMultiviewRenderTarget===!0&&(Ft=s.TEXTURE_2D_ARRAY),t.bindTexture(Ft,dt.__webglTexture),mi(Ft,ce),ce.mipmaps&&ce.mipmaps.length>0)for(let Jt=0;Jt<ce.mipmaps.length;Jt++)Ot(tt.__webglFramebuffer[Jt],Se,ce,s.COLOR_ATTACHMENT0,Ft,Jt);else Ot(tt.__webglFramebuffer,Se,ce,s.COLOR_ATTACHMENT0,Ft,0);$(ce)&&J(Ft),t.unbindTexture()}(Se.depthBuffer||Se.isWebGLMultiviewRenderTarget===!0)&&this.setupDepthRenderbuffer(Se)}function wt(Se){let ce=Se.textures;for(let tt=0,dt=ce.length;tt<dt;tt++){let gt=ce[tt];if($(gt)){let At=Se.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:s.TEXTURE_2D,cn=n.get(gt).__webglTexture;t.bindTexture(At,cn),J(At),t.unbindTexture()}}}let xt=[],Vt=[];function Yt(Se){if(Se.samples>0){if(Pn(Se)===!1){let ce=Se.textures,tt=Se.width,dt=Se.height,gt=s.COLOR_BUFFER_BIT,At=Se.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,cn=n.get(Se),Ft=ce.length>1;if(Ft)for(let Jt=0;Jt<ce.length;Jt++)t.bindFramebuffer(s.FRAMEBUFFER,cn.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Jt,s.RENDERBUFFER,null),t.bindFramebuffer(s.FRAMEBUFFER,cn.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+Jt,s.TEXTURE_2D,null,0);t.bindFramebuffer(s.READ_FRAMEBUFFER,cn.__webglMultisampledFramebuffer),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,cn.__webglFramebuffer);for(let Jt=0;Jt<ce.length;Jt++){if(Se.resolveDepthBuffer&&(Se.depthBuffer&&(gt|=s.DEPTH_BUFFER_BIT),Se.stencilBuffer&&Se.resolveStencilBuffer&&(gt|=s.STENCIL_BUFFER_BIT)),Ft){s.framebufferRenderbuffer(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,cn.__webglColorRenderbuffer[Jt]);let bi=n.get(ce[Jt]).__webglTexture;s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,bi,0)}s.blitFramebuffer(0,0,tt,dt,0,0,tt,dt,gt,s.NEAREST),d===!0&&(xt.length=0,Vt.length=0,xt.push(s.COLOR_ATTACHMENT0+Jt),Se.depthBuffer&&Se.resolveDepthBuffer===!1&&(xt.push(At),Vt.push(At),s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,Vt)),s.invalidateFramebuffer(s.READ_FRAMEBUFFER,xt))}if(t.bindFramebuffer(s.READ_FRAMEBUFFER,null),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),Ft)for(let Jt=0;Jt<ce.length;Jt++){t.bindFramebuffer(s.FRAMEBUFFER,cn.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Jt,s.RENDERBUFFER,cn.__webglColorRenderbuffer[Jt]);let bi=n.get(ce[Jt]).__webglTexture;t.bindFramebuffer(s.FRAMEBUFFER,cn.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+Jt,s.TEXTURE_2D,bi,0)}t.bindFramebuffer(s.DRAW_FRAMEBUFFER,cn.__webglMultisampledFramebuffer)}else if(Se.depthBuffer&&Se.resolveDepthBuffer===!1&&d){let ce=Se.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT;s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,[ce])}}}function Tn(Se){return Math.min(i.maxSamples,Se.samples)}function Pn(Se){let ce=n.get(Se);return Se.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ce.__useRenderToTexture!==!1}function ui(Se){let ce=o.render.frame;T.get(Se)!==ce&&(T.set(Se,ce),Se.update())}function Ki(Se,ce){let tt=Se.colorSpace,dt=Se.format,gt=Se.type;return Se.isCompressedTexture===!0||Se.isVideoTexture===!0||tt!==ls&&tt!==br&&(Ai.getTransfer(tt)===Ii?(dt!==Me||gt!==Ui)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",tt)),ce}function Pi(Se){return typeof HTMLImageElement!="undefined"&&Se instanceof HTMLImageElement?(w.width=Se.naturalWidth||Se.width,w.height=Se.naturalHeight||Se.height):typeof VideoFrame!="undefined"&&Se instanceof VideoFrame?(w.width=Se.displayWidth,w.height=Se.displayHeight):(w.width=Se.width,w.height=Se.height),w}this.allocateTextureUnit=Ge,this.resetTextureUnits=Fe,this.setTexture2D=ct,this.setTexture2DArray=Pt,this.setTexture3D=Ze,this.setTextureCube=It,this.rebindTextures=rt,this.uploadTexture=sn,this.setupRenderTarget=St,this.updateRenderTargetMipmap=wt,this.updateMultisampleRenderTarget=Yt,this.setupDepthTexture=Qe,this.setupDepthRenderbuffer=ft,this.setupFrameBufferTexture=Ot,this.useMultisampledRTT=Pn,this.runDeferredUploads=Ti,this.setDeferTextureUploads=di}function Vu(s,e){function t(n,i=br){let r,o=Ai.getTransfer(i);if(n===Ui)return s.UNSIGNED_BYTE;if(n===$i)return s.UNSIGNED_SHORT_4_4_4_4;if(n===_s)return s.UNSIGNED_SHORT_5_5_5_1;if(n===Vs)return s.UNSIGNED_INT_5_9_9_9_REV;if(n===es)return s.BYTE;if(n===Zi)return s.SHORT;if(n===Lr)return s.UNSIGNED_SHORT;if(n===ts)return s.INT;if(n===xr)return s.UNSIGNED_INT;if(n===Ni)return s.FLOAT;if(n===Ci)return s.HALF_FLOAT;if(n===ps)return s.ALPHA;if(n===ue)return s.RGB;if(n===Me)return s.RGBA;if(n===Ne)return s.LUMINANCE;if(n===$e)return s.LUMINANCE_ALPHA;if(n===We)return s.DEPTH_COMPONENT;if(n===st)return s.DEPTH_STENCIL;if(n===yt)return s.RED;if(n===$t)return s.RED_INTEGER;if(n===Gt)return s.RG;if(n===ot)return s.RG_INTEGER;if(n===on)return s.RGBA_INTEGER;if(n===An||n===Cn||n===xi||n===Fn)if(o===Ii)if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),r!==null){if(n===An)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Cn)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===xi)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Fn)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(r=e.get("WEBGL_compressed_texture_s3tc"),r!==null){if(n===An)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Cn)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===xi)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Fn)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===In||n===Yn||n===Bi||n===er)if(r=e.get("WEBGL_compressed_texture_pvrtc"),r!==null){if(n===In)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Yn)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Bi)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===er)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===Qt||n===On||n===Hi)if(r=e.get("WEBGL_compressed_texture_etc"),r!==null){if(n===Qt||n===On)return o===Ii?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===Hi)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===$n||n===U||n===Q||n===q||n===ie||n===Ae||n===Pe||n===ze||n===lt||n===at||n===Ve||n===et||n===Et||n===zt)if(r=e.get("WEBGL_compressed_texture_astc"),r!==null){if(n===$n)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===U)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Q)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===q)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===ie)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Ae)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Pe)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===ze)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===lt)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===at)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Ve)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===et)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Et)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===zt)return o===Ii?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===tn||n===mn||n===Ln)if(r=e.get("EXT_texture_compression_bptc"),r!==null){if(n===tn)return o===Ii?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===mn)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Ln)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===_n||n===vn||n===li||n===_i)if(r=e.get("EXT_texture_compression_rgtc"),r!==null){if(n===tn)return r.COMPRESSED_RED_RGTC1_EXT;if(n===vn)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===li)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===_i)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===jr?s.UNSIGNED_INT_24_8:s[n]!==void 0?s[n]:null}return{convert:t}}class xo extends hi{constructor(){super();this.isGroup=!0,this.type="Group"}}class Kh extends dr{constructor(e=[]){super();this.isArrayCamera=!0,this.cameras=e}}var Hu=new ve,zu=new ve;function iv(s,e,t){Hu.setFromMatrixPosition(e.matrixWorld),zu.setFromMatrixPosition(t.matrixWorld);var n=Hu.distanceTo(zu),i=e.projectionMatrix.elements,r=t.projectionMatrix.elements,o=i[14]/(i[10]-1),a=i[14]/(i[10]+1),d=(i[9]+1)/i[5],E=(i[9]-1)/i[5],w=(i[8]-1)/i[0],T=(r[8]+1)/r[0],B=o*w,D=o*T,N=n/(-w+T),j=N*-w;e.matrixWorld.decompose(s.position,s.quaternion,s.scale),s.translateX(j),s.translateZ(N),s.matrixWorld.compose(s.position,s.quaternion,s.scale),s.matrixWorldInverse.copy(s.matrixWorld).invert();var G=o+N,P=a+N,se=B-j,$=D+(n-j),J=d*a/P*G,Be=E*a/P*G;s.projectionMatrix.makePerspective(se,$,J,Be,G,P)}function ju(s){var e,t,n=this,i=null,r=null,o=null,a=[],d=new rn,E=new rn,w=1,T="local-floor";typeof window!="undefined"&&"VRFrameData"in window&&(r=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",J,!1));var B=new rn,D=new ci,N=new ve,j=new dr;j.viewport=new oi,j.layers.enable(1);var G=new dr;G.viewport=new oi,G.layers.enable(2);var P=new Kh([j,G]);P.layers.enable(1),P.layers.enable(2);var se=new ht,$;function J(){var Ie=n.isPresenting=i!==null&&i.isPresenting===!0;if(Ie){var ke=i.getEyeParameters("left");e=2*ke.renderWidth*w,t=ke.renderHeight*w,$=s.getPixelRatio(),s.getSize(se),s.setDrawingBufferSize(e,t,1),j.viewport.set(0,0,e/2,t),G.viewport.set(e/2,0,e/2,t),le.start(),n.dispatchEvent({type:"sessionstart"})}else n.enabled&&s.setDrawingBufferSize(se.width,se.height,$),le.stop(),n.dispatchEvent({type:"sessionend"})}var Be=[],ge=[];function we(Ie){for(var ke=navigator.getGamepads&&navigator.getGamepads(),Fe=0,Ge=ke.length;Fe<Ge;Fe++){var qe=ke[Fe];if(qe&&(qe.id==="Daydream Controller"||qe.id==="Gear VR Controller"||qe.id==="Oculus Go Controller"||qe.id==="OpenVR Gamepad"||qe.id.startsWith("Oculus Touch")||qe.id.startsWith("HTC Vive Focus")||qe.id.startsWith("Spatial Controller"))){var ct=qe.hand;if(Ie===0&&(ct===""||ct==="right")||Ie===1&&ct==="left")return qe}}}function Te(){for(var Ie=0;Ie<a.length;Ie++){var ke=a[Ie],Fe=we(Ie);if(Fe!==void 0&&Fe.pose!==void 0){if(Fe.pose===null)return;var Ge=Fe.pose;Ge.hasPosition===!1&&ke.position.set(.2,-.6,-.05),Ge.position!==null&&ke.position.fromArray(Ge.position),Ge.orientation!==null&&ke.quaternion.fromArray(Ge.orientation),ke.matrix.compose(ke.position,ke.quaternion,ke.scale),ke.matrix.premultiply(d),ke.matrix.decompose(ke.position,ke.quaternion,ke.scale),ke.matrixWorldNeedsUpdate=!0,ke.visible=!0;var qe=Fe.id==="Daydream Controller"?0:1;Be[Ie]===void 0&&(Be[Ie]=!1),Be[Ie]!==Fe.buttons[qe].pressed&&(Be[Ie]=Fe.buttons[qe].pressed,Be[Ie]===!0?ke.dispatchEvent({type:"selectstart"}):(ke.dispatchEvent({type:"selectend"}),ke.dispatchEvent({type:"select"}))),qe=2,ge[Ie]===void 0&&(ge[Ie]=!1),Fe.buttons[qe]!==void 0&&ge[Ie]!==Fe.buttons[qe].pressed&&(ge[Ie]=Fe.buttons[qe].pressed,ge[Ie]===!0?ke.dispatchEvent({type:"squeezestart"}):(ke.dispatchEvent({type:"squeezeend"}),ke.dispatchEvent({type:"squeeze"})))}else ke.visible=!1}}function de(Ie,ke){ke!==null&&ke.length===4&&Ie.set(ke[0]*e,ke[1]*t,ke[2]*e,ke[3]*t)}this.enabled=!1,this.getController=function(Ie){var ke=a[Ie];return ke===void 0&&(ke=new xo,ke.matrixAutoUpdate=!1,ke.visible=!1,a[Ie]=ke),ke},this.getDevice=function(){return i},this.setDevice=function(Ie){Ie!==void 0&&(i=Ie),le.setContext(Ie)},this.setFramebufferScaleFactor=function(Ie){w=Ie},this.setReferenceSpaceType=function(Ie){T=Ie},this.setPoseTarget=function(Ie){Ie!==void 0&&(o=Ie)},this.cameraAutoUpdate=!0,this.updateCamera=function(Ie){var ke=T==="local-floor"?1.6:0;if(i.depthNear=Ie.near,i.depthFar=Ie.far,i.getFrameData(r),T==="local-floor"){var Fe=i.stageParameters;Fe?d.fromArray(Fe.sittingToStandingTransform):d.makeTranslation(0,ke,0)}var Ge=r.pose,qe=o!==null?o:Ie;qe.matrix.copy(d),qe.matrix.decompose(qe.position,qe.quaternion,qe.scale),Ge.orientation!==null&&(D.fromArray(Ge.orientation),qe.quaternion.multiply(D)),Ge.position!==null&&(D.setFromRotationMatrix(d),N.fromArray(Ge.position),N.applyQuaternion(D),qe.position.add(N)),qe.updateMatrixWorld();for(var ct=qe.children,Pt=0,Ze=ct.length;Pt<Ze;Pt++)ct[Pt].updateMatrixWorld(!0);j.near=Ie.near,G.near=Ie.near,j.far=Ie.far,G.far=Ie.far,j.matrixWorldInverse.fromArray(r.leftViewMatrix),G.matrixWorldInverse.fromArray(r.rightViewMatrix),E.copy(d).invert(),T==="local-floor"&&(j.matrixWorldInverse.multiply(E),G.matrixWorldInverse.multiply(E));var It=qe.parent;It!==null&&(B.copy(It.matrixWorld).invert(),j.matrixWorldInverse.multiply(B),G.matrixWorldInverse.multiply(B)),j.matrixWorld.copy(j.matrixWorldInverse).invert(),G.matrixWorld.copy(G.matrixWorldInverse).invert(),j.projectionMatrix.fromArray(r.leftProjectionMatrix),G.projectionMatrix.fromArray(r.rightProjectionMatrix),iv(P,j,G);var Rt=i.getLayers();if(Rt.length){var nn=Rt[0];de(j.viewport,nn.leftBounds),de(G.viewport,nn.rightBounds)}return Te(),P},this.getCamera=function(){return P},this.getFoveation=function(){return 1},this.setFoveation=function(Ie){Ie!==1&&console.warn("THREE.WebVRManager: setFoveation() not used in WebVR.")},this.getEnvironmentBlendMode=function(){if(n.isPresenting)return"opaque"},this.getStandingMatrix=function(){return d},this.isPresenting=!1;var le=new Ph;this.setAnimationLoop=function(Ie){le.setAnimationLoop(Ie),this.isPresenting&&le.start()},this.submitFrame=function(){this.isPresenting&&i.submitFrame()},this.dispose=function(){typeof window!="undefined"&&window.removeEventListener("vrdisplaypresentchange",J)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}Object.assign(ju.prototype,{addEventListener:Dr.prototype.addEventListener,hasEventListener:Dr.prototype.hasEventListener,removeEventListener:Dr.prototype.removeEventListener,dispatchEvent:Dr.prototype.dispatchEvent});class Wu extends Gr{constructor(e,t,n,i={}){super(e,t,i);this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=n}copy(e){return super.copy(e),this.numViews=e.numViews,this}}Wu.prototype.isWebGLMultiviewRenderTarget=!0;let rv={type:"move"};class Xh{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new xo,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new xo,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ve,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ve),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new xo,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ve,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ve),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let i=null,r=null,o=null,a=this._targetRay,d=this._grip,E=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(E&&e.hand){o=!0;for(let j of e.hand.values()){let G=t.getJointPose(j,n),P=this._getHandJoint(E,j);G!==null&&(P.matrix.fromArray(G.transform.matrix),P.matrix.decompose(P.position,P.rotation,P.scale),P.matrixWorldNeedsUpdate=!0,P.jointRadius=G.radius),P.visible=G!==null}let w=E.joints["index-finger-tip"],T=E.joints["thumb-tip"],B=w.position.distanceTo(T.position),D=.02,N=.005;E.inputState.pinching&&B>D+N?(E.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!E.inputState.pinching&&B<=D-N&&(E.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else d!==null&&e.gripSpace&&(r=t.getPose(e.gripSpace,n),r!==null&&(d.matrix.fromArray(r.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,r.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(r.linearVelocity)):d.hasLinearVelocity=!1,r.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(r.angularVelocity)):d.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,n),i===null&&r!==null&&(i=r),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(rv)))}return a!==null&&(a.visible=i!==null),d!==null&&(d.visible=r!==null),E!==null&&(E.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let n=new xo;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}let sv=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,ov=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class av{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){let i=new Li,r=e.properties.get(i);r.__webglTexture=t.texture,(t.depthNear!=n.depthNear||t.depthFar!=n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}render(e,t){if(this.texture!==null){if(this.mesh===null){let n=t.cameras[0].viewport,i=new hs({vertexShader:sv,fragmentShader:ov,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new ar(new ia(20,20),i)}e.render(this.mesh,t)}}reset(){this.texture=null,this.mesh=null}}class lv extends Dr{constructor(e,t,n,i){super();let r=this,o=null,a=1;var d=null;let E=null,w="local-floor",T=1,B=null,D=null;var N=[];let j=null,G=null,P=null,se=null,$=new av,J=t.getContextAttributes(),Be=null,ge=null,we=[],Te=[],de=new ht,le=null,Ie=new dr;Ie.layers.enable(1),Ie.viewport=new oi;let ke=new dr;ke.layers.enable(2),ke.viewport=new oi;let Fe=[Ie,ke],Ge=new Kh;Ge.layers.enable(1),Ge.layers.enable(2);let qe=null,ct=null;this.cameraAutoUpdate=!0,this.layersEnabled=!1,this.enabled=!1,this.isPresenting=!1,this.isMultiview=!1,this.getCameraPose=function(){return D},this.getController=function(ut){let Ot=we[ut];return Ot===void 0&&(Ot=new Xh,we[ut]=Ot),Ot.getTargetRaySpace()},this.getControllerGrip=function(ut){let Ot=we[ut];return Ot===void 0&&(Ot=new Xh,we[ut]=Ot),Ot.getGripSpace()},this.getHand=function(ut){let Ot=we[ut];return Ot===void 0&&(Ot=new Xh,we[ut]=Ot),Ot.getHandSpace()};function Pt(ut){let Ot=Te.indexOf(ut.inputSource);if(Ot===-1)return;let Nt=we[Ot];Nt!==void 0&&(Nt.update(ut.inputSource,ut.frame,B||E),Nt.dispatchEvent({type:ut.type,data:ut.inputSource}))}function Ze(){o.removeEventListener("select",Pt),o.removeEventListener("selectstart",Pt),o.removeEventListener("selectend",Pt),o.removeEventListener("squeeze",Pt),o.removeEventListener("squeezestart",Pt),o.removeEventListener("squeezeend",Pt),o.removeEventListener("end",Ze),o.removeEventListener("inputsourceschange",It);for(let ut=0;ut<we.length;ut++){let Ot=Te[ut];Ot!==null&&(Te[ut]=null,we[ut].disconnect(Ot))}qe=null,ct=null,$.reset(),e.setRenderTarget(Be),P=null,G=null,j=null,o=null,ge=null,sn.stop(),r.isPresenting=!1,e.setPixelRatio(le),e.setSize(de.width,de.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ut){a=ut,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ut){w=ut,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return B||E},this.setReferenceSpace=function(ut){B=ut},this.getBaseLayer=function(){return G!==null?G:P},this.getBinding=function(){return j},this.getFrame=function(){return se},this.getSession=function(){return o},this.setSession=async function(ut){if(o=ut,o!==null){if(Be=e.getRenderTarget(),o.addEventListener("select",Pt),o.addEventListener("selectstart",Pt),o.addEventListener("selectend",Pt),o.addEventListener("squeeze",Pt),o.addEventListener("squeezestart",Pt),o.addEventListener("squeezeend",Pt),o.addEventListener("end",Ze),o.addEventListener("inputsourceschange",It),J.xrCompatible!==!0&&await t.makeXRCompatible(),le=e.getPixelRatio(),e.getSize(de),o.renderState.layers===void 0){let Ot={antialias:J.antialias,alpha:!0,depth:J.depth,stencil:J.stencil,framebufferScaleFactor:a};P=new XRWebGLLayer(o,t,Ot),o.updateRenderState({baseLayer:P}),e.setPixelRatio(1),e.setSize(P.framebufferWidth,P.framebufferHeight,!1),ge=new Gr(P.framebufferWidth,P.framebufferHeight,{format:Me,type:Ui,colorSpace:e.outputColorSpace,stencilBuffer:J.stencil})}else{let Ot=null,Nt=null,Qe=null;J.depth&&(Qe=J.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ot=J.stencil?st:We,Nt=J.stencil?jr:xr),r.isMultiview=i&&n.has("OCULUS_multiview");let ft={colorFormat:t.RGBA8,depthFormat:Qe,scaleFactor:a};r.isMultiview&&(ft.textureType="texture-array"),j=new XRWebGLBinding(o,t),G=j.createProjectionLayer(ft),o.updateRenderState({layers:[G]}),e.setPixelRatio(1),e.setSize(G.textureWidth,G.textureHeight,!1);let rt={format:Me,type:Ui,depthTexture:new Vh(G.textureWidth,G.textureHeight,Nt,void 0,void 0,void 0,void 0,void 0,void 0,Ot),stencilBuffer:J.stencil,colorSpace:e.outputColorSpace,samples:J.antialias?4:0,resolveDepthBuffer:G.ignoreDepthValues===!1};if(r.isMultiview){let St=n.get("OCULUS_multiview");this.maxNumViews=t.getParameter(St.MAX_VIEWS_OVR),ge=new Wu(G.textureWidth,G.textureHeight,2,rt)}else ge=new Gr(G.textureWidth,G.textureHeight,rt)}ge.isXRRenderTarget=!0,this.setFoveation(T),B=null,E=await o.requestReferenceSpace(w),sn.setContext(o),sn.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(o!==null)return o.environmentBlendMode},this.addLayer=function(ut){!window.XRWebGLBinding||!this.layersEnabled||!o||(N.push(ut),this.updateLayers())},this.removeLayer=function(ut){N.splice(N.indexOf(ut),1),!(!window.XRWebGLBinding||!this.layersEnabled||!o)&&this.updateLayers()},this.updateLayers=function(){var ut=N.map(function(Ot){return Ot});ut.unshift(o.renderState.layers[0]),o.updateRenderState({layers:ut})};function It(ut){for(let Ot=0;Ot<ut.removed.length;Ot++){let Nt=ut.removed[Ot],Qe=Te.indexOf(Nt);Qe>=0&&(Te[Qe]=null,we[Qe].disconnect(Nt))}for(let Ot=0;Ot<ut.added.length;Ot++){let Nt=ut.added[Ot],Qe=Te.indexOf(Nt);if(Qe===-1){for(let rt=0;rt<we.length;rt++)if(rt>=Te.length){Te.push(Nt),Qe=rt;break}else if(Te[rt]===null){Te[rt]=Nt,Qe=rt;break}if(Qe===-1)break}let ft=we[Qe];ft&&ft.connect(Nt)}}let Rt=new ve,nn=new ve;function jn(ut,Ot,Nt){Rt.setFromMatrixPosition(Ot.matrixWorld),nn.setFromMatrixPosition(Nt.matrixWorld);let Qe=Rt.distanceTo(nn),ft=Ot.projectionMatrix.elements,rt=Nt.projectionMatrix.elements,St=ft[14]/(ft[10]-1),wt=ft[14]/(ft[10]+1),xt=(ft[9]+1)/ft[5],Vt=(ft[9]-1)/ft[5],Yt=(ft[8]-1)/ft[0],Tn=(rt[8]+1)/rt[0],Pn=St*Yt,ui=St*Tn,Ki=Qe/(-Yt+Tn),Pi=Ki*-Yt;Ot.matrixWorld.decompose(ut.position,ut.quaternion,ut.scale),ut.translateX(Pi),ut.translateZ(Ki),ut.matrixWorld.compose(ut.position,ut.quaternion,ut.scale),ut.matrixWorldInverse.copy(ut.matrixWorld).invert();let Se=St+Ki,ce=wt+Ki,tt=Pn-Pi,dt=ui+(Qe-Pi),gt=xt*wt/ce*Se,At=Vt*wt/ce*Se;ut.projectionMatrix.makePerspective(tt,dt,gt,At,Se,ce),ut.projectionMatrixInverse.copy(ut.projectionMatrix).invert()}function mi(ut,Ot){Ot===null?ut.matrixWorld.copy(ut.matrix):ut.matrixWorld.multiplyMatrices(Ot.matrixWorld,ut.matrix),ut.matrixWorldInverse.copy(ut.matrixWorld).invert()}this.setPoseTarget=function(ut){ut!==void 0&&(d=ut)},this.updateCamera=function(ut){if(o===null)return;$.texture!==null&&(ut.near=$.depthNear,ut.far=$.depthFar),Ge.near=ke.near=Ie.near=ut.near,Ge.far=ke.far=Ie.far=ut.far,(qe!==Ge.near||ct!==Ge.far)&&(o.updateRenderState({depthNear:Ge.near,depthFar:Ge.far}),qe=Ge.near,ct=Ge.far,Ie.near=qe,Ie.far=ct,ke.near=qe,ke.far=ct,Ie.updateProjectionMatrix(),ke.updateProjectionMatrix(),ut.updateProjectionMatrix());let Ot=Ge.cameras;var Nt=d||ut;let Qe=Nt.parent;mi(Ge,Qe);for(let ft=0;ft<Ot.length;ft++)mi(Ot[ft],Qe);Ot.length===2?jn(Ge,Ie,ke):Ge.projectionMatrix.copy(Ie.projectionMatrix),Di(ut,Ge,Nt)};function Di(ut,Ot,Nt){Ot.matrixWorld.decompose(Ot.position,Ot.quaternion,Ot.scale),Nt.parent===null?Nt.matrix.copy(Ot.matrixWorld):(Nt.matrix.copy(Nt.parent.matrixWorld),Nt.matrix.invert(),Nt.matrix.multiply(Ot.matrixWorld)),Nt.matrix.decompose(Nt.position,Nt.quaternion,Nt.scale),Nt.updateMatrixWorld(!0),ut.projectionMatrix.copy(Ot.projectionMatrix),ut.projectionMatrixInverse.copy(Ot.projectionMatrixInverse),ut.isPerspectiveCamera&&(ut.fov=Hs*2*Math.atan(1/ut.projectionMatrix.elements[5]),ut.zoom=1)}this.getCamera=function(){return Ge},this.getFoveation=function(){if(!(G===null&&P===null))return T},this.setFoveation=function(ut){T=ut,G!==null&&(G.fixedFoveation=ut),P!==null&&P.fixedFoveation!==void 0&&(P.fixedFoveation=ut)},this.hasDepthSensing=function(){return $.texture!==null};let di=null;function Ti(ut,Ot){if(D=Ot.getViewerPose(B||E),se=Ot,D!==null){let Nt=D.views;P!==null&&(e.setRenderTargetFramebuffer(ge,P.framebuffer),e.setRenderTarget(ge));let Qe=!1;Nt.length!==Ge.cameras.length&&(Ge.cameras.length=0,Qe=!0);for(let rt=0;rt<Nt.length;rt++){let St=Nt[rt],wt=null;if(P!==null)wt=P.getViewport(St);else{let Vt=j.getViewSubImage(G,St);wt=Vt.viewport,rt===0&&(e.setRenderTargetTextures(ge,Vt.colorTexture,G.ignoreDepthValues?void 0:Vt.depthStencilTexture),e.setRenderTarget(ge))}let xt=Fe[rt];xt===void 0&&(xt=new dr,xt.layers.enable(rt),xt.viewport=new oi,Fe[rt]=xt),xt.matrix.fromArray(St.transform.matrix),xt.matrix.decompose(xt.position,xt.quaternion,xt.scale),xt.projectionMatrix.fromArray(St.projectionMatrix),xt.projectionMatrixInverse.copy(xt.projectionMatrix).invert(),xt.viewport.set(wt.x,wt.y,wt.width,wt.height),rt===0&&(Ge.matrix.copy(xt.matrix),Ge.matrix.decompose(Ge.position,Ge.quaternion,Ge.scale)),Qe===!0&&Ge.cameras.push(xt)}let ft=o.enabledFeatures;if(ft&&ft.includes("depth-sensing")){let rt=j.getDepthInformation(Nt[0]);rt&&rt.isValid&&rt.texture&&$.init(e,rt,o.renderState)}}for(let Nt=0;Nt<we.length;Nt++){let Qe=Te[Nt],ft=we[Nt];Qe!==null&&ft!==void 0&&ft.update(Qe,Ot,B||E)}$.render(e,Ge),di&&di(ut,Ot),Ot.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:Ot}),se=null}let sn=new Ph;sn.setAnimationLoop(Ti),this.setAnimationLoop=function(ut){di=ut},this.dispose=function(){}}}let bo=new qr,cv=new rn;function hv(s,e){function t(G,P){G.matrixAutoUpdate===!0&&G.updateMatrix(),P.value.copy(G.matrix)}function n(G,P){P.color.getRGB(G.fogColor.value,hu(s)),P.isFog?(G.fogNear.value=P.near,G.fogFar.value=P.far):P.isFogExp2&&(G.fogDensity.value=P.density)}function i(G,P,se,$,J){P.isMeshBasicMaterial||P.isMeshLambertMaterial?r(G,P):P.isMeshToonMaterial?(r(G,P),T(G,P)):P.isMeshPhongMaterial?(r(G,P),w(G,P)):P.isMeshStandardMaterial?(r(G,P),B(G,P),P.isMeshPhysicalMaterial&&D(G,P,J)):P.isMeshMatcapMaterial?(r(G,P),N(G,P)):P.isMeshDepthMaterial?r(G,P):P.isMeshDistanceMaterial?(r(G,P),j(G,P)):P.isMeshNormalMaterial?r(G,P):P.isLineBasicMaterial?(o(G,P),P.isLineDashedMaterial&&a(G,P)):P.isPointsMaterial?d(G,P,se,$):P.isSpriteMaterial?E(G,P):P.isShadowMaterial?(G.color.value.copy(P.color),G.opacity.value=P.opacity):P.isShaderMaterial&&(P.uniformsNeedUpdate=!1)}function r(G,P){G.opacity.value=P.opacity,P.color&&G.diffuse.value.copy(P.color),P.emissive&&G.emissive.value.copy(P.emissive).multiplyScalar(P.emissiveIntensity),P.map&&(G.map.value=P.map,t(P.map,G.mapTransform)),P.alphaMap&&(G.alphaMap.value=P.alphaMap,t(P.alphaMap,G.alphaMapTransform)),P.bumpMap&&(G.bumpMap.value=P.bumpMap,t(P.bumpMap,G.bumpMapTransform),G.bumpScale.value=P.bumpScale,P.side===x&&(G.bumpScale.value*=-1)),P.normalMap&&(G.normalMap.value=P.normalMap,t(P.normalMap,G.normalMapTransform),G.normalScale.value.copy(P.normalScale),P.side===x&&G.normalScale.value.negate()),P.displacementMap&&(G.displacementMap.value=P.displacementMap,t(P.displacementMap,G.displacementMapTransform),G.displacementScale.value=P.displacementScale,G.displacementBias.value=P.displacementBias),P.emissiveMap&&(G.emissiveMap.value=P.emissiveMap,t(P.emissiveMap,G.emissiveMapTransform)),P.specularMap&&(G.specularMap.value=P.specularMap,t(P.specularMap,G.specularMapTransform)),P.alphaTest>0&&(G.alphaTest.value=P.alphaTest);let se=e.get(P),$=se.envMap,J=se.envMapRotation;if($&&(G.envMap.value=$,bo.copy(J),bo.x*=-1,bo.y*=-1,bo.z*=-1,$.isCubeTexture&&$.isRenderTargetTexture===!1&&(bo.y*=-1,bo.z*=-1),G.envMapRotation.value.setFromMatrix4(cv.makeRotationFromEuler(bo)),G.flipEnvMap.value=$.isCubeTexture&&$.isRenderTargetTexture===!1?-1:1,G.reflectivity.value=P.reflectivity,G.ior.value=P.ior,G.refractionRatio.value=P.refractionRatio),P.lightMap){G.lightMap.value=P.lightMap;let Be=s._useLegacyLights===!0?Math.PI:1;G.lightMapIntensity.value=P.lightMapIntensity*Be,t(P.lightMap,G.lightMapTransform)}P.aoMap&&(G.aoMap.value=P.aoMap,G.aoMapIntensity.value=P.aoMapIntensity,t(P.aoMap,G.aoMapTransform))}function o(G,P){G.diffuse.value.copy(P.color),G.opacity.value=P.opacity,P.map&&(G.map.value=P.map,t(P.map,G.mapTransform))}function a(G,P){G.dashSize.value=P.dashSize,G.totalSize.value=P.dashSize+P.gapSize,G.scale.value=P.scale}function d(G,P,se,$){G.diffuse.value.copy(P.color),G.opacity.value=P.opacity,G.size.value=P.size*se,G.scale.value=$*.5,P.map&&(G.map.value=P.map,t(P.map,G.uvTransform)),P.alphaMap&&(G.alphaMap.value=P.alphaMap,t(P.alphaMap,G.alphaMapTransform)),P.alphaTest>0&&(G.alphaTest.value=P.alphaTest)}function E(G,P){G.diffuse.value.copy(P.color),G.opacity.value=P.opacity,G.rotation.value=P.rotation,P.map&&(G.map.value=P.map,t(P.map,G.mapTransform)),P.alphaMap&&(G.alphaMap.value=P.alphaMap,t(P.alphaMap,G.alphaMapTransform)),P.alphaTest>0&&(G.alphaTest.value=P.alphaTest)}function w(G,P){G.specular.value.copy(P.specular),G.shininess.value=Math.max(P.shininess,1e-4)}function T(G,P){P.gradientMap&&(G.gradientMap.value=P.gradientMap)}function B(G,P){G.metalness.value=P.metalness,P.metalnessMap&&(G.metalnessMap.value=P.metalnessMap,t(P.metalnessMap,G.metalnessMapTransform)),G.roughness.value=P.roughness,P.roughnessMap&&(G.roughnessMap.value=P.roughnessMap,t(P.roughnessMap,G.roughnessMapTransform)),P.envMap&&(G.envMapIntensity.value=P.envMapIntensity)}function D(G,P,se){G.ior.value=P.ior,P.sheen>0&&(G.sheenColor.value.copy(P.sheenColor).multiplyScalar(P.sheen),G.sheenRoughness.value=P.sheenRoughness,P.sheenColorMap&&(G.sheenColorMap.value=P.sheenColorMap,t(P.sheenColorMap,G.sheenColorMapTransform)),P.sheenRoughnessMap&&(G.sheenRoughnessMap.value=P.sheenRoughnessMap,t(P.sheenRoughnessMap,G.sheenRoughnessMapTransform))),P.clearcoat>0&&(G.clearcoat.value=P.clearcoat,G.clearcoatRoughness.value=P.clearcoatRoughness,P.clearcoatMap&&(G.clearcoatMap.value=P.clearcoatMap,t(P.clearcoatMap,G.clearcoatMapTransform)),P.clearcoatRoughnessMap&&(G.clearcoatRoughnessMap.value=P.clearcoatRoughnessMap,t(P.clearcoatRoughnessMap,G.clearcoatRoughnessMapTransform)),P.clearcoatNormalMap&&(G.clearcoatNormalMap.value=P.clearcoatNormalMap,t(P.clearcoatNormalMap,G.clearcoatNormalMapTransform),G.clearcoatNormalScale.value.copy(P.clearcoatNormalScale),P.side===x&&G.clearcoatNormalScale.value.negate())),P.dispersion>0&&(G.dispersion.value=P.dispersion),P.iridescence>0&&(G.iridescence.value=P.iridescence,G.iridescenceIOR.value=P.iridescenceIOR,G.iridescenceThicknessMinimum.value=P.iridescenceThicknessRange[0],G.iridescenceThicknessMaximum.value=P.iridescenceThicknessRange[1],P.iridescenceMap&&(G.iridescenceMap.value=P.iridescenceMap,t(P.iridescenceMap,G.iridescenceMapTransform)),P.iridescenceThicknessMap&&(G.iridescenceThicknessMap.value=P.iridescenceThicknessMap,t(P.iridescenceThicknessMap,G.iridescenceThicknessMapTransform))),P.transmission>0&&(G.transmission.value=P.transmission,G.transmissionSamplerMap.value=se.texture,G.transmissionSamplerSize.value.set(se.width,se.height),P.transmissionMap&&(G.transmissionMap.value=P.transmissionMap,t(P.transmissionMap,G.transmissionMapTransform)),G.thickness.value=P.thickness,P.thicknessMap&&(G.thicknessMap.value=P.thicknessMap,t(P.thicknessMap,G.thicknessMapTransform)),G.attenuationDistance.value=P.attenuationDistance,G.attenuationColor.value.copy(P.attenuationColor)),P.anisotropy>0&&(G.anisotropyVector.value.set(P.anisotropy*Math.cos(P.anisotropyRotation),P.anisotropy*Math.sin(P.anisotropyRotation)),P.anisotropyMap&&(G.anisotropyMap.value=P.anisotropyMap,t(P.anisotropyMap,G.anisotropyMapTransform))),G.specularIntensity.value=P.specularIntensity,G.specularColor.value.copy(P.specularColor),P.specularColorMap&&(G.specularColorMap.value=P.specularColorMap,t(P.specularColorMap,G.specularColorMapTransform)),P.specularIntensityMap&&(G.specularIntensityMap.value=P.specularIntensityMap,t(P.specularIntensityMap,G.specularIntensityMapTransform))}function N(G,P){P.matcap&&(G.matcap.value=P.matcap)}function j(G,P){let se=e.get(P).light;G.referencePosition.value.setFromMatrixPosition(se.matrixWorld),G.nearDistance.value=se.shadow.camera.near,G.farDistance.value=se.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:i}}function dv(s,e,t,n){let i={},r={},o=[],a=s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS);function d(se,$){let J=$.program;n.uniformBlockBinding(se,J)}function E(se,$){let J=i[se.id];J===void 0&&(N(se),J=w(se),i[se.id]=J,se.addEventListener("dispose",G));let Be=$.program;n.updateUBOMapping(se,Be);let ge=e.render.frame;r[se.id]!==ge&&(B(se),r[se.id]=ge)}function w(se){let $=T();se.__bindingPointIndex=$;let J=s.createBuffer(),Be=se.__size,ge=se.usage;return s.bindBuffer(s.UNIFORM_BUFFER,J),s.bufferData(s.UNIFORM_BUFFER,Be,ge),s.bindBuffer(s.UNIFORM_BUFFER,null),s.bindBufferBase(s.UNIFORM_BUFFER,$,J),J}function T(){for(let se=0;se<a;se++)if(o.indexOf(se)===-1)return o.push(se),se;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function B(se){let $=i[se.id],J=se.uniforms,Be=se.__cache;s.bindBuffer(s.UNIFORM_BUFFER,$);for(let ge=0,we=J.length;ge<we;ge++){let Te=Array.isArray(J[ge])?J[ge]:[J[ge]];for(let de=0,le=Te.length;de<le;de++){let Ie=Te[de];if(D(Ie,ge,de,Be)===!0){let ke=Ie.__offset,Fe=Array.isArray(Ie.value)?Ie.value:[Ie.value],Ge=0;for(let qe=0;qe<Fe.length;qe++){let ct=Fe[qe],Pt=j(ct);typeof ct=="number"||typeof ct=="boolean"?(Ie.__data[0]=ct,s.bufferSubData(s.UNIFORM_BUFFER,ke+Ge,Ie.__data)):ct.isMatrix3?(Ie.__data[0]=ct.elements[0],Ie.__data[1]=ct.elements[1],Ie.__data[2]=ct.elements[2],Ie.__data[3]=0,Ie.__data[4]=ct.elements[3],Ie.__data[5]=ct.elements[4],Ie.__data[6]=ct.elements[5],Ie.__data[7]=0,Ie.__data[8]=ct.elements[6],Ie.__data[9]=ct.elements[7],Ie.__data[10]=ct.elements[8],Ie.__data[11]=0):(ct.toArray(Ie.__data,Ge),Ge+=Pt.storage/Float32Array.BYTES_PER_ELEMENT)}s.bufferSubData(s.UNIFORM_BUFFER,ke,Ie.__data)}}}s.bindBuffer(s.UNIFORM_BUFFER,null)}function D(se,$,J,Be){let ge=se.value,we=$+"_"+J;if(Be[we]===void 0)return typeof ge=="number"||typeof ge=="boolean"?Be[we]=ge:Be[we]=ge.clone(),!0;{let Te=Be[we];if(typeof ge=="number"||typeof ge=="boolean"){if(Te!==ge)return Be[we]=ge,!0}else if(Te.equals(ge)===!1)return Te.copy(ge),!0}return!1}function N(se){let $=se.uniforms,J=0,Be=16;for(let we=0,Te=$.length;we<Te;we++){let de=Array.isArray($[we])?$[we]:[$[we]];for(let le=0,Ie=de.length;le<Ie;le++){let ke=de[le],Fe=Array.isArray(ke.value)?ke.value:[ke.value];for(let Ge=0,qe=Fe.length;Ge<qe;Ge++){let ct=Fe[Ge],Pt=j(ct),Ze=J%Be;Ze!==0&&Be-Ze<Pt.boundary&&(J+=Be-Ze),ke.__data=new Float32Array(Pt.storage/Float32Array.BYTES_PER_ELEMENT),ke.__offset=J,J+=Pt.storage}}}let ge=J%Be;return ge>0&&(J+=Be-ge),se.__size=J,se.__cache={},this}function j(se){let $={boundary:0,storage:0};return typeof se=="number"||typeof se=="boolean"?($.boundary=4,$.storage=4):se.isVector2?($.boundary=8,$.storage=8):se.isVector3||se.isColor?($.boundary=16,$.storage=12):se.isVector4?($.boundary=16,$.storage=16):se.isMatrix3?($.boundary=48,$.storage=48):se.isMatrix4?($.boundary=64,$.storage=64):se.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",se),$}function G(se){let $=se.target;$.removeEventListener("dispose",G);let J=o.indexOf($.__bindingPointIndex);o.splice(J,1),s.deleteBuffer(i[$.id]),delete i[$.id],delete r[$.id]}function P(){for(let se in i)s.deleteBuffer(i[se]);o=[],i={},r={}}return{bind:d,update:E,dispose:P}}class uv{constructor(e={}){let{canvas:t=cl(),context:n=null,depth:i=!0,stencil:r=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:E=!1,powerPreference:w="default",failIfMajorPerformanceCaveat:T=!1,multiviewStereo:B=!1}=e;this.isWebGLRenderer=!0;let D;if(n!==null){if(typeof WebGLRenderingContext!="undefined"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");D=n.getContextAttributes().alpha}else D=o;let N=new Uint32Array(4),j=new Int32Array(4),G=null,P=null,se=[],$=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=ni,this._useLegacyLights=!1,this.toneMapping=vi,this.toneMappingExposure=1;let J=this,Be=!1,ge=0,we=0,Te=null,de=-1,le=null,Ie=new oi,ke=new oi,Fe=null,Ge=new qt(0),qe=0,ct=t.width,Pt=t.height,Ze=1,It=null,Rt=null,nn=new oi(0,0,ct,Pt),jn=new oi(0,0,ct,Pt),mi=!1,Di=new Ta,di=!1,Ti=!1,sn=new rn,ut=new ve,Ot={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Nt(){return Te===null?Ze:1}let Qe=n;function ft(me,He){return t.getContext(me,He)}try{let me={alpha:!0,depth:i,stencil:r,antialias:a,premultipliedAlpha:d,preserveDrawingBuffer:E,powerPreference:w,failIfMajorPerformanceCaveat:T};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${y}`),t.addEventListener("webglcontextlost",Lt,!1),t.addEventListener("webglcontextrestored",hn,!1),t.addEventListener("webglcontextcreationerror",Wt,!1),Qe===null){let He="webgl2";if(Qe=ft(He,me),Qe===null)throw ft(He)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(me){throw console.error("THREE.WebGLRenderer: "+me.message),me}let rt,St,wt,xt,Vt,Yt,Tn,Pn,ui,Ki,Pi,Se,ce,tt,dt,gt,At,cn,Ft,Jt,bi,Zt,dn,Vn,bn;function Le(){rt=new x0(Qe),rt.init(),dn=new Vu(Qe,rt),St=new m0(Qe,rt,e,dn),wt=new tv(Qe),xt=new w0(Qe),Vt=new Hg,Yt=new nv(Qe,rt,wt,Vt,St,dn,xt),Tn=new v0(J),Pn=new C0(J),ui=new uA(Qe),Vn=new p0(Qe,ui),Ki=new b0(Qe,ui,xt,Vn),Pi=new I0(Qe,Ki,ui,xt),Jt=new M0(Qe,St,Yt),gt=new g0(Vt),Se=new Vg(J,Tn,Pn,rt,St,Vn,gt),ce=new hv(J,Vt),tt=new jg,dt=new Jg(rt),Ft=new f0(J,Tn,Pn,wt,Pi,D,d),cn=new S0(J,rt,Qe),At=new ev(J,Pi,St),bn=new dv(Qe,xt,St,wt),bi=new A0(Qe,rt,xt),Zt=new _0(Qe,rt,xt),xt.programs=Se.programs,J.capabilities=St,J.extensions=rt,J.properties=Vt,J.renderLists=tt,J.shadowMap=At,J.state=wt,J.info=xt}Le();let bt=typeof navigator!="undefined"&&"xr"in navigator?new lv(J,Qe,rt,B):new ju(J);this.xr=bt,this.getContext=function(){return Qe},this.getContextAttributes=function(){return Qe.getContextAttributes()},this.forceContextLoss=function(){let me=rt.get("WEBGL_lose_context");me&&me.loseContext()},this.forceContextRestore=function(){let me=rt.get("WEBGL_lose_context");me&&me.restoreContext()},this.getPixelRatio=function(){return Ze},this.setPixelRatio=function(me){me!==void 0&&(Ze=me,this.setSize(ct,Pt,!1))},this.getSize=function(me){return me.set(ct,Pt)},this.setSize=function(me,He,Je=!0){if(bt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ct=me,Pt=He,t.width=Math.floor(me*Ze),t.height=Math.floor(He*Ze),Je===!0&&(t.style.width=me+"px",t.style.height=He+"px"),this.setViewport(0,0,me,He)},this.getDrawingBufferSize=function(me){return me.set(ct*Ze,Pt*Ze).floor()},this.setDrawingBufferSize=function(me,He,Je){ct=me,Pt=He,Ze=Je,t.width=Math.floor(me*Je),t.height=Math.floor(He*Je),this.setViewport(0,0,me,He)},this.getCurrentViewport=function(me){return me.copy(Ie)},this.getViewport=function(me){return me.copy(nn)},this.setViewport=function(me,He,Je,Xe){me.isVector4?nn.set(me.x,me.y,me.z,me.w):nn.set(me,He,Je,Xe),wt.viewport(Ie.copy(nn).multiplyScalar(Ze).round())},this.getScissor=function(me){return me.copy(jn)},this.setScissor=function(me,He,Je,Xe){me.isVector4?jn.set(me.x,me.y,me.z,me.w):jn.set(me,He,Je,Xe),wt.scissor(ke.copy(jn).multiplyScalar(Ze).round())},this.getScissorTest=function(){return mi},this.setScissorTest=function(me){wt.setScissorTest(mi=me)},this.setOpaqueSort=function(me){It=me},this.setTransparentSort=function(me){Rt=me},this.getClearColor=function(me){return me.copy(Ft.getClearColor())},this.setClearColor=function(){Ft.setClearColor.apply(Ft,arguments)},this.getClearAlpha=function(){return Ft.getClearAlpha()},this.setClearAlpha=function(){Ft.setClearAlpha.apply(Ft,arguments)},this.clear=function(me=!0,He=!0,Je=!0){let Xe=0;if(me){let Ye=!1;if(Te!==null){let jt=Te.texture.format;Ye=jt===on||jt===ot||jt===$t}if(Ye){let jt=Te.texture.type,fn=jt===Ui||jt===xr||jt===Lr||jt===jr||jt===$i||jt===_s,gn=Ft.getClearColor(),Mn=Ft.getClearAlpha(),Un=gn.r,Wn=gn.g,qn=gn.b;fn?(N[0]=Un,N[1]=Wn,N[2]=qn,N[3]=Mn,Qe.clearBufferuiv(Qe.COLOR,0,N)):(j[0]=Un,j[1]=Wn,j[2]=qn,j[3]=Mn,Qe.clearBufferiv(Qe.COLOR,0,j))}else Xe|=Qe.COLOR_BUFFER_BIT}He&&(Xe|=Qe.DEPTH_BUFFER_BIT),Je&&(Xe|=Qe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Qe.clear(Xe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Lt,!1),t.removeEventListener("webglcontextrestored",hn,!1),t.removeEventListener("webglcontextcreationerror",Wt,!1),tt.dispose(),dt.dispose(),Vt.dispose(),Tn.dispose(),Pn.dispose(),Pi.dispose(),Vn.dispose(),bn.dispose(),Se.dispose(),bt.dispose(),bt.removeEventListener("sessionstart",xs),bt.removeEventListener("sessionend",Pp),Oo.stop()};function Lt(me){me.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Be=!0}function hn(){console.log("THREE.WebGLRenderer: Context Restored."),Be=!1;let me=xt.autoReset,He=At.enabled,Je=At.autoUpdate,Xe=At.needsUpdate,Ye=At.type;Le(),xt.autoReset=me,At.enabled=He,At.autoUpdate=Je,At.needsUpdate=Xe,At.type=Ye}function Wt(me){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",me.statusMessage)}function Hn(me){let He=me.target;He.removeEventListener("dispose",Hn),Kt(He)}function Kt(me){Ht(me),Vt.remove(me)}function Ht(me){let He=Vt.get(me).programs;He!==void 0&&(He.forEach(function(Je){Se.releaseProgram(Je)}),me.isShaderMaterial&&Se.releaseShaderCache(me))}this.renderBufferDirect=function(me,He,Je,Xe,Ye,jt){He===null&&(He=Ot);let fn=Ye.isMesh&&Ye.matrixWorld.determinant()<0,gn=o1(me,He,Je,Xe,Ye);wt.setMaterial(Xe,fn);let Mn=Je.index,Un=1;if(Xe.wireframe===!0){if(Mn=Ki.getWireframeAttribute(Je),Mn===void 0)return;Un=2}let Wn=Je.drawRange,qn=Je.attributes.position,lr=Wn.start*Un,Rr=(Wn.start+Wn.count)*Un;jt!==null&&(lr=Math.max(lr,jt.start*Un),Rr=Math.min(Rr,(jt.start+jt.count)*Un)),Mn!==null?(lr=Math.max(lr,0),Rr=Math.min(Rr,Mn.count)):qn!=null&&(lr=Math.max(lr,0),Rr=Math.min(Rr,qn.count));let $r=Rr-lr;if($r<0||$r===1/0)return;Vn.setup(Ye,Xe,gn,Je,Mn);let so,gi=bi;if(Mn!==null&&(so=ui.get(Mn),gi=Zt,gi.setIndex(so)),Ye.isMesh)Xe.wireframe===!0?(wt.setLineWidth(Xe.wireframeLinewidth*Nt()),gi.setMode(Qe.LINES)):gi.setMode(Qe.TRIANGLES);else if(Ye.isLine){let Gs=Xe.linewidth;Gs===void 0&&(Gs=1),wt.setLineWidth(Gs*Nt()),Ye.isLineSegments?gi.setMode(Qe.LINES):Ye.isLineLoop?gi.setMode(Qe.LINE_LOOP):gi.setMode(Qe.LINE_STRIP)}else Ye.isPoints?gi.setMode(Qe.POINTS):Ye.isSprite&&gi.setMode(Qe.TRIANGLES);if(Ye.isBatchedMesh)Ye._multiDrawInstances!==null?gi.renderMultiDrawInstances(Ye._multiDrawStarts,Ye._multiDrawCounts,Ye._multiDrawCount,Ye._multiDrawInstances):gi.renderMultiDraw(Ye._multiDrawStarts,Ye._multiDrawCounts,Ye._multiDrawCount);else if(Ye.isInstancedMesh)gi.renderInstances(lr,$r,Ye.count);else if(Je.isInstancedBufferGeometry){let Gs=Je._maxInstanceCount!==void 0?Je._maxInstanceCount:1/0,Xn=Math.min(Je.instanceCount,Gs);gi.renderInstances(lr,$r,Xn)}else gi.render(lr,$r)};function Kn(me,He,Je){me.transparent===!0&&me.side===S&&me.forceSinglePass===!1?(me.side=x,me.needsUpdate=!0,Rc(me,He,Je),me.side=m,me.needsUpdate=!0,Rc(me,He,Je),me.side=S):Rc(me,He,Je)}this.compile=function(me,He,Je=null){Je===null&&(Je=me),P=dt.get(Je),P.init(He),$.push(P),Je.traverseVisible(function(Ye){Ye.isLight&&Ye.layers.test(He.layers)&&(P.pushLight(Ye),Ye.castShadow&&P.pushShadow(Ye))}),me!==Je&&me.traverseVisible(function(Ye){Ye.isLight&&Ye.layers.test(He.layers)&&(P.pushLight(Ye),Ye.castShadow&&P.pushShadow(Ye))}),P.setupLights(J._useLegacyLights);let Xe=new Set;return me.traverse(function(Ye){let jt=Ye.material;if(jt)if(Array.isArray(jt))for(let fn=0;fn<jt.length;fn++){let gn=jt[fn];Kn(gn,Je,Ye),Xe.add(gn)}else Kn(jt,Je,Ye),Xe.add(jt)}),$.pop(),P=null,Xe},this.compileAsync=function(me,He,Je=null){let Xe=this.compile(me,He,Je);return new Promise(Ye=>{function jt(){if(Xe.forEach(function(fn){Vt.get(fn).currentProgram.isReady()&&Xe.delete(fn)}),Xe.size===0){Ye(me);return}setTimeout(jt,10)}rt.get("KHR_parallel_shader_compile")!==null?jt():setTimeout(jt,10)})};let wn=null;function pr(me){wn&&wn(me)}function xs(){Oo.stop()}function Pp(){Oo.start()}let Oo=new Ph;Oo.setAnimationLoop(pr),typeof self!="undefined"&&Oo.setContext(self),this.setAnimationLoop=function(me){wn=me,bt.setAnimationLoop(me),me===null?Oo.stop():Oo.start()},bt.addEventListener("sessionstart",xs),bt.addEventListener("sessionend",Pp),this.render=function(me,He){if(He!==void 0&&He.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(Be===!0)return;me.matrixWorldAutoUpdate===!0&&me.updateMatrixWorld(),He.parent===null&&He.matrixWorldAutoUpdate===!0&&He.updateMatrixWorld(),bt.enabled===!0&&bt.isPresenting===!0&&(bt.cameraAutoUpdate===!0&&bt.updateCamera(He),He=bt.getCamera()),me.isScene===!0&&me.onBeforeRender(J,me,He,Te),P=dt.get(me,$.length),P.init(He),$.push(P),sn.multiplyMatrices(He.projectionMatrix,He.matrixWorldInverse),Di.setFromProjectionMatrix(sn),Ti=this.localClippingEnabled,di=gt.init(this.clippingPlanes,Ti),G=tt.get(me,se.length),G.init(),se.push(G),Fp(me,He,0,J.sortObjects),G.finish(),J.sortObjects===!0&&G.sort(It,Rt);let Je=bt.enabled===!1||bt.isPresenting===!1||bt.hasDepthSensing()===!1;Je&&Ft.addToRenderList(G,me),this.info.render.frame++,di===!0&&gt.beginShadows();let Xe=P.state.shadowsArray;At.render(Xe,me,He),di===!0&&gt.endShadows(),this.info.autoReset===!0&&this.info.reset();let Ye=G.opaque,jt=G.transmissive;if(P.setupLights(J._useLegacyLights),He.isArrayCamera){let fn=He.cameras;if(jt.length>0)for(let gn=0,Mn=fn.length;gn<Mn;gn++){let Un=fn[gn];Op(Ye,jt,me,Un)}if(Je&&Ft.render(me),bt.enabled&&bt.isMultiview)Yt.setDeferTextureUploads(!0),Pd(G,me,He,He.cameras[0].viewport);else for(let gn=0,Mn=fn.length;gn<Mn;gn++){let Un=fn[gn];Pd(G,me,Un,Un.viewport)}}else jt.length>0&&Op(Ye,jt,me,He),Je&&Ft.render(me),Pd(G,me,He);Te!==null&&(Yt.updateMultisampleRenderTarget(Te),Yt.updateRenderTargetMipmap(Te)),me.isScene===!0&&me.onAfterRender(J,me,He),Yt.runDeferredUploads(),bt.enabled&&bt.submitFrame&&bt.submitFrame(),Vn.resetDefaultState(),de=-1,le=null,$.pop(),$.length>0?(P=$[$.length-1],di===!0&&gt.setGlobalState(J.clippingPlanes,P.state.camera)):P=null,se.pop(),se.length>0?G=se[se.length-1]:G=null};function Fp(me,He,Je,Xe){if(me.visible===!1)return;if(me.layers.test(He.layers)){if(me.isGroup)Je=me.renderOrder;else if(me.isLOD)me.autoUpdate===!0&&me.update(He);else if(me.isLight)P.pushLight(me),me.castShadow&&P.pushShadow(me);else if(me.isSprite){if(!me.frustumCulled||Di.intersectsSprite(me)){Xe&&ut.setFromMatrixPosition(me.matrixWorld).applyMatrix4(sn);let fn=Pi.update(me),gn=me.material;gn.visible&&G.push(me,fn,gn,Je,ut.z,null)}}else if((me.isMesh||me.isLine||me.isPoints)&&(!me.frustumCulled||Di.intersectsObject(me))){let fn=Pi.update(me),gn=me.material;if(Xe&&(me.boundingSphere!==void 0?(me.boundingSphere===null&&me.computeBoundingSphere(),ut.copy(me.boundingSphere.center)):(fn.boundingSphere===null&&fn.computeBoundingSphere(),ut.copy(fn.boundingSphere.center)),ut.applyMatrix4(me.matrixWorld).applyMatrix4(sn)),Array.isArray(gn)){let Mn=fn.groups;for(let Un=0,Wn=Mn.length;Un<Wn;Un++){let qn=Mn[Un],lr=gn[qn.materialIndex];lr&&lr.visible&&G.push(me,fn,lr,Je,ut.z,qn)}}else gn.visible&&G.push(me,fn,gn,Je,ut.z,null)}}let jt=me.children;for(let fn=0,gn=jt.length;fn<gn;fn++)Fp(jt[fn],He,Je,Xe)}function Pd(me,He,Je,Xe){let Ye=me.opaque,jt=me.transmissive,fn=me.transparent;P.setupLightsView(Je),di===!0&&gt.setGlobalState(J.clippingPlanes,Je),Xe&&wt.viewport(Ie.copy(Xe)),Ye.length>0&&Bc(Ye,He,Je),jt.length>0&&Bc(jt,He,Je),fn.length>0&&Bc(fn,He,Je),wt.buffers.depth.setTest(!0),wt.buffers.depth.setMask(!0),wt.buffers.color.setMask(!0),wt.setPolygonOffset(!1)}function Op(me,He,Je,Xe){if((Je.isScene===!0?Je.overrideMaterial:null)!==null)return;P.state.transmissionRenderTarget[Xe.id]===void 0&&(P.state.transmissionRenderTarget[Xe.id]=new Gr(1,1,{generateMipmaps:!0,type:rt.has("EXT_color_buffer_half_float")||rt.has("EXT_color_buffer_float")?Ci:Ui,minFilter:yi,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1}));let jt=P.state.transmissionRenderTarget[Xe.id],fn=Xe.viewport||Ie;jt.setSize(fn.z,fn.w);let gn=J.getRenderTarget();J.setRenderTarget(jt),J.getClearColor(Ge),qe=J.getClearAlpha(),qe<1&&J.setClearColor(16777215,.5),J.clear();let Mn=J.toneMapping;J.toneMapping=vi;let Un=Xe.viewport;if(Xe.viewport!==void 0&&(Xe.viewport=void 0),P.setupLightsView(Xe),di===!0&&gt.setGlobalState(J.clippingPlanes,Xe),Bc(me,Je,Xe),Yt.updateMultisampleRenderTarget(jt),Yt.updateRenderTargetMipmap(jt),rt.has("WEBGL_multisampled_render_to_texture")===!1){let Wn=!1;for(let qn=0,lr=He.length;qn<lr;qn++){let Rr=He[qn],$r=Rr.object,so=Rr.geometry,gi=Rr.material,Gs=Rr.group;if(gi.side===S&&$r.layers.test(Xe.layers)){let Xn=gi.side;gi.side=x,gi.needsUpdate=!0,Up($r,Je,Xe,so,gi,Gs),gi.side=Xn,gi.needsUpdate=!0,Wn=!0}}Wn===!0&&(Yt.updateMultisampleRenderTarget(jt),Yt.updateRenderTargetMipmap(jt))}J.setRenderTarget(gn),J.setClearColor(Ge,qe),Un!==void 0&&(Xe.viewport=Un),J.toneMapping=Mn}function Bc(me,He,Je){let Xe=He.isScene===!0?He.overrideMaterial:null;for(let Ye=0,jt=me.length;Ye<jt;Ye++){let fn=me[Ye],gn=fn.object,Mn=fn.geometry,Un=Xe===null?fn.material:Xe,Wn=fn.group;gn.layers.test(Je.layers)&&Up(gn,He,Je,Mn,Un,Wn)}}function Up(me,He,Je,Xe,Ye,jt){me.onBeforeRender(J,He,Je,Xe,Ye,jt),me.modelViewMatrix.multiplyMatrices(Je.matrixWorldInverse,me.matrixWorld),me.normalMatrix.getNormalMatrix(me.modelViewMatrix),Ye.onBeforeRender(J,He,Je,Xe,me,jt),Ye.transparent===!0&&Ye.side===S&&Ye.forceSinglePass===!1?(Ye.side=x,Ye.needsUpdate=!0,J.renderBufferDirect(Je,He,Xe,Ye,me,jt),Ye.side=m,Ye.needsUpdate=!0,J.renderBufferDirect(Je,He,Xe,Ye,me,jt),Ye.side=S):J.renderBufferDirect(Je,He,Xe,Ye,me,jt),me.onAfterRender(J,He,Je,Xe,Ye,jt)}function Rc(me,He,Je){He.isScene!==!0&&(He=Ot);let Xe=Vt.get(me),Ye=P.state.lights,jt=P.state.shadowsArray,fn=Ye.state.version,gn=Se.getParameters(me,Ye.state,jt,He,Je),Mn=Se.getProgramCacheKey(gn),Un=Xe.programs;Xe.environment=me.isMeshStandardMaterial?He.environment:null,Xe.fog=He.fog,Xe.envMap=(me.isMeshStandardMaterial?Pn:Tn).get(me.envMap||Xe.environment),Xe.envMapRotation=Xe.environment!==null&&me.envMap===null?He.environmentRotation:me.envMapRotation,Un===void 0&&(me.addEventListener("dispose",Hn),Un=new Map,Xe.programs=Un);let Wn=Un.get(Mn);if(Wn!==void 0){if(Xe.currentProgram===Wn&&Xe.lightsStateVersion===fn)return kp(me,gn),Wn}else gn.uniforms=Se.getUniforms(me),me.onBuild(Je,gn,J),me.onBeforeCompile(gn,J),Wn=Se.acquireProgram(gn,Mn),Un.set(Mn,Wn),Xe.uniforms=gn.uniforms;let qn=Xe.uniforms;return(!me.isShaderMaterial&&!me.isRawShaderMaterial||me.clipping===!0)&&(qn.clippingPlanes=gt.uniform),kp(me,gn),Xe.needsLights=l1(me),Xe.lightsStateVersion=fn,Xe.needsLights&&(qn.ambientLightColor.value=Ye.state.ambient,qn.lightProbe.value=Ye.state.probe,qn.directionalLights.value=Ye.state.directional,qn.directionalLightShadows.value=Ye.state.directionalShadow,qn.spotLights.value=Ye.state.spot,qn.spotLightShadows.value=Ye.state.spotShadow,qn.rectAreaLights.value=Ye.state.rectArea,qn.ltc_1.value=Ye.state.rectAreaLTC1,qn.ltc_2.value=Ye.state.rectAreaLTC2,qn.pointLights.value=Ye.state.point,qn.pointLightShadows.value=Ye.state.pointShadow,qn.hemisphereLights.value=Ye.state.hemi,qn.directionalShadowMap.value=Ye.state.directionalShadowMap,qn.directionalShadowMatrix.value=Ye.state.directionalShadowMatrix,qn.spotShadowMap.value=Ye.state.spotShadowMap,qn.spotLightMatrix.value=Ye.state.spotLightMatrix,qn.spotLightMap.value=Ye.state.spotLightMap,qn.pointShadowMap.value=Ye.state.pointShadowMap,qn.pointShadowMatrix.value=Ye.state.pointShadowMatrix),Xe.currentProgram=Wn,Xe.uniformsList=null,Wn}function Np(me){if(me.uniformsList===null){let He=me.currentProgram.getUniforms();me.uniformsList=Fl.seqWithValue(He.seq,me.uniforms)}return me.uniformsList}function kp(me,He){let Je=Vt.get(me);Je.outputColorSpace=He.outputColorSpace,Je.batching=He.batching,Je.instancing=He.instancing,Je.instancingColor=He.instancingColor,Je.instancingMorph=He.instancingMorph,Je.skinning=He.skinning,Je.morphTargets=He.morphTargets,Je.morphNormals=He.morphNormals,Je.morphColors=He.morphColors,Je.morphTargetsCount=He.morphTargetsCount,Je.numClippingPlanes=He.numClippingPlanes,Je.numIntersection=He.numClipIntersection,Je.vertexAlphas=He.vertexAlphas,Je.vertexTangents=He.vertexTangents,Je.toneMapping=He.toneMapping,Je.numMultiviewViews=He.numMultiviewViews}function o1(me,He,Je,Xe,Ye){He.isScene!==!0&&(He=Ot),Yt.resetTextureUnits();let jt=He.fog,fn=Xe.isMeshStandardMaterial?He.environment:null,gn=Te===null?J.outputColorSpace:Te.isXRRenderTarget===!0?Te.texture.colorSpace:ls,Mn=(Xe.isMeshStandardMaterial?Pn:Tn).get(Xe.envMap||fn),Un=Xe.vertexColors===!0&&!!Je.attributes.color&&Je.attributes.color.itemSize===4,Wn=!!Je.attributes.tangent&&(!!Xe.normalMap||Xe.anisotropy>0),qn=!!Je.morphAttributes.position,lr=!!Je.morphAttributes.normal,Rr=!!Je.morphAttributes.color,$r=vi;Xe.toneMapped&&(Te===null||Te.isXRRenderTarget===!0)&&($r=J.toneMapping);let so=Te&&Te.isWebGLMultiviewRenderTarget?Te.numViews:0,gi=Je.morphAttributes.position||Je.morphAttributes.normal||Je.morphAttributes.color,Gs=gi!==void 0?gi.length:0,Xn=Vt.get(Xe),c1=P.state.lights;if(di===!0&&(Ti===!0||me!==le)){let os=me===le&&Xe.id===de;gt.setState(Xe,me,os)}let Gi=!1;Xe.version===Xn.__version?(Xn.needsLights&&Xn.lightsStateVersion!==c1.state.version||Xn.outputColorSpace!==gn||Ye.isBatchedMesh&&Xn.batching===!1||!Ye.isBatchedMesh&&Xn.batching===!0||Ye.isInstancedMesh&&Xn.instancing===!1||!Ye.isInstancedMesh&&Xn.instancing===!0||Ye.isSkinnedMesh&&Xn.skinning===!1||!Ye.isSkinnedMesh&&Xn.skinning===!0||Ye.isInstancedMesh&&Xn.instancingColor===!0&&Ye.instanceColor===null||Ye.isInstancedMesh&&Xn.instancingColor===!1&&Ye.instanceColor!==null||Ye.isInstancedMesh&&Xn.instancingMorph===!0&&Ye.morphTexture===null||Ye.isInstancedMesh&&Xn.instancingMorph===!1&&Ye.morphTexture!==null||Xn.envMap!==Mn||Xe.fog===!0&&Xn.fog!==jt||Xn.numClippingPlanes!==void 0&&(Xn.numClippingPlanes!==gt.numPlanes||Xn.numIntersection!==gt.numIntersection)||Xn.vertexAlphas!==Un||Xn.vertexTangents!==Wn||Xn.morphTargets!==qn||Xn.morphNormals!==lr||Xn.morphColors!==Rr||Xn.toneMapping!==$r||Xn.morphTargetsCount!==Gs||Xn.numMultiviewViews!==so)&&(Gi=!0):(Gi=!0,Xn.__version=Xe.version);let Qs=Xn.currentProgram;Gi===!0&&(Qs=Rc(Xe,He,Ye));let Gp=!1,$a=!1,Fd=!1,Ar=Qs.getUniforms(),oo=Xn.uniforms;if(wt.useProgram(Qs.program)&&(Gp=!0,$a=!0,Fd=!0),Xe.id!==de&&(de=Xe.id,$a=!0),Gp||le!==me){Qs.numMultiviewViews>0?(cn.updateCameraProjectionMatricesUniform(me,Ar),cn.updateCameraViewMatricesUniform(me,Ar)):(Ar.setValue(Qe,"projectionMatrix",me.projectionMatrix),Ar.setValue(Qe,"viewMatrix",me.matrixWorldInverse));let os=Ar.map.cameraPosition;os!==void 0&&os.setValue(Qe,ut.setFromMatrixPosition(me.matrixWorld)),St.logarithmicDepthBuffer&&Ar.setValue(Qe,"logDepthBufFC",2/(Math.log(me.far+1)/Math.LN2)),(Xe.isMeshPhongMaterial||Xe.isMeshToonMaterial||Xe.isMeshLambertMaterial||Xe.isMeshBasicMaterial||Xe.isMeshStandardMaterial||Xe.isShaderMaterial)&&Ar.setValue(Qe,"isOrthographic",me.isOrthographicCamera===!0),le!==me&&(le=me,$a=!0,Fd=!0)}if(Ye.isSkinnedMesh){Ar.setOptional(Qe,Ye,"bindMatrix"),Ar.setOptional(Qe,Ye,"bindMatrixInverse");let os=Ye.skeleton;os&&(os.boneTexture===null&&os.computeBoneTexture(),Ar.setValue(Qe,"boneTexture",os.boneTexture,Yt))}Ye.isBatchedMesh&&(Ar.setOptional(Qe,Ye,"batchingTexture"),Ar.setValue(Qe,"batchingTexture",Ye._matricesTexture,Yt));let Od=Je.morphAttributes;if((Od.position!==void 0||Od.normal!==void 0||Od.color!==void 0)&&Jt.update(Ye,Je,Qs),($a||Xn.receiveShadow!==Ye.receiveShadow)&&(Xn.receiveShadow=Ye.receiveShadow,Ar.setValue(Qe,"receiveShadow",Ye.receiveShadow)),Xe.isMeshGouraudMaterial&&Xe.envMap!==null&&(oo.envMap.value=Mn,oo.flipEnvMap.value=Mn.isCubeTexture&&Mn.isRenderTargetTexture===!1?-1:1),Xe.isMeshStandardMaterial&&Xe.envMap===null&&He.environment!==null&&(oo.envMapIntensity.value=He.environmentIntensity),$a&&(Ar.setValue(Qe,"toneMappingExposure",J.toneMappingExposure),Xn.needsLights&&a1(oo,Fd),jt&&Xe.fog===!0&&ce.refreshFogUniforms(oo,jt),ce.refreshMaterialUniforms(oo,Xe,Ze,Pt,P.state.transmissionRenderTarget[me.id]),Fl.upload(Qe,Np(Xn),oo,Yt)),Xe.isShaderMaterial&&Xe.uniformsNeedUpdate===!0&&(Fl.upload(Qe,Np(Xn),oo,Yt),Xe.uniformsNeedUpdate=!1),Xe.isSpriteMaterial&&Ar.setValue(Qe,"center",Ye.center),Qs.numMultiviewViews>0?cn.updateObjectMatricesUniforms(Ye,me,Ar):(Ar.setValue(Qe,"modelViewMatrix",Ye.modelViewMatrix),Ar.setValue(Qe,"normalMatrix",Ye.normalMatrix)),Ar.setValue(Qe,"modelMatrix",Ye.matrixWorld),Xe.isShaderMaterial||Xe.isRawShaderMaterial){let os=Xe.uniformsGroups;for(let Ud=0,h1=os.length;Ud<h1;Ud++){let Qp=os[Ud];bn.update(Qp,Qs),bn.bind(Qp,Qs)}}return Qs}function a1(me,He){me.ambientLightColor.needsUpdate=He,me.lightProbe.needsUpdate=He,me.directionalLights.needsUpdate=He,me.directionalLightShadows.needsUpdate=He,me.pointLights.needsUpdate=He,me.pointLightShadows.needsUpdate=He,me.spotLights.needsUpdate=He,me.spotLightShadows.needsUpdate=He,me.rectAreaLights.needsUpdate=He,me.hemisphereLights.needsUpdate=He}function l1(me){return me.isMeshLambertMaterial||me.isMeshToonMaterial||me.isMeshPhongMaterial||me.isMeshStandardMaterial||me.isShadowMaterial||me.isShaderMaterial&&me.lights===!0}this.setTexture2D=function(){var me=!1;return function(Je,Xe){Je&&Je.isWebGLRenderTarget&&(me||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),me=!0),Je=Je.texture),Yt.setTexture2D(Je,Xe)}}(),this.getActiveCubeFace=function(){return ge},this.getActiveMipmapLevel=function(){return we},this.getRenderTarget=function(){return Te},this.setRenderTargetTextures=function(me,He,Je){Vt.get(me.texture).__webglTexture=He,Vt.get(me.depthTexture).__webglTexture=Je;let Xe=Vt.get(me);Xe.__hasExternalTextures=!0,Xe.__autoAllocateDepthBuffer=Je===void 0,!Xe.__autoAllocateDepthBuffer&&(!Te||!Te.isWebGLMultiviewRenderTarget)&&rt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Xe.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(me,He){let Je=Vt.get(me);Je.__webglFramebuffer=He,Je.__useDefaultFramebuffer=He===void 0},this.setRenderTarget=function(me,He=0,Je=0){Te=me,ge=He,we=Je;let Xe=!0,Ye=null,jt=!1,fn=!1;if(me){let Mn=Vt.get(me);Mn.__useDefaultFramebuffer!==void 0?(wt.bindFramebuffer(Qe.FRAMEBUFFER,null),Xe=!1):Mn.__webglFramebuffer===void 0?Yt.setupRenderTarget(me):Mn.__hasExternalTextures&&Yt.rebindTextures(me,Vt.get(me.texture).__webglTexture,Vt.get(me.depthTexture).__webglTexture);let Un=me.texture;(Un.isData3DTexture||Un.isDataArrayTexture||Un.isCompressedArrayTexture)&&(fn=!0);let Wn=Vt.get(me).__webglFramebuffer;me.isWebGLCubeRenderTarget?(Array.isArray(Wn[He])?Ye=Wn[He][Je]:Ye=Wn[He],jt=!0):me.samples>0&&Yt.useMultisampledRTT(me)===!1?Ye=Vt.get(me).__webglMultisampledFramebuffer:Array.isArray(Wn)?Ye=Wn[Je]:Ye=Wn,Ie.copy(me.viewport),ke.copy(me.scissor),Fe=me.scissorTest}else Ie.copy(nn).multiplyScalar(Ze).floor(),ke.copy(jn).multiplyScalar(Ze).floor(),Fe=mi;if(wt.bindFramebuffer(Qe.FRAMEBUFFER,Ye)&&Xe&&wt.drawBuffers(me,Ye),wt.viewport(Ie),wt.scissor(ke),wt.setScissorTest(Fe),jt){let Mn=Vt.get(me.texture);Qe.framebufferTexture2D(Qe.FRAMEBUFFER,Qe.COLOR_ATTACHMENT0,Qe.TEXTURE_CUBE_MAP_POSITIVE_X+He,Mn.__webglTexture,Je)}else if(fn){let Mn=Vt.get(me.texture),Un=He||0;Qe.framebufferTextureLayer(Qe.FRAMEBUFFER,Qe.COLOR_ATTACHMENT0,Mn.__webglTexture,Je||0,Un)}de=-1},this.readRenderTargetPixels=function(me,He,Je,Xe,Ye,jt,fn){if(!(me&&me.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let gn=Vt.get(me).__webglFramebuffer;if(me.isWebGLCubeRenderTarget&&fn!==void 0&&(gn=gn[fn]),gn){wt.bindFramebuffer(Qe.FRAMEBUFFER,gn);try{let Mn=me.texture,Un=Mn.format,Wn=Mn.type;if(!St.textureFormatReadable(Un)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!St.textureTypeReadable(Wn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}He>=0&&He<=me.width-Xe&&Je>=0&&Je<=me.height-Ye&&Qe.readPixels(He,Je,Xe,Ye,dn.convert(Un),dn.convert(Wn),jt)}finally{let Mn=Te!==null?Vt.get(Te).__webglFramebuffer:null;wt.bindFramebuffer(Qe.FRAMEBUFFER,Mn)}}},this.copyFramebufferToTexture=function(me,He,Je=0){let Xe=Math.pow(2,-Je),Ye=Math.floor(He.image.width*Xe),jt=Math.floor(He.image.height*Xe);Yt.setTexture2D(He,0),Qe.copyTexSubImage2D(Qe.TEXTURE_2D,Je,0,0,me.x,me.y,Ye,jt),wt.unbindTexture()},this.copyTextureToTexture=function(me,He,Je,Xe=0){let Ye=He.image.width,jt=He.image.height,fn=dn.convert(Je.format),gn=dn.convert(Je.type);Yt.setTexture2D(Je,0),Qe.pixelStorei(Qe.UNPACK_FLIP_Y_WEBGL,Je.flipY),Qe.pixelStorei(Qe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Je.premultiplyAlpha),Qe.pixelStorei(Qe.UNPACK_ALIGNMENT,Je.unpackAlignment),He.isDataTexture?Qe.texSubImage2D(Qe.TEXTURE_2D,Xe,me.x,me.y,Ye,jt,fn,gn,He.image.data):He.isCompressedTexture?Qe.compressedTexSubImage2D(Qe.TEXTURE_2D,Xe,me.x,me.y,He.mipmaps[0].width,He.mipmaps[0].height,fn,He.mipmaps[0].data):Qe.texSubImage2D(Qe.TEXTURE_2D,Xe,me.x,me.y,fn,gn,He.image),Xe===0&&Je.generateMipmaps&&Qe.generateMipmap(Qe.TEXTURE_2D),wt.unbindTexture()},this.copyTextureToTexture3D=function(me,He,Je,Xe,Ye=0){let jt=me.max.x-me.min.x,fn=me.max.y-me.min.y,gn=me.max.z-me.min.z,Mn=dn.convert(Xe.format),Un=dn.convert(Xe.type),Wn;if(Xe.isData3DTexture)Yt.setTexture3D(Xe,0),Wn=Qe.TEXTURE_3D;else if(Xe.isDataArrayTexture||Xe.isCompressedArrayTexture)Yt.setTexture2DArray(Xe,0),Wn=Qe.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Qe.pixelStorei(Qe.UNPACK_FLIP_Y_WEBGL,Xe.flipY),Qe.pixelStorei(Qe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Xe.premultiplyAlpha),Qe.pixelStorei(Qe.UNPACK_ALIGNMENT,Xe.unpackAlignment);let qn=Qe.getParameter(Qe.UNPACK_ROW_LENGTH),lr=Qe.getParameter(Qe.UNPACK_IMAGE_HEIGHT),Rr=Qe.getParameter(Qe.UNPACK_SKIP_PIXELS),$r=Qe.getParameter(Qe.UNPACK_SKIP_ROWS),so=Qe.getParameter(Qe.UNPACK_SKIP_IMAGES),gi=Je.isCompressedTexture?Je.mipmaps[Ye]:Je.image;Qe.pixelStorei(Qe.UNPACK_ROW_LENGTH,gi.width),Qe.pixelStorei(Qe.UNPACK_IMAGE_HEIGHT,gi.height),Qe.pixelStorei(Qe.UNPACK_SKIP_PIXELS,me.min.x),Qe.pixelStorei(Qe.UNPACK_SKIP_ROWS,me.min.y),Qe.pixelStorei(Qe.UNPACK_SKIP_IMAGES,me.min.z),Je.isDataTexture||Je.isData3DTexture?Qe.texSubImage3D(Wn,Ye,He.x,He.y,He.z,jt,fn,gn,Mn,Un,gi.data):Xe.isCompressedArrayTexture?Qe.compressedTexSubImage3D(Wn,Ye,He.x,He.y,He.z,jt,fn,gn,Mn,gi.data):Qe.texSubImage3D(Wn,Ye,He.x,He.y,He.z,jt,fn,gn,Mn,Un,gi),Qe.pixelStorei(Qe.UNPACK_ROW_LENGTH,qn),Qe.pixelStorei(Qe.UNPACK_IMAGE_HEIGHT,lr),Qe.pixelStorei(Qe.UNPACK_SKIP_PIXELS,Rr),Qe.pixelStorei(Qe.UNPACK_SKIP_ROWS,$r),Qe.pixelStorei(Qe.UNPACK_SKIP_IMAGES,so),Ye===0&&Xe.generateMipmaps&&Qe.generateMipmap(Wn),wt.unbindTexture()},this.initTexture=function(me){me.isCubeTexture?Yt.setTextureCube(me,0):me.isData3DTexture?Yt.setTexture3D(me,0):me.isDataArrayTexture||me.isCompressedArrayTexture?Yt.setTexture2DArray(me,0):Yt.setTexture2D(me,0),wt.unbindTexture()},this.resetState=function(){ge=0,we=0,Te=null,wt.reset(),Vn.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return is}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorSpace=e===Uo?"display-p3":"srgb",t.unpackColorSpace=Ai.workingColorSpace===ao?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class Ol{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new qt(e),this.density=t}clone(){return new Ol(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Ul{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new qt(e),this.near=t,this.far=n}clone(){return new Ul(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Ku extends hi{constructor(){super();this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new qr,this.environmentIntensity=1,this.environmentRotation=new qr,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class Nl{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=uo,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Pr()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return dl("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Pr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Pr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}let Ur=new ve;class _o{constructor(e,t,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Ur.fromBufferAttribute(this,t),Ur.applyMatrix4(e),this.setXYZ(t,Ur.x,Ur.y,Ur.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Ur.fromBufferAttribute(this,t),Ur.applyNormalMatrix(e),this.setXYZ(t,Ur.x,Ur.y,Ur.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Ur.fromBufferAttribute(this,t),Ur.transformDirection(e),this.setXYZ(t,Ur.x,Ur.y,Ur.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=_r(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Dn(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Dn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Dn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Dn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Dn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=_r(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=_r(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=_r(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=_r(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Dn(t,this.array),n=Dn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Dn(t,this.array),n=Dn(n,this.array),i=Dn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Dn(t,this.array),n=Dn(n,this.array),i=Dn(i,this.array),r=Dn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let n=0;n<this.count;n++){let i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[i+r])}return new Si(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new _o(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let n=0;n<this.count;n++){let i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[i+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Yh extends Tr{constructor(e){super();this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new qt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let aa,Ra=new ve,la=new ve,ca=new ve,ha=new ht,La=new ht,Xu=new rn,kl=new ve,Da=new ve,Gl=new ve,Yu=new ht,qh=new ht,qu=new ht;class Ju extends hi{constructor(e=new Yh){super();if(this.isSprite=!0,this.type="Sprite",aa===void 0){aa=new zn;let t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Nl(t,5);aa.setIndex([0,1,2,0,2,3]),aa.setAttribute("position",new _o(n,3,0,!1)),aa.setAttribute("uv",new _o(n,2,3,!1))}this.geometry=aa,this.material=e,this.center=new ht(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),la.setFromMatrixScale(this.matrixWorld),Xu.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ca.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&la.multiplyScalar(-ca.z);let n=this.material.rotation,i,r;n!==0&&(r=Math.cos(n),i=Math.sin(n));let o=this.center;Ql(kl.set(-.5,-.5,0),ca,o,la,i,r),Ql(Da.set(.5,-.5,0),ca,o,la,i,r),Ql(Gl.set(.5,.5,0),ca,o,la,i,r),Yu.set(0,0),qh.set(1,0),qu.set(1,1);let a=e.ray.intersectTriangle(kl,Da,Gl,!1,Ra);if(a===null&&(Ql(Da.set(-.5,.5,0),ca,o,la,i,r),qh.set(0,1),a=e.ray.intersectTriangle(kl,Gl,Da,!1,Ra),a===null))return;let d=e.ray.origin.distanceTo(Ra);d<e.near||d>e.far||t.push({distance:d,point:Ra.clone(),uv:Jr.getInterpolation(Ra,kl,Da,Gl,Yu,qh,qu,new ht),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Ql(s,e,t,n,i,r){ha.subVectors(s,t).addScalar(.5).multiply(n),i!==void 0?(La.x=r*ha.x-i*ha.y,La.y=i*ha.x+r*ha.y):La.copy(ha),s.copy(e),s.x+=La.x,s.y+=La.y,s.applyMatrix4(Xu)}let Vl=new ve,Zu=new ve;class $u extends hi{constructor(){super();this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);let t=e.levels;for(let n=0,i=t.length;n<i;n++){let r=t[n];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);let i=this.levels,r;for(r=0;r<i.length&&!(t<i[r].distance);r++);return i.splice(r,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){let t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Vl.setFromMatrixPosition(this.matrixWorld);let i=e.ray.origin.distanceTo(Vl);this.getObjectForDistance(i).raycast(e,t)}}update(e){let t=this.levels;if(t.length>1){Vl.setFromMatrixPosition(e.matrixWorld),Zu.setFromMatrixPosition(this.matrixWorld);let n=Vl.distanceTo(Zu)/e.zoom;t[0].object.visible=!0;let i,r;for(i=1,r=t.length;i<r;i++){let o=t[i].distance;if(t[i].object.visible&&(o-=o*t[i].hysteresis),n>=o)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<r;i++)t[i].object.visible=!1}}toJSON(e){let t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];let n=this.levels;for(let i=0,r=n.length;i<r;i++){let o=n[i];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}let ef=new ve,tf=new oi,nf=new oi,fv=new ve,rf=new rn,Hl=new ve,Jh=new cr,sf=new rn,Zh=new hr;class of extends ar{constructor(e,t){super(e,t);this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=fe,this.bindMatrix=new rn,this.bindMatrixInverse=new rn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new ji),this.boundingBox.makeEmpty();let t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Hl),this.boundingBox.expandByPoint(Hl)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new cr),this.boundingSphere.makeEmpty();let t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,Hl),this.boundingSphere.expandByPoint(Hl)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){let n=this.material,i=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Jh.copy(this.boundingSphere),Jh.applyMatrix4(i),e.ray.intersectsSphere(Jh)!==!1&&(sf.copy(i).invert(),Zh.copy(e.ray).applyMatrix4(sf),!(this.boundingBox!==null&&Zh.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,Zh)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new oi,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);let r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===fe?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Ee?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){let n=this.skeleton,i=this.geometry;tf.fromBufferAttribute(i.attributes.skinIndex,e),nf.fromBufferAttribute(i.attributes.skinWeight,e),ef.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){let o=nf.getComponent(r);if(o!==0){let a=tf.getComponent(r);rf.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(fv.copy(ef).applyMatrix4(rf),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class $h extends hi{constructor(){super();this.isBone=!0,this.type="Bone"}}class $s extends Li{constructor(e=null,t=1,n=1,i,r,o,a,d,E=Bt,w=Bt,T,B){super(null,o,a,d,E,w,i,r,T,B);this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let af=new rn,pv=new rn;class zl{constructor(e=[],t=[]){this.uuid=Pr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new rn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let n=new rn;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){let e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let r=0,o=e.length;r<o;r++){let a=e[r]?e[r].matrixWorld:pv;af.multiplyMatrices(a,t[r]),af.toArray(n,r*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new zl(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let n=new $s(t,e,e,Me,Ni);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){let i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){let r=e.bones[n],o=t[r];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),o=new $h),this.bones.push(o),this.boneInverses.push(new rn().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,n=this.boneInverses;for(let i=0,r=t.length;i<r;i++){let o=t[i];e.bones.push(o.uuid);let a=n[i];e.boneInverses.push(a.toArray())}return e}}class da extends Si{constructor(e,t,n,i=1){super(e,t,n);this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}let ua=new rn,lf=new rn,jl=[],cf=new ji,Av=new rn,Pa=new ar,Fa=new cr;class hf extends ar{constructor(e,t,n){super(e,t);this.isInstancedMesh=!0,this.instanceMatrix=new da(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<n;i++)this.setMatrixAt(i,Av)}computeBoundingBox(){let e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new ji),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,ua),cf.copy(e.boundingBox).applyMatrix4(ua),this.boundingBox.union(cf)}computeBoundingSphere(){let e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new cr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,ua),Fa.copy(e.boundingSphere).applyMatrix4(ua),this.boundingSphere.union(Fa)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){let n=t.morphTargetInfluences,i=this.morphTexture.source.data.data,r=n.length+1,o=e*r+1;for(let a=0;a<n.length;a++)n[a]=i[o+a]}raycast(e,t){let n=this.matrixWorld,i=this.count;if(Pa.geometry=this.geometry,Pa.material=this.material,Pa.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Fa.copy(this.boundingSphere),Fa.applyMatrix4(n),e.ray.intersectsSphere(Fa)!==!1))for(let r=0;r<i;r++){this.getMatrixAt(r,ua),lf.multiplyMatrices(n,ua),Pa.matrixWorld=lf,Pa.raycast(e,jl);for(let o=0,a=jl.length;o<a;o++){let d=jl[o];d.instanceId=r,d.object=this,t.push(d)}jl.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new da(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){let n=t.morphTargetInfluences,i=n.length+1;this.morphTexture===null&&(this.morphTexture=new $s(new Float32Array(i*this.count),i,this.count,yt,Ni));let r=this.morphTexture.source.data.data,o=0;for(let E=0;E<n.length;E++)o+=n[E];let a=this.geometry.morphTargetsRelative?1:1-o,d=i*e;r[d]=a,r.set(n,d+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function mv(s,e){return s.z-e.z}function gv(s,e){return e.z-s.z}class vv{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){let n=this.pool,i=this.list;this.index>=n.length&&n.push({start:-1,count:-1,z:-1});let r=n[this.index];i.push(r),this.index++,r.start=e.start,r.count=e.count,r.z=t}reset(){this.list.length=0,this.index=0}}let fa="batchId",eo=new rn,df=new rn,Ev=new rn,uf=new rn,ed=new Ta,Wl=new ji,wo=new cr,Oa=new ve,td=new vv,Br=new ar,Kl=[];function yv(s,e,t=0){let n=e.itemSize;if(s.isInterleavedBufferAttribute||s.array.constructor!==e.array.constructor){let i=s.count;for(let r=0;r<i;r++)for(let o=0;o<n;o++)e.setComponent(r+t,o,s.getComponent(r,o))}else e.array.set(s.array,t*n);e.needsUpdate=!0}class ff extends ar{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t,n=t*2,i){super(new zn,i);this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4),n=new $s(t,e,e,Me,Ni);this._matricesTexture=n}_initializeGeometry(e){let t=this.geometry,n=this._maxVertexCount,i=this._maxGeometryCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(let a in e.attributes){let d=e.getAttribute(a),{array:E,itemSize:w,normalized:T}=d,B=new E.constructor(n*w),D=new Si(B,w,T);t.setAttribute(a,D)}if(e.getIndex()!==null){let a=n>65536?new Uint32Array(r):new Uint16Array(r);t.setIndex(new Si(a,1))}let o=i>65536?new Uint32Array(n):new Uint16Array(n);t.setAttribute(fa,new Si(o,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(fa))throw new Error(`BatchedMesh: Geometry cannot use attribute "${fa}"`);let t=this.geometry;if(Boolean(e.getIndex())!==Boolean(t.getIndex()))throw new Error('BatchedMesh: All geometries must consistently have "index".');for(let n in t.attributes){if(n===fa)continue;if(!e.hasAttribute(n))throw new Error(`BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);let i=e.getAttribute(n),r=t.getAttribute(n);if(i.itemSize!==r.itemSize||i.normalized!==r.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ji);let e=this._geometryCount,t=this.boundingBox,n=this._active;t.makeEmpty();for(let i=0;i<e;i++)n[i]!==!1&&(this.getMatrixAt(i,eo),this.getBoundingBoxAt(i,Wl).applyMatrix4(eo),t.union(Wl))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new cr);let e=this._geometryCount,t=this.boundingSphere,n=this._active;t.makeEmpty();for(let i=0;i<e;i++)n[i]!==!1&&(this.getMatrixAt(i,eo),this.getBoundingSphereAt(i,wo).applyMatrix4(eo),t.union(wo))}addGeometry(e,t=-1,n=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");let i={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1},r=null,o=this._reservedRanges,a=this._drawRanges,d=this._bounds;this._geometryCount!==0&&(r=o[o.length-1]),t===-1?i.vertexCount=e.getAttribute("position").count:i.vertexCount=t,r===null?i.vertexStart=0:i.vertexStart=r.vertexStart+r.vertexCount;let E=e.getIndex(),w=E!==null;if(w&&(n===-1?i.indexCount=E.count:i.indexCount=n,r===null?i.indexStart=0:i.indexStart=r.indexStart+r.indexCount),i.indexStart!==-1&&i.indexStart+i.indexCount>this._maxIndexCount||i.vertexStart+i.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");let T=this._visibility,B=this._active,D=this._matricesTexture,N=this._matricesTexture.image.data;T.push(!0),B.push(!0);let j=this._geometryCount;this._geometryCount++,Ev.toArray(N,j*16),D.needsUpdate=!0,o.push(i),a.push({start:w?i.indexStart:i.vertexStart,count:-1}),d.push({boxInitialized:!1,box:new ji,sphereInitialized:!1,sphere:new cr});let G=this.geometry.getAttribute(fa);for(let P=0;P<i.vertexCount;P++)G.setX(i.vertexStart+P,j);return G.needsUpdate=!0,this.setGeometryAt(j,e),j}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);let n=this.geometry,i=n.getIndex()!==null,r=n.getIndex(),o=t.getIndex(),a=this._reservedRanges[e];if(i&&o.count>a.indexCount||t.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");let d=a.vertexStart,E=a.vertexCount;for(let D in n.attributes){if(D===fa)continue;let N=t.getAttribute(D),j=n.getAttribute(D);yv(N,j,d);let G=N.itemSize;for(let P=N.count,se=E;P<se;P++){let $=d+P;for(let J=0;J<G;J++)j.setComponent($,J,0)}j.needsUpdate=!0,j.addUpdateRange(d*G,E*G)}if(i){let D=a.indexStart;for(let N=0;N<o.count;N++)r.setX(D+N,d+o.getX(N));for(let N=o.count,j=a.indexCount;N<j;N++)r.setX(D+N,d);r.needsUpdate=!0,r.addUpdateRange(D,a.indexCount)}let w=this._bounds[e];t.boundingBox!==null?(w.box.copy(t.boundingBox),w.boxInitialized=!0):w.boxInitialized=!1,t.boundingSphere!==null?(w.sphere.copy(t.boundingSphere),w.sphereInitialized=!0):w.sphereInitialized=!1;let T=this._drawRanges[e],B=t.getAttribute("position");return T.count=i?o.count:B.count,this._visibilityChanged=!0,e}deleteGeometry(e){let t=this._active;return e>=t.length||t[e]===!1?this:(t[e]=!1,this._visibilityChanged=!0,this)}getInstanceCountAt(e){return this._multiDrawInstances===null?null:this._multiDrawInstances[e]}setInstanceCountAt(e,t){return this._multiDrawInstances===null&&(this._multiDrawInstances=new Int32Array(this._maxGeometryCount).fill(1)),this._multiDrawInstances[e]=t,e}getBoundingBoxAt(e,t){if(this._active[e]===!1)return null;let i=this._bounds[e],r=i.box,o=this.geometry;if(i.boxInitialized===!1){r.makeEmpty();let a=o.index,d=o.attributes.position,E=this._drawRanges[e];for(let w=E.start,T=E.start+E.count;w<T;w++){let B=w;a&&(B=a.getX(B)),r.expandByPoint(Oa.fromBufferAttribute(d,B))}i.boxInitialized=!0}return t.copy(r),t}getBoundingSphereAt(e,t){if(this._active[e]===!1)return null;let i=this._bounds[e],r=i.sphere,o=this.geometry;if(i.sphereInitialized===!1){r.makeEmpty(),this.getBoundingBoxAt(e,Wl),Wl.getCenter(r.center);let a=o.index,d=o.attributes.position,E=this._drawRanges[e],w=0;for(let T=E.start,B=E.start+E.count;T<B;T++){let D=T;a&&(D=a.getX(D)),Oa.fromBufferAttribute(d,D),w=Math.max(w,r.center.distanceToSquared(Oa))}r.radius=Math.sqrt(w),i.sphereInitialized=!0}return t.copy(r),t}setMatrixAt(e,t){let n=this._active,i=this._matricesTexture,r=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||n[e]===!1?this:(t.toArray(r,e*16),i.needsUpdate=!0,this)}getMatrixAt(e,t){let n=this._active,i=this._matricesTexture.image.data,r=this._geometryCount;return e>=r||n[e]===!1?null:t.fromArray(i,e*16)}setVisibleAt(e,t){let n=this._visibility,i=this._active,r=this._geometryCount;return e>=r||i[e]===!1||n[e]===t?this:(n[e]=t,this._visibilityChanged=!0,this)}getVisibleAt(e){let t=this._visibility,n=this._active,i=this._geometryCount;return e>=i||n[e]===!1?!1:t[e]}raycast(e,t){let n=this._visibility,i=this._active,r=this._drawRanges,o=this._geometryCount,a=this.matrixWorld,d=this.geometry;Br.material=this.material,Br.geometry.index=d.index,Br.geometry.attributes=d.attributes,Br.geometry.boundingBox===null&&(Br.geometry.boundingBox=new ji),Br.geometry.boundingSphere===null&&(Br.geometry.boundingSphere=new cr);for(let E=0;E<o;E++){if(!n[E]||!i[E])continue;let w=r[E];Br.geometry.setDrawRange(w.start,w.count),this.getMatrixAt(E,Br.matrixWorld).premultiply(a),this.getBoundingBoxAt(E,Br.geometry.boundingBox),this.getBoundingSphereAt(E,Br.geometry.boundingSphere),Br.raycast(e,Kl);for(let T=0,B=Kl.length;T<B;T++){let D=Kl[T];D.object=this,D.batchId=E,t.push(D)}Kl.length=0}Br.material=null,Br.geometry.index=null,Br.geometry.attributes={},Br.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,n,i,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;let o=i.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,d=this._active,E=this._visibility,w=this._multiDrawStarts,T=this._multiDrawCounts,B=this._drawRanges,D=this.perObjectFrustumCulled;D&&(uf.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),ed.setFromProjectionMatrix(uf,e.coordinateSystem));let N=0;if(this.sortObjects){df.copy(this.matrixWorld).invert(),Oa.setFromMatrixPosition(n.matrixWorld).applyMatrix4(df);for(let P=0,se=E.length;P<se;P++)if(E[P]&&d[P]){this.getMatrixAt(P,eo),this.getBoundingSphereAt(P,wo).applyMatrix4(eo);let $=!1;if(D&&($=!ed.intersectsSphere(wo)),!$){let J=Oa.distanceTo(wo.center);td.push(B[P],J)}}let j=td.list,G=this.customSort;G===null?j.sort(r.transparent?gv:mv):G.call(this,j,n);for(let P=0,se=j.length;P<se;P++){let $=j[P];w[N]=$.start*a,T[N]=$.count,N++}td.reset()}else for(let j=0,G=E.length;j<G;j++)if(E[j]&&d[j]){let P=!1;if(D&&(this.getMatrixAt(j,eo),this.getBoundingSphereAt(j,wo).applyMatrix4(eo),P=!ed.intersectsSphere(wo)),!P){let se=B[j];w[N]=se.start*a,T[N]=se.count,N++}}this._multiDrawCount=N,this._visibilityChanged=!1}onBeforeShadow(e,t,n,i,r,o){this.onBeforeRender(e,null,i,r,o)}}class Nr extends Tr{constructor(e){super();this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new qt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}let Xl=new ve,Yl=new ve,pf=new rn,Ua=new hr,ql=new cr,nd=new ve,Af=new ve;class to extends hi{constructor(e=new zn,t=new Nr){super();this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,n=[0];for(let i=1,r=t.count;i<r;i++)Xl.fromBufferAttribute(t,i-1),Yl.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=Xl.distanceTo(Yl);e.setAttribute("lineDistance",new an(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let n=this.geometry,i=this.matrixWorld,r=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),ql.copy(n.boundingSphere),ql.applyMatrix4(i),ql.radius+=r,e.ray.intersectsSphere(ql)===!1)return;pf.copy(i).invert(),Ua.copy(e.ray).applyMatrix4(pf);let a=r/((this.scale.x+this.scale.y+this.scale.z)/3),d=a*a,E=this.isLineSegments?2:1,w=n.index,B=n.attributes.position;if(w!==null){let D=Math.max(0,o.start),N=Math.min(w.count,o.start+o.count);for(let j=D,G=N-1;j<G;j+=E){let P=w.getX(j),se=w.getX(j+1),$=Jl(this,e,Ua,d,P,se);$&&t.push($)}if(this.isLineLoop){let j=w.getX(N-1),G=w.getX(D),P=Jl(this,e,Ua,d,j,G);P&&t.push(P)}}else{let D=Math.max(0,o.start),N=Math.min(B.count,o.start+o.count);for(let j=D,G=N-1;j<G;j+=E){let P=Jl(this,e,Ua,d,j,j+1);P&&t.push(P)}if(this.isLineLoop){let j=Jl(this,e,Ua,d,N-1,D);j&&t.push(j)}}}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=i.length;r<o;r++){let a=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}function Jl(s,e,t,n,i,r){let o=s.geometry.attributes.position;if(Xl.fromBufferAttribute(o,i),Yl.fromBufferAttribute(o,r),t.distanceSqToSegment(Xl,Yl,nd,Af)>n)return;nd.applyMatrix4(s.matrixWorld);let d=e.ray.origin.distanceTo(nd);if(!(d<e.near||d>e.far))return{distance:d,point:Af.clone().applyMatrix4(s.matrixWorld),index:i,face:null,faceIndex:null,object:s}}let mf=new ve,gf=new ve;class ys extends to{constructor(e,t){super(e,t);this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,n=[];for(let i=0,r=t.count;i<r;i+=2)mf.fromBufferAttribute(t,i),gf.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+mf.distanceTo(gf);e.setAttribute("lineDistance",new an(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class vf extends to{constructor(e,t){super(e,t);this.isLineLoop=!0,this.type="LineLoop"}}class id extends Tr{constructor(e){super();this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new qt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Ef=new rn,rd=new hr,Zl=new cr,$l=new ve;class yf extends hi{constructor(e=new zn,t=new id){super();this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let n=this.geometry,i=this.matrixWorld,r=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Zl.copy(n.boundingSphere),Zl.applyMatrix4(i),Zl.radius+=r,e.ray.intersectsSphere(Zl)===!1)return;Ef.copy(i).invert(),rd.copy(e.ray).applyMatrix4(Ef);let a=r/((this.scale.x+this.scale.y+this.scale.z)/3),d=a*a,E=n.index,T=n.attributes.position;if(E!==null){let B=Math.max(0,o.start),D=Math.min(E.count,o.start+o.count);for(let N=B,j=D;N<j;N++){let G=E.getX(N);$l.fromBufferAttribute(T,G),Cf($l,G,d,i,e,t,this)}}else{let B=Math.max(0,o.start),D=Math.min(T.count,o.start+o.count);for(let N=B,j=D;N<j;N++)$l.fromBufferAttribute(T,N),Cf($l,N,d,i,e,t,this)}}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=i.length;r<o;r++){let a=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}}function Cf(s,e,t,n,i,r,o){let a=rd.distanceSqToPoint(s);if(a<t){let d=new ve;rd.closestPointToPoint(s,d),d.applyMatrix4(n);let E=i.ray.origin.distanceTo(d);if(E<i.near||E>i.far)return;r.push({distance:E,distanceToRay:Math.sqrt(a),point:d,index:e,face:null,object:o})}}class Cv extends Li{constructor(e,t,n,i,r,o,a,d,E){super(e,t,n,i,r,o,a,d,E);this.isVideoTexture=!0,this.minFilter=o!==void 0?o:pn,this.magFilter=r!==void 0?r:pn,this.generateMipmaps=!1;let w=this;function T(){w.needsUpdate=!0,e.requestVideoFrameCallback(T)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(T)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class xv extends Li{constructor(e,t){super({width:e,height:t});this.isFramebufferTexture=!0,this.magFilter=Bt,this.minFilter=Bt,this.generateMipmaps=!1,this.needsUpdate=!0}}class ec extends Li{constructor(e,t,n,i,r,o,a,d,E,w,T,B){super(null,o,a,d,E,w,i,r,T,B);this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class bv extends ec{constructor(e,t,n,i,r,o){super(e,t,n,r,o);this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=De}}class _v extends ec{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,z);this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class wv extends Li{constructor(e,t,n,i,r,o,a,d,E){super(e,t,n,i,r,o,a,d,E);this.isCanvasTexture=!0,this.needsUpdate=!0}}class us{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],n,i=this.getPoint(0),r=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),r+=n.distanceTo(i),t.push(r),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let n=this.getLengths(),i=0,r=n.length,o;t?o=t:o=e*n[r-1];let a=0,d=r-1,E;for(;a<=d;)if(i=Math.floor(a+(d-a)/2),E=n[i]-o,E<0)a=i+1;else if(E>0)d=i-1;else{d=i;break}if(i=d,n[i]===o)return i/(r-1);let w=n[i],B=n[i+1]-w,D=(o-w)/B;return(i+D)/(r-1)}getTangent(e,t){let n=1e-4,i=e-n,r=e+n;i<0&&(i=0),r>1&&(r=1);let o=this.getPoint(i),a=this.getPoint(r),d=t||(o.isVector2?new ht:new ve);return d.copy(a).sub(o).normalize(),d}getTangentAt(e,t){let n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){let n=new ve,i=[],r=[],o=[],a=new ve,d=new rn;for(let D=0;D<=e;D++){let N=D/e;i[D]=this.getTangentAt(N,new ve)}r[0]=new ve,o[0]=new ve;let E=Number.MAX_VALUE,w=Math.abs(i[0].x),T=Math.abs(i[0].y),B=Math.abs(i[0].z);w<=E&&(E=w,n.set(1,0,0)),T<=E&&(E=T,n.set(0,1,0)),B<=E&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],a),o[0].crossVectors(i[0],r[0]);for(let D=1;D<=e;D++){if(r[D]=r[D-1].clone(),o[D]=o[D-1].clone(),a.crossVectors(i[D-1],i[D]),a.length()>Number.EPSILON){a.normalize();let N=Math.acos(Vi(i[D-1].dot(i[D]),-1,1));r[D].applyMatrix4(d.makeRotationAxis(a,N))}o[D].crossVectors(i[D],r[D])}if(t===!0){let D=Math.acos(Vi(r[0].dot(r[e]),-1,1));D/=e,i[0].dot(a.crossVectors(r[0],r[e]))>0&&(D=-D);for(let N=1;N<=e;N++)r[N].applyMatrix4(d.makeRotationAxis(i[N],D*N)),o[N].crossVectors(i[N],r[N])}return{tangents:i,normals:r,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class tc extends us{constructor(e=0,t=0,n=1,i=1,r=0,o=Math.PI*2,a=!1,d=0){super();this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=a,this.aRotation=d}getPoint(e,t=new ht){let n=t,i=Math.PI*2,r=this.aEndAngle-this.aStartAngle,o=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(o?r=0:r=i),this.aClockwise===!0&&!o&&(r===i?r=-i:r=r-i);let a=this.aStartAngle+e*r,d=this.aX+this.xRadius*Math.cos(a),E=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let w=Math.cos(this.aRotation),T=Math.sin(this.aRotation),B=d-this.aX,D=E-this.aY;d=B*w-D*T+this.aX,E=B*T+D*w+this.aY}return n.set(d,E)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class xf extends tc{constructor(e,t,n,i,r,o){super(e,t,n,n,i,r,o);this.isArcCurve=!0,this.type="ArcCurve"}}function sd(){let s=0,e=0,t=0,n=0;function i(r,o,a,d){s=r,e=a,t=-3*r+3*o-2*a-d,n=2*r-2*o+a+d}return{initCatmullRom:function(r,o,a,d,E){i(o,a,E*(a-r),E*(d-o))},initNonuniformCatmullRom:function(r,o,a,d,E,w,T){let B=(o-r)/E-(a-r)/(E+w)+(a-o)/w,D=(a-o)/w-(d-o)/(w+T)+(d-a)/T;B*=w,D*=w,i(o,a,B,D)},calc:function(r){let o=r*r,a=o*r;return s+e*r+t*o+n*a}}}let nc=new ve,od=new sd,ad=new sd,ld=new sd;class bf extends us{constructor(e=[],t=!1,n="centripetal",i=.5){super();this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new ve){let n=t,i=this.points,r=i.length,o=(r-(this.closed?0:1))*e,a=Math.floor(o),d=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/r)+1)*r:d===0&&a===r-1&&(a=r-2,d=1);let E,w;this.closed||a>0?E=i[(a-1)%r]:(nc.subVectors(i[0],i[1]).add(i[0]),E=nc);let T=i[a%r],B=i[(a+1)%r];if(this.closed||a+2<r?w=i[(a+2)%r]:(nc.subVectors(i[r-1],i[r-2]).add(i[r-1]),w=nc),this.curveType==="centripetal"||this.curveType==="chordal"){let D=this.curveType==="chordal"?.5:.25,N=Math.pow(E.distanceToSquared(T),D),j=Math.pow(T.distanceToSquared(B),D),G=Math.pow(B.distanceToSquared(w),D);j<1e-4&&(j=1),N<1e-4&&(N=j),G<1e-4&&(G=j),od.initNonuniformCatmullRom(E.x,T.x,B.x,w.x,N,j,G),ad.initNonuniformCatmullRom(E.y,T.y,B.y,w.y,N,j,G),ld.initNonuniformCatmullRom(E.z,T.z,B.z,w.z,N,j,G)}else this.curveType==="catmullrom"&&(od.initCatmullRom(E.x,T.x,B.x,w.x,this.tension),ad.initCatmullRom(E.y,T.y,B.y,w.y,this.tension),ld.initCatmullRom(E.z,T.z,B.z,w.z,this.tension));return n.set(od.calc(d),ad.calc(d),ld.calc(d)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let i=e.points[t];this.points.push(new ve().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function _f(s,e,t,n,i){let r=(n-e)*.5,o=(i-t)*.5,a=s*s,d=s*a;return(2*t-2*n+r+o)*d+(-3*t+3*n-2*r-o)*a+r*s+t}function Mv(s,e){let t=1-s;return t*t*e}function Sv(s,e){return 2*(1-s)*s*e}function Iv(s,e){return s*s*e}function Na(s,e,t,n){return Mv(s,e)+Sv(s,t)+Iv(s,n)}function Tv(s,e){let t=1-s;return t*t*t*e}function Bv(s,e){let t=1-s;return 3*t*t*s*e}function Rv(s,e){return 3*(1-s)*s*s*e}function Lv(s,e){return s*s*s*e}function ka(s,e,t,n,i){return Tv(s,e)+Bv(s,t)+Rv(s,n)+Lv(s,i)}class cd extends us{constructor(e=new ht,t=new ht,n=new ht,i=new ht){super();this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new ht){let n=t,i=this.v0,r=this.v1,o=this.v2,a=this.v3;return n.set(ka(e,i.x,r.x,o.x,a.x),ka(e,i.y,r.y,o.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class wf extends us{constructor(e=new ve,t=new ve,n=new ve,i=new ve){super();this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new ve){let n=t,i=this.v0,r=this.v1,o=this.v2,a=this.v3;return n.set(ka(e,i.x,r.x,o.x,a.x),ka(e,i.y,r.y,o.y,a.y),ka(e,i.z,r.z,o.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class hd extends us{constructor(e=new ht,t=new ht){super();this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ht){let n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ht){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Mf extends us{constructor(e=new ve,t=new ve){super();this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ve){let n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ve){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class dd extends us{constructor(e=new ht,t=new ht,n=new ht){super();this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ht){let n=t,i=this.v0,r=this.v1,o=this.v2;return n.set(Na(e,i.x,r.x,o.x),Na(e,i.y,r.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ud extends us{constructor(e=new ve,t=new ve,n=new ve){super();this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ve){let n=t,i=this.v0,r=this.v1,o=this.v2;return n.set(Na(e,i.x,r.x,o.x),Na(e,i.y,r.y,o.y),Na(e,i.z,r.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class fd extends us{constructor(e=[]){super();this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ht){let n=t,i=this.points,r=(i.length-1)*e,o=Math.floor(r),a=r-o,d=i[o===0?o:o-1],E=i[o],w=i[o>i.length-2?i.length-1:o+1],T=i[o>i.length-3?i.length-1:o+2];return n.set(_f(a,d.x,E.x,w.x,T.x),_f(a,d.y,E.y,w.y,T.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let i=e.points[t];this.points.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let i=e.points[t];this.points.push(new ht().fromArray(i))}return this}}var ic=Object.freeze({__proto__:null,ArcCurve:xf,CatmullRomCurve3:bf,CubicBezierCurve:cd,CubicBezierCurve3:wf,EllipseCurve:tc,LineCurve:hd,LineCurve3:Mf,QuadraticBezierCurve:dd,QuadraticBezierCurve3:ud,SplineCurve:fd});class Sf extends us{constructor(){super();this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){let n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new ic[n](t,e))}return this}getPoint(e,t){let n=e*this.getLength(),i=this.getCurveLengths(),r=0;for(;r<i.length;){if(i[r]>=n){let o=i[r]-n,a=this.curves[r],d=a.getLength(),E=d===0?0:1-o/d;return a.getPointAt(E,t)}r++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],n;for(let i=0,r=this.curves;i<r.length;i++){let o=r[i],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,d=o.getPoints(a);for(let E=0;E<d.length;E++){let w=d[E];n&&n.equals(w)||(t.push(w),n=w)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){let i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let i=e.curves[t];this.curves.push(new ic[i.type]().fromJSON(i))}return this}}class Ga extends Sf{constructor(e){super();this.type="Path",this.currentPoint=new ht,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let n=new hd(this.currentPoint.clone(),new ht(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){let r=new dd(this.currentPoint.clone(),new ht(e,t),new ht(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,r,o){let a=new cd(this.currentPoint.clone(),new ht(e,t),new ht(n,i),new ht(r,o));return this.curves.push(a),this.currentPoint.set(r,o),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),n=new fd(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,r,o){let a=this.currentPoint.x,d=this.currentPoint.y;return this.absarc(e+a,t+d,n,i,r,o),this}absarc(e,t,n,i,r,o){return this.absellipse(e,t,n,n,i,r,o),this}ellipse(e,t,n,i,r,o,a,d){let E=this.currentPoint.x,w=this.currentPoint.y;return this.absellipse(e+E,t+w,n,i,r,o,a,d),this}absellipse(e,t,n,i,r,o,a,d){let E=new tc(e,t,n,i,r,o,a,d);if(this.curves.length>0){let T=E.getPoint(0);T.equals(this.currentPoint)||this.lineTo(T.x,T.y)}this.curves.push(E);let w=E.getPoint(1);return this.currentPoint.copy(w),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Qa extends zn{constructor(e=[new ht(0,-.5),new ht(.5,0),new ht(0,.5)],t=12,n=0,i=Math.PI*2){super();this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=Vi(i,0,Math.PI*2);let r=[],o=[],a=[],d=[],E=[],w=1/t,T=new ve,B=new ht,D=new ve,N=new ve,j=new ve,G=0,P=0;for(let se=0;se<=e.length-1;se++)switch(se){case 0:G=e[se+1].x-e[se].x,P=e[se+1].y-e[se].y,D.x=P*1,D.y=-G,D.z=P*0,j.copy(D),D.normalize(),d.push(D.x,D.y,D.z);break;case e.length-1:d.push(j.x,j.y,j.z);break;default:G=e[se+1].x-e[se].x,P=e[se+1].y-e[se].y,D.x=P*1,D.y=-G,D.z=P*0,N.copy(D),D.x+=j.x,D.y+=j.y,D.z+=j.z,D.normalize(),d.push(D.x,D.y,D.z),j.copy(N)}for(let se=0;se<=t;se++){let $=n+se*w*i,J=Math.sin($),Be=Math.cos($);for(let ge=0;ge<=e.length-1;ge++){T.x=e[ge].x*J,T.y=e[ge].y,T.z=e[ge].x*Be,o.push(T.x,T.y,T.z),B.x=se/t,B.y=ge/(e.length-1),a.push(B.x,B.y);let we=d[3*ge+0]*J,Te=d[3*ge+1],de=d[3*ge+0]*Be;E.push(we,Te,de)}}for(let se=0;se<t;se++)for(let $=0;$<e.length-1;$++){let J=$+se*e.length,Be=J,ge=J+e.length,we=J+e.length+1,Te=J+1;r.push(Be,ge,Te),r.push(we,Te,ge)}this.setIndex(r),this.setAttribute("position",new an(o,3)),this.setAttribute("uv",new an(a,2)),this.setAttribute("normal",new an(E,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Qa(e.points,e.segments,e.phiStart,e.phiLength)}}class rc extends Qa{constructor(e=1,t=1,n=4,i=8){let r=new Ga;r.absarc(0,-t/2,e,Math.PI*1.5,0),r.absarc(0,t/2,e,0,Math.PI*.5);super(r.getPoints(n),i);this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:n,radialSegments:i}}static fromJSON(e){return new rc(e.radius,e.length,e.capSegments,e.radialSegments)}}class sc extends zn{constructor(e=1,t=32,n=0,i=Math.PI*2){super();this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);let r=[],o=[],a=[],d=[],E=new ve,w=new ht;o.push(0,0,0),a.push(0,0,1),d.push(.5,.5);for(let T=0,B=3;T<=t;T++,B+=3){let D=n+T/t*i;E.x=e*Math.cos(D),E.y=e*Math.sin(D),o.push(E.x,E.y,E.z),a.push(0,0,1),w.x=(o[B]/e+1)/2,w.y=(o[B+1]/e+1)/2,d.push(w.x,w.y)}for(let T=1;T<=t;T++)r.push(T,T+1,0);this.setIndex(r),this.setAttribute("position",new an(o,3)),this.setAttribute("normal",new an(a,3)),this.setAttribute("uv",new an(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sc(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class pa extends zn{constructor(e=1,t=1,n=1,i=32,r=1,o=!1,a=0,d=Math.PI*2){super();this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:d};let E=this;i=Math.floor(i),r=Math.floor(r);let w=[],T=[],B=[],D=[],N=0,j=[],G=n/2,P=0;se(),o===!1&&(e>0&&$(!0),t>0&&$(!1)),this.setIndex(w),this.setAttribute("position",new an(T,3)),this.setAttribute("normal",new an(B,3)),this.setAttribute("uv",new an(D,2));function se(){let J=new ve,Be=new ve,ge=0,we=(t-e)/n;for(let Te=0;Te<=r;Te++){let de=[],le=Te/r,Ie=le*(t-e)+e;for(let ke=0;ke<=i;ke++){let Fe=ke/i,Ge=Fe*d+a,qe=Math.sin(Ge),ct=Math.cos(Ge);Be.x=Ie*qe,Be.y=-le*n+G,Be.z=Ie*ct,T.push(Be.x,Be.y,Be.z),J.set(qe,we,ct).normalize(),B.push(J.x,J.y,J.z),D.push(Fe,1-le),de.push(N++)}j.push(de)}for(let Te=0;Te<i;Te++)for(let de=0;de<r;de++){let le=j[de][Te],Ie=j[de+1][Te],ke=j[de+1][Te+1],Fe=j[de][Te+1];w.push(le,Ie,Fe),w.push(Ie,ke,Fe),ge+=6}E.addGroup(P,ge,0),P+=ge}function $(J){let Be=N,ge=new ht,we=new ve,Te=0,de=J===!0?e:t,le=J===!0?1:-1;for(let ke=1;ke<=i;ke++)T.push(0,G*le,0),B.push(0,le,0),D.push(.5,.5),N++;let Ie=N;for(let ke=0;ke<=i;ke++){let Ge=ke/i*d+a,qe=Math.cos(Ge),ct=Math.sin(Ge);we.x=de*ct,we.y=G*le,we.z=de*qe,T.push(we.x,we.y,we.z),B.push(0,le,0),ge.x=qe*.5+.5,ge.y=ct*.5*le+.5,D.push(ge.x,ge.y),N++}for(let ke=0;ke<i;ke++){let Fe=Be+ke,Ge=Ie+ke;J===!0?w.push(Ge,Ge+1,Fe):w.push(Ge+1,Ge,Fe),Te+=3}E.addGroup(P,Te,J===!0?1:2),P+=Te}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pa(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class oc extends pa{constructor(e=1,t=1,n=32,i=1,r=!1,o=0,a=Math.PI*2){super(0,e,t,n,i,r,o,a);this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:o,thetaLength:a}}static fromJSON(e){return new oc(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class no extends zn{constructor(e=[],t=[],n=1,i=0){super();this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};let r=[],o=[];a(i),E(n),w(),this.setAttribute("position",new an(r,3)),this.setAttribute("normal",new an(r.slice(),3)),this.setAttribute("uv",new an(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(se){let $=new ve,J=new ve,Be=new ve;for(let ge=0;ge<t.length;ge+=3)D(t[ge+0],$),D(t[ge+1],J),D(t[ge+2],Be),d($,J,Be,se)}function d(se,$,J,Be){let ge=Be+1,we=[];for(let Te=0;Te<=ge;Te++){we[Te]=[];let de=se.clone().lerp(J,Te/ge),le=$.clone().lerp(J,Te/ge),Ie=ge-Te;for(let ke=0;ke<=Ie;ke++)ke===0&&Te===ge?we[Te][ke]=de:we[Te][ke]=de.clone().lerp(le,ke/Ie)}for(let Te=0;Te<ge;Te++)for(let de=0;de<2*(ge-Te)-1;de++){let le=Math.floor(de/2);de%2==0?(B(we[Te][le+1]),B(we[Te+1][le]),B(we[Te][le])):(B(we[Te][le+1]),B(we[Te+1][le+1]),B(we[Te+1][le]))}}function E(se){let $=new ve;for(let J=0;J<r.length;J+=3)$.x=r[J+0],$.y=r[J+1],$.z=r[J+2],$.normalize().multiplyScalar(se),r[J+0]=$.x,r[J+1]=$.y,r[J+2]=$.z}function w(){let se=new ve;for(let $=0;$<r.length;$+=3){se.x=r[$+0],se.y=r[$+1],se.z=r[$+2];let J=G(se)/2/Math.PI+.5,Be=P(se)/Math.PI+.5;o.push(J,1-Be)}N(),T()}function T(){for(let se=0;se<o.length;se+=6){let $=o[se+0],J=o[se+2],Be=o[se+4],ge=Math.max($,J,Be),we=Math.min($,J,Be);ge>.9&&we<.1&&($<.2&&(o[se+0]+=1),J<.2&&(o[se+2]+=1),Be<.2&&(o[se+4]+=1))}}function B(se){r.push(se.x,se.y,se.z)}function D(se,$){let J=se*3;$.x=e[J+0],$.y=e[J+1],$.z=e[J+2]}function N(){let se=new ve,$=new ve,J=new ve,Be=new ve,ge=new ht,we=new ht,Te=new ht;for(let de=0,le=0;de<r.length;de+=9,le+=6){se.set(r[de+0],r[de+1],r[de+2]),$.set(r[de+3],r[de+4],r[de+5]),J.set(r[de+6],r[de+7],r[de+8]),ge.set(o[le+0],o[le+1]),we.set(o[le+2],o[le+3]),Te.set(o[le+4],o[le+5]),Be.copy(se).add($).add(J).divideScalar(3);let Ie=G(Be);j(ge,le+0,se,Ie),j(we,le+2,$,Ie),j(Te,le+4,J,Ie)}}function j(se,$,J,Be){Be<0&&se.x===1&&(o[$]=se.x-1),J.x===0&&J.z===0&&(o[$]=Be/2/Math.PI+.5)}function G(se){return Math.atan2(se.z,-se.x)}function P(se){return Math.atan2(-se.y,Math.sqrt(se.x*se.x+se.z*se.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new no(e.vertices,e.indices,e.radius,e.details)}}class ac extends no{constructor(e=1,t=0){let n=(1+Math.sqrt(5))/2,i=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,o,e,t);this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ac(e.radius,e.detail)}}let lc=new ve,cc=new ve,pd=new ve,hc=new Jr;class If extends zn{constructor(e=null,t=1){super();if(this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){let i=Math.pow(10,4),r=Math.cos(Ts*t),o=e.getIndex(),a=e.getAttribute("position"),d=o?o.count:a.count,E=[0,0,0],w=["a","b","c"],T=new Array(3),B={},D=[];for(let N=0;N<d;N+=3){o?(E[0]=o.getX(N),E[1]=o.getX(N+1),E[2]=o.getX(N+2)):(E[0]=N,E[1]=N+1,E[2]=N+2);let{a:j,b:G,c:P}=hc;if(j.fromBufferAttribute(a,E[0]),G.fromBufferAttribute(a,E[1]),P.fromBufferAttribute(a,E[2]),hc.getNormal(pd),T[0]=`${Math.round(j.x*i)},${Math.round(j.y*i)},${Math.round(j.z*i)}`,T[1]=`${Math.round(G.x*i)},${Math.round(G.y*i)},${Math.round(G.z*i)}`,T[2]=`${Math.round(P.x*i)},${Math.round(P.y*i)},${Math.round(P.z*i)}`,!(T[0]===T[1]||T[1]===T[2]||T[2]===T[0]))for(let se=0;se<3;se++){let $=(se+1)%3,J=T[se],Be=T[$],ge=hc[w[se]],we=hc[w[$]],Te=`${J}_${Be}`,de=`${Be}_${J}`;de in B&&B[de]?(pd.dot(B[de].normal)<=r&&(D.push(ge.x,ge.y,ge.z),D.push(we.x,we.y,we.z)),B[de]=null):Te in B||(B[Te]={index0:E[se],index1:E[$],normal:pd.clone()})}}for(let N in B)if(B[N]){let{index0:j,index1:G}=B[N];lc.fromBufferAttribute(a,j),cc.fromBufferAttribute(a,G),D.push(lc.x,lc.y,lc.z),D.push(cc.x,cc.y,cc.z)}this.setAttribute("position",new an(D,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Mo extends Ga{constructor(e){super(e);this.uuid=Pr(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){let i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let i=e.holes[t];this.holes.push(new Ga().fromJSON(i))}return this}}let Dv={triangulate:function(s,e,t=2){let n=e&&e.length,i=n?e[0]*t:s.length,r=Tf(s,0,i,t,!0),o=[];if(!r||r.next===r.prev)return o;let a,d,E,w,T,B,D;if(n&&(r=Nv(s,e,r,t)),s.length>80*t){a=E=s[0],d=w=s[1];for(let N=t;N<i;N+=t)T=s[N],B=s[N+1],T<a&&(a=T),B<d&&(d=B),T>E&&(E=T),B>w&&(w=B);D=Math.max(E-a,w-d),D=D!==0?32767/D:0}return Va(r,o,t,a,d,D,0),o}};function Tf(s,e,t,n,i){let r,o;if(i===Yv(s,e,t,n)>0)for(r=e;r<t;r+=n)o=Lf(r,s[r],s[r+1],o);else for(r=t-n;r>=e;r-=n)o=Lf(r,s[r],s[r+1],o);return o&&dc(o,o.next)&&(za(o),o=o.next),o}function So(s,e){if(!s)return s;e||(e=s);let t=s,n;do if(n=!1,!t.steiner&&(dc(t,t.next)||Wi(t.prev,t,t.next)===0)){if(za(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function Va(s,e,t,n,i,r,o){if(!s)return;!o&&r&&Hv(s,n,i,r);let a=s,d,E;for(;s.prev!==s.next;){if(d=s.prev,E=s.next,r?Fv(s,n,i,r):Pv(s)){e.push(d.i/t|0),e.push(s.i/t|0),e.push(E.i/t|0),za(s),s=E.next,a=E.next;continue}if(s=E,s===a){o?o===1?(s=Ov(So(s),e,t),Va(s,e,t,n,i,r,2)):o===2&&Uv(s,e,t,n,i,r):Va(So(s),e,t,n,i,r,1);break}}}function Pv(s){let e=s.prev,t=s,n=s.next;if(Wi(e,t,n)>=0)return!1;let i=e.x,r=t.x,o=n.x,a=e.y,d=t.y,E=n.y,w=i<r?i<o?i:o:r<o?r:o,T=a<d?a<E?a:E:d<E?d:E,B=i>r?i>o?i:o:r>o?r:o,D=a>d?a>E?a:E:d>E?d:E,N=n.next;for(;N!==e;){if(N.x>=w&&N.x<=B&&N.y>=T&&N.y<=D&&Aa(i,a,r,d,o,E,N.x,N.y)&&Wi(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function Fv(s,e,t,n){let i=s.prev,r=s,o=s.next;if(Wi(i,r,o)>=0)return!1;let a=i.x,d=r.x,E=o.x,w=i.y,T=r.y,B=o.y,D=a<d?a<E?a:E:d<E?d:E,N=w<T?w<B?w:B:T<B?T:B,j=a>d?a>E?a:E:d>E?d:E,G=w>T?w>B?w:B:T>B?T:B,P=Ad(D,N,e,t,n),se=Ad(j,G,e,t,n),$=s.prevZ,J=s.nextZ;for(;$&&$.z>=P&&J&&J.z<=se;){if($.x>=D&&$.x<=j&&$.y>=N&&$.y<=G&&$!==i&&$!==o&&Aa(a,w,d,T,E,B,$.x,$.y)&&Wi($.prev,$,$.next)>=0||($=$.prevZ,J.x>=D&&J.x<=j&&J.y>=N&&J.y<=G&&J!==i&&J!==o&&Aa(a,w,d,T,E,B,J.x,J.y)&&Wi(J.prev,J,J.next)>=0))return!1;J=J.nextZ}for(;$&&$.z>=P;){if($.x>=D&&$.x<=j&&$.y>=N&&$.y<=G&&$!==i&&$!==o&&Aa(a,w,d,T,E,B,$.x,$.y)&&Wi($.prev,$,$.next)>=0)return!1;$=$.prevZ}for(;J&&J.z<=se;){if(J.x>=D&&J.x<=j&&J.y>=N&&J.y<=G&&J!==i&&J!==o&&Aa(a,w,d,T,E,B,J.x,J.y)&&Wi(J.prev,J,J.next)>=0)return!1;J=J.nextZ}return!0}function Ov(s,e,t){let n=s;do{let i=n.prev,r=n.next.next;!dc(i,r)&&Bf(i,n,n.next,r)&&Ha(i,r)&&Ha(r,i)&&(e.push(i.i/t|0),e.push(n.i/t|0),e.push(r.i/t|0),za(n),za(n.next),n=s=r),n=n.next}while(n!==s);return So(n)}function Uv(s,e,t,n,i,r){let o=s;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Wv(o,a)){let d=Rf(o,a);o=So(o,o.next),d=So(d,d.next),Va(o,e,t,n,i,r,0),Va(d,e,t,n,i,r,0);return}a=a.next}o=o.next}while(o!==s)}function Nv(s,e,t,n){let i=[],r,o,a,d,E;for(r=0,o=e.length;r<o;r++)a=e[r]*n,d=r<o-1?e[r+1]*n:s.length,E=Tf(s,a,d,n,!1),E===E.next&&(E.steiner=!0),i.push(jv(E));for(i.sort(kv),r=0;r<i.length;r++)t=Gv(i[r],t);return t}function kv(s,e){return s.x-e.x}function Gv(s,e){let t=Qv(s,e);if(!t)return e;let n=Rf(t,s);return So(n,n.next),So(t,t.next)}function Qv(s,e){let t=e,n=-1/0,i,r=s.x,o=s.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){let B=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(B<=r&&B>n&&(n=B,i=t.x<t.next.x?t:t.next,B===r))return i}t=t.next}while(t!==e);if(!i)return null;let a=i,d=i.x,E=i.y,w=1/0,T;t=i;do r>=t.x&&t.x>=d&&r!==t.x&&Aa(o<E?r:n,o,d,E,o<E?n:r,o,t.x,t.y)&&(T=Math.abs(o-t.y)/(r-t.x),Ha(t,s)&&(T<w||T===w&&(t.x>i.x||t.x===i.x&&Vv(i,t)))&&(i=t,w=T)),t=t.next;while(t!==a);return i}function Vv(s,e){return Wi(s.prev,s,e.prev)<0&&Wi(e.next,s,s.next)<0}function Hv(s,e,t,n){let i=s;do i.z===0&&(i.z=Ad(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==s);i.prevZ.nextZ=null,i.prevZ=null,zv(i)}function zv(s){let e,t,n,i,r,o,a,d,E=1;do{for(t=s,s=null,r=null,o=0;t;){for(o++,n=t,a=0,e=0;e<E&&(a++,n=n.nextZ,!!n);e++);for(d=E;a>0||d>0&&n;)a!==0&&(d===0||!n||t.z<=n.z)?(i=t,t=t.nextZ,a--):(i=n,n=n.nextZ,d--),r?r.nextZ=i:s=i,i.prevZ=r,r=i;t=n}r.nextZ=null,E*=2}while(o>1);return s}function Ad(s,e,t,n,i){return s=(s-t)*i|0,e=(e-n)*i|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s|e<<1}function jv(s){let e=s,t=s;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==s);return t}function Aa(s,e,t,n,i,r,o,a){return(i-o)*(e-a)>=(s-o)*(r-a)&&(s-o)*(n-a)>=(t-o)*(e-a)&&(t-o)*(r-a)>=(i-o)*(n-a)}function Wv(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!Kv(s,e)&&(Ha(s,e)&&Ha(e,s)&&Xv(s,e)&&(Wi(s.prev,s,e.prev)||Wi(s,e.prev,e))||dc(s,e)&&Wi(s.prev,s,s.next)>0&&Wi(e.prev,e,e.next)>0)}function Wi(s,e,t){return(e.y-s.y)*(t.x-e.x)-(e.x-s.x)*(t.y-e.y)}function dc(s,e){return s.x===e.x&&s.y===e.y}function Bf(s,e,t,n){let i=fc(Wi(s,e,t)),r=fc(Wi(s,e,n)),o=fc(Wi(t,n,s)),a=fc(Wi(t,n,e));return!!(i!==r&&o!==a||i===0&&uc(s,t,e)||r===0&&uc(s,n,e)||o===0&&uc(t,s,n)||a===0&&uc(t,e,n))}function uc(s,e,t){return e.x<=Math.max(s.x,t.x)&&e.x>=Math.min(s.x,t.x)&&e.y<=Math.max(s.y,t.y)&&e.y>=Math.min(s.y,t.y)}function fc(s){return s>0?1:s<0?-1:0}function Kv(s,e){let t=s;do{if(t.i!==s.i&&t.next.i!==s.i&&t.i!==e.i&&t.next.i!==e.i&&Bf(t,t.next,s,e))return!0;t=t.next}while(t!==s);return!1}function Ha(s,e){return Wi(s.prev,s,s.next)<0?Wi(s,e,s.next)>=0&&Wi(s,s.prev,e)>=0:Wi(s,e,s.prev)<0||Wi(s,s.next,e)<0}function Xv(s,e){let t=s,n=!1,i=(s.x+e.x)/2,r=(s.y+e.y)/2;do t.y>r!=t.next.y>r&&t.next.y!==t.y&&i<(t.next.x-t.x)*(r-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==s);return n}function Rf(s,e){let t=new md(s.i,s.x,s.y),n=new md(e.i,e.x,e.y),i=s.next,r=e.prev;return s.next=e,e.prev=s,t.next=i,i.prev=t,n.next=t,t.prev=n,r.next=n,n.prev=r,n}function Lf(s,e,t,n){let i=new md(s,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function za(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function md(s,e,t){this.i=s,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Yv(s,e,t,n){let i=0;for(let r=e,o=t-n;r<t;r+=n)i+=(s[o]-s[r])*(s[r+1]+s[o+1]),o=r;return i}class Cs{static area(e){let t=e.length,n=0;for(let i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return n*.5}static isClockWise(e){return Cs.area(e)<0}static triangulateShape(e,t){let n=[],i=[],r=[];Df(e),Pf(n,e);let o=e.length;t.forEach(Df);for(let d=0;d<t.length;d++)i.push(o),o+=t[d].length,Pf(n,t[d]);let a=Dv.triangulate(n,i);for(let d=0;d<a.length;d+=3)r.push(a.slice(d,d+3));return r}}function Df(s){let e=s.length;e>2&&s[e-1].equals(s[0])&&s.pop()}function Pf(s,e){for(let t=0;t<e.length;t++)s.push(e[t].x),s.push(e[t].y)}class pc extends zn{constructor(e=new Mo([new ht(.5,.5),new ht(-.5,.5),new ht(-.5,-.5),new ht(.5,-.5)]),t={}){super();this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let n=this,i=[],r=[];for(let a=0,d=e.length;a<d;a++){let E=e[a];o(E)}this.setAttribute("position",new an(i,3)),this.setAttribute("uv",new an(r,2)),this.computeVertexNormals();function o(a){let d=[],E=t.curveSegments!==void 0?t.curveSegments:12,w=t.steps!==void 0?t.steps:1,T=t.depth!==void 0?t.depth:1,B=t.bevelEnabled!==void 0?t.bevelEnabled:!0,D=t.bevelThickness!==void 0?t.bevelThickness:.2,N=t.bevelSize!==void 0?t.bevelSize:D-.1,j=t.bevelOffset!==void 0?t.bevelOffset:0,G=t.bevelSegments!==void 0?t.bevelSegments:3,P=t.extrudePath,se=t.UVGenerator!==void 0?t.UVGenerator:qv,$,J=!1,Be,ge,we,Te;P&&($=P.getSpacedPoints(w),J=!0,B=!1,Be=P.computeFrenetFrames(w,!1),ge=new ve,we=new ve,Te=new ve),B||(G=0,D=0,N=0,j=0);let de=a.extractPoints(E),le=de.shape,Ie=de.holes;if(!Cs.isClockWise(le)){le=le.reverse();for(let ft=0,rt=Ie.length;ft<rt;ft++){let St=Ie[ft];Cs.isClockWise(St)&&(Ie[ft]=St.reverse())}}let Fe=Cs.triangulateShape(le,Ie),Ge=le;for(let ft=0,rt=Ie.length;ft<rt;ft++){let St=Ie[ft];le=le.concat(St)}function qe(ft,rt,St){return rt||console.error("THREE.ExtrudeGeometry: vec does not exist"),ft.clone().addScaledVector(rt,St)}let ct=le.length,Pt=Fe.length;function Ze(ft,rt,St){let wt,xt,Vt,Yt=ft.x-rt.x,Tn=ft.y-rt.y,Pn=St.x-ft.x,ui=St.y-ft.y,Ki=Yt*Yt+Tn*Tn,Pi=Yt*ui-Tn*Pn;if(Math.abs(Pi)>Number.EPSILON){let Se=Math.sqrt(Ki),ce=Math.sqrt(Pn*Pn+ui*ui),tt=rt.x-Tn/Se,dt=rt.y+Yt/Se,gt=St.x-ui/ce,At=St.y+Pn/ce,cn=((gt-tt)*ui-(At-dt)*Pn)/(Yt*ui-Tn*Pn);wt=tt+Yt*cn-ft.x,xt=dt+Tn*cn-ft.y;let Ft=wt*wt+xt*xt;if(Ft<=2)return new ht(wt,xt);Vt=Math.sqrt(Ft/2)}else{let Se=!1;Yt>Number.EPSILON?Pn>Number.EPSILON&&(Se=!0):Yt<-Number.EPSILON?Pn<-Number.EPSILON&&(Se=!0):Math.sign(Tn)===Math.sign(ui)&&(Se=!0),Se?(wt=-Tn,xt=Yt,Vt=Math.sqrt(Ki)):(wt=Yt,xt=Tn,Vt=Math.sqrt(Ki/2))}return new ht(wt/Vt,xt/Vt)}let It=[];for(let ft=0,rt=Ge.length,St=rt-1,wt=ft+1;ft<rt;ft++,St++,wt++)St===rt&&(St=0),wt===rt&&(wt=0),It[ft]=Ze(Ge[ft],Ge[St],Ge[wt]);let Rt=[],nn,jn=It.concat();for(let ft=0,rt=Ie.length;ft<rt;ft++){let St=Ie[ft];nn=[];for(let wt=0,xt=St.length,Vt=xt-1,Yt=wt+1;wt<xt;wt++,Vt++,Yt++)Vt===xt&&(Vt=0),Yt===xt&&(Yt=0),nn[wt]=Ze(St[wt],St[Vt],St[Yt]);Rt.push(nn),jn=jn.concat(nn)}for(let ft=0;ft<G;ft++){let rt=ft/G,St=D*Math.cos(rt*Math.PI/2),wt=N*Math.sin(rt*Math.PI/2)+j;for(let xt=0,Vt=Ge.length;xt<Vt;xt++){let Yt=qe(Ge[xt],It[xt],wt);sn(Yt.x,Yt.y,-St)}for(let xt=0,Vt=Ie.length;xt<Vt;xt++){let Yt=Ie[xt];nn=Rt[xt];for(let Tn=0,Pn=Yt.length;Tn<Pn;Tn++){let ui=qe(Yt[Tn],nn[Tn],wt);sn(ui.x,ui.y,-St)}}}let mi=N+j;for(let ft=0;ft<ct;ft++){let rt=B?qe(le[ft],jn[ft],mi):le[ft];J?(we.copy(Be.normals[0]).multiplyScalar(rt.x),ge.copy(Be.binormals[0]).multiplyScalar(rt.y),Te.copy($[0]).add(we).add(ge),sn(Te.x,Te.y,Te.z)):sn(rt.x,rt.y,0)}for(let ft=1;ft<=w;ft++)for(let rt=0;rt<ct;rt++){let St=B?qe(le[rt],jn[rt],mi):le[rt];J?(we.copy(Be.normals[ft]).multiplyScalar(St.x),ge.copy(Be.binormals[ft]).multiplyScalar(St.y),Te.copy($[ft]).add(we).add(ge),sn(Te.x,Te.y,Te.z)):sn(St.x,St.y,T/w*ft)}for(let ft=G-1;ft>=0;ft--){let rt=ft/G,St=D*Math.cos(rt*Math.PI/2),wt=N*Math.sin(rt*Math.PI/2)+j;for(let xt=0,Vt=Ge.length;xt<Vt;xt++){let Yt=qe(Ge[xt],It[xt],wt);sn(Yt.x,Yt.y,T+St)}for(let xt=0,Vt=Ie.length;xt<Vt;xt++){let Yt=Ie[xt];nn=Rt[xt];for(let Tn=0,Pn=Yt.length;Tn<Pn;Tn++){let ui=qe(Yt[Tn],nn[Tn],wt);J?sn(ui.x,ui.y+$[w-1].y,$[w-1].x+St):sn(ui.x,ui.y,T+St)}}}Di(),di();function Di(){let ft=i.length/3;if(B){let rt=0,St=ct*rt;for(let wt=0;wt<Pt;wt++){let xt=Fe[wt];ut(xt[2]+St,xt[1]+St,xt[0]+St)}rt=w+G*2,St=ct*rt;for(let wt=0;wt<Pt;wt++){let xt=Fe[wt];ut(xt[0]+St,xt[1]+St,xt[2]+St)}}else{for(let rt=0;rt<Pt;rt++){let St=Fe[rt];ut(St[2],St[1],St[0])}for(let rt=0;rt<Pt;rt++){let St=Fe[rt];ut(St[0]+ct*w,St[1]+ct*w,St[2]+ct*w)}}n.addGroup(ft,i.length/3-ft,0)}function di(){let ft=i.length/3,rt=0;Ti(Ge,rt),rt+=Ge.length;for(let St=0,wt=Ie.length;St<wt;St++){let xt=Ie[St];Ti(xt,rt),rt+=xt.length}n.addGroup(ft,i.length/3-ft,1)}function Ti(ft,rt){let St=ft.length;for(;--St>=0;){let wt=St,xt=St-1;xt<0&&(xt=ft.length-1);for(let Vt=0,Yt=w+G*2;Vt<Yt;Vt++){let Tn=ct*Vt,Pn=ct*(Vt+1),ui=rt+wt+Tn,Ki=rt+xt+Tn,Pi=rt+xt+Pn,Se=rt+wt+Pn;Ot(ui,Ki,Pi,Se)}}}function sn(ft,rt,St){d.push(ft),d.push(rt),d.push(St)}function ut(ft,rt,St){Nt(ft),Nt(rt),Nt(St);let wt=i.length/3,xt=se.generateTopUV(n,i,wt-3,wt-2,wt-1);Qe(xt[0]),Qe(xt[1]),Qe(xt[2])}function Ot(ft,rt,St,wt){Nt(ft),Nt(rt),Nt(wt),Nt(rt),Nt(St),Nt(wt);let xt=i.length/3,Vt=se.generateSideWallUV(n,i,xt-6,xt-3,xt-2,xt-1);Qe(Vt[0]),Qe(Vt[1]),Qe(Vt[3]),Qe(Vt[1]),Qe(Vt[2]),Qe(Vt[3])}function Nt(ft){i.push(d[ft*3+0]),i.push(d[ft*3+1]),i.push(d[ft*3+2])}function Qe(ft){r.push(ft.x),r.push(ft.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return Jv(t,n,e)}static fromJSON(e,t){let n=[];for(let r=0,o=e.shapes.length;r<o;r++){let a=t[e.shapes[r]];n.push(a)}let i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new ic[i.type]().fromJSON(i)),new pc(n,e.options)}}let qv={generateTopUV:function(s,e,t,n,i){let r=e[t*3],o=e[t*3+1],a=e[n*3],d=e[n*3+1],E=e[i*3],w=e[i*3+1];return[new ht(r,o),new ht(a,d),new ht(E,w)]},generateSideWallUV:function(s,e,t,n,i,r){let o=e[t*3],a=e[t*3+1],d=e[t*3+2],E=e[n*3],w=e[n*3+1],T=e[n*3+2],B=e[i*3],D=e[i*3+1],N=e[i*3+2],j=e[r*3],G=e[r*3+1],P=e[r*3+2];return Math.abs(a-w)<Math.abs(o-E)?[new ht(o,1-d),new ht(E,1-T),new ht(B,1-N),new ht(j,1-P)]:[new ht(a,1-d),new ht(w,1-T),new ht(D,1-N),new ht(G,1-P)]}};function Jv(s,e,t){if(t.shapes=[],Array.isArray(s))for(let n=0,i=s.length;n<i;n++){let r=s[n];t.shapes.push(r.uuid)}else t.shapes.push(s.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Ac extends no{constructor(e=1,t=0){let n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,r,e,t);this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ac(e.radius,e.detail)}}class ja extends no{constructor(e=1,t=0){let n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,i,e,t);this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ja(e.radius,e.detail)}}class mc extends zn{constructor(e=.5,t=1,n=32,i=1,r=0,o=Math.PI*2){super();this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:o},n=Math.max(3,n),i=Math.max(1,i);let a=[],d=[],E=[],w=[],T=e,B=(t-e)/i,D=new ve,N=new ht;for(let j=0;j<=i;j++){for(let G=0;G<=n;G++){let P=r+G/n*o;D.x=T*Math.cos(P),D.y=T*Math.sin(P),d.push(D.x,D.y,D.z),E.push(0,0,1),N.x=(D.x/t+1)/2,N.y=(D.y/t+1)/2,w.push(N.x,N.y)}T+=B}for(let j=0;j<i;j++){let G=j*(n+1);for(let P=0;P<n;P++){let se=P+G,$=se,J=se+n+1,Be=se+n+2,ge=se+1;a.push($,J,ge),a.push(J,Be,ge)}}this.setIndex(a),this.setAttribute("position",new an(d,3)),this.setAttribute("normal",new an(E,3)),this.setAttribute("uv",new an(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mc(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class gc extends zn{constructor(e=new Mo([new ht(0,.5),new ht(-.5,-.5),new ht(.5,-.5)]),t=12){super();this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};let n=[],i=[],r=[],o=[],a=0,d=0;if(Array.isArray(e)===!1)E(e);else for(let w=0;w<e.length;w++)E(e[w]),this.addGroup(a,d,w),a+=d,d=0;this.setIndex(n),this.setAttribute("position",new an(i,3)),this.setAttribute("normal",new an(r,3)),this.setAttribute("uv",new an(o,2));function E(w){let T=i.length/3,B=w.extractPoints(t),D=B.shape,N=B.holes;Cs.isClockWise(D)===!1&&(D=D.reverse());for(let G=0,P=N.length;G<P;G++){let se=N[G];Cs.isClockWise(se)===!0&&(N[G]=se.reverse())}let j=Cs.triangulateShape(D,N);for(let G=0,P=N.length;G<P;G++){let se=N[G];D=D.concat(se)}for(let G=0,P=D.length;G<P;G++){let se=D[G];i.push(se.x,se.y,0),r.push(0,0,1),o.push(se.x,se.y)}for(let G=0,P=j.length;G<P;G++){let se=j[G],$=se[0]+T,J=se[1]+T,Be=se[2]+T;n.push($,J,Be),d+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes;return Zv(t,e)}static fromJSON(e,t){let n=[];for(let i=0,r=e.shapes.length;i<r;i++){let o=t[e.shapes[i]];n.push(o)}return new gc(n,e.curveSegments)}}function Zv(s,e){if(e.shapes=[],Array.isArray(s))for(let t=0,n=s.length;t<n;t++){let i=s[t];e.shapes.push(i.uuid)}else e.shapes.push(s.uuid);return e}class Wa extends zn{constructor(e=1,t=32,n=16,i=0,r=Math.PI*2,o=0,a=Math.PI){super();this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));let d=Math.min(o+a,Math.PI),E=0,w=[],T=new ve,B=new ve,D=[],N=[],j=[],G=[];for(let P=0;P<=n;P++){let se=[],$=P/n,J=0;P===0&&o===0?J=.5/t:P===n&&d===Math.PI&&(J=-.5/t);for(let Be=0;Be<=t;Be++){let ge=Be/t;T.x=-e*Math.cos(i+ge*r)*Math.sin(o+$*a),T.y=e*Math.cos(o+$*a),T.z=e*Math.sin(i+ge*r)*Math.sin(o+$*a),N.push(T.x,T.y,T.z),B.copy(T).normalize(),j.push(B.x,B.y,B.z),G.push(ge+J,1-$),se.push(E++)}w.push(se)}for(let P=0;P<n;P++)for(let se=0;se<t;se++){let $=w[P][se+1],J=w[P][se],Be=w[P+1][se],ge=w[P+1][se+1];(P!==0||o>0)&&D.push($,J,ge),(P!==n-1||d<Math.PI)&&D.push(J,Be,ge)}this.setIndex(D),this.setAttribute("position",new an(N,3)),this.setAttribute("normal",new an(j,3)),this.setAttribute("uv",new an(G,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Wa(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class vc extends no{constructor(e=1,t=0){let n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,i,e,t);this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new vc(e.radius,e.detail)}}class Ec extends zn{constructor(e=1,t=.4,n=12,i=48,r=Math.PI*2){super();this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},n=Math.floor(n),i=Math.floor(i);let o=[],a=[],d=[],E=[],w=new ve,T=new ve,B=new ve;for(let D=0;D<=n;D++)for(let N=0;N<=i;N++){let j=N/i*r,G=D/n*Math.PI*2;T.x=(e+t*Math.cos(G))*Math.cos(j),T.y=(e+t*Math.cos(G))*Math.sin(j),T.z=t*Math.sin(G),a.push(T.x,T.y,T.z),w.x=e*Math.cos(j),w.y=e*Math.sin(j),B.subVectors(T,w).normalize(),d.push(B.x,B.y,B.z),E.push(N/i),E.push(D/n)}for(let D=1;D<=n;D++)for(let N=1;N<=i;N++){let j=(i+1)*D+N-1,G=(i+1)*(D-1)+N-1,P=(i+1)*(D-1)+N,se=(i+1)*D+N;o.push(j,G,se),o.push(G,P,se)}this.setIndex(o),this.setAttribute("position",new an(a,3)),this.setAttribute("normal",new an(d,3)),this.setAttribute("uv",new an(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ec(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class yc extends zn{constructor(e=1,t=.4,n=64,i=8,r=2,o=3){super();this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:o},n=Math.floor(n),i=Math.floor(i);let a=[],d=[],E=[],w=[],T=new ve,B=new ve,D=new ve,N=new ve,j=new ve,G=new ve,P=new ve;for(let $=0;$<=n;++$){let J=$/n*r*Math.PI*2;se(J,r,o,e,D),se(J+.01,r,o,e,N),G.subVectors(N,D),P.addVectors(N,D),j.crossVectors(G,P),P.crossVectors(j,G),j.normalize(),P.normalize();for(let Be=0;Be<=i;++Be){let ge=Be/i*Math.PI*2,we=-t*Math.cos(ge),Te=t*Math.sin(ge);T.x=D.x+(we*P.x+Te*j.x),T.y=D.y+(we*P.y+Te*j.y),T.z=D.z+(we*P.z+Te*j.z),d.push(T.x,T.y,T.z),B.subVectors(T,D).normalize(),E.push(B.x,B.y,B.z),w.push($/n),w.push(Be/i)}}for(let $=1;$<=n;$++)for(let J=1;J<=i;J++){let Be=(i+1)*($-1)+(J-1),ge=(i+1)*$+(J-1),we=(i+1)*$+J,Te=(i+1)*($-1)+J;a.push(Be,ge,Te),a.push(ge,we,Te)}this.setIndex(a),this.setAttribute("position",new an(d,3)),this.setAttribute("normal",new an(E,3)),this.setAttribute("uv",new an(w,2));function se($,J,Be,ge,we){let Te=Math.cos($),de=Math.sin($),le=Be/J*$,Ie=Math.cos(le);we.x=ge*(2+Ie)*.5*Te,we.y=ge*(2+Ie)*de*.5,we.z=ge*Math.sin(le)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yc(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Cc extends zn{constructor(e=new ud(new ve(-1,-1,0),new ve(-1,1,0),new ve(1,1,0)),t=64,n=1,i=8,r=!1){super();this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r};let o=e.computeFrenetFrames(t,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;let a=new ve,d=new ve,E=new ht,w=new ve,T=[],B=[],D=[],N=[];j(),this.setIndex(N),this.setAttribute("position",new an(T,3)),this.setAttribute("normal",new an(B,3)),this.setAttribute("uv",new an(D,2));function j(){for(let $=0;$<t;$++)G($);G(r===!1?t:0),se(),P()}function G($){w=e.getPointAt($/t,w);let J=o.normals[$],Be=o.binormals[$];for(let ge=0;ge<=i;ge++){let we=ge/i*Math.PI*2,Te=Math.sin(we),de=-Math.cos(we);d.x=de*J.x+Te*Be.x,d.y=de*J.y+Te*Be.y,d.z=de*J.z+Te*Be.z,d.normalize(),B.push(d.x,d.y,d.z),a.x=w.x+n*d.x,a.y=w.y+n*d.y,a.z=w.z+n*d.z,T.push(a.x,a.y,a.z)}}function P(){for(let $=1;$<=t;$++)for(let J=1;J<=i;J++){let Be=(i+1)*($-1)+(J-1),ge=(i+1)*$+(J-1),we=(i+1)*$+J,Te=(i+1)*($-1)+J;N.push(Be,ge,Te),N.push(ge,we,Te)}}function se(){for(let $=0;$<=t;$++)for(let J=0;J<=i;J++)E.x=$/t,E.y=J/i,D.push(E.x,E.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Cc(new ic[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Ff extends zn{constructor(e=null){super();if(this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){let t=[],n=new Set,i=new ve,r=new ve;if(e.index!==null){let o=e.attributes.position,a=e.index,d=e.groups;d.length===0&&(d=[{start:0,count:a.count,materialIndex:0}]);for(let E=0,w=d.length;E<w;++E){let T=d[E],B=T.start,D=T.count;for(let N=B,j=B+D;N<j;N+=3)for(let G=0;G<3;G++){let P=a.getX(N+G),se=a.getX(N+(G+1)%3);i.fromBufferAttribute(o,P),r.fromBufferAttribute(o,se),Of(i,r,n)===!0&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}}else{let o=e.attributes.position;for(let a=0,d=o.count/3;a<d;a++)for(let E=0;E<3;E++){let w=3*a+E,T=3*a+(E+1)%3;i.fromBufferAttribute(o,w),r.fromBufferAttribute(o,T),Of(i,r,n)===!0&&(t.push(i.x,i.y,i.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new an(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function Of(s,e,t){let n=`${s.x},${s.y},${s.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${s.x},${s.y},${s.z}`;return t.has(n)===!0||t.has(i)===!0?!1:(t.add(n),t.add(i),!0)}var Uf=Object.freeze({__proto__:null,BoxGeometry:go,CapsuleGeometry:rc,CircleGeometry:sc,ConeGeometry:oc,CylinderGeometry:pa,DodecahedronGeometry:ac,EdgesGeometry:If,ExtrudeGeometry:pc,IcosahedronGeometry:Ac,LatheGeometry:Qa,OctahedronGeometry:ja,PlaneGeometry:ia,PolyhedronGeometry:no,RingGeometry:mc,ShapeGeometry:gc,SphereGeometry:Wa,TetrahedronGeometry:vc,TorusGeometry:Ec,TorusKnotGeometry:yc,TubeGeometry:Cc,WireframeGeometry:Ff});class Nf extends Tr{constructor(e){super();this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new qt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class kf extends hs{constructor(e){super(e);this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class gd extends Tr{constructor(e){super();this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new qt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mr,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new qr,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Gf extends gd{constructor(e){super();this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ht(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Vi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new qt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new qt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new qt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Qf extends Tr{constructor(e){super();this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new qt(16777215),this.specular=new qt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mr,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new qr,this.combine=pi,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Vf extends Tr{constructor(e){super();this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new qt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mr,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Hf extends Tr{constructor(e){super();this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mr,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class zf extends Tr{constructor(e){super();this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new qt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mr,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new qr,this.combine=pi,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class jf extends Tr{constructor(e){super();this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new qt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mr,this.normalScale=new ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Wf extends Nr{constructor(e){super();this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Io(s,e,t){return!s||!t&&s.constructor===e?s:typeof e.BYTES_PER_ELEMENT=="number"?new e(s):Array.prototype.slice.call(s)}function Kf(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function Xf(s){function e(i,r){return s[i]-s[r]}let t=s.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort(e),n}function vd(s,e,t){let n=s.length,i=new s.constructor(n);for(let r=0,o=0;o!==n;++r){let a=t[r]*e;for(let d=0;d!==e;++d)i[o++]=s[a+d]}return i}function Ed(s,e,t,n){let i=1,r=s[0];for(;r!==void 0&&r[n]===void 0;)r=s[i++];if(r===void 0)return;let o=r[n];if(o!==void 0)if(Array.isArray(o))do o=r[n],o!==void 0&&(e.push(r.time),t.push.apply(t,o)),r=s[i++];while(r!==void 0);else if(o.toArray!==void 0)do o=r[n],o!==void 0&&(e.push(r.time),o.toArray(t,t.length)),r=s[i++];while(r!==void 0);else do o=r[n],o!==void 0&&(e.push(r.time),t.push(o)),r=s[i++];while(r!==void 0)}function $v(s,e,t,n,i=30){let r=s.clone();r.name=e;let o=[];for(let d=0;d<r.tracks.length;++d){let E=r.tracks[d],w=E.getValueSize(),T=[],B=[];for(let D=0;D<E.times.length;++D){let N=E.times[D]*i;if(!(N<t||N>=n)){T.push(E.times[D]);for(let j=0;j<w;++j)B.push(E.values[D*w+j])}}T.length!==0&&(E.times=Io(T,E.times.constructor),E.values=Io(B,E.values.constructor),o.push(E))}r.tracks=o;let a=1/0;for(let d=0;d<r.tracks.length;++d)a>r.tracks[d].times[0]&&(a=r.tracks[d].times[0]);for(let d=0;d<r.tracks.length;++d)r.tracks[d].shift(-1*a);return r.resetDuration(),r}function eE(s,e=0,t=s,n=30){n<=0&&(n=30);let i=t.tracks.length,r=e/n;for(let o=0;o<i;++o){let a=t.tracks[o],d=a.ValueTypeName;if(d==="bool"||d==="string")continue;let E=s.tracks.find(function(P){return P.name===a.name&&P.ValueTypeName===d});if(E===void 0)continue;let w=0,T=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(w=T/3);let B=0,D=E.getValueSize();E.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(B=D/3);let N=a.times.length-1,j;if(r<=a.times[0]){let P=w,se=T-w;j=a.values.slice(P,se)}else if(r>=a.times[N]){let P=N*T+w,se=P+T-w;j=a.values.slice(P,se)}else{let P=a.createInterpolant(),se=w,$=T-w;P.evaluate(r),j=P.resultBuffer.slice(se,$)}d==="quaternion"&&new ci().fromArray(j).normalize().conjugate().toArray(j);let G=E.times.length;for(let P=0;P<G;++P){let se=P*D+B;if(d==="quaternion")ci.multiplyQuaternionsFlat(E.values,se,j,0,E.values,se);else{let $=D-B*2;for(let J=0;J<$;++J)E.values[se+J]-=j[J]}}}return s.blendMode=as,s}let tE={convertArray:Io,isTypedArray:Kf,getKeyframeOrder:Xf,sortedArray:vd,flattenJSON:Ed,subclip:$v,makeClipAdditive:eE};class Ka{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{let o;n:{i:if(!(e<i)){for(let a=n+2;;){if(i===void 0){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(r=i,i=t[++n],e<i)break t}o=t.length;break n}if(!(e>=r)){let a=t[1];e<a&&(n=2,r=a);for(let d=n-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===d)break;if(i=r,r=t[--n-1],e>=r)break t}o=n,n=0;break n}break e}for(;n<o;){let a=n+o>>>1;e<t[a]?o=a:n=a+1}if(i=t[n],r=t[n-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i;for(let o=0;o!==i;++o)t[o]=n[r+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Yf extends Ka{constructor(e,t,n,i){super(e,t,n,i);this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:zi,endingEnd:zi}}intervalChanged_(e,t,n){let i=this.parameterPositions,r=e-2,o=e+1,a=i[r],d=i[o];if(a===void 0)switch(this.getSettings_().endingStart){case gr:r=e,a=2*t-n;break;case Wr:r=i.length-2,a=t+i[r]-i[r+1];break;default:r=e,a=n}if(d===void 0)switch(this.getSettings_().endingEnd){case gr:o=e,d=2*n-t;break;case Wr:o=1,d=n+i[1]-i[0];break;default:o=e-1,d=t}let E=(n-t)*.5,w=this.valueSize;this._weightPrev=E/(t-a),this._weightNext=E/(d-n),this._offsetPrev=r*w,this._offsetNext=o*w}interpolate_(e,t,n,i){let r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,d=e*a,E=d-a,w=this._offsetPrev,T=this._offsetNext,B=this._weightPrev,D=this._weightNext,N=(n-t)/(i-t),j=N*N,G=j*N,P=-B*G+2*B*j-B*N,se=(1+B)*G+(-1.5-2*B)*j+(-.5+B)*N+1,$=(-1-D)*G+(1.5+D)*j+.5*N,J=D*G-D*j;for(let Be=0;Be!==a;++Be)r[Be]=P*o[w+Be]+se*o[E+Be]+$*o[d+Be]+J*o[T+Be];return r}}class yd extends Ka{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){let r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,d=e*a,E=d-a,w=(n-t)/(i-t),T=1-w;for(let B=0;B!==a;++B)r[B]=o[E+B]*T+o[d+B]*w;return r}}class qf extends Ka{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class fs{constructor(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Io(t,this.TimeBufferType),this.values=Io(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Io(e.times,Array),values:Io(e.values,Array)};let i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new qf(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new yd(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Yf(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case nr:t=this.InterpolantFactoryMethodDiscrete;break;case ir:t=this.InterpolantFactoryMethodLinear;break;case sr:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return nr;case this.InterpolantFactoryMethodLinear:return ir;case this.InterpolantFactoryMethodSmooth:return sr}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){let n=this.times,i=n.length,r=0,o=i-1;for(;r!==i&&n[r]<e;)++r;for(;o!==-1&&n[o]>t;)--o;if(++o,r!==0||o!==i){r>=o&&(o=Math.max(o,1),r=o-1);let a=this.getValueSize();this.times=n.slice(r,o),this.values=this.values.slice(r*a,o*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let n=this.times,i=this.values,r=n.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==r;a++){let d=n[a];if(typeof d=="number"&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,d),e=!1;break}if(o!==null&&o>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,d,o),e=!1;break}o=d}if(i!==void 0&&Kf(i))for(let a=0,d=i.length;a!==d;++a){let E=i[a];if(isNaN(E)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,E),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===sr,r=e.length-1,o=1;for(let a=1;a<r;++a){let d=!1,E=e[a],w=e[a+1];if(E!==w&&(a!==1||E!==e[0]))if(i)d=!0;else{let T=a*n,B=T-n,D=T+n;for(let N=0;N!==n;++N){let j=t[T+N];if(j!==t[B+N]||j!==t[D+N]){d=!0;break}}}if(d){if(a!==o){e[o]=e[a];let T=a*n,B=o*n;for(let D=0;D!==n;++D)t[B+D]=t[T+D]}++o}}if(r>0){e[o]=e[r];for(let a=r*n,d=o*n,E=0;E!==n;++E)t[d+E]=t[a+E];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),n=this.constructor,i=new n(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}fs.prototype.TimeBufferType=Float32Array,fs.prototype.ValueBufferType=Float32Array,fs.prototype.DefaultInterpolation=ir;class To extends fs{}To.prototype.ValueTypeName="bool",To.prototype.ValueBufferType=Array,To.prototype.DefaultInterpolation=nr,To.prototype.InterpolantFactoryMethodLinear=void 0,To.prototype.InterpolantFactoryMethodSmooth=void 0;class Cd extends fs{}Cd.prototype.ValueTypeName="color";class Xa extends fs{}Xa.prototype.ValueTypeName="number";class Jf extends Ka{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){let r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,d=(n-t)/(i-t),E=e*a;for(let w=E+a;E!==w;E+=4)ci.slerpFlat(r,0,o,E-a,o,E,d);return r}}class ma extends fs{InterpolantFactoryMethodLinear(e){return new Jf(this.times,this.values,this.getValueSize(),e)}}ma.prototype.ValueTypeName="quaternion",ma.prototype.DefaultInterpolation=ir,ma.prototype.InterpolantFactoryMethodSmooth=void 0;class Bo extends fs{}Bo.prototype.ValueTypeName="string",Bo.prototype.ValueBufferType=Array,Bo.prototype.DefaultInterpolation=nr,Bo.prototype.InterpolantFactoryMethodLinear=void 0,Bo.prototype.InterpolantFactoryMethodSmooth=void 0;class Ya extends fs{}Ya.prototype.ValueTypeName="vector";class qa{constructor(e="",t=-1,n=[],i=ns){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=Pr(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],n=e.tracks,i=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(iE(n[o]).scale(i));let r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){let t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,o=n.length;r!==o;++r)t.push(fs.toJSON(n[r]));return i}static CreateFromMorphTargetSequence(e,t,n,i){let r=t.length,o=[];for(let a=0;a<r;a++){let d=[],E=[];d.push((a+r-1)%r,a,(a+1)%r),E.push(0,1,0);let w=Xf(d);d=vd(d,1,w),E=vd(E,1,w),!i&&d[0]===0&&(d.push(r),E.push(E[0])),o.push(new Xa(".morphTargetInfluences["+t[a].name+"]",d,E).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){let i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){let i={},r=/^([\w-]*?)([\d]+)$/;for(let a=0,d=e.length;a<d;a++){let E=e[a],w=E.name.match(r);if(w&&w.length>1){let T=w[1],B=i[T];B||(i[T]=B=[]),B.push(E)}}let o=[];for(let a in i)o.push(this.CreateFromMorphTargetSequence(a,i[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let n=function(T,B,D,N,j){if(D.length!==0){let G=[],P=[];Ed(D,G,P,N),G.length!==0&&j.push(new T(B,G,P))}},i=[],r=e.name||"default",o=e.fps||30,a=e.blendMode,d=e.length||-1,E=e.hierarchy||[];for(let T=0;T<E.length;T++){let B=E[T].keys;if(!(!B||B.length===0))if(B[0].morphTargets){let D={},N;for(N=0;N<B.length;N++)if(B[N].morphTargets)for(let j=0;j<B[N].morphTargets.length;j++)D[B[N].morphTargets[j]]=-1;for(let j in D){let G=[],P=[];for(let se=0;se!==B[N].morphTargets.length;++se){let $=B[N];G.push($.time),P.push($.morphTarget===j?1:0)}i.push(new Xa(".morphTargetInfluence["+j+"]",G,P))}d=D.length*o}else{let D=".bones["+t[T].name+"]";n(Ya,D+".position",B,"pos",i),n(ma,D+".quaternion",B,"rot",i),n(Ya,D+".scale",B,"scl",i)}}return i.length===0?null:new this(r,d,i,a)}resetDuration(){let e=this.tracks,t=0;for(let n=0,i=e.length;n!==i;++n){let r=this.tracks[n];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function nE(s){switch(s.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Xa;case"vector":case"vector2":case"vector3":case"vector4":return Ya;case"color":return Cd;case"quaternion":return ma;case"bool":case"boolean":return To;case"string":return Bo}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+s)}function iE(s){if(s.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=nE(s.type);if(s.times===void 0){let t=[],n=[];Ed(s.keys,t,n,"value"),s.times=t,s.values=n}return e.parse!==void 0?e.parse(s):new e(s.name,s.times,s.values,s.interpolation)}let Us={enabled:!1,files:{},add:function(s,e){this.enabled!==!1&&(this.files[s]=e)},get:function(s){if(this.enabled!==!1)return this.files[s]},remove:function(s){delete this.files[s]},clear:function(){this.files={}}};class xd{constructor(e,t,n){let i=this,r=!1,o=0,a=0,d,E=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(w){a++,r===!1&&i.onStart!==void 0&&i.onStart(w,o,a),r=!0},this.itemEnd=function(w){o++,i.onProgress!==void 0&&i.onProgress(w,o,a),o===a&&(r=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(w){i.onError!==void 0&&i.onError(w)},this.resolveURL=function(w){return d?d(w):w},this.setURLModifier=function(w){return d=w,this},this.addHandler=function(w,T){return E.push(w,T),this},this.removeHandler=function(w){let T=E.indexOf(w);return T!==-1&&E.splice(T,2),this},this.getHandler=function(w){for(let T=0,B=E.length;T<B;T+=2){let D=E[T],N=E[T+1];if(D.global&&(D.lastIndex=0),D.test(w))return N}return null}}}let Zf=new xd;class zr{constructor(e){this.manager=e!==void 0?e:Zf,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let n=this;return new Promise(function(i,r){n.load(e,i,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}zr.DEFAULT_MATERIAL_NAME="__DEFAULT";let Ns={};class rE extends Error{constructor(e,t){super(e);this.response=t}}class ks extends zr{constructor(e){super(e)}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let r=Us.get(e);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(Ns[e]!==void 0){Ns[e].push({onLoad:t,onProgress:n,onError:i});return}Ns[e]=[],Ns[e].push({onLoad:t,onProgress:n,onError:i});let o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,d=this.responseType;fetch(o).then(E=>{if(E.status===200||E.status===0){if(E.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream=="undefined"||E.body===void 0||E.body.getReader===void 0)return E;let w=Ns[e],T=E.body.getReader(),B=E.headers.get("X-File-Size")||E.headers.get("Content-Length"),D=B?parseInt(B):0,N=D!==0,j=0,G=new ReadableStream({start(P){se();function se(){T.read().then(({done:$,value:J})=>{if($)P.close();else{j+=J.byteLength;let Be=new ProgressEvent("progress",{lengthComputable:N,loaded:j,total:D});for(let ge=0,we=w.length;ge<we;ge++){let Te=w[ge];Te.onProgress&&Te.onProgress(Be)}P.enqueue(J),se()}})}}});return new Response(G)}else throw new rE(`fetch for "${E.url}" responded with ${E.status}: ${E.statusText}`,E)}).then(E=>{switch(d){case"arraybuffer":return E.arrayBuffer();case"blob":return E.blob();case"document":return E.text().then(w=>new DOMParser().parseFromString(w,a));case"json":return E.json();default:if(a===void 0)return E.text();{let T=/charset="?([^;"\s]*)"?/i.exec(a),B=T&&T[1]?T[1].toLowerCase():void 0,D=new TextDecoder(B);return E.arrayBuffer().then(N=>D.decode(N))}}}).then(E=>{Us.add(e,E);let w=Ns[e];delete Ns[e];for(let T=0,B=w.length;T<B;T++){let D=w[T];D.onLoad&&D.onLoad(E)}}).catch(E=>{let w=Ns[e];if(w===void 0)throw this.manager.itemError(e),E;delete Ns[e];for(let T=0,B=w.length;T<B;T++){let D=w[T];D.onError&&D.onError(E)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class sE extends zr{constructor(e){super(e)}load(e,t,n,i){let r=this,o=new ks(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(r.parse(JSON.parse(a)))}catch(d){i?i(d):console.error(d),r.manager.itemError(e)}},n,i)}parse(e){let t=[];for(let n=0;n<e.length;n++){let i=qa.parse(e[n]);t.push(i)}return t}}class oE extends zr{constructor(e){super(e)}load(e,t,n,i){let r=this,o=[],a=new ec,d=new ks(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(r.withCredentials);let E=0;function w(T){d.load(e[T],function(B){let D=r.parse(B,!0);o[T]={width:D.width,height:D.height,format:D.format,mipmaps:D.mipmaps},E+=1,E===6&&(D.mipmapCount===1&&(a.minFilter=pn),a.image=o,a.format=D.format,a.needsUpdate=!0,t&&t(a))},n,i)}if(Array.isArray(e))for(let T=0,B=e.length;T<B;++T)w(T);else d.load(e,function(T){let B=r.parse(T,!0);if(B.isCubemap){let D=B.mipmaps.length/B.mipmapCount;for(let N=0;N<D;N++){o[N]={mipmaps:[]};for(let j=0;j<B.mipmapCount;j++)o[N].mipmaps.push(B.mipmaps[N*B.mipmapCount+j]),o[N].format=B.format,o[N].width=B.width,o[N].height=B.height}a.image=o}else a.image.width=B.width,a.image.height=B.height,a.mipmaps=B.mipmaps;B.mipmapCount===1&&(a.minFilter=pn),a.format=B.format,a.needsUpdate=!0,t&&t(a)},n,i);return a}}class Ja extends zr{constructor(e){super(e)}load(e,t,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let r=this,o=Us.get(e);if(o!==void 0)return r.manager.itemStart(e),setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o;let a=Ao("img");function d(){w(),Us.add(e,this),t&&t(this),r.manager.itemEnd(e)}function E(T){w(),i&&i(T),r.manager.itemError(e),r.manager.itemEnd(e)}function w(){a.removeEventListener("load",d,!1),a.removeEventListener("error",E,!1)}return a.addEventListener("load",d,!1),a.addEventListener("error",E,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(e),a.src=e,a}}class aE extends zr{constructor(e){super(e)}load(e,t,n,i){let r=new Ia;r.colorSpace=ni;let o=new Ja(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function d(E){o.load(e[E],function(w){r.images[E]=w,a++,a===6&&(r.needsUpdate=!0,t&&t(r))},void 0,i)}for(let E=0;E<e.length;++E)d(E);return r}}class lE extends zr{constructor(e){super(e)}load(e,t,n,i){let r=this,o=new $s,a=new ks(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(r.withCredentials),a.load(e,function(d){let E;try{E=r.parse(d)}catch(w){if(i!==void 0)i(w);else{console.error(w);return}}E.image!==void 0?o.image=E.image:E.data!==void 0&&(o.image.width=E.width,o.image.height=E.height,o.image.data=E.data),o.wrapS=E.wrapS!==void 0?E.wrapS:De,o.wrapT=E.wrapT!==void 0?E.wrapT:De,o.magFilter=E.magFilter!==void 0?E.magFilter:pn,o.minFilter=E.minFilter!==void 0?E.minFilter:pn,o.anisotropy=E.anisotropy!==void 0?E.anisotropy:1,E.colorSpace!==void 0&&(o.colorSpace=E.colorSpace),E.flipY!==void 0&&(o.flipY=E.flipY),E.format!==void 0&&(o.format=E.format),E.type!==void 0&&(o.type=E.type),E.mipmaps!==void 0&&(o.mipmaps=E.mipmaps,o.minFilter=yi),E.mipmapCount===1&&(o.minFilter=pn),E.generateMipmaps!==void 0&&(o.generateMipmaps=E.generateMipmaps),o.needsUpdate=!0,t&&t(o,E)},n,i),o}}class cE extends zr{constructor(e){super(e)}load(e,t,n,i){let r=new Li,o=new Ja(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){r.image=a,r.needsUpdate=!0,t!==void 0&&t(r)},n,i),r}}class io extends hi{constructor(e,t=1){super();this.isLight=!0,this.type="Light",this.color=new qt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class $f extends io{constructor(e,t,n){super(e,n);this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(hi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new qt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}let bd=new rn,ep=new ve,tp=new ve;class _d{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ht(512,512),this.map=null,this.mapPass=null,this.matrix=new rn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ta,this._frameExtents=new ht(1,1),this._viewportCount=1,this._viewports=[new oi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,n=this.matrix;ep.setFromMatrixPosition(e.matrixWorld),t.position.copy(ep),tp.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(tp),t.updateMatrixWorld(),bd.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(bd),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(bd)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class hE extends _d{constructor(){super(new dr(50,1,.5,500));this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,n=Hs*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(n!==t.fov||i!==t.aspect||r!==t.far)&&(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class np extends io{constructor(e,t,n=0,i=Math.PI/3,r=0,o=2){super(e,t);this.isSpotLight=!0,this.type="SpotLight",this.position.copy(hi.DEFAULT_UP),this.updateMatrix(),this.target=new hi,this.distance=n,this.angle=i,this.penumbra=r,this.decay=o,this.map=null,this.shadow=new hE}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}let ip=new rn,Za=new ve,wd=new ve;class dE extends _d{constructor(){super(new dr(90,1,.5,500));this.isPointLightShadow=!0,this._frameExtents=new ht(4,2),this._viewportCount=6,this._viewports=[new oi(2,1,1,1),new oi(0,1,1,1),new oi(3,1,1,1),new oi(1,1,1,1),new oi(3,0,1,1),new oi(1,0,1,1)],this._cubeDirections=[new ve(1,0,0),new ve(-1,0,0),new ve(0,0,1),new ve(0,0,-1),new ve(0,1,0),new ve(0,-1,0)],this._cubeUps=[new ve(0,1,0),new ve(0,1,0),new ve(0,1,0),new ve(0,1,0),new ve(0,0,1),new ve(0,0,-1)]}updateMatrices(e,t=0){let n=this.camera,i=this.matrix,r=e.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),Za.setFromMatrixPosition(e.matrixWorld),n.position.copy(Za),wd.copy(n.position),wd.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(wd),n.updateMatrixWorld(),i.makeTranslation(-Za.x,-Za.y,-Za.z),ip.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ip)}}class rp extends io{constructor(e,t,n=0,i=2){super(e,t);this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new dE}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class uE extends _d{constructor(){super(new Ll(-5,5,5,-5,.5,500));this.isDirectionalLightShadow=!0}}class sp extends io{constructor(e,t){super(e,t);this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(hi.DEFAULT_UP),this.updateMatrix(),this.target=new hi,this.shadow=new uE}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class op extends io{constructor(e,t){super(e,t);this.isAmbientLight=!0,this.type="AmbientLight"}}class ap extends io{constructor(e,t,n=10,i=10){super(e,t);this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){let t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class lp{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ve)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){let n=e.x,i=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*i),t.addScaledVector(o[2],.488603*r),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*i)),t.addScaledVector(o[5],1.092548*(i*r)),t.addScaledVector(o[6],.315392*(3*r*r-1)),t.addScaledVector(o[7],1.092548*(n*r)),t.addScaledVector(o[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){let n=e.x,i=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*i),t.addScaledVector(o[2],2*.511664*r),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*i),t.addScaledVector(o[5],2*.429043*i*r),t.addScaledVector(o[6],.743125*r*r-.247708),t.addScaledVector(o[7],2*.429043*n*r),t.addScaledVector(o[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){let n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){let n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){let n=e.x,i=e.y,r=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-i*i)}}class cp extends io{constructor(e=new lp,t=1){super(void 0,t);this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){let t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class xc extends zr{constructor(e){super(e);this.textures={}}load(e,t,n,i){let r=this,o=new ks(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(a){try{t(r.parse(JSON.parse(a)))}catch(d){i?i(d):console.error(d),r.manager.itemError(e)}},n,i)}parse(e){let t=this.textures;function n(r){return t[r]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",r),t[r]}let i=xc.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new qt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(i.dispersion=e.dispersion),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(let r in e.uniforms){let o=e.uniforms[r];switch(i.uniforms[r]={},o.type){case"t":i.uniforms[r].value=n(o.value);break;case"c":i.uniforms[r].value=new qt().setHex(o.value);break;case"v2":i.uniforms[r].value=new ht().fromArray(o.value);break;case"v3":i.uniforms[r].value=new ve().fromArray(o.value);break;case"v4":i.uniforms[r].value=new oi().fromArray(o.value);break;case"m3":i.uniforms[r].value=new Bn().fromArray(o.value);break;case"m4":i.uniforms[r].value=new rn().fromArray(o.value);break;default:i.uniforms[r].value=o.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(let r in e.extensions)i.extensions[r]=e.extensions[r];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let r=e.normalScale;Array.isArray(r)===!1&&(r=[r,r]),i.normalScale=new ht().fromArray(r)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapRotation!==void 0&&i.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new ht().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){let t={ShadowMaterial:Nf,SpriteMaterial:Yh,RawShaderMaterial:kf,ShaderMaterial:hs,PointsMaterial:id,MeshPhysicalMaterial:Gf,MeshStandardMaterial:gd,MeshPhongMaterial:Qf,MeshToonMaterial:Vf,MeshNormalMaterial:Hf,MeshLambertMaterial:zf,MeshDepthMaterial:jh,MeshDistanceMaterial:Wh,MeshBasicMaterial:qs,MeshMatcapMaterial:jf,LineDashedMaterial:Wf,LineBasicMaterial:Nr,Material:Tr};return new t[e]}}class Md{static decodeText(e){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(n){return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class hp extends zn{constructor(){super();this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class dp extends zr{constructor(e){super(e)}load(e,t,n,i){let r=this,o=new ks(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(a){try{t(r.parse(JSON.parse(a)))}catch(d){i?i(d):console.error(d),r.manager.itemError(e)}},n,i)}parse(e){let t={},n={};function i(D,N){if(t[N]!==void 0)return t[N];let G=D.interleavedBuffers[N],P=r(D,G.buffer),se=zs(G.type,P),$=new Nl(se,G.stride);return $.uuid=G.uuid,t[N]=$,$}function r(D,N){if(n[N]!==void 0)return n[N];let G=D.arrayBuffers[N],P=new Uint32Array(G).buffer;return n[N]=P,P}let o=e.isInstancedBufferGeometry?new hp:new zn,a=e.data.index;if(a!==void 0){let D=zs(a.type,a.array);o.setIndex(new Si(D,1))}let d=e.data.attributes;for(let D in d){let N=d[D],j;if(N.isInterleavedBufferAttribute){let G=i(e.data,N.data);j=new _o(G,N.itemSize,N.offset,N.normalized)}else{let G=zs(N.type,N.array),P=N.isInstancedBufferAttribute?da:Si;j=new P(G,N.itemSize,N.normalized)}N.name!==void 0&&(j.name=N.name),N.usage!==void 0&&j.setUsage(N.usage),o.setAttribute(D,j)}let E=e.data.morphAttributes;if(E)for(let D in E){let N=E[D],j=[];for(let G=0,P=N.length;G<P;G++){let se=N[G],$;if(se.isInterleavedBufferAttribute){let J=i(e.data,se.data);$=new _o(J,se.itemSize,se.offset,se.normalized)}else{let J=zs(se.type,se.array);$=new Si(J,se.itemSize,se.normalized)}se.name!==void 0&&($.name=se.name),j.push($)}o.morphAttributes[D]=j}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);let T=e.data.groups||e.data.drawcalls||e.data.offsets;if(T!==void 0)for(let D=0,N=T.length;D!==N;++D){let j=T[D];o.addGroup(j.start,j.count,j.materialIndex)}let B=e.data.boundingSphere;if(B!==void 0){let D=new ve;B.center!==void 0&&D.fromArray(B.center),o.boundingSphere=new cr(D,B.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class fE extends zr{constructor(e){super(e)}load(e,t,n,i){let r=this,o=this.path===""?Md.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;let a=new ks(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(d){let E=null;try{E=JSON.parse(d)}catch(T){i!==void 0&&i(T),console.error("THREE:ObjectLoader: Can't parse "+e+".",T.message);return}let w=E.metadata;if(w===void 0||w.type===void 0||w.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}r.parse(E,t)},n,i)}async loadAsync(e,t){let n=this,i=this.path===""?Md.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;let r=new ks(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);let o=await r.loadAsync(e,t),a=JSON.parse(o),d=a.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(a)}parse(e,t){let n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),o=this.parseImages(e.images,function(){t!==void 0&&t(E)}),a=this.parseTextures(e.textures,o),d=this.parseMaterials(e.materials,a),E=this.parseObject(e.object,r,d,a,n),w=this.parseSkeletons(e.skeletons,E);if(this.bindSkeletons(E,w),t!==void 0){let T=!1;for(let B in o)if(o[B].data instanceof HTMLImageElement){T=!0;break}T===!1&&t(E)}return E}async parseAsync(e){let t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),r=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,r),a=this.parseMaterials(e.materials,o),d=this.parseObject(e.object,i,a,o,t),E=this.parseSkeletons(e.skeletons,d);return this.bindSkeletons(d,E),d}parseShapes(e){let t={};if(e!==void 0)for(let n=0,i=e.length;n<i;n++){let r=new Mo().fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){let n={},i={};if(t.traverse(function(r){r.isBone&&(i[r.uuid]=r)}),e!==void 0)for(let r=0,o=e.length;r<o;r++){let a=new zl().fromJSON(e[r],i);n[a.uuid]=a}return n}parseGeometries(e,t){let n={};if(e!==void 0){let r=new dp;for(let o=0,a=e.length;o<a;o++){let d,E=e[o];switch(E.type){case"BufferGeometry":case"InstancedBufferGeometry":d=r.parse(E);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var i=new THREE.LegacyJSONLoader;d=i.parse(E,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:E.type in Uf?d=Uf[E.type].fromJSON(E,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${E.type}"`)}d.uuid=E.uuid,E.name!==void 0&&(d.name=E.name),E.userData!==void 0&&(d.userData=E.userData),n[E.uuid]=d}}return n}parseMaterials(e,t){let n={},i={};if(e!==void 0){let r=new xc;r.setTextures(t);for(let o=0,a=e.length;o<a;o++){let d=e[o];n[d.uuid]===void 0&&(n[d.uuid]=r.parse(d)),i[d.uuid]=n[d.uuid]}}return i}parseAnimations(e){let t={};if(e!==void 0)for(let n=0;n<e.length;n++){let i=e[n],r=qa.parse(i);t[r.uuid]=r}return t}parseImages(e,t){let n=this,i={},r;function o(d){return n.manager.itemStart(d),r.load(d,function(){n.manager.itemEnd(d)},void 0,function(){n.manager.itemError(d),n.manager.itemEnd(d)})}function a(d){if(typeof d=="string"){let E=d,w=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(E)?E:n.resourcePath+E;return o(w)}else return d.data?{data:zs(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){let d=new xd(t);r=new Ja(d),r.setCrossOrigin(this.crossOrigin);for(let E=0,w=e.length;E<w;E++){let T=e[E],B=T.url;if(Array.isArray(B)){let D=[];for(let N=0,j=B.length;N<j;N++){let G=B[N],P=a(G);P!==null&&(P instanceof HTMLImageElement?D.push(P):D.push(new $s(P.data,P.width,P.height)))}i[T.uuid]=new ki(D)}else{let D=a(T.url);i[T.uuid]=new ki(D)}}}return i}async parseImagesAsync(e){let t=this,n={},i;async function r(o){if(typeof o=="string"){let a=o,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await i.loadAsync(d)}else return o.data?{data:zs(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){i=new Ja(this.manager),i.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){let d=e[o],E=d.url;if(Array.isArray(E)){let w=[];for(let T=0,B=E.length;T<B;T++){let D=E[T],N=await r(D);N!==null&&(N instanceof HTMLImageElement?w.push(N):w.push(new $s(N.data,N.width,N.height)))}n[d.uuid]=new ki(w)}else{let w=await r(d.url);n[d.uuid]=new ki(w)}}}return n}parseTextures(e,t){function n(r,o){return typeof r=="number"?r:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",r),o[r])}let i={};if(e!==void 0)for(let r=0,o=e.length;r<o;r++){let a=e[r];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);let d=t[a.image],E=d.data,w;Array.isArray(E)?(w=new Ia,E.length===6&&(w.needsUpdate=!0)):(E&&E.data?w=new $s:w=new Li,E&&(w.needsUpdate=!0)),w.source=d,w.uuid=a.uuid,a.name!==void 0&&(w.name=a.name),a.mapping!==void 0&&(w.mapping=n(a.mapping,pE)),a.channel!==void 0&&(w.channel=a.channel),a.offset!==void 0&&w.offset.fromArray(a.offset),a.repeat!==void 0&&w.repeat.fromArray(a.repeat),a.center!==void 0&&w.center.fromArray(a.center),a.rotation!==void 0&&(w.rotation=a.rotation),a.wrap!==void 0&&(w.wrapS=n(a.wrap[0],up),w.wrapT=n(a.wrap[1],up)),a.format!==void 0&&(w.format=a.format),a.internalFormat!==void 0&&(w.internalFormat=a.internalFormat),a.type!==void 0&&(w.type=a.type),a.colorSpace!==void 0&&(w.colorSpace=a.colorSpace),a.minFilter!==void 0&&(w.minFilter=n(a.minFilter,fp)),a.magFilter!==void 0&&(w.magFilter=n(a.magFilter,fp)),a.anisotropy!==void 0&&(w.anisotropy=a.anisotropy),a.flipY!==void 0&&(w.flipY=a.flipY),a.generateMipmaps!==void 0&&(w.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(w.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(w.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(w.compareFunction=a.compareFunction),a.userData!==void 0&&(w.userData=a.userData),i[a.uuid]=w}return i}parseObject(e,t,n,i,r){let o;function a(B){return t[B]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",B),t[B]}function d(B){if(B!==void 0){if(Array.isArray(B)){let D=[];for(let N=0,j=B.length;N<j;N++){let G=B[N];n[G]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",G),D.push(n[G])}return D}return n[B]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",B),n[B]}}function E(B){return i[B]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",B),i[B]}let w,T;switch(e.type){case"Scene":o=new Ku,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new qt(e.background):o.background=E(e.background)),e.environment!==void 0&&(o.environment=E(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new Ul(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new Ol(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new dr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Ll(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new op(e.color,e.intensity);break;case"DirectionalLight":o=new sp(e.color,e.intensity);break;case"PointLight":o=new rp(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new ap(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new np(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new $f(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new cp().fromJSON(e);break;case"SkinnedMesh":w=a(e.geometry),T=d(e.material),o=new of(w,T),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":w=a(e.geometry),T=d(e.material),o=new ar(w,T);break;case"InstancedMesh":w=a(e.geometry),T=d(e.material);let B=e.count,D=e.instanceMatrix,N=e.instanceColor;o=new hf(w,T,B),o.instanceMatrix=new da(new Float32Array(D.array),16),N!==void 0&&(o.instanceColor=new da(new Float32Array(N.array),N.itemSize));break;case"BatchedMesh":w=a(e.geometry),T=d(e.material),o=new ff(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,T),o.geometry=w,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(j=>{let G=new ji;G.min.fromArray(j.boxMin),G.max.fromArray(j.boxMax);let P=new cr;return P.radius=j.sphereRadius,P.center.fromArray(j.sphereCenter),{boxInitialized:j.boxInitialized,box:G,sphereInitialized:j.sphereInitialized,sphere:P}}),o._maxGeometryCount=e.maxGeometryCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=E(e.matricesTexture.uuid);break;case"LOD":o=new $u;break;case"Line":o=new to(a(e.geometry),d(e.material));break;case"LineLoop":o=new vf(a(e.geometry),d(e.material));break;case"LineSegments":o=new ys(a(e.geometry),d(e.material));break;case"PointCloud":case"Points":o=new yf(a(e.geometry),d(e.material));break;case"Sprite":o=new Ju(d(e.material));break;case"Group":o=new xo;break;case"Bone":o=new $h;break;default:o=new hi}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){let B=e.children;for(let D=0;D<B.length;D++)o.add(this.parseObject(B[D],t,n,i,r))}if(e.animations!==void 0){let B=e.animations;for(let D=0;D<B.length;D++){let N=B[D];o.animations.push(r[N])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);let B=e.levels;for(let D=0;D<B.length;D++){let N=B[D],j=o.getObjectByProperty("uuid",N.object);j!==void 0&&o.addLevel(j,N.distance,N.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){let i=t[n.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(i,n.bindMatrix)}})}}let pE={UVMapping:xe,CubeReflectionMapping:z,CubeRefractionMapping:I,EquirectangularReflectionMapping:R,EquirectangularRefractionMapping:ee,CubeUVReflectionMapping:he},up={RepeatWrapping:_e,ClampToEdgeWrapping:De,MirroredRepeatWrapping:Ct},fp={NearestFilter:Bt,NearestMipmapNearestFilter:_t,NearestMipmapLinearFilter:Xt,LinearFilter:pn,LinearMipmapNearestFilter:Oi,LinearMipmapLinearFilter:yi};class AE extends zr{constructor(e){super(e);this.isImageBitmapLoader=!0,typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let r=this,o=Us.get(e);if(o!==void 0){if(r.manager.itemStart(e),o.then){o.then(E=>{t&&t(E),r.manager.itemEnd(e)}).catch(E=>{i&&i(E)});return}return setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o}let a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;let d=fetch(e,a).then(function(E){return E.blob()}).then(function(E){return createImageBitmap(E,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(E){return Us.add(e,E),t&&t(E),r.manager.itemEnd(e),E}).catch(function(E){i&&i(E),Us.remove(e),r.manager.itemError(e),r.manager.itemEnd(e)});Us.add(e,d),r.manager.itemStart(e)}}let bc;class Sd{static getContext(){return bc===void 0&&(bc=new(window.AudioContext||window.webkitAudioContext)),bc}static setContext(e){bc=e}}class mE extends zr{constructor(e){super(e)}load(e,t,n,i){let r=this,o=new ks(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(d){try{let E=d.slice(0);Sd.getContext().decodeAudioData(E,function(T){t(T)}).catch(a)}catch(E){a(E)}},n,i);function a(d){i?i(d):console.error(d),r.manager.itemError(e)}}}let pp=new rn,Ap=new rn,Ro=new rn;class gE{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new dr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new dr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){let t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Ro.copy(e.projectionMatrix);let i=t.eyeSep/2,r=i*t.near/t.focus,o=t.near*Math.tan(Ts*t.fov*.5)/t.zoom,a,d;Ap.elements[12]=-i,pp.elements[12]=i,a=-o*t.aspect+r,d=o*t.aspect+r,Ro.elements[0]=2*t.near/(d-a),Ro.elements[8]=(d+a)/(d-a),this.cameraL.projectionMatrix.copy(Ro),a=-o*t.aspect-r,d=o*t.aspect-r,Ro.elements[0]=2*t.near/(d-a),Ro.elements[8]=(d+a)/(d-a),this.cameraR.projectionMatrix.copy(Ro)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Ap),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(pp)}}class mp{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=gp(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=gp();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function gp(){return(typeof performance=="undefined"?Date:performance).now()}let Lo=new ve,vp=new ci,vE=new ve,Do=new ve;class EE extends hi{constructor(){super();this.type="AudioListener",this.context=Sd.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new mp}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);let t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Lo,vp,vE),Do.set(0,0,-1).applyQuaternion(vp),t.positionX){let i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Lo.x,i),t.positionY.linearRampToValueAtTime(Lo.y,i),t.positionZ.linearRampToValueAtTime(Lo.z,i),t.forwardX.linearRampToValueAtTime(Do.x,i),t.forwardY.linearRampToValueAtTime(Do.y,i),t.forwardZ.linearRampToValueAtTime(Do.z,i),t.upX.linearRampToValueAtTime(n.x,i),t.upY.linearRampToValueAtTime(n.y,i),t.upZ.linearRampToValueAtTime(n.z,i)}else t.setPosition(Lo.x,Lo.y,Lo.z),t.setOrientation(Do.x,Do.y,Do.z,n.x,n.y,n.z)}}class Ep extends hi{constructor(e){super();this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;let t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}let Po=new ve,yp=new ci,yE=new ve,Fo=new ve;class CE extends Ep{constructor(e){super(e);this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Po,yp,yE),Fo.set(0,0,1).applyQuaternion(yp);let t=this.panner;if(t.positionX){let n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Po.x,n),t.positionY.linearRampToValueAtTime(Po.y,n),t.positionZ.linearRampToValueAtTime(Po.z,n),t.orientationX.linearRampToValueAtTime(Fo.x,n),t.orientationY.linearRampToValueAtTime(Fo.y,n),t.orientationZ.linearRampToValueAtTime(Fo.z,n)}else t.setPosition(Po.x,Po.y,Po.z),t.setOrientation(Fo.x,Fo.y,Fo.z)}}class xE{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0,t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class Cp{constructor(e,t,n){this.binding=e,this.valueSize=n;let i,r,o;switch(t){case"quaternion":i=this._slerp,r=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:i=this._lerp,r=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let n=this.buffer,i=this.valueSize,r=e*i+i,o=this.cumulativeWeight;if(o===0){for(let a=0;a!==i;++a)n[r+a]=n[a];o=t}else{o+=t;let a=t/o;this._mixBufferRegion(n,r,0,a,i)}this.cumulativeWeight=o}accumulateAdditive(e){let t=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){let d=t*this._origIndex;this._mixBufferRegion(n,i,d,1-r,t)}o>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let d=t,E=t+t;d!==E;++d)if(n[d]!==n[d+t]){a.setValue(n,i);break}}saveOriginalState(){let e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let r=n,o=i;r!==o;++r)t[r]=t[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,r){if(i>=.5)for(let o=0;o!==r;++o)e[t+o]=e[n+o]}_slerp(e,t,n,i){ci.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,r){let o=this._workIndex*r;ci.multiplyQuaternionsFlat(e,o,e,t,e,n),ci.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,n,i,r){let o=1-i;for(let a=0;a!==r;++a){let d=t+a;e[d]=e[d]*o+e[n+a]*i}}_lerpAdditive(e,t,n,i,r){for(let o=0;o!==r;++o){let a=t+o;e[a]=e[a]+e[n+o]*i}}}let Id="\\[\\]\\.:\\/",bE=new RegExp("["+Id+"]","g"),Td="[^"+Id+"]",_E="[^"+Id.replace("\\.","")+"]",wE=/((?:WC+[\/:])*)/.source.replace("WC",Td),ME=/(WCOD+)?/.source.replace("WCOD",_E),SE=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Td),IE=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Td),TE=new RegExp("^"+wE+ME+SE+IE+"$"),BE=["material","materials","bones","map"];class RE{constructor(e,t,n){let i=n||ai.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();let n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(e,t)}setValue(e,t){let n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class ai{constructor(e,t,n){this.path=t,this.parsedPath=n||ai.parseTrackName(t),this.node=ai.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new ai.Composite(e,t,n):new ai(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(bE,"")}static parseTrackName(e){let t=TE.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){let r=n.nodeName.substring(i+1);BE.indexOf(r)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=r)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){let n=function(r){for(let o=0;o<r.length;o++){let a=r[o];if(a.name===t||a.uuid===t)return a;let d=n(a.children);if(d)return d}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,n=t.objectName,i=t.propertyName,r=t.propertyIndex;if(e||(e=ai.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let E=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let w=0;w<e.length;w++)if(e[w].name===E){E=w;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(E!==void 0){if(e[E]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[E]}}let o=e[i];if(o===void 0){let E=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+E+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(r!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}d=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else o.fromArray!==void 0&&o.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(d=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ai.Composite=RE,ai.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},ai.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},ai.prototype.GetterByBindingType=[ai.prototype._getValue_direct,ai.prototype._getValue_array,ai.prototype._getValue_arrayElement,ai.prototype._getValue_toArray],ai.prototype.SetterByBindingTypeAndVersioning=[[ai.prototype._setValue_direct,ai.prototype._setValue_direct_setNeedsUpdate,ai.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ai.prototype._setValue_array,ai.prototype._setValue_array_setNeedsUpdate,ai.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ai.prototype._setValue_arrayElement,ai.prototype._setValue_arrayElement_setNeedsUpdate,ai.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ai.prototype._setValue_fromArray,ai.prototype._setValue_fromArray_setNeedsUpdate,ai.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class LE{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Pr(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;let e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};let t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){let e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,r=this._bindings,o=r.length,a,d=e.length,E=this.nCachedObjects_;for(let w=0,T=arguments.length;w!==T;++w){let B=arguments[w],D=B.uuid,N=t[D];if(N===void 0){N=d++,t[D]=N,e.push(B);for(let j=0,G=o;j!==G;++j)r[j].push(new ai(B,n[j],i[j]))}else if(N<E){a=e[N];let j=--E,G=e[j];t[G.uuid]=N,e[N]=G,t[D]=j,e[j]=B;for(let P=0,se=o;P!==se;++P){let $=r[P],J=$[j],Be=$[N];$[N]=J,Be===void 0&&(Be=new ai(B,n[P],i[P])),$[j]=Be}}else e[N]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=E}remove(){let e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length,r=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){let d=arguments[o],E=d.uuid,w=t[E];if(w!==void 0&&w>=r){let T=r++,B=e[T];t[B.uuid]=w,e[w]=B,t[E]=T,e[T]=d;for(let D=0,N=i;D!==N;++D){let j=n[D],G=j[T],P=j[w];j[w]=G,j[T]=P}}}this.nCachedObjects_=r}uncache(){let e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length,r=this.nCachedObjects_,o=e.length;for(let a=0,d=arguments.length;a!==d;++a){let E=arguments[a],w=E.uuid,T=t[w];if(T!==void 0)if(delete t[w],T<r){let B=--r,D=e[B],N=--o,j=e[N];t[D.uuid]=T,e[T]=D,t[j.uuid]=B,e[B]=j,e.pop();for(let G=0,P=i;G!==P;++G){let se=n[G],$=se[B],J=se[N];se[T]=$,se[B]=J,se.pop()}}else{let B=--o,D=e[B];B>0&&(t[D.uuid]=T),e[T]=D,e.pop();for(let N=0,j=i;N!==j;++N){let G=n[N];G[T]=G[B],G.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){let n=this._bindingsIndicesByPath,i=n[e],r=this._bindings;if(i!==void 0)return r[i];let o=this._paths,a=this._parsedPaths,d=this._objects,E=d.length,w=this.nCachedObjects_,T=new Array(E);i=r.length,n[e]=i,o.push(e),a.push(t),r.push(T);for(let B=w,D=d.length;B!==D;++B){let N=d[B];T[B]=new ai(N,e,t)}return T}unsubscribe_(e){let t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){let i=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,d=o[a],E=e[a];t[E]=n,o[n]=d,o.pop(),r[n]=r[a],r.pop(),i[n]=i[a],i.pop()}}}class xp{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;let r=t.tracks,o=r.length,a=new Array(o),d={endingStart:zi,endingEnd:zi};for(let E=0;E!==o;++E){let w=r[E].createInterpolant(null);a[E]=w,w.settings=d}this._interpolantSettings=d,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=wi,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){let i=this._clip.duration,r=e._clip.duration,o=r/i,a=i/r;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){let i=this._mixer,r=i.time,o=this.timeScale,a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);let d=a.parameterPositions,E=a.sampleValues;return d[0]=r,d[1]=r+n,E[0]=e/o,E[1]=t/o,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled){this._updateWeight(e);return}let r=this._startTime;if(r!==null){let d=(e-r)*n;d<0||n===0?t=0:(this._startTime=null,t=n*d)}t*=this._updateTimeScale(e);let o=this._updateTime(t),a=this._updateWeight(e);if(a>0){let d=this._interpolants,E=this._propertyBindings;switch(this.blendMode){case as:for(let w=0,T=d.length;w!==T;++w)d[w].evaluate(o),E[w].accumulateAdditive(a);break;case ns:default:for(let w=0,T=d.length;w!==T;++w)d[w].evaluate(o),E[w].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let n=this._weightInterpolant;if(n!==null){let i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let n=this._timeScaleInterpolant;n!==null&&(t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,n=this.loop,i=this.time+e,r=this._loopCount,o=n===tr;if(e===0)return r===-1?i:o&&(r&1)==1?t-i:i;if(n===Ri){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=t||i<0){let a=Math.floor(i/t);i-=t*a,r+=Math.abs(a);let d=this.repetitions-r;if(d<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(d===1){let E=e<0;this._setEndings(E,!E,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(o&&(r&1)==1)return t-i}return i}_setEndings(e,t,n){let i=this._interpolantSettings;n?(i.endingStart=gr,i.endingEnd=gr):(e?i.endingStart=this.zeroSlopeAtStart?gr:zi:i.endingStart=Wr,t?i.endingEnd=this.zeroSlopeAtEnd?gr:zi:i.endingEnd=Wr)}_scheduleFading(e,t,n){let i=this._mixer,r=i.time,o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);let a=o.parameterPositions,d=o.sampleValues;return a[0]=r,d[0]=t,a[1]=r+e,d[1]=n,this}}let DE=new Float32Array(1);class PE extends Dr{constructor(e){super();this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,o=e._propertyBindings,a=e._interpolants,d=n.uuid,E=this._bindingsByRootAndName,w=E[d];w===void 0&&(w={},E[d]=w);for(let T=0;T!==r;++T){let B=i[T],D=B.name,N=w[D];if(N!==void 0)++N.referenceCount,o[T]=N;else{if(N=o[T],N!==void 0){N._cacheIndex===null&&(++N.referenceCount,this._addInactiveBinding(N,d,D));continue}let j=t&&t._propertyBindings[T].binding.parsedPath;N=new Cp(ai.create(n,D,j),B.ValueTypeName,B.getValueSize()),++N.referenceCount,this._addInactiveBinding(N,d,D),o[T]=N}a[T].resultBuffer=N.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let n=(e._localRoot||this._root).uuid,i=e._clip.uuid,r=this._actionsByClip[i];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,i,n)}let t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){let r=t[n];r.useCount++==0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){let r=t[n];--r.useCount==0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){let i=this._actions,r=this._actionsByClip,o=r[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{let a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){let t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;let r=e._clip.uuid,o=this._actionsByClip,a=o[r],d=a.knownActions,E=d[d.length-1],w=e._byClipCacheIndex;E._byClipCacheIndex=w,d[w]=E,d.pop(),e._byClipCacheIndex=null;let T=a.actionByRoot,B=(e._localRoot||this._root).uuid;delete T[B],d.length===0&&delete o[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){let r=t[n];--r.referenceCount==0&&this._removeInactiveBinding(r)}}_lendAction(e){let t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackAction(e){let t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_addInactiveBinding(e,t,n){let i=this._bindingsByRootAndName,r=this._bindings,o=i[t];o===void 0&&(o={},i[t]=o),o[n]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){let t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,o=this._bindingsByRootAndName,a=o[i],d=t[t.length-1],E=e._cacheIndex;d._cacheIndex=E,t[E]=d,t.pop(),delete a[r],Object.keys(a).length===0&&delete o[i]}_lendBinding(e){let t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_takeBackBinding(e){let t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return n===void 0&&(n=new yd(new Float32Array(2),new Float32Array(2),1,DE),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){let t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r}clipAction(e,t,n){let i=t||this._root,r=i.uuid,o=typeof e=="string"?qa.findByName(i,e):e,a=o!==null?o.uuid:e,d=this._actionsByClip[a],E=null;if(n===void 0&&(o!==null?n=o.blendMode:n=ns),d!==void 0){let T=d.actionByRoot[r];if(T!==void 0&&T.blendMode===n)return T;E=d.knownActions[0],o===null&&(o=E._clip)}if(o===null)return null;let w=new xp(this,o,t,n);return this._bindAction(w,E),this._addInactiveAction(w,a,r),w}existingAction(e,t){let n=t||this._root,i=n.uuid,r=typeof e=="string"?qa.findByName(n,e):e,o=r?r.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;let t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1;for(let E=0;E!==n;++E)t[E]._update(i,e,r,o);let a=this._bindings,d=this._nActiveBindings;for(let E=0;E!==d;++E)a[E].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(r!==void 0){let o=r.knownActions;for(let a=0,d=o.length;a!==d;++a){let E=o[a];this._deactivateAction(E);let w=E._cacheIndex,T=t[t.length-1];E._cacheIndex=null,E._byClipCacheIndex=null,T._cacheIndex=w,t[w]=T,t.pop(),this._removeInactiveBindingsForAction(E)}delete i[n]}}uncacheRoot(e){let t=e.uuid,n=this._actionsByClip;for(let o in n){let a=n[o].actionByRoot,d=a[t];d!==void 0&&(this._deactivateAction(d),this._removeInactiveAction(d))}let i=this._bindingsByRootAndName,r=i[t];if(r!==void 0)for(let o in r){let a=r[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){let n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class Bd{constructor(e){this.value=e}clone(){return new Bd(this.value.clone===void 0?this.value:this.value.clone())}}let FE=0;class OE extends Dr{constructor(){super();this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:FE++}),this.name="",this.usage=uo,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){let t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;let t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++){let r=Array.isArray(t[n])?t[n]:[t[n]];for(let o=0;o<r.length;o++)this.uniforms.push(r[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class UE extends Nl{constructor(e,t,n=1){super(e,t);this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){let t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){let t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class NE{constructor(e,t,n,i,r){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=r,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}let bp=new rn;class kE{constructor(e,t,n=0,i=1/0){this.ray=new hr(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new gl,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return bp.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(bp),this}intersectObject(e,t=!0,n=[]){return Rd(e,this,n,t),n.sort(_p),n}intersectObjects(e,t=!0,n=[]){for(let i=0,r=e.length;i<r;i++)Rd(e[i],this,n,t);return n.sort(_p),n}}function _p(s,e){return s.distance-e.distance}function Rd(s,e,t,n){if(s.layers.test(e.layers)&&s.raycast(e,t),n===!0){let i=s.children;for(let r=0,o=i.length;r<o;r++)Rd(i[r],e,t,!0)}}class GE{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){let e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Vi(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class QE{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}let wp=new ht;class VE{constructor(e=new ht(1/0,1/0),t=new ht(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=wp.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,wp).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}let Mp=new ve,_c=new ve;class HE{constructor(e=new ve,t=new ve){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Mp.subVectors(e,this.start),_c.subVectors(this.end,this.start);let n=_c.dot(_c),r=_c.dot(Mp)/n;return t&&(r=Vi(r,0,1)),r}closestPointToPoint(e,t,n){let i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}let Sp=new ve;class zE extends hi{constructor(e,t){super();this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let n=new zn,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,d=32;o<d;o++,a++){let E=o/d*Math.PI*2,w=a/d*Math.PI*2;i.push(Math.cos(E),Math.sin(E),1,Math.cos(w),Math.sin(w),1)}n.setAttribute("position",new an(i,3));let r=new Nr({fog:!1,toneMapped:!1});this.cone=new ys(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Sp.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Sp),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}let ro=new ve,wc=new rn,Ld=new rn;class jE extends ys{constructor(e){let t=Ip(e),n=new zn,i=[],r=[],o=new qt(0,0,1),a=new qt(0,1,0);for(let E=0;E<t.length;E++){let w=t[E];w.parent&&w.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(o.r,o.g,o.b),r.push(a.r,a.g,a.b))}n.setAttribute("position",new an(i,3)),n.setAttribute("color",new an(r,3));let d=new Nr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,d);this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){let t=this.bones,n=this.geometry,i=n.getAttribute("position");Ld.copy(this.root.matrixWorld).invert();for(let r=0,o=0;r<t.length;r++){let a=t[r];a.parent&&a.parent.isBone&&(wc.multiplyMatrices(Ld,a.matrixWorld),ro.setFromMatrixPosition(wc),i.setXYZ(o,ro.x,ro.y,ro.z),wc.multiplyMatrices(Ld,a.parent.matrixWorld),ro.setFromMatrixPosition(wc),i.setXYZ(o+1,ro.x,ro.y,ro.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ip(s){let e=[];s.isBone===!0&&e.push(s);for(let t=0;t<s.children.length;t++)e.push.apply(e,Ip(s.children[t]));return e}class WE extends ar{constructor(e,t,n){let i=new Wa(t,4,2),r=new qs({wireframe:!0,fog:!1,toneMapped:!1});super(i,r);this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}let KE=new ve,Tp=new qt,Bp=new qt;class XE extends hi{constructor(e,t,n){super();this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";let i=new ja(t);i.rotateY(Math.PI*.5),this.material=new qs({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);let r=i.getAttribute("position"),o=new Float32Array(r.count*3);i.setAttribute("color",new Si(o,3)),this.add(new ar(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){let e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{let t=e.geometry.getAttribute("color");Tp.copy(this.light.color),Bp.copy(this.light.groundColor);for(let n=0,i=t.count;n<i;n++){let r=n<i/2?Tp:Bp;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(KE.setFromMatrixPosition(this.light.matrixWorld).negate())}}class YE extends ys{constructor(e=10,t=10,n=4473924,i=8947848){n=new qt(n),i=new qt(i);let r=t/2,o=e/t,a=e/2,d=[],E=[];for(let B=0,D=0,N=-a;B<=t;B++,N+=o){d.push(-a,0,N,a,0,N),d.push(N,0,-a,N,0,a);let j=B===r?n:i;j.toArray(E,D),D+=3,j.toArray(E,D),D+=3,j.toArray(E,D),D+=3,j.toArray(E,D),D+=3}let w=new zn;w.setAttribute("position",new an(d,3)),w.setAttribute("color",new an(E,3));let T=new Nr({vertexColors:!0,toneMapped:!1});super(w,T);this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class qE extends ys{constructor(e=10,t=16,n=8,i=64,r=4473924,o=8947848){r=new qt(r),o=new qt(o);let a=[],d=[];if(t>1)for(let T=0;T<t;T++){let B=T/t*(Math.PI*2),D=Math.sin(B)*e,N=Math.cos(B)*e;a.push(0,0,0),a.push(D,0,N);let j=T&1?r:o;d.push(j.r,j.g,j.b),d.push(j.r,j.g,j.b)}for(let T=0;T<n;T++){let B=T&1?r:o,D=e-e/n*T;for(let N=0;N<i;N++){let j=N/i*(Math.PI*2),G=Math.sin(j)*D,P=Math.cos(j)*D;a.push(G,0,P),d.push(B.r,B.g,B.b),j=(N+1)/i*(Math.PI*2),G=Math.sin(j)*D,P=Math.cos(j)*D,a.push(G,0,P),d.push(B.r,B.g,B.b)}}let E=new zn;E.setAttribute("position",new an(a,3)),E.setAttribute("color",new an(d,3));let w=new Nr({vertexColors:!0,toneMapped:!1});super(E,w);this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}let Rp=new ve,Mc=new ve,Lp=new ve;class JE extends hi{constructor(e,t,n){super();this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new zn;i.setAttribute("position",new an([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let r=new Nr({fog:!1,toneMapped:!1});this.lightPlane=new to(i,r),this.add(this.lightPlane),i=new zn,i.setAttribute("position",new an([0,0,0,0,0,1],3)),this.targetLine=new to(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),Rp.setFromMatrixPosition(this.light.matrixWorld),Mc.setFromMatrixPosition(this.light.target.matrixWorld),Lp.subVectors(Mc,Rp),this.lightPlane.lookAt(Mc),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Mc),this.targetLine.scale.z=Lp.length()}}let Sc=new ve,Yi=new Tl;class ZE extends ys{constructor(e){let t=new zn,n=new Nr({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(N,j){d(N),d(j)}function d(N){i.push(0,0,0),r.push(0,0,0),o[N]===void 0&&(o[N]=[]),o[N].push(i.length/3-1)}t.setAttribute("position",new an(i,3)),t.setAttribute("color",new an(r,3));super(t,n);this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();let E=new qt(16755200),w=new qt(16711680),T=new qt(43775),B=new qt(16777215),D=new qt(3355443);this.setColors(E,w,T,B,D)}setColors(e,t,n,i,r){let a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,i.r,i.g,i.b),a.setXYZ(39,i.r,i.g,i.b),a.setXYZ(40,r.r,r.g,r.b),a.setXYZ(41,r.r,r.g,r.b),a.setXYZ(42,r.r,r.g,r.b),a.setXYZ(43,r.r,r.g,r.b),a.setXYZ(44,r.r,r.g,r.b),a.setXYZ(45,r.r,r.g,r.b),a.setXYZ(46,r.r,r.g,r.b),a.setXYZ(47,r.r,r.g,r.b),a.setXYZ(48,r.r,r.g,r.b),a.setXYZ(49,r.r,r.g,r.b),a.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap,n=1,i=1;Yi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),rr("c",t,e,Yi,0,0,-1),rr("t",t,e,Yi,0,0,1),rr("n1",t,e,Yi,-n,-i,-1),rr("n2",t,e,Yi,n,-i,-1),rr("n3",t,e,Yi,-n,i,-1),rr("n4",t,e,Yi,n,i,-1),rr("f1",t,e,Yi,-n,-i,1),rr("f2",t,e,Yi,n,-i,1),rr("f3",t,e,Yi,-n,i,1),rr("f4",t,e,Yi,n,i,1),rr("u1",t,e,Yi,n*.7,i*1.1,-1),rr("u2",t,e,Yi,-n*.7,i*1.1,-1),rr("u3",t,e,Yi,0,i*2,-1),rr("cf1",t,e,Yi,-n,0,1),rr("cf2",t,e,Yi,n,0,1),rr("cf3",t,e,Yi,0,-i,1),rr("cf4",t,e,Yi,0,i,1),rr("cn1",t,e,Yi,-n,0,-1),rr("cn2",t,e,Yi,n,0,-1),rr("cn3",t,e,Yi,0,-i,-1),rr("cn4",t,e,Yi,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function rr(s,e,t,n,i,r,o){Sc.set(i,r,o).unproject(n);let a=e[s];if(a!==void 0){let d=t.getAttribute("position");for(let E=0,w=a.length;E<w;E++)d.setXYZ(a[E],Sc.x,Sc.y,Sc.z)}}let Ic=new ji;class $E extends ys{constructor(e,t=16776960){let n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),r=new zn;r.setIndex(new Si(n,1)),r.setAttribute("position",new Si(i,3));super(r,new Nr({color:t,toneMapped:!1}));this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Ic.setFromObject(this.object),Ic.isEmpty())return;let t=Ic.min,n=Ic.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=t.x,r[4]=n.y,r[5]=n.z,r[6]=t.x,r[7]=t.y,r[8]=n.z,r[9]=n.x,r[10]=t.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=t.z,r[15]=t.x,r[16]=n.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=n.x,r[22]=t.y,r[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class e1 extends ys{constructor(e,t=16776960){let n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new zn;r.setIndex(new Si(n,1)),r.setAttribute("position",new an(i,3));super(r,new Nr({color:t,toneMapped:!1}));this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class t1 extends to{constructor(e,t=1,n=16776960){let i=n,r=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new zn;o.setAttribute("position",new an(r,3)),o.computeBoundingSphere();super(o,new Nr({color:i,toneMapped:!1}));this.type="PlaneHelper",this.plane=e,this.size=t;let a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],d=new zn;d.setAttribute("position",new an(a,3)),d.computeBoundingSphere(),this.add(new ar(d,new qs({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}let Dp=new ve,Tc,Dd;class n1 extends hi{constructor(e=new ve(0,0,1),t=new ve(0,0,0),n=1,i=16776960,r=n*.2,o=r*.2){super();this.type="ArrowHelper",Tc===void 0&&(Tc=new zn,Tc.setAttribute("position",new an([0,0,0,0,1,0],3)),Dd=new pa(0,.5,1,5,1),Dd.translate(0,-.5,0)),this.position.copy(t),this.line=new to(Tc,new Nr({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ar(Dd,new qs({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Dp.set(e.z,0,-e.x).normalize();let t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Dp,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class i1 extends ys{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new zn;i.setAttribute("position",new an(t,3)),i.setAttribute("color",new an(n,3));let r=new Nr({vertexColors:!0,toneMapped:!1});super(i,r);this.type="AxesHelper"}setColors(e,t,n){let i=new qt,r=this.geometry.attributes.color.array;return i.set(e),i.toArray(r,0),i.toArray(r,3),i.set(t),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class r1{constructor(){this.type="ShapePath",this.color=new qt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Ga,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,r,o){return this.currentPath.bezierCurveTo(e,t,n,i,r,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(P){let se=[];for(let $=0,J=P.length;$<J;$++){let Be=P[$],ge=new Mo;ge.curves=Be.curves,se.push(ge)}return se}function n(P,se){let $=se.length,J=!1;for(let Be=$-1,ge=0;ge<$;Be=ge++){let we=se[Be],Te=se[ge],de=Te.x-we.x,le=Te.y-we.y;if(Math.abs(le)>Number.EPSILON){if(le<0&&(we=se[ge],de=-de,Te=se[Be],le=-le),P.y<we.y||P.y>Te.y)continue;if(P.y===we.y){if(P.x===we.x)return!0}else{let Ie=le*(P.x-we.x)-de*(P.y-we.y);if(Ie===0)return!0;if(Ie<0)continue;J=!J}}else{if(P.y!==we.y)continue;if(Te.x<=P.x&&P.x<=we.x||we.x<=P.x&&P.x<=Te.x)return!0}}return J}let i=Cs.isClockWise,r=this.subPaths;if(r.length===0)return[];let o,a,d,E=[];if(r.length===1)return a=r[0],d=new Mo,d.curves=a.curves,E.push(d),E;let w=!i(r[0].getPoints());w=e?!w:w;let T=[],B=[],D=[],N=0,j;B[N]=void 0,D[N]=[];for(let P=0,se=r.length;P<se;P++)a=r[P],j=a.getPoints(),o=i(j),o=e?!o:o,o?(!w&&B[N]&&N++,B[N]={s:new Mo,p:j},B[N].s.curves=a.curves,w&&N++,D[N]=[]):D[N].push({h:a,p:j[0]});if(!B[0])return t(r);if(B.length>1){let P=!1,se=0;for(let $=0,J=B.length;$<J;$++)T[$]=[];for(let $=0,J=B.length;$<J;$++){let Be=D[$];for(let ge=0;ge<Be.length;ge++){let we=Be[ge],Te=!0;for(let de=0;de<B.length;de++)n(we.p,B[de].p)&&($!==de&&se++,Te?(Te=!1,T[de].push(we)):P=!0);Te&&T[$].push(we)}}se>0&&P===!1&&(D=T)}let G;for(let P=0,se=B.length;P<se;P++){d=B[P].s,E.push(d),G=D[P];for(let $=0,J=G.length;$<J;$++)d.holes.push(G[$].h)}return E}}class s1 extends Gr{constructor(e=1,t=1,n=1,i={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.');super(e,t,{...i,count:n});this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:y}})),typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=y)},"./node_modules/three/examples/jsm/libs/ktx-parse.module.js":(k,K,f)=>{"use strict";f.r(K),f.d(K,{KHR_DF_CHANNEL_RGBSDA_ALPHA:()=>mr,KHR_DF_CHANNEL_RGBSDA_BLUE:()=>Jn,KHR_DF_CHANNEL_RGBSDA_DEPTH:()=>vi,KHR_DF_CHANNEL_RGBSDA_GREEN:()=>pi,KHR_DF_CHANNEL_RGBSDA_RED:()=>qi,KHR_DF_CHANNEL_RGBSDA_STENCIL:()=>Fi,KHR_DF_FLAG_ALPHA_PREMULTIPLIED:()=>L,KHR_DF_FLAG_ALPHA_STRAIGHT:()=>b,KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT:()=>u,KHR_DF_MODEL_ASTC:()=>x,KHR_DF_MODEL_ETC1:()=>h,KHR_DF_MODEL_ETC1S:()=>S,KHR_DF_MODEL_ETC2:()=>m,KHR_DF_MODEL_RGBSDA:()=>A,KHR_DF_MODEL_UNSPECIFIED:()=>g,KHR_DF_PRIMARIES_ACES:()=>Sn,KHR_DF_PRIMARIES_ACESCC:()=>Nn,KHR_DF_PRIMARIES_ADOBERGB:()=>si,KHR_DF_PRIMARIES_BT2020:()=>un,KHR_DF_PRIMARIES_BT601_EBU:()=>Tt,KHR_DF_PRIMARIES_BT601_SMPTE:()=>kt,KHR_DF_PRIMARIES_BT709:()=>pt,KHR_DF_PRIMARIES_CIEXYZ:()=>yn,KHR_DF_PRIMARIES_DISPLAYP3:()=>fi,KHR_DF_PRIMARIES_NTSC1953:()=>ln,KHR_DF_PRIMARIES_PAL525:()=>En,KHR_DF_PRIMARIES_UNSPECIFIED:()=>Dt,KHR_DF_SAMPLE_DATATYPE_EXPONENT:()=>vt,KHR_DF_SAMPLE_DATATYPE_FLOAT:()=>Ji,KHR_DF_SAMPLE_DATATYPE_LINEAR:()=>ae,KHR_DF_SAMPLE_DATATYPE_SIGNED:()=>Ei,KHR_DF_TRANSFER_ACESCC:()=>je,KHR_DF_TRANSFER_ACESCCT:()=>nt,KHR_DF_TRANSFER_ADOBERGB:()=>mt,KHR_DF_TRANSFER_BT1886:()=>X,KHR_DF_TRANSFER_DCIP3:()=>pe,KHR_DF_TRANSFER_HLG_EOTF:()=>O,KHR_DF_TRANSFER_HLG_OETF:()=>V,KHR_DF_TRANSFER_ITU:()=>Y,KHR_DF_TRANSFER_LINEAR:()=>F,KHR_DF_TRANSFER_NTSC:()=>W,KHR_DF_TRANSFER_PAL625_EOTF:()=>Re,KHR_DF_TRANSFER_PAL_OETF:()=>be,KHR_DF_TRANSFER_PQ_EOTF:()=>Z,KHR_DF_TRANSFER_PQ_OETF:()=>ne,KHR_DF_TRANSFER_SLOG:()=>te,KHR_DF_TRANSFER_SLOG2:()=>re,KHR_DF_TRANSFER_SRGB:()=>H,KHR_DF_TRANSFER_ST240:()=>Ue,KHR_DF_TRANSFER_UNSPECIFIED:()=>M,KHR_DF_VENDORID_KHRONOS:()=>p,KHR_DF_VERSION:()=>c,KHR_SUPERCOMPRESSION_BASISLZ:()=>v,KHR_SUPERCOMPRESSION_NONE:()=>_,KHR_SUPERCOMPRESSION_ZLIB:()=>l,KHR_SUPERCOMPRESSION_ZSTD:()=>C,KTX2Container:()=>Bs,VK_FORMAT_A1R5G5B5_UNORM_PACK16:()=>ee,VK_FORMAT_A2B10G10R10_SINT_PACK32:()=>on,VK_FORMAT_A2B10G10R10_SNORM_PACK32:()=>Gt,VK_FORMAT_A2B10G10R10_UINT_PACK32:()=>ot,VK_FORMAT_A2B10G10R10_UNORM_PACK32:()=>$t,VK_FORMAT_A2R10G10B10_SINT_PACK32:()=>yt,VK_FORMAT_A2R10G10B10_SNORM_PACK32:()=>We,VK_FORMAT_A2R10G10B10_UINT_PACK32:()=>st,VK_FORMAT_A2R10G10B10_UNORM_PACK32:()=>$e,VK_FORMAT_A4B4G4R4_UNORM_PACK16_EXT:()=>xa,VK_FORMAT_A4R4G4B4_UNORM_PACK16_EXT:()=>js,VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT:()=>No,VK_FORMAT_ASTC_10x10_SRGB_BLOCK:()=>Vi,VK_FORMAT_ASTC_10x10_UNORM_BLOCK:()=>Pr,VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT:()=>dl,VK_FORMAT_ASTC_10x5_SRGB_BLOCK:()=>Dr,VK_FORMAT_ASTC_10x5_UNORM_BLOCK:()=>fo,VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT:()=>ul,VK_FORMAT_ASTC_10x6_SRGB_BLOCK:()=>al,VK_FORMAT_ASTC_10x6_UNORM_BLOCK:()=>vr,VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT:()=>fl,VK_FORMAT_ASTC_10x8_SRGB_BLOCK:()=>Hs,VK_FORMAT_ASTC_10x8_UNORM_BLOCK:()=>Ts,VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT:()=>xh,VK_FORMAT_ASTC_12x10_SRGB_BLOCK:()=>rh,VK_FORMAT_ASTC_12x10_UNORM_BLOCK:()=>ya,VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT:()=>Ai,VK_FORMAT_ASTC_12x12_SRGB_BLOCK:()=>po,VK_FORMAT_ASTC_12x12_UNORM_BLOCK:()=>sh,VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT:()=>Bn,VK_FORMAT_ASTC_4x4_SRGB_BLOCK:()=>rl,VK_FORMAT_ASTC_4x4_UNORM_BLOCK:()=>il,VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT:()=>Ca,VK_FORMAT_ASTC_5x4_SRGB_BLOCK:()=>ol,VK_FORMAT_ASTC_5x4_UNORM_BLOCK:()=>sl,VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT:()=>ll,VK_FORMAT_ASTC_5x5_SRGB_BLOCK:()=>Yc,VK_FORMAT_ASTC_5x5_UNORM_BLOCK:()=>uo,VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT:()=>Ch,VK_FORMAT_ASTC_6x5_SRGB_BLOCK:()=>Jc,VK_FORMAT_ASTC_6x5_UNORM_BLOCK:()=>qc,VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT:()=>zs,VK_FORMAT_ASTC_6x6_SRGB_BLOCK:()=>$c,VK_FORMAT_ASTC_6x6_UNORM_BLOCK:()=>Zc,VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT:()=>Ao,VK_FORMAT_ASTC_8x5_SRGB_BLOCK:()=>th,VK_FORMAT_ASTC_8x5_UNORM_BLOCK:()=>eh,VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT:()=>cl,VK_FORMAT_ASTC_8x6_SRGB_BLOCK:()=>ih,VK_FORMAT_ASTC_8x6_UNORM_BLOCK:()=>nh,VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT:()=>hl,VK_FORMAT_ASTC_8x8_SRGB_BLOCK:()=>is,VK_FORMAT_ASTC_8x8_UNORM_BLOCK:()=>Ea,VK_FORMAT_B10G11R11_UFLOAT_PACK32:()=>Ms,VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16:()=>hh,VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16:()=>Ah,VK_FORMAT_B4G4R4A4_UNORM_PACK16:()=>Ee,VK_FORMAT_B5G5R5A1_UNORM_PACK16:()=>R,VK_FORMAT_B5G6R5_UNORM_PACK16:()=>z,VK_FORMAT_B8G8R8A8_SINT:()=>Me,VK_FORMAT_B8G8R8A8_SNORM:()=>ps,VK_FORMAT_B8G8R8A8_SRGB:()=>Ne,VK_FORMAT_B8G8R8A8_UINT:()=>ue,VK_FORMAT_B8G8R8A8_UNORM:()=>Vs,VK_FORMAT_B8G8R8_SINT:()=>ts,VK_FORMAT_B8G8R8_SNORM:()=>Zi,VK_FORMAT_B8G8R8_SRGB:()=>xr,VK_FORMAT_B8G8R8_UINT:()=>Lr,VK_FORMAT_B8G8R8_UNORM:()=>es,VK_FORMAT_BC1_RGBA_SRGB_BLOCK:()=>Ii,VK_FORMAT_BC1_RGBA_UNORM_BLOCK:()=>lo,VK_FORMAT_BC1_RGB_SRGB_BLOCK:()=>ao,VK_FORMAT_BC1_RGB_UNORM_BLOCK:()=>Uo,VK_FORMAT_BC2_SRGB_BLOCK:()=>ho,VK_FORMAT_BC2_UNORM_BLOCK:()=>co,VK_FORMAT_BC3_SRGB_BLOCK:()=>Is,VK_FORMAT_BC3_UNORM_BLOCK:()=>Fc,VK_FORMAT_BC4_SNORM_BLOCK:()=>Uc,VK_FORMAT_BC4_UNORM_BLOCK:()=>Oc,VK_FORMAT_BC5_SNORM_BLOCK:()=>kc,VK_FORMAT_BC5_UNORM_BLOCK:()=>Nc,VK_FORMAT_BC6H_SFLOAT_BLOCK:()=>Qc,VK_FORMAT_BC6H_UFLOAT_BLOCK:()=>Gc,VK_FORMAT_BC7_SRGB_BLOCK:()=>Hc,VK_FORMAT_BC7_UNORM_BLOCK:()=>Vc,VK_FORMAT_D16_UNORM:()=>As,VK_FORMAT_D16_UNORM_S8_UINT:()=>br,VK_FORMAT_D24_UNORM_S8_UINT:()=>ni,VK_FORMAT_D32_SFLOAT:()=>Mr,VK_FORMAT_D32_SFLOAT_S8_UINT:()=>ls,VK_FORMAT_E5B9G9R9_UFLOAT_PACK32:()=>Ss,VK_FORMAT_EAC_R11G11_SNORM_BLOCK:()=>va,VK_FORMAT_EAC_R11G11_UNORM_BLOCK:()=>nl,VK_FORMAT_EAC_R11_SNORM_BLOCK:()=>tl,VK_FORMAT_EAC_R11_UNORM_BLOCK:()=>el,VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK:()=>Kc,VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK:()=>Wc,VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK:()=>ga,VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK:()=>Xc,VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK:()=>jc,VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK:()=>zc,VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16:()=>ch,VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16:()=>ph,VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG:()=>_r,VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG:()=>mh,VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG:()=>Dn,VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG:()=>gh,VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG:()=>yh,VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG:()=>vh,VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG:()=>ht,VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG:()=>Eh,VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16:()=>lh,VK_FORMAT_R10X6G10X6_UNORM_2PACK16:()=>ah,VK_FORMAT_R10X6_UNORM_PACK16:()=>oh,VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16:()=>fh,VK_FORMAT_R12X4G12X4_UNORM_2PACK16:()=>uh,VK_FORMAT_R12X4_UNORM_PACK16:()=>dh,VK_FORMAT_R16G16B16A16_SFLOAT:()=>lt,VK_FORMAT_R16G16B16A16_SINT:()=>ze,VK_FORMAT_R16G16B16A16_SNORM:()=>Ae,VK_FORMAT_R16G16B16A16_UINT:()=>Pe,VK_FORMAT_R16G16B16A16_UNORM:()=>ie,VK_FORMAT_R16G16B16_SFLOAT:()=>q,VK_FORMAT_R16G16B16_SINT:()=>Q,VK_FORMAT_R16G16B16_SNORM:()=>$n,VK_FORMAT_R16G16B16_UINT:()=>U,VK_FORMAT_R16G16B16_UNORM:()=>Hi,VK_FORMAT_R16G16_SFLOAT:()=>On,VK_FORMAT_R16G16_SINT:()=>Qt,VK_FORMAT_R16G16_SNORM:()=>Bi,VK_FORMAT_R16G16_UINT:()=>er,VK_FORMAT_R16G16_UNORM:()=>Yn,VK_FORMAT_R16_SFLOAT:()=>In,VK_FORMAT_R16_SINT:()=>Fn,VK_FORMAT_R16_SNORM:()=>Cn,VK_FORMAT_R16_UINT:()=>xi,VK_FORMAT_R16_UNORM:()=>An,VK_FORMAT_R32G32B32A32_SFLOAT:()=>_i,VK_FORMAT_R32G32B32A32_SINT:()=>li,VK_FORMAT_R32G32B32A32_UINT:()=>vn,VK_FORMAT_R32G32B32_SFLOAT:()=>_n,VK_FORMAT_R32G32B32_SINT:()=>Ln,VK_FORMAT_R32G32B32_UINT:()=>mn,VK_FORMAT_R32G32_SFLOAT:()=>tn,VK_FORMAT_R32G32_SINT:()=>zt,VK_FORMAT_R32G32_UINT:()=>Et,VK_FORMAT_R32_SFLOAT:()=>et,VK_FORMAT_R32_SINT:()=>Ve,VK_FORMAT_R32_UINT:()=>at,VK_FORMAT_R4G4B4A4_UNORM_PACK16:()=>fe,VK_FORMAT_R4G4_UNORM_PACK8:()=>Ce,VK_FORMAT_R5G5B5A1_UNORM_PACK16:()=>I,VK_FORMAT_R5G6B5_UNORM_PACK16:()=>xe,VK_FORMAT_R64G64B64A64_SFLOAT:()=>ws,VK_FORMAT_R64G64B64A64_SINT:()=>as,VK_FORMAT_R64G64B64A64_UINT:()=>ns,VK_FORMAT_R64G64B64_SFLOAT:()=>Wr,VK_FORMAT_R64G64B64_SINT:()=>gr,VK_FORMAT_R64G64B64_UINT:()=>zi,VK_FORMAT_R64G64_SFLOAT:()=>sr,VK_FORMAT_R64G64_SINT:()=>ir,VK_FORMAT_R64G64_UINT:()=>nr,VK_FORMAT_R64_SFLOAT:()=>tr,VK_FORMAT_R64_SINT:()=>wi,VK_FORMAT_R64_UINT:()=>Ri,VK_FORMAT_R8G8B8A8_SINT:()=>_s,VK_FORMAT_R8G8B8A8_SNORM:()=>Ci,VK_FORMAT_R8G8B8A8_SRGB:()=>jr,VK_FORMAT_R8G8B8A8_UINT:()=>$i,VK_FORMAT_R8G8B8A8_UNORM:()=>Ni,VK_FORMAT_R8G8B8_SINT:()=>kr,VK_FORMAT_R8G8B8_SNORM:()=>ti,VK_FORMAT_R8G8B8_SRGB:()=>Ui,VK_FORMAT_R8G8B8_UINT:()=>yi,VK_FORMAT_R8G8B8_UNORM:()=>Oi,VK_FORMAT_R8G8_SINT:()=>Qi,VK_FORMAT_R8G8_SNORM:()=>Mt,VK_FORMAT_R8G8_SRGB:()=>pn,VK_FORMAT_R8G8_UINT:()=>Xt,VK_FORMAT_R8G8_UNORM:()=>_t,VK_FORMAT_R8_SINT:()=>Ct,VK_FORMAT_R8_SNORM:()=>_e,VK_FORMAT_R8_SRGB:()=>Bt,VK_FORMAT_R8_UINT:()=>De,VK_FORMAT_R8_UNORM:()=>he,VK_FORMAT_S8_UINT:()=>gs,VK_FORMAT_UNDEFINED:()=>oe,VK_FORMAT_X8_D24_UNORM_PACK32:()=>ms,read:()=>oi,write:()=>Qo});var y=f("./node_modules/buffer/index.js").Buffer;let _=0,v=1,C=2,l=3,u=0,p=0,c=2,g=0,A=1,h=160,m=161,x=162,S=163,b=0,L=1,M=0,F=1,H=2,Y=3,W=4,te=5,re=6,X=7,V=8,O=9,Z=10,ne=11,pe=12,be=13,Re=14,Ue=15,je=16,nt=17,mt=18,Dt=0,pt=1,Tt=2,kt=3,un=4,yn=5,Sn=6,Nn=7,ln=8,En=9,fi=10,si=11,qi=0,pi=1,Jn=2,Fi=13,vi=14,mr=15,Ji=128,Ei=64,vt=32,ae=16,oe=0,Ce=1,fe=2,Ee=3,xe=4,z=5,I=6,R=7,ee=8,he=9,_e=10,De=13,Ct=14,Bt=15,_t=16,Mt=17,Xt=20,Qi=21,pn=22,Oi=23,ti=24,yi=27,kr=28,Ui=29,es=30,Zi=31,Lr=34,ts=35,xr=36,Ni=37,Ci=38,$i=41,_s=42,jr=43,Vs=44,ps=45,ue=48,Me=49,Ne=50,$e=58,We=59,st=62,yt=63,$t=64,Gt=65,ot=68,on=69,An=70,Cn=71,xi=74,Fn=75,In=76,Yn=77,Bi=78,er=81,Qt=82,On=83,Hi=84,$n=85,U=88,Q=89,q=90,ie=91,Ae=92,Pe=95,ze=96,lt=97,at=98,Ve=99,et=100,Et=101,zt=102,tn=103,mn=104,Ln=105,_n=106,vn=107,li=108,_i=109,Ri=110,wi=111,tr=112,nr=113,ir=114,sr=115,zi=116,gr=117,Wr=118,ns=119,as=120,ws=121,Ms=122,Ss=123,As=124,ms=125,Mr=126,gs=127,br=128,ni=129,ls=130,Uo=131,ao=132,lo=133,Ii=134,co=135,ho=136,Fc=137,Is=138,Oc=139,Uc=140,Nc=141,kc=142,Gc=143,Qc=144,Vc=145,Hc=146,zc=147,jc=148,Wc=149,Kc=150,Xc=151,ga=152,el=153,tl=154,nl=155,va=156,il=157,rl=158,sl=159,ol=160,uo=161,Yc=162,qc=163,Jc=164,Zc=165,$c=166,eh=167,th=168,nh=169,ih=170,Ea=171,is=172,fo=173,Dr=174,vr=175,al=176,Ts=177,Hs=178,Pr=179,Vi=180,ya=181,rh=182,sh=183,po=184,oh=1000156007,ah=1000156008,lh=1000156009,ch=1000156010,hh=1000156011,dh=1000156017,uh=1000156018,fh=1000156019,ph=1000156020,Ah=1000156021,mh=1000054e3,gh=1000054001,vh=1000054002,Eh=1000054003,_r=1000054004,Dn=1000054005,yh=1000054006,ht=1000054007,Bn=1000066e3,Ca=1000066001,ll=1000066002,Ch=1000066003,zs=1000066004,Ao=1000066005,cl=1000066006,hl=1000066007,dl=1000066008,ul=1000066009,fl=1000066010,No=1000066011,xh=1000066012,Ai=1000066013,js=100034e4,xa=1000340001;class Bs{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class Ws{constructor(Rn,ei,ci,ve){this._dataView=new DataView(Rn.buffer,Rn.byteOffset+ei,ci),this._littleEndian=ve,this._offset=0}_nextUint8(){let Rn=this._dataView.getUint8(this._offset);return this._offset+=1,Rn}_nextUint16(){let Rn=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,Rn}_nextUint32(){let Rn=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,Rn}_nextUint64(){let Rn=this._dataView.getUint32(this._offset,this._littleEndian)+2**32*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,Rn}_nextInt32(){let Rn=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,Rn}_skip(Rn){return this._offset+=Rn,this}_scan(Rn,ei=0){let ci=this._offset,ve=0;for(;this._dataView.getUint8(this._offset)!==ei&&ve<Rn;)ve++,this._offset++;return ve<Rn&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+ci,ve)}}let pl=new Uint8Array([0]),ki=[171,75,84,88,32,50,48,187,13,10,26,10];function ko(en){return typeof TextEncoder!="undefined"?new TextEncoder().encode(en):y.from(en)}function Al(en){return typeof TextDecoder!="undefined"?new TextDecoder().decode(en):y.from(en).toString("utf8")}function Li(en){let Rn=0;for(let ve of en)Rn+=ve.byteLength;let ei=new Uint8Array(Rn),ci=0;for(let ve of en)ei.set(new Uint8Array(ve),ci),ci+=ve.byteLength;return ei}function oi(en){let Rn=new Uint8Array(en.buffer,en.byteOffset,ki.length);if(Rn[0]!==ki[0]||Rn[1]!==ki[1]||Rn[2]!==ki[2]||Rn[3]!==ki[3]||Rn[4]!==ki[4]||Rn[5]!==ki[5]||Rn[6]!==ki[6]||Rn[7]!==ki[7]||Rn[8]!==ki[8]||Rn[9]!==ki[9]||Rn[10]!==ki[10]||Rn[11]!==ki[11])throw new Error("Missing KTX 2.0 identifier.");let ei=new Bs,ci=17*Uint32Array.BYTES_PER_ELEMENT,ve=new Ws(en,ki.length,ci,!0);ei.vkFormat=ve._nextUint32(),ei.typeSize=ve._nextUint32(),ei.pixelWidth=ve._nextUint32(),ei.pixelHeight=ve._nextUint32(),ei.pixelDepth=ve._nextUint32(),ei.layerCount=ve._nextUint32(),ei.faceCount=ve._nextUint32();let Kr=ve._nextUint32();ei.supercompressionScheme=ve._nextUint32();let Xi=ve._nextUint32(),ji=ve._nextUint32(),Zn=ve._nextUint32(),Sr=ve._nextUint32(),vs=ve._nextUint64(),Qr=ve._nextUint64(),Er=new Ws(en,ki.length+ci,3*Kr*8,!0);for(let hr=0;hr<Kr;hr++)ei.levels.push({levelData:new Uint8Array(en.buffer,en.byteOffset+Er._nextUint64(),Er._nextUint64()),uncompressedByteLength:Er._nextUint64()});let kn=new Ws(en,Xi,ji,!0),wr={vendorId:kn._skip(4)._nextUint16(),descriptorType:kn._nextUint16(),versionNumber:kn._nextUint16(),descriptorBlockSize:kn._nextUint16(),colorModel:kn._nextUint8(),colorPrimaries:kn._nextUint8(),transferFunction:kn._nextUint8(),flags:kn._nextUint8(),texelBlockDimension:[kn._nextUint8(),kn._nextUint8(),kn._nextUint8(),kn._nextUint8()],bytesPlane:[kn._nextUint8(),kn._nextUint8(),kn._nextUint8(),kn._nextUint8(),kn._nextUint8(),kn._nextUint8(),kn._nextUint8(),kn._nextUint8()],samples:[]},Xr=(wr.descriptorBlockSize/4-6)/4;for(let hr=0;hr<Xr;hr++){let rn={bitOffset:kn._nextUint16(),bitLength:kn._nextUint8(),channelType:kn._nextUint8(),samplePosition:[kn._nextUint8(),kn._nextUint8(),kn._nextUint8(),kn._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&rn.channelType?(rn.sampleLower=kn._nextInt32(),rn.sampleUpper=kn._nextInt32()):(rn.sampleLower=kn._nextUint32(),rn.sampleUpper=kn._nextUint32()),wr.samples[hr]=rn}ei.dataFormatDescriptor.length=0,ei.dataFormatDescriptor.push(wr);let yr=new Ws(en,Zn,Sr,!0);for(;yr._offset<Sr;){let hr=yr._nextUint32(),rn=yr._scan(hr),Ls=Al(rn),Vr=yr._scan(hr-rn.byteLength);ei.keyValue[Ls]=Ls.match(/^ktx/i)?Al(Vr):Vr,yr._offset%4&&yr._skip(4-yr._offset%4)}if(Qr<=0)return ei;let ii=new Ws(en,vs,Qr,!0),Mi=ii._nextUint16(),Gn=ii._nextUint16(),ri=ii._nextUint32(),Fr=ii._nextUint32(),Ks=ii._nextUint32(),Rs=ii._nextUint32(),Vo=[];for(let hr=0;hr<Kr;hr++)Vo.push({imageFlags:ii._nextUint32(),rgbSliceByteOffset:ii._nextUint32(),rgbSliceByteLength:ii._nextUint32(),alphaSliceByteOffset:ii._nextUint32(),alphaSliceByteLength:ii._nextUint32()});let cr=vs+ii._offset,rs=cr+ri,Ho=rs+Fr,zo=Ho+Ks,Es=new Uint8Array(en.buffer,en.byteOffset+cr,ri),ba=new Uint8Array(en.buffer,en.byteOffset+rs,Fr),jo=new Uint8Array(en.buffer,en.byteOffset+Ho,Ks),_a=new Uint8Array(en.buffer,en.byteOffset+zo,Rs);return ei.globalData={endpointCount:Mi,selectorCount:Gn,imageDescs:Vo,endpointsData:Es,selectorsData:ba,tablesData:jo,extendedData:_a},ei}function Go(){return(Go=Object.assign||function(en){for(var Rn=1;Rn<arguments.length;Rn++){var ei=arguments[Rn];for(var ci in ei)Object.prototype.hasOwnProperty.call(ei,ci)&&(en[ci]=ei[ci])}return en}).apply(this,arguments)}let Gr={keepWriter:!1};function Qo(en,Rn={}){Rn=Go({},Gr,Rn);let ei=new ArrayBuffer(0);if(en.globalData){let Mi=new ArrayBuffer(20+5*en.globalData.imageDescs.length*4),Gn=new DataView(Mi);Gn.setUint16(0,en.globalData.endpointCount,!0),Gn.setUint16(2,en.globalData.selectorCount,!0),Gn.setUint32(4,en.globalData.endpointsData.byteLength,!0),Gn.setUint32(8,en.globalData.selectorsData.byteLength,!0),Gn.setUint32(12,en.globalData.tablesData.byteLength,!0),Gn.setUint32(16,en.globalData.extendedData.byteLength,!0);for(let ri=0;ri<en.globalData.imageDescs.length;ri++){let Fr=en.globalData.imageDescs[ri];Gn.setUint32(20+5*ri*4+0,Fr.imageFlags,!0),Gn.setUint32(20+5*ri*4+4,Fr.rgbSliceByteOffset,!0),Gn.setUint32(20+5*ri*4+8,Fr.rgbSliceByteLength,!0),Gn.setUint32(20+5*ri*4+12,Fr.alphaSliceByteOffset,!0),Gn.setUint32(20+5*ri*4+16,Fr.alphaSliceByteLength,!0)}ei=Li([Mi,en.globalData.endpointsData,en.globalData.selectorsData,en.globalData.tablesData,en.globalData.extendedData])}let ci=[],ve=en.keyValue;Rn.keepWriter||(ve=Go({},en.keyValue,{KTXwriter:"KTX-Parse v0.3.1"}));for(let Mi in ve){let Gn=ve[Mi],ri=ko(Mi),Fr=typeof Gn=="string"?ko(Gn):Gn,Ks=ri.byteLength+1+Fr.byteLength+1,Rs=Ks%4?4-Ks%4:0;ci.push(Li([new Uint32Array([Ks]),ri,pl,Fr,pl,new Uint8Array(Rs).fill(0)]))}let Kr=Li(ci);if(en.dataFormatDescriptor.length!==1||en.dataFormatDescriptor[0].descriptorType!==0)throw new Error("Only BASICFORMAT Data Format Descriptor output supported.");let Xi=en.dataFormatDescriptor[0],ji=new ArrayBuffer(28+16*Xi.samples.length),Zn=new DataView(ji),Sr=24+16*Xi.samples.length;if(Zn.setUint32(0,ji.byteLength,!0),Zn.setUint16(4,Xi.vendorId,!0),Zn.setUint16(6,Xi.descriptorType,!0),Zn.setUint16(8,Xi.versionNumber,!0),Zn.setUint16(10,Sr,!0),Zn.setUint8(12,Xi.colorModel),Zn.setUint8(13,Xi.colorPrimaries),Zn.setUint8(14,Xi.transferFunction),Zn.setUint8(15,Xi.flags),!Array.isArray(Xi.texelBlockDimension))throw new Error("texelBlockDimension is now an array. For dimensionality `d`, set `d - 1`.");Zn.setUint8(16,Xi.texelBlockDimension[0]),Zn.setUint8(17,Xi.texelBlockDimension[1]),Zn.setUint8(18,Xi.texelBlockDimension[2]),Zn.setUint8(19,Xi.texelBlockDimension[3]);for(let Mi=0;Mi<8;Mi++)Zn.setUint8(20+Mi,Xi.bytesPlane[Mi]);for(let Mi=0;Mi<Xi.samples.length;Mi++){let Gn=Xi.samples[Mi],ri=28+16*Mi;if(Gn.channelID)throw new Error("channelID has been renamed to channelType.");Zn.setUint16(ri+0,Gn.bitOffset,!0),Zn.setUint8(ri+2,Gn.bitLength),Zn.setUint8(ri+3,Gn.channelType),Zn.setUint8(ri+4,Gn.samplePosition[0]),Zn.setUint8(ri+5,Gn.samplePosition[1]),Zn.setUint8(ri+6,Gn.samplePosition[2]),Zn.setUint8(ri+7,Gn.samplePosition[3]),64&Gn.channelType?(Zn.setInt32(ri+8,Gn.sampleLower,!0),Zn.setInt32(ri+12,Gn.sampleUpper,!0)):(Zn.setUint32(ri+8,Gn.sampleLower,!0),Zn.setUint32(ri+12,Gn.sampleUpper,!0))}let vs=ki.length+68+3*en.levels.length*8,Qr=vs+ji.byteLength,Er=ei.byteLength>0?Qr+Kr.byteLength:0;Er%8&&(Er+=8-Er%8);let kn=[],wr=new DataView(new ArrayBuffer(3*en.levels.length*8)),Xr=(Er||Qr+Kr.byteLength)+ei.byteLength;for(let Mi=0;Mi<en.levels.length;Mi++){let Gn=en.levels[Mi];kn.push(Gn.levelData),wr.setBigUint64(24*Mi+0,BigInt(Xr),!0),wr.setBigUint64(24*Mi+8,BigInt(Gn.levelData.byteLength),!0),wr.setBigUint64(24*Mi+16,BigInt(Gn.uncompressedByteLength),!0),Xr+=Gn.levelData.byteLength}let yr=new ArrayBuffer(68),ii=new DataView(yr);return ii.setUint32(0,en.vkFormat,!0),ii.setUint32(4,en.typeSize,!0),ii.setUint32(8,en.pixelWidth,!0),ii.setUint32(12,en.pixelHeight,!0),ii.setUint32(16,en.pixelDepth,!0),ii.setUint32(20,en.layerCount,!0),ii.setUint32(24,en.faceCount,!0),ii.setUint32(28,en.levels.length,!0),ii.setUint32(32,en.supercompressionScheme,!0),ii.setUint32(36,vs,!0),ii.setUint32(40,ji.byteLength,!0),ii.setUint32(44,Qr,!0),ii.setUint32(48,Kr.byteLength,!0),ii.setBigUint64(52,BigInt(ei.byteLength>0?Er:0),!0),ii.setBigUint64(60,BigInt(ei.byteLength),!0),new Uint8Array(Li([new Uint8Array(ki).buffer,yr,wr.buffer,ji,Kr,Er>0?new ArrayBuffer(Er-(Qr+Kr.byteLength)):new ArrayBuffer(0),ei,...kn]))}},"./node_modules/three/examples/jsm/libs/zstddec.module.js":(k,K,f)=>{"use strict";f.r(K),f.d(K,{ZSTDDecoder:()=>u});var y=f("./node_modules/buffer/index.js").Buffer;let _,v,C,l={env:{emscripten_notify_memory_growth:function(c){C=new Uint8Array(v.exports.memory.buffer)}}};class u{init(){return _||(_=typeof fetch!="undefined"?fetch("data:application/wasm;base64,"+p).then(g=>g.arrayBuffer()).then(g=>WebAssembly.instantiate(g,l)).then(this._init):WebAssembly.instantiate(y.from(p,"base64"),l).then(this._init),_)}_init(g){v=g.instance,l.env.emscripten_notify_memory_growth(0)}decode(g,A=0){if(!v)throw new Error("ZSTDDecoder: Await .init() before decoding.");let h=g.byteLength,m=v.exports.malloc(h);C.set(g,m),A=A||Number(v.exports.ZSTD_findDecompressedSize(m,h));let x=v.exports.malloc(A),S=v.exports.ZSTD_decompress(x,A,m,h),b=C.slice(x,x+S);return v.exports.free(m),v.exports.free(x),b}}let p="AGFzbQEAAAABpQEVYAF/AX9gAn9/AGADf39/AX9gBX9/f39/AX9gAX8AYAJ/fwF/YAR/f39/AX9gA39/fwBgBn9/f39/fwF/YAd/f39/f39/AX9gAn9/AX5gAn5+AX5gAABgBX9/f39/AGAGf39/f39/AGAIf39/f39/f38AYAl/f39/f39/f38AYAABf2AIf39/f39/f38Bf2ANf39/f39/f39/f39/fwF/YAF/AX4CJwEDZW52H2Vtc2NyaXB0ZW5fbm90aWZ5X21lbW9yeV9ncm93dGgABANpaAEFAAAFAgEFCwACAQABAgIFBQcAAwABDgsBAQcAEhMHAAUBDAQEAAANBwQCAgYCBAgDAwMDBgEACQkHBgICAAYGAgQUBwYGAwIGAAMCAQgBBwUGCgoEEQAEBAEIAwgDBQgDEA8IAAcABAUBcAECAgUEAQCAAgYJAX8BQaCgwAILB2AHBm1lbW9yeQIABm1hbGxvYwAoBGZyZWUAJgxaU1REX2lzRXJyb3IAaBlaU1REX2ZpbmREZWNvbXByZXNzZWRTaXplAFQPWlNURF9kZWNvbXByZXNzAEoGX3N0YXJ0ACQJBwEAQQELASQKussBaA8AIAAgACgCBCABajYCBAsZACAAKAIAIAAoAgRBH3F0QQAgAWtBH3F2CwgAIABBiH9LC34BBH9BAyEBIAAoAgQiA0EgTQRAIAAoAggiASAAKAIQTwRAIAAQDQ8LIAAoAgwiAiABRgRAQQFBAiADQSBJGw8LIAAgASABIAJrIANBA3YiBCABIARrIAJJIgEbIgJrIgQ2AgggACADIAJBA3RrNgIEIAAgBCgAADYCAAsgAQsUAQF/IAAgARACIQIgACABEAEgAgv3AQECfyACRQRAIABCADcCACAAQQA2AhAgAEIANwIIQbh/DwsgACABNgIMIAAgAUEEajYCECACQQRPBEAgACABIAJqIgFBfGoiAzYCCCAAIAMoAAA2AgAgAUF/ai0AACIBBEAgAEEIIAEQFGs2AgQgAg8LIABBADYCBEF/DwsgACABNgIIIAAgAS0AACIDNgIAIAJBfmoiBEEBTQRAIARBAWtFBEAgACABLQACQRB0IANyIgM2AgALIAAgAS0AAUEIdCADajYCAAsgASACakF/ai0AACIBRQRAIABBADYCBEFsDwsgAEEoIAEQFCACQQN0ams2AgQgAgsWACAAIAEpAAA3AAAgACABKQAINwAICy8BAX8gAUECdEGgHWooAgAgACgCAEEgIAEgACgCBGprQR9xdnEhAiAAIAEQASACCyEAIAFCz9bTvtLHq9lCfiAAfEIfiUKHla+vmLbem55/fgsdAQF/IAAoAgggACgCDEYEfyAAKAIEQSBGBUEACwuCBAEDfyACQYDAAE8EQCAAIAEgAhBnIAAPCyAAIAJqIQMCQCAAIAFzQQNxRQRAAkAgAkEBSARAIAAhAgwBCyAAQQNxRQRAIAAhAgwBCyAAIQIDQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADTw0BIAJBA3ENAAsLAkAgA0F8cSIEQcAASQ0AIAIgBEFAaiIFSw0AA0AgAiABKAIANgIAIAIgASgCBDYCBCACIAEoAgg2AgggAiABKAIMNgIMIAIgASgCEDYCECACIAEoAhQ2AhQgAiABKAIYNgIYIAIgASgCHDYCHCACIAEoAiA2AiAgAiABKAIkNgIkIAIgASgCKDYCKCACIAEoAiw2AiwgAiABKAIwNgIwIAIgASgCNDYCNCACIAEoAjg2AjggAiABKAI8NgI8IAFBQGshASACQUBrIgIgBU0NAAsLIAIgBE8NAQNAIAIgASgCADYCACABQQRqIQEgAkEEaiICIARJDQALDAELIANBBEkEQCAAIQIMAQsgA0F8aiIEIABJBEAgACECDAELIAAhAgNAIAIgAS0AADoAACACIAEtAAE6AAEgAiABLQACOgACIAIgAS0AAzoAAyABQQRqIQEgAkEEaiICIARNDQALCyACIANJBEADQCACIAEtAAA6AAAgAUEBaiEBIAJBAWoiAiADRw0ACwsgAAsMACAAIAEpAAA3AAALQQECfyAAKAIIIgEgACgCEEkEQEEDDwsgACAAKAIEIgJBB3E2AgQgACABIAJBA3ZrIgE2AgggACABKAAANgIAQQALDAAgACABKAIANgAAC/cCAQJ/AkAgACABRg0AAkAgASACaiAASwRAIAAgAmoiBCABSw0BCyAAIAEgAhALDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRAIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkF/aiECIANBAWoiA0EDcQ0ACwwBCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQhBSAGQQR2IQRBICAAdCIAQQFyIQkgASgCACEPQQAhAiADIQYCQANAIAlBAkggAiAPS3JFBEAgAiEHAkAgCARAA0AgBEH//wNxQf//A0YEQCAHQRhqIQcgBiAQSQR/IAZBAmoiBigAACAFdgUgBUEQaiEFIARBEHYLIQQMAQsLA0AgBEEDcSIIQQNGBEAgBUECaiEFIARBAnYhBCAHQQNqIQcMAQsLIAcgCGoiByAPSw0EIAVBAmohBQNAIAIgB0kEQCANIAJBAXRqQQA7AQAgAkEBaiECDAELCyAGIA5LQQAgBiAFQQN1aiIHIAxLG0UEQCAHKAAAIAVBB3EiBXYhBAwCCyAEQQJ2IQQLIAYhBwsCfyALQX9qIAQgAEF/anEiBiAAQQF0QX9qIgggCWsiEUkNABogBCAIcSIEQQAgESAEIABIG2shBiALCyEIIA0gAkEBdGogBkF/aiIEOwEAIAlBASAGayAEIAZBAUgbayEJA0AgCSAASARAIABBAXUhACALQX9qIQsMAQsLAn8gByAOS0EAIAcgBSAIaiIFQQN1aiIGIAxLG0UEQCAFQQdxDAELIAUgDCIGIAdrQQN0awshBSACQQFqIQIgBEUhCCAGKAAAIAVBH3F2IQQMAQsLQWwgCUEBRyAFQSBKcg0BGiABIAJBf2o2AgAgBiAFQQdqQQN1aiADawwBC0FQCyEAIApBEGokACAACwkAQQFBBSAAGwsMACAAIAEoAAA2AAALqgMBCn8jAEHwAGsiCiQAIAJBAWohDiAAQQhqIQtBgIAEIAVBf2p0QRB1IQxBACECQQEhBkEBIAV0IglBf2oiDyEIA0AgAiAORkUEQAJAIAEgAkEBdCINai8BACIHQf//A0YEQCALIAhBA3RqIAI2AgQgCEF/aiEIQQEhBwwBCyAGQQAgDCAHQRB0QRB1ShshBgsgCiANaiAHOwEAIAJBAWohAgwBCwsgACAFNgIEIAAgBjYCACAJQQN2IAlBAXZqQQNqIQxBACEAQQAhBkEAIQIDQCAGIA5GBEADQAJAIAAgCUYNACAKIAsgAEEDdGoiASgCBCIGQQF0aiICIAIvAQAiAkEBajsBACABIAUgAhAUayIIOgADIAEgAiAIQf8BcXQgCWs7AQAgASAEIAZBAnQiAmooAgA6AAIgASACIANqKAIANgIEIABBAWohAAwBCwsFIAEgBkEBdGouAQAhDUEAIQcDQCAHIA1ORQRAIAsgAkEDdGogBjYCBANAIAIgDGogD3EiAiAISw0ACyAHQQFqIQcMAQsLIAZBAWohBgwBCwsgCkHwAGokAAsjAEIAIAEQCSAAhUKHla+vmLbem55/fkLj3MqV/M7y9YV/fAsQACAAQn43AwggACABNgIACyQBAX8gAARAIAEoAgQiAgRAIAEoAgggACACEQEADwsgABAmCwsfACAAIAEgAi8BABAINgIAIAEQBBogACACQQRqNgIEC0oBAX9BoCAoAgAiASAAaiIAQX9MBEBBiCBBMDYCAEF/DwsCQCAAPwBBEHRNDQAgABBmDQBBiCBBMDYCAEF/DwtBoCAgADYCACABC9cBAQh/Qbp/IQoCQCACKAIEIgggAigCACIJaiIOIAEgAGtLDQBBbCEKIAkgBCADKAIAIgtrSw0AIAAgCWoiBCACKAIIIgxrIQ0gACABQWBqIg8gCyAJQQAQKSADIAkgC2o2AgACQAJAIAwgBCAFa00EQCANIQUMAQsgDCAEIAZrSw0CIAcgDSAFayIAaiIBIAhqIAdNBEAgBCABIAgQDxoMAgsgBCABQQAgAGsQDyEBIAIgACAIaiIINgIEIAEgAGshBAsgBCAPIAUgCEEBECkLIA4hCgsgCgubAgEBfyMAQYABayINJAAgDSADNgJ8AkAgAkEDSwRAQX8hCQwBCwJAAkACQAJAIAJBAWsOAwADAgELIAZFBEBBuH8hCQwEC0FsIQkgBS0AACICIANLDQMgACAHIAJBAnQiAmooAgAgAiAIaigCABA7IAEgADYCAEEBIQkMAwsgASAJNgIAQQAhCQwCCyAKRQRAQWwhCQwCC0EAIQkgC0UgDEEZSHINAUEIIAR0QQhqIQBBACECA0AgAiAATw0CIAJBQGshAgwAAAsAC0FsIQkgDSANQfwAaiANQfgAaiAFIAYQFSICEAMNACANKAJ4IgMgBEsNACAAIA0gDSgCfCAHIAggAxAYIAEgADYCACACIQkLIA1BgAFqJAAgCQsLACAAIAEgAhALGgsQACAALwAAIAAtAAJBEHRyCy8AAn9BuH8gAUEISQ0AGkFyIAAoAAQiAEF3Sw0AGkG4fyAAQQhqIgAgACABSxsLCwkAIAAgATsAAAsDAAELigYBBX8gACAAKAIAIgVBfnE2AgBBACAAIAVBAXZqQYQgKAIAIgQgAEYbIQECQAJAIAAoAgQiAkUNACACKAIAIgNBAXENACACQQhqIgUgA0EBdkF4aiIDQQggA0EISxtnQR9zQQJ0QYAfaiIDKAIARgRAIAMgAigCDDYCAAsgAigCCCIDBEAgAyACKAIMNgIECyACKAIMIgMEQCADIAIoAgg2AgALIAIgAigCACAAKAIAQX5xajYCAEGEICEAAkACQCABRQ0AIAEgAjYCBCABKAIAIgNBAXENASADQQF2QXhqIgNBCCADQQhLG2dBH3NBAnRBgB9qIgMoAgAgAUEIakYEQCADIAEoAgw2AgALIAEoAggiAwRAIAMgASgCDDYCBAsgASgCDCIDBEAgAyABKAIINgIAQYQgKAIAIQQLIAIgAigCACABKAIAQX5xajYCACABIARGDQAgASABKAIAQQF2akEEaiEACyAAIAI2AgALIAIoAgBBAXZBeGoiAEEIIABBCEsbZ0Efc0ECdEGAH2oiASgCACEAIAEgBTYCACACIAA2AgwgAkEANgIIIABFDQEgACAFNgIADwsCQCABRQ0AIAEoAgAiAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAigCACABQQhqRgRAIAIgASgCDDYCAAsgASgCCCICBEAgAiABKAIMNgIECyABKAIMIgIEQCACIAEoAgg2AgBBhCAoAgAhBAsgACAAKAIAIAEoAgBBfnFqIgI2AgACQCABIARHBEAgASABKAIAQQF2aiAANgIEIAAoAgAhAgwBC0GEICAANgIACyACQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgIoAgAhASACIABBCGoiAjYCACAAIAE2AgwgAEEANgIIIAFFDQEgASACNgIADwsgBUEBdkF4aiIBQQggAUEISxtnQR9zQQJ0QYAfaiICKAIAIQEgAiAAQQhqIgI2AgAgACABNgIMIABBADYCCCABRQ0AIAEgAjYCAAsLDgAgAARAIABBeGoQJQsLgAIBA38CQCAAQQ9qQXhxQYQgKAIAKAIAQQF2ayICEB1Bf0YNAAJAQYQgKAIAIgAoAgAiAUEBcQ0AIAFBAXZBeGoiAUEIIAFBCEsbZ0Efc0ECdEGAH2oiASgCACAAQQhqRgRAIAEgACgCDDYCAAsgACgCCCIBBEAgASAAKAIMNgIECyAAKAIMIgFFDQAgASAAKAIINgIAC0EBIQEgACAAKAIAIAJBAXRqIgI2AgAgAkEBcQ0AIAJBAXZBeGoiAkEIIAJBCEsbZ0Efc0ECdEGAH2oiAygCACECIAMgAEEIaiIDNgIAIAAgAjYCDCAAQQA2AgggAkUNACACIAM2AgALIAELtwIBA38CQAJAIABBASAAGyICEDgiAA0AAkACQEGEICgCACIARQ0AIAAoAgAiA0EBcQ0AIAAgA0EBcjYCACADQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgAgAEEIakYEQCABIAAoAgw2AgALIAAoAggiAQRAIAEgACgCDDYCBAsgACgCDCIBBEAgASAAKAIINgIACyACECchAkEAIQFBhCAoAgAhACACDQEgACAAKAIAQX5xNgIAQQAPCyACQQ9qQXhxIgMQHSICQX9GDQIgAkEHakF4cSIAIAJHBEAgACACaxAdQX9GDQMLAkBBhCAoAgAiAUUEQEGAICAANgIADAELIAAgATYCBAtBhCAgADYCACAAIANBAXRBAXI2AgAMAQsgAEUNAQsgAEEIaiEBCyABC7kDAQJ/IAAgA2ohBQJAIANBB0wEQANAIAAgBU8NAiAAIAItAAA6AAAgAEEBaiEAIAJBAWohAgwAAAsACyAEQQFGBEACQCAAIAJrIgZBB00EQCAAIAItAAA6AAAgACACLQABOgABIAAgAi0AAjoAAiAAIAItAAM6AAMgAEEEaiACIAZBAnQiBkHAHmooAgBqIgIQFyACIAZB4B5qKAIAayECDAELIAAgAhAMCyACQQhqIQIgAEEIaiEACwJAAkACQAJAIAUgAU0EQCAAIANqIQEgBEEBRyAAIAJrQQ9Kcg0BA0AgACACEAwgAkEIaiECIABBCGoiACABSQ0ACwwFCyAAIAFLBEAgACEBDAQLIARBAUcgACACa0EPSnINASAAIQMgAiEEA0AgAyAEEAwgBEEIaiEEIANBCGoiAyABSQ0ACwwCCwNAIAAgAhAHIAJBEGohAiAAQRBqIgAgAUkNAAsMAwsgACEDIAIhBANAIAMgBBAHIARBEGohBCADQRBqIgMgAUkNAAsLIAIgASAAa2ohAgsDQCABIAVPDQEgASACLQAAOgAAIAFBAWohASACQQFqIQIMAAALAAsLQQECfyAAIAAoArjgASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEEdCAAbiECCyAAQQh2IgEgAkEYbCIAQYwIaigCAGwgAEGICGooAgBqIgJBA3YgAmogAEGACGooAgAgAEGECGooAgAgAWxqSQs3ACAAIAMgBCAFQYAQEDMiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQMgVBuH8LC78DAQN/IwBBIGsiBSQAIAVBCGogAiADEAYiAhADRQRAIAAgAWoiB0F9aiEGIAUgBBAOIARBBGohAiAFLQACIQMDQEEAIAAgBkkgBUEIahAEGwRAIAAgAiAFQQhqIAMQAkECdGoiBC8BADsAACAFQQhqIAQtAAIQASAAIAQtAANqIgQgAiAFQQhqIAMQAkECdGoiAC8BADsAACAFQQhqIAAtAAIQASAEIAAtAANqIQAMAQUgB0F+aiEEA0AgBUEIahAEIAAgBEtyRQRAIAAgAiAFQQhqIAMQAkECdGoiBi8BADsAACAFQQhqIAYtAAIQASAAIAYtAANqIQAMAQsLA0AgACAES0UEQCAAIAIgBUEIaiADEAJBAnRqIgYvAQA7AAAgBUEIaiAGLQACEAEgACAGLQADaiEADAELCwJAIAAgB08NACAAIAIgBUEIaiADEAIiA0ECdGoiAC0AADoAACAALQADQQFGBEAgBUEIaiAALQACEAEMAQsgBSgCDEEfSw0AIAVBCGogAiADQQJ0ai0AAhABIAUoAgxBIUkNACAFQSA2AgwLIAFBbCAFQQhqEAobIQILCwsgBUEgaiQAIAILkgIBBH8jAEFAaiIJJAAgCSADQTQQCyEDAkAgBEECSA0AIAMgBEECdGooAgAhCSADQTxqIAgQIyADQQE6AD8gAyACOgA+QQAhBCADKAI8IQoDQCAEIAlGDQEgACAEQQJ0aiAKNgEAIARBAWohBAwAAAsAC0EAIQkDQCAGIAlGRQRAIAMgBSAJQQF0aiIKLQABIgtBAnRqIgwoAgAhBCADQTxqIAotAABBCHQgCGpB//8DcRAjIANBAjoAPyADIAcgC2siCiACajoAPiAEQQEgASAKa3RqIQogAygCPCELA0AgACAEQQJ0aiALNgEAIARBAWoiBCAKSQ0ACyAMIAo2AgAgCUEBaiEJDAELCyADQUBrJAALowIBCX8jAEHQAGsiCSQAIAlBEGogBUE0EAsaIAcgBmshDyAHIAFrIRADQAJAIAMgCkcEQEEBIAEgByACIApBAXRqIgYtAAEiDGsiCGsiC3QhDSAGLQAAIQ4gCUEQaiAMQQJ0aiIMKAIAIQYgCyAPTwRAIAAgBkECdGogCyAIIAUgCEE0bGogCCAQaiIIQQEgCEEBShsiCCACIAQgCEECdGooAgAiCEEBdGogAyAIayAHIA4QYyAGIA1qIQgMAgsgCUEMaiAOECMgCUEBOgAPIAkgCDoADiAGIA1qIQggCSgCDCELA0AgBiAITw0CIAAgBkECdGogCzYBACAGQQFqIQYMAAALAAsgCUHQAGokAA8LIAwgCDYCACAKQQFqIQoMAAALAAs0ACAAIAMgBCAFEDYiBRADBEAgBQ8LIAUgBEkEfyABIAIgAyAFaiAEIAVrIAAQNAVBuH8LCyMAIAA/AEEQdGtB//8DakEQdkAAQX9GBEBBAA8LQQAQAEEBCzsBAX8gAgRAA0AgACABIAJBgCAgAkGAIEkbIgMQCyEAIAFBgCBqIQEgAEGAIGohACACIANrIgINAAsLCwYAIAAQAwsLqBUJAEGICAsNAQAAAAEAAAACAAAAAgBBoAgLswYBAAAAAQAAAAIAAAACAAAAJgAAAIIAAAAhBQAASgAAAGcIAAAmAAAAwAEAAIAAAABJBQAASgAAAL4IAAApAAAALAIAAIAAAABJBQAASgAAAL4IAAAvAAAAygIAAIAAAACKBQAASgAAAIQJAAA1AAAAcwMAAIAAAACdBQAASgAAAKAJAAA9AAAAgQMAAIAAAADrBQAASwAAAD4KAABEAAAAngMAAIAAAABNBgAASwAAAKoKAABLAAAAswMAAIAAAADBBgAATQAAAB8NAABNAAAAUwQAAIAAAAAjCAAAUQAAAKYPAABUAAAAmQQAAIAAAABLCQAAVwAAALESAABYAAAA2gQAAIAAAABvCQAAXQAAACMUAABUAAAARQUAAIAAAABUCgAAagAAAIwUAABqAAAArwUAAIAAAAB2CQAAfAAAAE4QAAB8AAAA0gIAAIAAAABjBwAAkQAAAJAHAACSAAAAAAAAAAEAAAABAAAABQAAAA0AAAAdAAAAPQAAAH0AAAD9AAAA/QEAAP0DAAD9BwAA/Q8AAP0fAAD9PwAA/X8AAP3/AAD9/wEA/f8DAP3/BwD9/w8A/f8fAP3/PwD9/38A/f//AP3//wH9//8D/f//B/3//w/9//8f/f//P/3//38AAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAABUAAAAWAAAAFwAAABgAAAAZAAAAGgAAABsAAAAcAAAAHQAAAB4AAAAfAAAAIAAAACEAAAAiAAAAIwAAACUAAAAnAAAAKQAAACsAAAAvAAAAMwAAADsAAABDAAAAUwAAAGMAAACDAAAAAwEAAAMCAAADBAAAAwgAAAMQAAADIAAAA0AAAAOAAAADAAEAQeAPC1EBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAA0AAAAOAAAADwAAABAAQcQQC4sBAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABIAAAAUAAAAFgAAABgAAAAcAAAAIAAAACgAAAAwAAAAQAAAAIAAAAAAAQAAAAIAAAAEAAAACAAAABAAAAAgAAAAQAAAAIAAAAAAAQBBkBIL5gQBAAAAAQAAAAEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAAAEAAAAEAAAACAAAAAAAAAABAAEBBgAAAAAAAAQAAAAAEAAABAAAAAAgAAAFAQAAAAAAAAUDAAAAAAAABQQAAAAAAAAFBgAAAAAAAAUHAAAAAAAABQkAAAAAAAAFCgAAAAAAAAUMAAAAAAAABg4AAAAAAAEFEAAAAAAAAQUUAAAAAAABBRYAAAAAAAIFHAAAAAAAAwUgAAAAAAAEBTAAAAAgAAYFQAAAAAAABwWAAAAAAAAIBgABAAAAAAoGAAQAAAAADAYAEAAAIAAABAAAAAAAAAAEAQAAAAAAAAUCAAAAIAAABQQAAAAAAAAFBQAAACAAAAUHAAAAAAAABQgAAAAgAAAFCgAAAAAAAAULAAAAAAAABg0AAAAgAAEFEAAAAAAAAQUSAAAAIAABBRYAAAAAAAIFGAAAACAAAwUgAAAAAAADBSgAAAAAAAYEQAAAABAABgRAAAAAIAAHBYAAAAAAAAkGAAIAAAAACwYACAAAMAAABAAAAAAQAAAEAQAAACAAAAUCAAAAIAAABQMAAAAgAAAFBQAAACAAAAUGAAAAIAAABQgAAAAgAAAFCQAAACAAAAULAAAAIAAABQwAAAAAAAAGDwAAACAAAQUSAAAAIAABBRQAAAAgAAIFGAAAACAAAgUcAAAAIAADBSgAAAAgAAQFMAAAAAAAEAYAAAEAAAAPBgCAAAAAAA4GAEAAAAAADQYAIABBgBcLhwIBAAEBBQAAAAAAAAUAAAAAAAAGBD0AAAAAAAkF/QEAAAAADwX9fwAAAAAVBf3/HwAAAAMFBQAAAAAABwR9AAAAAAAMBf0PAAAAABIF/f8DAAAAFwX9/38AAAAFBR0AAAAAAAgE/QAAAAAADgX9PwAAAAAUBf3/DwAAAAIFAQAAABAABwR9AAAAAAALBf0HAAAAABEF/f8BAAAAFgX9/z8AAAAEBQ0AAAAQAAgE/QAAAAAADQX9HwAAAAATBf3/BwAAAAEFAQAAABAABgQ9AAAAAAAKBf0DAAAAABAF/f8AAAAAHAX9//8PAAAbBf3//wcAABoF/f//AwAAGQX9//8BAAAYBf3//wBBkBkLhgQBAAEBBgAAAAAAAAYDAAAAAAAABAQAAAAgAAAFBQAAAAAAAAUGAAAAAAAABQgAAAAAAAAFCQAAAAAAAAULAAAAAAAABg0AAAAAAAAGEAAAAAAAAAYTAAAAAAAABhYAAAAAAAAGGQAAAAAAAAYcAAAAAAAABh8AAAAAAAAGIgAAAAAAAQYlAAAAAAABBikAAAAAAAIGLwAAAAAAAwY7AAAAAAAEBlMAAAAAAAcGgwAAAAAACQYDAgAAEAAABAQAAAAAAAAEBQAAACAAAAUGAAAAAAAABQcAAAAgAAAFCQAAAAAAAAUKAAAAAAAABgwAAAAAAAAGDwAAAAAAAAYSAAAAAAAABhUAAAAAAAAGGAAAAAAAAAYbAAAAAAAABh4AAAAAAAAGIQAAAAAAAQYjAAAAAAABBicAAAAAAAIGKwAAAAAAAwYzAAAAAAAEBkMAAAAAAAUGYwAAAAAACAYDAQAAIAAABAQAAAAwAAAEBAAAABAAAAQFAAAAIAAABQcAAAAgAAAFCAAAACAAAAUKAAAAIAAABQsAAAAAAAAGDgAAAAAAAAYRAAAAAAAABhQAAAAAAAAGFwAAAAAAAAYaAAAAAAAABh0AAAAAAAAGIAAAAAAAEAYDAAEAAAAPBgOAAAAAAA4GA0AAAAAADQYDIAAAAAAMBgMQAAAAAAsGAwgAAAAACgYDBABBpB0L2QEBAAAAAwAAAAcAAAAPAAAAHwAAAD8AAAB/AAAA/wAAAP8BAAD/AwAA/wcAAP8PAAD/HwAA/z8AAP9/AAD//wAA//8BAP//AwD//wcA//8PAP//HwD//z8A//9/AP///wD///8B////A////wf///8P////H////z////9/AAAAAAEAAAACAAAABAAAAAAAAAACAAAABAAAAAgAAAAAAAAAAQAAAAIAAAABAAAABAAAAAQAAAAEAAAABAAAAAgAAAAIAAAACAAAAAcAAAAIAAAACQAAAAoAAAALAEGgIAsDwBBQ"},"./node_modules/three/examples/jsm/lights/LightProbeGenerator.js":(k,K,f)=>{"use strict";f.r(K),f.d(K,{LightProbeGenerator:()=>_});var y=f("./node_modules/three/build/three.module.js");class _{static fromCubeTexture(l){let u=0,p=new y.Vector3,c=new y.Vector3,g=new y.Color,A=[0,0,0,0,0,0,0,0,0],h=new y.SphericalHarmonics3,m=h.coefficients;for(let S=0;S<6;S++){let b=l.image[S],L=b.width,M=b.height,F=document.createElement("canvas");F.width=L,F.height=M;let H=F.getContext("2d");H.drawImage(b,0,0,L,M);let Y=H.getImageData(0,0,L,M),W=Y.data,te=Y.width,re=2/te;for(let X=0,V=W.length;X<V;X+=4){g.setRGB(W[X]/255,W[X+1]/255,W[X+2]/255),v(g,l.colorSpace);let O=X/4,Z=-1+(O%te+.5)*re,ne=1-(Math.floor(O/te)+.5)*re;switch(S){case 0:p.set(-1,ne,-Z);break;case 1:p.set(1,ne,Z);break;case 2:p.set(-Z,1,-ne);break;case 3:p.set(-Z,-1,ne);break;case 4:p.set(-Z,ne,1);break;case 5:p.set(Z,ne,-1);break}let pe=p.lengthSq(),be=4/(Math.sqrt(pe)*pe);u+=be,c.copy(p).normalize(),y.SphericalHarmonics3.getBasisAt(c,A);for(let Re=0;Re<9;Re++)m[Re].x+=A[Re]*g.r*be,m[Re].y+=A[Re]*g.g*be,m[Re].z+=A[Re]*g.b*be}}let x=4*Math.PI/u;for(let S=0;S<9;S++)m[S].x*=x,m[S].y*=x,m[S].z*=x;return new y.LightProbe(h)}static fromCubeRenderTarget(l,u){let p=0,c=new y.Vector3,g=new y.Vector3,A=new y.Color,h=[0,0,0,0,0,0,0,0,0],m=new y.SphericalHarmonics3,x=m.coefficients,S=u.texture.type;for(let L=0;L<6;L++){let M=u.width,F;S===y.HalfFloatType?F=new Uint16Array(M*M*4):F=new Uint8Array(M*M*4),l.readRenderTargetPixels(u,0,0,M,M,F,L);let H=2/M;for(let Y=0,W=F.length;Y<W;Y+=4){let te,re,X;S===y.HalfFloatType?(te=y.DataUtils.fromHalfFloat(F[Y]),re=y.DataUtils.fromHalfFloat(F[Y+1]),X=y.DataUtils.fromHalfFloat(F[Y+2])):(te=F[Y]/255,re=F[Y+1]/255,X=F[Y+2]/255),A.setRGB(te,re,X),v(A,u.texture.colorSpace);let V=Y/4,O=-1+(V%M+.5)*H,Z=1-(Math.floor(V/M)+.5)*H;switch(L){case 0:c.set(1,Z,-O);break;case 1:c.set(-1,Z,O);break;case 2:c.set(O,1,-Z);break;case 3:c.set(O,-1,Z);break;case 4:c.set(O,Z,1);break;case 5:c.set(-O,Z,-1);break}let ne=c.lengthSq(),pe=4/(Math.sqrt(ne)*ne);p+=pe,g.copy(c).normalize(),y.SphericalHarmonics3.getBasisAt(g,h);for(let be=0;be<9;be++)x[be].x+=h[be]*A.r*pe,x[be].y+=h[be]*A.g*pe,x[be].z+=h[be]*A.b*pe}}let b=4*Math.PI/p;for(let L=0;L<9;L++)x[L].x*=b,x[L].y*=b,x[L].z*=b;return new y.LightProbe(m)}}function v(C,l){switch(l){case y.SRGBColorSpace:C.convertSRGBToLinear();break;case y.LinearSRGBColorSpace:case y.NoColorSpace:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported color space.");break}return C}},"./node_modules/three/examples/jsm/loaders/DRACOLoader.js":(k,K,f)=>{"use strict";f.r(K),f.d(K,{DRACOLoader:()=>v});var y=f("./node_modules/three/build/three.module.js");let _=new WeakMap;class v extends y.Loader{constructor(u){super(u);this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(u){return this.decoderPath=u,this}setDecoderConfig(u){return this.decoderConfig=u,this}setWorkerLimit(u){return this.workerLimit=u,this}load(u,p,c,g){let A=new y.FileLoader(this.manager);A.setPath(this.path),A.setResponseType("arraybuffer"),A.setRequestHeader(this.requestHeader),A.setWithCredentials(this.withCredentials),A.load(u,h=>{this.parse(h,p,g)},c,g)}parse(u,p,c=()=>{}){this.decodeDracoFile(u,p,null,null,y.SRGBColorSpace).catch(c)}decodeDracoFile(u,p,c,g,A=y.LinearSRGBColorSpace,h=()=>{}){let m={attributeIDs:c||this.defaultAttributeIDs,attributeTypes:g||this.defaultAttributeTypes,useUniqueIDs:!!c,vertexColorSpace:A};return this.decodeGeometry(u,m).then(p).catch(h)}decodeGeometry(u,p){let c=JSON.stringify(p);if(_.has(u)){let x=_.get(u);if(x.key===c)return x.promise;if(u.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let g,A=this.workerNextTaskID++,h=u.byteLength,m=this._getWorker(A,h).then(x=>(g=x,new Promise((S,b)=>{g._callbacks[A]={resolve:S,reject:b},g.postMessage({type:"decode",id:A,taskConfig:p,buffer:u},[u])}))).then(x=>this._createGeometry(x.geometry));return m.catch(()=>!0).then(()=>{g&&A&&this._releaseTask(g,A)}),_.set(u,{key:c,promise:m}),m}_createGeometry(u){let p=new y.BufferGeometry;u.index&&p.setIndex(new y.BufferAttribute(u.index.array,1));for(let c=0;c<u.attributes.length;c++){let g=u.attributes[c],A=g.name,h=g.array,m=g.itemSize,x=new y.BufferAttribute(h,m);A==="color"&&(this._assignVertexColorSpace(x,g.vertexColorSpace),x.normalized=!(h instanceof Float32Array)),p.setAttribute(A,x)}return p}_assignVertexColorSpace(u,p){if(p!==y.SRGBColorSpace)return;let c=new y.Color;for(let g=0,A=u.count;g<A;g++)c.fromBufferAttribute(u,g).convertSRGBToLinear(),u.setXYZ(g,c.r,c.g,c.b)}_loadLibrary(u,p){let c=new y.FileLoader(this.manager);return c.setPath(this.decoderPath),c.setResponseType(p),c.setWithCredentials(this.withCredentials),new Promise((g,A)=>{c.load(u,g,void 0,A)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let u=typeof WebAssembly!="object"||this.decoderConfig.type==="js",p=[];return u?p.push(this._loadLibrary("draco_decoder.js","text")):(p.push(this._loadLibrary("draco_wasm_wrapper.js","text")),p.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(p).then(c=>{let g=c[0];u||(this.decoderConfig.wasmBinary=c[1]);let A=C.toString(),h=["/* draco decoder */",g,"","/* worker */",A.substring(A.indexOf("{")+1,A.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([h]))}),this.decoderPending}_getWorker(u,p){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let g=new Worker(this.workerSourceURL);g._callbacks={},g._taskCosts={},g._taskLoad=0,g.postMessage({type:"init",decoderConfig:this.decoderConfig}),g.onmessage=function(A){let h=A.data;switch(h.type){case"decode":g._callbacks[h.id].resolve(h);break;case"error":g._callbacks[h.id].reject(h);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+h.type+'"')}},this.workerPool.push(g)}else this.workerPool.sort(function(g,A){return g._taskLoad>A._taskLoad?-1:1});let c=this.workerPool[this.workerPool.length-1];return c._taskCosts[u]=p,c._taskLoad+=p,c})}_releaseTask(u,p){u._taskLoad-=u._taskCosts[p],delete u._callbacks[p],delete u._taskCosts[p]}debug(){console.log("Task load: ",this.workerPool.map(u=>u._taskLoad))}dispose(){for(let u=0;u<this.workerPool.length;++u)this.workerPool[u].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function C(){let l,u;onmessage=function(h){let m=h.data;switch(m.type){case"init":l=m.decoderConfig,u=new Promise(function(b){l.onModuleLoaded=function(L){b({draco:L})},DracoDecoderModule(l)});break;case"decode":let x=m.buffer,S=m.taskConfig;u.then(b=>{let L=b.draco,M=new L.Decoder;try{let F=p(L,M,new Int8Array(x),S),H=F.attributes.map(Y=>Y.array.buffer);F.index&&H.push(F.index.array.buffer),self.postMessage({type:"decode",id:m.id,geometry:F},H)}catch(F){console.error(F),self.postMessage({type:"error",id:m.id,error:F.message})}finally{L.destroy(M)}});break}};function p(h,m,x,S){let b=S.attributeIDs,L=S.attributeTypes,M,F,H=m.GetEncodedGeometryType(x);if(H===h.TRIANGULAR_MESH)M=new h.Mesh,F=m.DecodeArrayToMesh(x,x.byteLength,M);else if(H===h.POINT_CLOUD)M=new h.PointCloud,F=m.DecodeArrayToPointCloud(x,x.byteLength,M);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!F.ok()||M.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+F.error_msg());let Y={index:null,attributes:[]};for(let W in b){let te=self[L[W]],re,X;if(S.useUniqueIDs)X=b[W],re=m.GetAttributeByUniqueId(M,X);else{if(X=m.GetAttributeId(M,h[b[W]]),X===-1)continue;re=m.GetAttribute(M,X)}let V=g(h,m,M,W,te,re);W==="color"&&(V.vertexColorSpace=S.vertexColorSpace),Y.attributes.push(V)}return H===h.TRIANGULAR_MESH&&(Y.index=c(h,m,M)),h.destroy(M),Y}function c(h,m,x){let b=x.num_faces()*3,L=b*4,M=h._malloc(L);m.GetTrianglesUInt32Array(x,L,M);let F=new Uint32Array(h.HEAPF32.buffer,M,b).slice();return h._free(M),{array:F,itemSize:1}}function g(h,m,x,S,b,L){let M=L.num_components(),H=x.num_points()*M,Y=H*b.BYTES_PER_ELEMENT,W=A(h,b),te=h._malloc(Y);m.GetAttributeDataArrayForAllPoints(x,L,W,Y,te);let re=new b(h.HEAPF32.buffer,te,H).slice();return h._free(te),{name:S,array:re,itemSize:M}}function A(h,m){switch(m){case Float32Array:return h.DT_FLOAT32;case Int8Array:return h.DT_INT8;case Int16Array:return h.DT_INT16;case Int32Array:return h.DT_INT32;case Uint8Array:return h.DT_UINT8;case Uint16Array:return h.DT_UINT16;case Uint32Array:return h.DT_UINT32}}}},"./node_modules/three/examples/jsm/loaders/GLTFLoader.js":(k,K,f)=>{"use strict";f.r(K),f.d(K,{GLTFLoader:()=>v});var y=f("./node_modules/three/build/three.module.js"),_=f("./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js");class v extends y.Loader{constructor(ae){super(ae);this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(oe){return new g(oe)}),this.register(function(oe){return new A(oe)}),this.register(function(oe){return new H(oe)}),this.register(function(oe){return new Y(oe)}),this.register(function(oe){return new W(oe)}),this.register(function(oe){return new m(oe)}),this.register(function(oe){return new x(oe)}),this.register(function(oe){return new S(oe)}),this.register(function(oe){return new b(oe)}),this.register(function(oe){return new c(oe)}),this.register(function(oe){return new L(oe)}),this.register(function(oe){return new h(oe)}),this.register(function(oe){return new F(oe)}),this.register(function(oe){return new M(oe)}),this.register(function(oe){return new u(oe)}),this.register(function(oe){return new te(oe)}),this.register(function(oe){return new re(oe)})}load(ae,oe,Ce,fe){let Ee=this,xe;if(this.resourcePath!=="")xe=this.resourcePath;else if(this.path!==""){let R=y.LoaderUtils.extractUrlBase(ae);xe=y.LoaderUtils.resolveURL(R,this.path)}else xe=y.LoaderUtils.extractUrlBase(ae);this.manager.itemStart(ae);let z=function(R){fe?fe(R):console.error(R),Ee.manager.itemError(ae),Ee.manager.itemEnd(ae)},I=new y.FileLoader(this.manager);I.setPath(this.path),I.setResponseType("arraybuffer"),I.setRequestHeader(this.requestHeader),I.setWithCredentials(this.withCredentials),I.load(ae,function(R){try{Ee.parse(R,xe,function(ee){oe(ee),Ee.manager.itemEnd(ae)},z)}catch(ee){z(ee)}},Ce,z)}setDRACOLoader(ae){return this.dracoLoader=ae,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(ae){return this.ktx2Loader=ae,this}setMeshoptDecoder(ae){return this.meshoptDecoder=ae,this}register(ae){return this.pluginCallbacks.indexOf(ae)===-1&&this.pluginCallbacks.push(ae),this}unregister(ae){return this.pluginCallbacks.indexOf(ae)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(ae),1),this}parse(ae,oe,Ce,fe){let Ee,xe={},z={},I=new TextDecoder;if(typeof ae=="string")Ee=JSON.parse(ae);else if(ae instanceof ArrayBuffer)if(I.decode(new Uint8Array(ae,0,4))===X){try{xe[l.KHR_BINARY_GLTF]=new Z(ae)}catch(he){fe&&fe(he);return}Ee=JSON.parse(xe[l.KHR_BINARY_GLTF].content)}else Ee=JSON.parse(I.decode(ae));else Ee=ae;if(Ee.asset===void 0||Ee.asset.version[0]<2){fe&&fe(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let R=new mr(Ee,{path:oe||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});R.fileLoader.setRequestHeader(this.requestHeader);for(let ee=0;ee<this.pluginCallbacks.length;ee++){let he=this.pluginCallbacks[ee](R);he.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),z[he.name]=he,xe[he.name]=!0}if(Ee.extensionsUsed)for(let ee=0;ee<Ee.extensionsUsed.length;++ee){let he=Ee.extensionsUsed[ee],_e=Ee.extensionsRequired||[];switch(he){case l.KHR_MATERIALS_UNLIT:xe[he]=new p;break;case l.KHR_DRACO_MESH_COMPRESSION:xe[he]=new ne(Ee,this.dracoLoader);break;case l.KHR_TEXTURE_TRANSFORM:xe[he]=new pe;break;case l.KHR_MESH_QUANTIZATION:xe[he]=new be;break;default:_e.indexOf(he)>=0&&z[he]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+he+'".')}}R.setExtensions(xe),R.setPlugins(z),R.parse(Ce,fe)}parseAsync(ae,oe){let Ce=this;return new Promise(function(fe,Ee){Ce.parse(ae,oe,fe,Ee)})}}function C(){let vt={};return{get:function(ae){return vt[ae]},add:function(ae,oe){vt[ae]=oe},remove:function(ae){delete vt[ae]},removeAll:function(){vt={}}}}let l={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class u{constructor(ae){this.parser=ae,this.name=l.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let ae=this.parser,oe=this.parser.json.nodes||[];for(let Ce=0,fe=oe.length;Ce<fe;Ce++){let Ee=oe[Ce];Ee.extensions&&Ee.extensions[this.name]&&Ee.extensions[this.name].light!==void 0&&ae._addNodeRef(this.cache,Ee.extensions[this.name].light)}}_loadLight(ae){let oe=this.parser,Ce="light:"+ae,fe=oe.cache.get(Ce);if(fe)return fe;let Ee=oe.json,I=((Ee.extensions&&Ee.extensions[this.name]||{}).lights||[])[ae],R,ee=new y.Color(16777215);I.color!==void 0&&ee.setRGB(I.color[0],I.color[1],I.color[2],y.LinearSRGBColorSpace);let he=I.range!==void 0?I.range:0;switch(I.type){case"directional":R=new y.DirectionalLight(ee),R.target.position.set(0,0,-1),R.add(R.target);break;case"point":R=new y.PointLight(ee),R.distance=he;break;case"spot":R=new y.SpotLight(ee),R.distance=he,I.spot=I.spot||{},I.spot.innerConeAngle=I.spot.innerConeAngle!==void 0?I.spot.innerConeAngle:0,I.spot.outerConeAngle=I.spot.outerConeAngle!==void 0?I.spot.outerConeAngle:Math.PI/4,R.angle=I.spot.outerConeAngle,R.penumbra=1-I.spot.innerConeAngle/I.spot.outerConeAngle,R.target.position.set(0,0,-1),R.add(R.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+I.type)}return R.position.set(0,0,0),R.decay=2,En(R,I),I.intensity!==void 0&&(R.intensity=I.intensity),R.name=oe.createUniqueName(I.name||"light_"+ae),fe=Promise.resolve(R),oe.cache.add(Ce,fe),fe}getDependency(ae,oe){if(ae==="light")return this._loadLight(oe)}createNodeAttachment(ae){let oe=this,Ce=this.parser,Ee=Ce.json.nodes[ae],z=(Ee.extensions&&Ee.extensions[this.name]||{}).light;return z===void 0?null:this._loadLight(z).then(function(I){return Ce._getNodeRef(oe.cache,z,I)})}}class p{constructor(){this.name=l.KHR_MATERIALS_UNLIT}getMaterialType(){return y.MeshBasicMaterial}extendParams(ae,oe,Ce){let fe=[];ae.color=new y.Color(1,1,1),ae.opacity=1;let Ee=oe.pbrMetallicRoughness;if(Ee){if(Array.isArray(Ee.baseColorFactor)){let xe=Ee.baseColorFactor;ae.color.setRGB(xe[0],xe[1],xe[2],y.LinearSRGBColorSpace),ae.opacity=xe[3]}Ee.baseColorTexture!==void 0&&fe.push(Ce.assignTexture(ae,"map",Ee.baseColorTexture,y.SRGBColorSpace))}return Promise.all(fe)}}class c{constructor(ae){this.parser=ae,this.name=l.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(ae,oe){let fe=this.parser.json.materials[ae];if(!fe.extensions||!fe.extensions[this.name])return Promise.resolve();let Ee=fe.extensions[this.name].emissiveStrength;return Ee!==void 0&&(oe.emissiveIntensity=Ee),Promise.resolve()}}class g{constructor(ae){this.parser=ae,this.name=l.KHR_MATERIALS_CLEARCOAT}getMaterialType(ae){let Ce=this.parser.json.materials[ae];return!Ce.extensions||!Ce.extensions[this.name]?null:y.MeshPhysicalMaterial}extendMaterialParams(ae,oe){let Ce=this.parser,fe=Ce.json.materials[ae];if(!fe.extensions||!fe.extensions[this.name])return Promise.resolve();let Ee=[],xe=fe.extensions[this.name];if(xe.clearcoatFactor!==void 0&&(oe.clearcoat=xe.clearcoatFactor),xe.clearcoatTexture!==void 0&&Ee.push(Ce.assignTexture(oe,"clearcoatMap",xe.clearcoatTexture)),xe.clearcoatRoughnessFactor!==void 0&&(oe.clearcoatRoughness=xe.clearcoatRoughnessFactor),xe.clearcoatRoughnessTexture!==void 0&&Ee.push(Ce.assignTexture(oe,"clearcoatRoughnessMap",xe.clearcoatRoughnessTexture)),xe.clearcoatNormalTexture!==void 0&&(Ee.push(Ce.assignTexture(oe,"clearcoatNormalMap",xe.clearcoatNormalTexture)),xe.clearcoatNormalTexture.scale!==void 0)){let z=xe.clearcoatNormalTexture.scale;oe.clearcoatNormalScale=new y.Vector2(z,z)}return Promise.all(Ee)}}class A{constructor(ae){this.parser=ae,this.name=l.KHR_MATERIALS_DISPERSION}getMaterialType(ae){let Ce=this.parser.json.materials[ae];return!Ce.extensions||!Ce.extensions[this.name]?null:y.MeshPhysicalMaterial}extendMaterialParams(ae,oe){let fe=this.parser.json.materials[ae];if(!fe.extensions||!fe.extensions[this.name])return Promise.resolve();let Ee=fe.extensions[this.name];return oe.dispersion=Ee.dispersion!==void 0?Ee.dispersion:0,Promise.resolve()}}class h{constructor(ae){this.parser=ae,this.name=l.KHR_MATERIALS_IRIDESCENCE}getMaterialType(ae){let Ce=this.parser.json.materials[ae];return!Ce.extensions||!Ce.extensions[this.name]?null:y.MeshPhysicalMaterial}extendMaterialParams(ae,oe){let Ce=this.parser,fe=Ce.json.materials[ae];if(!fe.extensions||!fe.extensions[this.name])return Promise.resolve();let Ee=[],xe=fe.extensions[this.name];return xe.iridescenceFactor!==void 0&&(oe.iridescence=xe.iridescenceFactor),xe.iridescenceTexture!==void 0&&Ee.push(Ce.assignTexture(oe,"iridescenceMap",xe.iridescenceTexture)),xe.iridescenceIor!==void 0&&(oe.iridescenceIOR=xe.iridescenceIor),oe.iridescenceThicknessRange===void 0&&(oe.iridescenceThicknessRange=[100,400]),xe.iridescenceThicknessMinimum!==void 0&&(oe.iridescenceThicknessRange[0]=xe.iridescenceThicknessMinimum),xe.iridescenceThicknessMaximum!==void 0&&(oe.iridescenceThicknessRange[1]=xe.iridescenceThicknessMaximum),xe.iridescenceThicknessTexture!==void 0&&Ee.push(Ce.assignTexture(oe,"iridescenceThicknessMap",xe.iridescenceThicknessTexture)),Promise.all(Ee)}}class m{constructor(ae){this.parser=ae,this.name=l.KHR_MATERIALS_SHEEN}getMaterialType(ae){let Ce=this.parser.json.materials[ae];return!Ce.extensions||!Ce.extensions[this.name]?null:y.MeshPhysicalMaterial}extendMaterialParams(ae,oe){let Ce=this.parser,fe=Ce.json.materials[ae];if(!fe.extensions||!fe.extensions[this.name])return Promise.resolve();let Ee=[];oe.sheenColor=new y.Color(0,0,0),oe.sheenRoughness=0,oe.sheen=1;let xe=fe.extensions[this.name];if(xe.sheenColorFactor!==void 0){let z=xe.sheenColorFactor;oe.sheenColor.setRGB(z[0],z[1],z[2],y.LinearSRGBColorSpace)}return xe.sheenRoughnessFactor!==void 0&&(oe.sheenRoughness=xe.sheenRoughnessFactor),xe.sheenColorTexture!==void 0&&Ee.push(Ce.assignTexture(oe,"sheenColorMap",xe.sheenColorTexture,y.SRGBColorSpace)),xe.sheenRoughnessTexture!==void 0&&Ee.push(Ce.assignTexture(oe,"sheenRoughnessMap",xe.sheenRoughnessTexture)),Promise.all(Ee)}}class x{constructor(ae){this.parser=ae,this.name=l.KHR_MATERIALS_TRANSMISSION}getMaterialType(ae){let Ce=this.parser.json.materials[ae];return!Ce.extensions||!Ce.extensions[this.name]?null:y.MeshPhysicalMaterial}extendMaterialParams(ae,oe){let Ce=this.parser,fe=Ce.json.materials[ae];if(!fe.extensions||!fe.extensions[this.name])return Promise.resolve();let Ee=[],xe=fe.extensions[this.name];return xe.transmissionFactor!==void 0&&(oe.transmission=xe.transmissionFactor),xe.transmissionTexture!==void 0&&Ee.push(Ce.assignTexture(oe,"transmissionMap",xe.transmissionTexture)),Promise.all(Ee)}}class S{constructor(ae){this.parser=ae,this.name=l.KHR_MATERIALS_VOLUME}getMaterialType(ae){let Ce=this.parser.json.materials[ae];return!Ce.extensions||!Ce.extensions[this.name]?null:y.MeshPhysicalMaterial}extendMaterialParams(ae,oe){let Ce=this.parser,fe=Ce.json.materials[ae];if(!fe.extensions||!fe.extensions[this.name])return Promise.resolve();let Ee=[],xe=fe.extensions[this.name];oe.thickness=xe.thicknessFactor!==void 0?xe.thicknessFactor:0,xe.thicknessTexture!==void 0&&Ee.push(Ce.assignTexture(oe,"thicknessMap",xe.thicknessTexture)),oe.attenuationDistance=xe.attenuationDistance||1/0;let z=xe.attenuationColor||[1,1,1];return oe.attenuationColor=new y.Color().setRGB(z[0],z[1],z[2],y.LinearSRGBColorSpace),Promise.all(Ee)}}class b{constructor(ae){this.parser=ae,this.name=l.KHR_MATERIALS_IOR}getMaterialType(ae){let Ce=this.parser.json.materials[ae];return!Ce.extensions||!Ce.extensions[this.name]?null:y.MeshPhysicalMaterial}extendMaterialParams(ae,oe){let fe=this.parser.json.materials[ae];if(!fe.extensions||!fe.extensions[this.name])return Promise.resolve();let Ee=fe.extensions[this.name];return oe.ior=Ee.ior!==void 0?Ee.ior:1.5,Promise.resolve()}}class L{constructor(ae){this.parser=ae,this.name=l.KHR_MATERIALS_SPECULAR}getMaterialType(ae){let Ce=this.parser.json.materials[ae];return!Ce.extensions||!Ce.extensions[this.name]?null:y.MeshPhysicalMaterial}extendMaterialParams(ae,oe){let Ce=this.parser,fe=Ce.json.materials[ae];if(!fe.extensions||!fe.extensions[this.name])return Promise.resolve();let Ee=[],xe=fe.extensions[this.name];oe.specularIntensity=xe.specularFactor!==void 0?xe.specularFactor:1,xe.specularTexture!==void 0&&Ee.push(Ce.assignTexture(oe,"specularIntensityMap",xe.specularTexture));let z=xe.specularColorFactor||[1,1,1];return oe.specularColor=new y.Color().setRGB(z[0],z[1],z[2],y.LinearSRGBColorSpace),xe.specularColorTexture!==void 0&&Ee.push(Ce.assignTexture(oe,"specularColorMap",xe.specularColorTexture,y.SRGBColorSpace)),Promise.all(Ee)}}class M{constructor(ae){this.parser=ae,this.name=l.EXT_MATERIALS_BUMP}getMaterialType(ae){let Ce=this.parser.json.materials[ae];return!Ce.extensions||!Ce.extensions[this.name]?null:y.MeshPhysicalMaterial}extendMaterialParams(ae,oe){let Ce=this.parser,fe=Ce.json.materials[ae];if(!fe.extensions||!fe.extensions[this.name])return Promise.resolve();let Ee=[],xe=fe.extensions[this.name];return oe.bumpScale=xe.bumpFactor!==void 0?xe.bumpFactor:1,xe.bumpTexture!==void 0&&Ee.push(Ce.assignTexture(oe,"bumpMap",xe.bumpTexture)),Promise.all(Ee)}}class F{constructor(ae){this.parser=ae,this.name=l.KHR_MATERIALS_ANISOTROPY}getMaterialType(ae){let Ce=this.parser.json.materials[ae];return!Ce.extensions||!Ce.extensions[this.name]?null:y.MeshPhysicalMaterial}extendMaterialParams(ae,oe){let Ce=this.parser,fe=Ce.json.materials[ae];if(!fe.extensions||!fe.extensions[this.name])return Promise.resolve();let Ee=[],xe=fe.extensions[this.name];return xe.anisotropyStrength!==void 0&&(oe.anisotropy=xe.anisotropyStrength),xe.anisotropyRotation!==void 0&&(oe.anisotropyRotation=xe.anisotropyRotation),xe.anisotropyTexture!==void 0&&Ee.push(Ce.assignTexture(oe,"anisotropyMap",xe.anisotropyTexture)),Promise.all(Ee)}}class H{constructor(ae){this.parser=ae,this.name=l.KHR_TEXTURE_BASISU}loadTexture(ae){let oe=this.parser,Ce=oe.json,fe=Ce.textures[ae];if(!fe.extensions||!fe.extensions[this.name])return null;let Ee=fe.extensions[this.name],xe=oe.options.ktx2Loader;if(!xe){if(Ce.extensionsRequired&&Ce.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return oe.loadTextureImage(ae,Ee.source,xe)}}class Y{constructor(ae){this.parser=ae,this.name=l.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(ae){let oe=this.name,Ce=this.parser,fe=Ce.json,Ee=fe.textures[ae];if(!Ee.extensions||!Ee.extensions[oe])return null;let xe=Ee.extensions[oe],z=fe.images[xe.source],I=Ce.textureLoader;if(z.uri){let R=Ce.options.manager.getHandler(z.uri);R!==null&&(I=R)}return this.detectSupport().then(function(R){if(R)return Ce.loadTextureImage(ae,xe.source,I);if(fe.extensionsRequired&&fe.extensionsRequired.indexOf(oe)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return Ce.loadTexture(ae)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(ae){let oe=new Image;oe.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",oe.onload=oe.onerror=function(){ae(oe.height===1)}})),this.isSupported}}class W{constructor(ae){this.parser=ae,this.name=l.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(ae){let oe=this.name,Ce=this.parser,fe=Ce.json,Ee=fe.textures[ae];if(!Ee.extensions||!Ee.extensions[oe])return null;let xe=Ee.extensions[oe],z=fe.images[xe.source],I=Ce.textureLoader;if(z.uri){let R=Ce.options.manager.getHandler(z.uri);R!==null&&(I=R)}return this.detectSupport().then(function(R){if(R)return Ce.loadTextureImage(ae,xe.source,I);if(fe.extensionsRequired&&fe.extensionsRequired.indexOf(oe)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return Ce.loadTexture(ae)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(ae){let oe=new Image;oe.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",oe.onload=oe.onerror=function(){ae(oe.height===1)}})),this.isSupported}}class te{constructor(ae){this.name=l.EXT_MESHOPT_COMPRESSION,this.parser=ae}loadBufferView(ae){let oe=this.parser.json,Ce=oe.bufferViews[ae];if(Ce.extensions&&Ce.extensions[this.name]){let fe=Ce.extensions[this.name],Ee=this.parser.getDependency("buffer",fe.buffer),xe=this.parser.options.meshoptDecoder;if(!xe||!xe.supported){if(oe.extensionsRequired&&oe.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Ee.then(function(z){let I=fe.byteOffset||0,R=fe.byteLength||0,ee=fe.count,he=fe.byteStride,_e=new Uint8Array(z,I,R);return xe.decodeGltfBufferAsync?xe.decodeGltfBufferAsync(ee,he,_e,fe.mode,fe.filter).then(function(De){return De.buffer}):xe.ready.then(function(){let De=new ArrayBuffer(ee*he);return xe.decodeGltfBuffer(new Uint8Array(De),ee,he,_e,fe.mode,fe.filter),De})})}else return null}}class re{constructor(ae){this.name=l.EXT_MESH_GPU_INSTANCING,this.parser=ae}createNodeMesh(ae){let oe=this.parser.json,Ce=oe.nodes[ae];if(!Ce.extensions||!Ce.extensions[this.name]||Ce.mesh===void 0)return null;let fe=oe.meshes[Ce.mesh];for(let R of fe.primitives)if(R.mode!==nt.TRIANGLES&&R.mode!==nt.TRIANGLE_STRIP&&R.mode!==nt.TRIANGLE_FAN&&R.mode!==void 0)return null;let xe=Ce.extensions[this.name].attributes,z=[],I={};for(let R in xe)z.push(this.parser.getDependency("accessor",xe[R]).then(ee=>(I[R]=ee,I[R])));return z.length<1?null:(z.push(this.parser.createNodeMesh(ae)),Promise.all(z).then(R=>{let ee=R.pop(),he=ee.isGroup?ee.children:[ee],_e=R[0].count,De=[];for(let Ct of he){let Bt=new y.Matrix4,_t=new y.Vector3,Mt=new y.Quaternion,Xt=new y.Vector3(1,1,1),Qi=new y.InstancedMesh(Ct.geometry,Ct.material,_e);for(let pn=0;pn<_e;pn++)I.TRANSLATION&&_t.fromBufferAttribute(I.TRANSLATION,pn),I.ROTATION&&Mt.fromBufferAttribute(I.ROTATION,pn),I.SCALE&&Xt.fromBufferAttribute(I.SCALE,pn),Qi.setMatrixAt(pn,Bt.compose(_t,Mt,Xt));for(let pn in I)if(pn==="_COLOR_0"){let Oi=I[pn];Qi.instanceColor=new y.InstancedBufferAttribute(Oi.array,Oi.itemSize,Oi.normalized)}else pn!=="TRANSLATION"&&pn!=="ROTATION"&&pn!=="SCALE"&&Ct.geometry.setAttribute(pn,I[pn]);y.Object3D.prototype.copy.call(Qi,Ct),this.parser.assignFinalMaterial(Qi),De.push(Qi)}return ee.isGroup?(ee.clear(),ee.add(...De),ee):De[0]}))}}let X="glTF",V=12,O={JSON:1313821514,BIN:5130562};class Z{constructor(ae){this.name=l.KHR_BINARY_GLTF,this.content=null,this.body=null;let oe=new DataView(ae,0,V),Ce=new TextDecoder;if(this.header={magic:Ce.decode(new Uint8Array(ae.slice(0,4))),version:oe.getUint32(4,!0),length:oe.getUint32(8,!0)},this.header.magic!==X)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");let fe=this.header.length-V,Ee=new DataView(ae,V),xe=0;for(;xe<fe;){let z=Ee.getUint32(xe,!0);xe+=4;let I=Ee.getUint32(xe,!0);if(xe+=4,I===O.JSON){let R=new Uint8Array(ae,V+xe,z);this.content=Ce.decode(R)}else if(I===O.BIN){let R=V+xe;this.body=ae.slice(R,R+z)}xe+=z}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class ne{constructor(ae,oe){if(!oe)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=l.KHR_DRACO_MESH_COMPRESSION,this.json=ae,this.dracoLoader=oe,this.dracoLoader.preload()}decodePrimitive(ae,oe){let Ce=this.json,fe=this.dracoLoader,Ee=ae.extensions[this.name].bufferView,xe=ae.extensions[this.name].attributes,z={},I={},R={};for(let ee in xe){let he=kt[ee]||ee.toLowerCase();z[he]=xe[ee]}for(let ee in ae.attributes){let he=kt[ee]||ee.toLowerCase();if(xe[ee]!==void 0){let _e=Ce.accessors[ae.attributes[ee]],De=mt[_e.componentType];R[he]=De.name,I[he]=_e.normalized===!0}}return oe.getDependency("bufferView",Ee).then(function(ee){return new Promise(function(he,_e){fe.decodeDracoFile(ee,function(De){for(let Ct in De.attributes){let Bt=De.attributes[Ct],_t=I[Ct];_t!==void 0&&(Bt.normalized=_t)}he(De)},z,R,y.LinearSRGBColorSpace,_e)})})}}class pe{constructor(){this.name=l.KHR_TEXTURE_TRANSFORM}extendTexture(ae,oe){return(oe.texCoord===void 0||oe.texCoord===ae.channel)&&oe.offset===void 0&&oe.rotation===void 0&&oe.scale===void 0||(ae=ae.clone(),oe.texCoord!==void 0&&(ae.channel=oe.texCoord),oe.offset!==void 0&&ae.offset.fromArray(oe.offset),oe.rotation!==void 0&&(ae.rotation=oe.rotation),oe.scale!==void 0&&ae.repeat.fromArray(oe.scale),ae.needsUpdate=!0),ae}}class be{constructor(){this.name=l.KHR_MESH_QUANTIZATION}}class Re extends y.Interpolant{constructor(ae,oe,Ce,fe){super(ae,oe,Ce,fe)}copySampleValue_(ae){let oe=this.resultBuffer,Ce=this.sampleValues,fe=this.valueSize,Ee=ae*fe*3+fe;for(let xe=0;xe!==fe;xe++)oe[xe]=Ce[Ee+xe];return oe}interpolate_(ae,oe,Ce,fe){let Ee=this.resultBuffer,xe=this.sampleValues,z=this.valueSize,I=z*2,R=z*3,ee=fe-oe,he=(Ce-oe)/ee,_e=he*he,De=_e*he,Ct=ae*R,Bt=Ct-R,_t=-2*De+3*_e,Mt=De-_e,Xt=1-_t,Qi=Mt-_e+he;for(let pn=0;pn!==z;pn++){let Oi=xe[Bt+pn+z],ti=xe[Bt+pn+I]*ee,yi=xe[Ct+pn+z],kr=xe[Ct+pn]*ee;Ee[pn]=Xt*Oi+Qi*ti+_t*yi+Mt*kr}return Ee}}let Ue=new y.Quaternion;class je extends Re{interpolate_(ae,oe,Ce,fe){let Ee=super.interpolate_(ae,oe,Ce,fe);return Ue.fromArray(Ee).normalize().toArray(Ee),Ee}}let nt={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},mt={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Dt={9728:y.NearestFilter,9729:y.LinearFilter,9984:y.NearestMipmapNearestFilter,9985:y.LinearMipmapNearestFilter,9986:y.NearestMipmapLinearFilter,9987:y.LinearMipmapLinearFilter},pt={33071:y.ClampToEdgeWrapping,33648:y.MirroredRepeatWrapping,10497:y.RepeatWrapping},Tt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},kt={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},un={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},yn={CUBICSPLINE:void 0,LINEAR:y.InterpolateLinear,STEP:y.InterpolateDiscrete},Sn={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Nn(vt){return vt.DefaultMaterial===void 0&&(vt.DefaultMaterial=new y.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:y.FrontSide})),vt.DefaultMaterial}function ln(vt,ae,oe){for(let Ce in oe.extensions)vt[Ce]===void 0&&(ae.userData.gltfExtensions=ae.userData.gltfExtensions||{},ae.userData.gltfExtensions[Ce]=oe.extensions[Ce])}function En(vt,ae){ae.extras!==void 0&&(typeof ae.extras=="object"?Object.assign(vt.userData,ae.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+ae.extras))}function fi(vt,ae,oe){let Ce=!1,fe=!1,Ee=!1;for(let R=0,ee=ae.length;R<ee;R++){let he=ae[R];if(he.POSITION!==void 0&&(Ce=!0),he.NORMAL!==void 0&&(fe=!0),he.COLOR_0!==void 0&&(Ee=!0),Ce&&fe&&Ee)break}if(!Ce&&!fe&&!Ee)return Promise.resolve(vt);let xe=[],z=[],I=[];for(let R=0,ee=ae.length;R<ee;R++){let he=ae[R];if(Ce){let _e=he.POSITION!==void 0?oe.getDependency("accessor",he.POSITION):vt.attributes.position;xe.push(_e)}if(fe){let _e=he.NORMAL!==void 0?oe.getDependency("accessor",he.NORMAL):vt.attributes.normal;z.push(_e)}if(Ee){let _e=he.COLOR_0!==void 0?oe.getDependency("accessor",he.COLOR_0):vt.attributes.color;I.push(_e)}}return Promise.all([Promise.all(xe),Promise.all(z),Promise.all(I)]).then(function(R){let ee=R[0],he=R[1],_e=R[2];return Ce&&(vt.morphAttributes.position=ee),fe&&(vt.morphAttributes.normal=he),Ee&&(vt.morphAttributes.color=_e),vt.morphTargetsRelative=!0,vt})}function si(vt,ae){if(vt.updateMorphTargets(),ae.weights!==void 0)for(let oe=0,Ce=ae.weights.length;oe<Ce;oe++)vt.morphTargetInfluences[oe]=ae.weights[oe];if(ae.extras&&Array.isArray(ae.extras.targetNames)){let oe=ae.extras.targetNames;if(vt.morphTargetInfluences.length===oe.length){vt.morphTargetDictionary={};for(let Ce=0,fe=oe.length;Ce<fe;Ce++)vt.morphTargetDictionary[oe[Ce]]=Ce}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function qi(vt){let ae,oe=vt.extensions&&vt.extensions[l.KHR_DRACO_MESH_COMPRESSION];if(oe?ae="draco:"+oe.bufferView+":"+oe.indices+":"+pi(oe.attributes):ae=vt.indices+":"+pi(vt.attributes)+":"+vt.mode,vt.targets!==void 0)for(let Ce=0,fe=vt.targets.length;Ce<fe;Ce++)ae+=":"+pi(vt.targets[Ce]);return ae}function pi(vt){let ae="",oe=Object.keys(vt).sort();for(let Ce=0,fe=oe.length;Ce<fe;Ce++)ae+=oe[Ce]+":"+vt[oe[Ce]]+";";return ae}function Jn(vt){switch(vt){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Fi(vt){return vt.search(/\.jpe?g($|\?)/i)>0||vt.search(/^data\:image\/jpeg/)===0?"image/jpeg":vt.search(/\.webp($|\?)/i)>0||vt.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}let vi=new y.Matrix4;class mr{constructor(ae={},oe={}){this.json=ae,this.extensions={},this.plugins={},this.options=oe,this.cache=new C,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let Ce=!1,fe=!1,Ee=-1;typeof navigator!="undefined"&&(Ce=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,fe=navigator.userAgent.indexOf("Firefox")>-1,Ee=fe?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap=="undefined"||Ce||fe&&Ee<98?this.textureLoader=new y.TextureLoader(this.options.manager):this.textureLoader=new y.ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new y.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(ae){this.extensions=ae}setPlugins(ae){this.plugins=ae}parse(ae,oe){let Ce=this,fe=this.json,Ee=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(xe){return xe._markDefs&&xe._markDefs()}),Promise.all(this._invokeAll(function(xe){return xe.beforeRoot&&xe.beforeRoot()})).then(function(){return Promise.all([Ce.getDependencies("scene"),Ce.getDependencies("animation"),Ce.getDependencies("camera")])}).then(function(xe){let z={scene:xe[0][fe.scene||0],scenes:xe[0],animations:xe[1],cameras:xe[2],asset:fe.asset,parser:Ce,userData:{}};return ln(Ee,z,fe),En(z,fe),Promise.all(Ce._invokeAll(function(I){return I.afterRoot&&I.afterRoot(z)})).then(function(){for(let I of z.scenes)I.updateMatrixWorld();ae(z)})}).catch(oe)}_markDefs(){let ae=this.json.nodes||[],oe=this.json.skins||[],Ce=this.json.meshes||[];for(let fe=0,Ee=oe.length;fe<Ee;fe++){let xe=oe[fe].joints;for(let z=0,I=xe.length;z<I;z++)ae[xe[z]].isBone=!0}for(let fe=0,Ee=ae.length;fe<Ee;fe++){let xe=ae[fe];xe.mesh!==void 0&&(this._addNodeRef(this.meshCache,xe.mesh),xe.skin!==void 0&&(Ce[xe.mesh].isSkinnedMesh=!0)),xe.camera!==void 0&&this._addNodeRef(this.cameraCache,xe.camera)}}_addNodeRef(ae,oe){oe!==void 0&&(ae.refs[oe]===void 0&&(ae.refs[oe]=ae.uses[oe]=0),ae.refs[oe]++)}_getNodeRef(ae,oe,Ce){if(ae.refs[oe]<=1)return Ce;let fe=Ce.clone(),Ee=(xe,z)=>{let I=this.associations.get(xe);I!=null&&this.associations.set(z,I);for(let[R,ee]of xe.children.entries())Ee(ee,z.children[R])};return Ee(Ce,fe),fe.name+="_instance_"+ae.uses[oe]++,fe}_invokeOne(ae){let oe=Object.values(this.plugins);oe.push(this);for(let Ce=0;Ce<oe.length;Ce++){let fe=ae(oe[Ce]);if(fe)return fe}return null}_invokeAll(ae){let oe=Object.values(this.plugins);oe.unshift(this);let Ce=[];for(let fe=0;fe<oe.length;fe++){let Ee=ae(oe[fe]);Ee&&Ce.push(Ee)}return Ce}getDependency(ae,oe){let Ce=ae+":"+oe,fe=this.cache.get(Ce);if(!fe){switch(ae){case"scene":fe=this.loadScene(oe);break;case"node":fe=this._invokeOne(function(Ee){return Ee.loadNode&&Ee.loadNode(oe)});break;case"mesh":fe=this._invokeOne(function(Ee){return Ee.loadMesh&&Ee.loadMesh(oe)});break;case"accessor":fe=this.loadAccessor(oe);break;case"bufferView":fe=this._invokeOne(function(Ee){return Ee.loadBufferView&&Ee.loadBufferView(oe)});break;case"buffer":fe=this.loadBuffer(oe);break;case"material":fe=this._invokeOne(function(Ee){return Ee.loadMaterial&&Ee.loadMaterial(oe)});break;case"texture":fe=this._invokeOne(function(Ee){return Ee.loadTexture&&Ee.loadTexture(oe)});break;case"skin":fe=this.loadSkin(oe);break;case"animation":fe=this._invokeOne(function(Ee){return Ee.loadAnimation&&Ee.loadAnimation(oe)});break;case"camera":fe=this.loadCamera(oe);break;default:if(fe=this._invokeOne(function(Ee){return Ee!=this&&Ee.getDependency&&Ee.getDependency(ae,oe)}),!fe)throw new Error("Unknown type: "+ae);break}this.cache.add(Ce,fe)}return fe}getDependencies(ae){let oe=this.cache.get(ae);if(!oe){let Ce=this,fe=this.json[ae+(ae==="mesh"?"es":"s")]||[];oe=Promise.all(fe.map(function(Ee,xe){return Ce.getDependency(ae,xe)})),this.cache.add(ae,oe)}return oe}loadBuffer(ae){let oe=this.json.buffers[ae],Ce=this.fileLoader;if(oe.type&&oe.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+oe.type+" buffer type is not supported.");if(oe.uri===void 0&&ae===0)return Promise.resolve(this.extensions[l.KHR_BINARY_GLTF].body);let fe=this.options;return new Promise(function(Ee,xe){Ce.load(y.LoaderUtils.resolveURL(oe.uri,fe.path),Ee,void 0,function(){xe(new Error('THREE.GLTFLoader: Failed to load buffer "'+oe.uri+'".'))})})}loadBufferView(ae){let oe=this.json.bufferViews[ae];return this.getDependency("buffer",oe.buffer).then(function(Ce){let fe=oe.byteLength||0,Ee=oe.byteOffset||0;return Ce.slice(Ee,Ee+fe)})}loadAccessor(ae){let oe=this,Ce=this.json,fe=this.json.accessors[ae];if(fe.bufferView===void 0&&fe.sparse===void 0){let xe=Tt[fe.type],z=mt[fe.componentType],I=fe.normalized===!0,R=new z(fe.count*xe);return Promise.resolve(new y.BufferAttribute(R,xe,I))}let Ee=[];return fe.bufferView!==void 0?Ee.push(this.getDependency("bufferView",fe.bufferView)):Ee.push(null),fe.sparse!==void 0&&(Ee.push(this.getDependency("bufferView",fe.sparse.indices.bufferView)),Ee.push(this.getDependency("bufferView",fe.sparse.values.bufferView))),Promise.all(Ee).then(function(xe){let z=xe[0],I=Tt[fe.type],R=mt[fe.componentType],ee=R.BYTES_PER_ELEMENT,he=ee*I,_e=fe.byteOffset||0,De=fe.bufferView!==void 0?Ce.bufferViews[fe.bufferView].byteStride:void 0,Ct=fe.normalized===!0,Bt,_t;if(De&&De!==he){let Mt=Math.floor(_e/De),Xt="InterleavedBuffer:"+fe.bufferView+":"+fe.componentType+":"+Mt+":"+fe.count,Qi=oe.cache.get(Xt);Qi||(Bt=new R(z,Mt*De,fe.count*De/ee),Qi=new y.InterleavedBuffer(Bt,De/ee),oe.cache.add(Xt,Qi)),_t=new y.InterleavedBufferAttribute(Qi,I,_e%De/ee,Ct)}else z===null?Bt=new R(fe.count*I):Bt=new R(z,_e,fe.count*I),_t=new y.BufferAttribute(Bt,I,Ct);if(fe.sparse!==void 0){let Mt=Tt.SCALAR,Xt=mt[fe.sparse.indices.componentType],Qi=fe.sparse.indices.byteOffset||0,pn=fe.sparse.values.byteOffset||0,Oi=new Xt(xe[1],Qi,fe.sparse.count*Mt),ti=new R(xe[2],pn,fe.sparse.count*I);z!==null&&(_t=new y.BufferAttribute(_t.array.slice(),_t.itemSize,_t.normalized));for(let yi=0,kr=Oi.length;yi<kr;yi++){let Ui=Oi[yi];if(_t.setX(Ui,ti[yi*I]),I>=2&&_t.setY(Ui,ti[yi*I+1]),I>=3&&_t.setZ(Ui,ti[yi*I+2]),I>=4&&_t.setW(Ui,ti[yi*I+3]),I>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return _t})}loadTexture(ae){let oe=this.json,Ce=this.options,Ee=oe.textures[ae].source,xe=oe.images[Ee],z=this.textureLoader;if(xe.uri){let I=Ce.manager.getHandler(xe.uri);I!==null&&(z=I)}return this.loadTextureImage(ae,Ee,z)}loadTextureImage(ae,oe,Ce){let fe=this,Ee=this.json,xe=Ee.textures[ae],z=Ee.images[oe],I=(z.uri||z.bufferView)+":"+xe.sampler;if(this.textureCache[I])return this.textureCache[I];let R=this.loadImageSource(oe,Ce).then(function(ee){ee.flipY=!1,ee.name=xe.name||z.name||"",ee.name===""&&typeof z.uri=="string"&&z.uri.startsWith("data:image/")===!1&&(ee.name=z.uri);let _e=(Ee.samplers||{})[xe.sampler]||{};return ee.magFilter=Dt[_e.magFilter]||y.LinearFilter,ee.minFilter=Dt[_e.minFilter]||y.LinearMipmapLinearFilter,ee.wrapS=pt[_e.wrapS]||y.RepeatWrapping,ee.wrapT=pt[_e.wrapT]||y.RepeatWrapping,fe.associations.set(ee,{textures:ae}),ee}).catch(function(){return null});return this.textureCache[I]=R,R}loadImageSource(ae,oe){let Ce=this,fe=this.json,Ee=this.options;if(this.sourceCache[ae]!==void 0)return this.sourceCache[ae].then(he=>he.clone());let xe=fe.images[ae],z=self.URL||self.webkitURL,I=xe.uri||"",R=!1;if(xe.bufferView!==void 0)I=Ce.getDependency("bufferView",xe.bufferView).then(function(he){R=!0;let _e=new Blob([he],{type:xe.mimeType});return I=z.createObjectURL(_e),I});else if(xe.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+ae+" is missing URI and bufferView");let ee=Promise.resolve(I).then(function(he){return new Promise(function(_e,De){let Ct=_e;oe.isImageBitmapLoader===!0&&(Ct=function(Bt){let _t=new y.Texture(Bt);_t.needsUpdate=!0,_e(_t)}),oe.load(y.LoaderUtils.resolveURL(he,Ee.path),Ct,void 0,De)})}).then(function(he){return R===!0&&z.revokeObjectURL(I),he.userData.mimeType=xe.mimeType||Fi(xe.uri),he}).catch(function(he){throw console.error("THREE.GLTFLoader: Couldn't load texture",I),he});return this.sourceCache[ae]=ee,ee}assignTexture(ae,oe,Ce,fe){let Ee=this;return this.getDependency("texture",Ce.index).then(function(xe){if(!xe)return null;if(Ce.texCoord!==void 0&&Ce.texCoord>0&&(xe=xe.clone(),xe.channel=Ce.texCoord),Ee.extensions[l.KHR_TEXTURE_TRANSFORM]){let z=Ce.extensions!==void 0?Ce.extensions[l.KHR_TEXTURE_TRANSFORM]:void 0;if(z){let I=Ee.associations.get(xe);xe=Ee.extensions[l.KHR_TEXTURE_TRANSFORM].extendTexture(xe,z),Ee.associations.set(xe,I)}}return fe!==void 0&&(xe.colorSpace=fe),ae[oe]=xe,xe})}assignFinalMaterial(ae){let oe=ae.geometry,Ce=ae.material,fe=oe.attributes.tangent===void 0,Ee=oe.attributes.color!==void 0,xe=oe.attributes.normal===void 0;if(ae.isPoints){let z="PointsMaterial:"+Ce.uuid,I=this.cache.get(z);I||(I=new y.PointsMaterial,y.Material.prototype.copy.call(I,Ce),I.color.copy(Ce.color),I.map=Ce.map,I.sizeAttenuation=!1,this.cache.add(z,I)),Ce=I}else if(ae.isLine){let z="LineBasicMaterial:"+Ce.uuid,I=this.cache.get(z);I||(I=new y.LineBasicMaterial,y.Material.prototype.copy.call(I,Ce),I.color.copy(Ce.color),I.map=Ce.map,this.cache.add(z,I)),Ce=I}if(fe||Ee||xe){let z="ClonedMaterial:"+Ce.uuid+":";fe&&(z+="derivative-tangents:"),Ee&&(z+="vertex-colors:"),xe&&(z+="flat-shading:");let I=this.cache.get(z);I||(I=Ce.clone(),Ee&&(I.vertexColors=!0),xe&&(I.flatShading=!0),fe&&(I.normalScale&&(I.normalScale.y*=-1),I.clearcoatNormalScale&&(I.clearcoatNormalScale.y*=-1)),this.cache.add(z,I),this.associations.set(I,this.associations.get(Ce))),Ce=I}ae.material=Ce}getMaterialType(){return y.MeshStandardMaterial}loadMaterial(ae){let oe=this,Ce=this.json,fe=this.extensions,Ee=Ce.materials[ae],xe,z={},I=Ee.extensions||{},R=[];if(I[l.KHR_MATERIALS_UNLIT]){let he=fe[l.KHR_MATERIALS_UNLIT];xe=he.getMaterialType(),R.push(he.extendParams(z,Ee,oe))}else{let he=Ee.pbrMetallicRoughness||{};if(z.color=new y.Color(1,1,1),z.opacity=1,Array.isArray(he.baseColorFactor)){let _e=he.baseColorFactor;z.color.setRGB(_e[0],_e[1],_e[2],y.LinearSRGBColorSpace),z.opacity=_e[3]}he.baseColorTexture!==void 0&&R.push(oe.assignTexture(z,"map",he.baseColorTexture,y.SRGBColorSpace)),z.metalness=he.metallicFactor!==void 0?he.metallicFactor:1,z.roughness=he.roughnessFactor!==void 0?he.roughnessFactor:1,he.metallicRoughnessTexture!==void 0&&(R.push(oe.assignTexture(z,"metalnessMap",he.metallicRoughnessTexture)),R.push(oe.assignTexture(z,"roughnessMap",he.metallicRoughnessTexture))),xe=this._invokeOne(function(_e){return _e.getMaterialType&&_e.getMaterialType(ae)}),R.push(Promise.all(this._invokeAll(function(_e){return _e.extendMaterialParams&&_e.extendMaterialParams(ae,z)})))}Ee.doubleSided===!0&&(z.side=y.DoubleSide);let ee=Ee.alphaMode||Sn.OPAQUE;if(ee===Sn.BLEND?(z.transparent=!0,z.depthWrite=!1):(z.transparent=!1,ee===Sn.MASK&&(z.alphaTest=Ee.alphaCutoff!==void 0?Ee.alphaCutoff:.5)),Ee.normalTexture!==void 0&&xe!==y.MeshBasicMaterial&&(R.push(oe.assignTexture(z,"normalMap",Ee.normalTexture)),z.normalScale=new y.Vector2(1,1),Ee.normalTexture.scale!==void 0)){let he=Ee.normalTexture.scale;z.normalScale.set(he,he)}if(Ee.occlusionTexture!==void 0&&xe!==y.MeshBasicMaterial&&(R.push(oe.assignTexture(z,"aoMap",Ee.occlusionTexture)),Ee.occlusionTexture.strength!==void 0&&(z.aoMapIntensity=Ee.occlusionTexture.strength)),Ee.emissiveFactor!==void 0&&xe!==y.MeshBasicMaterial){let he=Ee.emissiveFactor;z.emissive=new y.Color().setRGB(he[0],he[1],he[2],y.LinearSRGBColorSpace)}return Ee.emissiveTexture!==void 0&&xe!==y.MeshBasicMaterial&&R.push(oe.assignTexture(z,"emissiveMap",Ee.emissiveTexture,y.SRGBColorSpace)),Promise.all(R).then(function(){let he=new xe(z);return Ee.name&&(he.name=Ee.name),En(he,Ee),oe.associations.set(he,{materials:ae}),Ee.extensions&&ln(fe,he,Ee),he})}createUniqueName(ae){let oe=y.PropertyBinding.sanitizeNodeName(ae||"");return oe in this.nodeNamesUsed?oe+"_"+ ++this.nodeNamesUsed[oe]:(this.nodeNamesUsed[oe]=0,oe)}loadGeometries(ae){let oe=this,Ce=this.extensions,fe=this.primitiveCache;function Ee(z){return Ce[l.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(z,oe).then(function(I){return Ei(I,z,oe)})}let xe=[];for(let z=0,I=ae.length;z<I;z++){let R=ae[z],ee=qi(R),he=fe[ee];if(he)xe.push(he.promise);else{let _e;R.extensions&&R.extensions[l.KHR_DRACO_MESH_COMPRESSION]?_e=Ee(R):_e=Ei(new y.BufferGeometry,R,oe),fe[ee]={primitive:R,promise:_e},xe.push(_e)}}return Promise.all(xe)}loadMesh(ae){let oe=this,Ce=this.json,fe=this.extensions,Ee=Ce.meshes[ae],xe=Ee.primitives,z=[];for(let I=0,R=xe.length;I<R;I++){let ee=xe[I].material===void 0?Nn(this.cache):this.getDependency("material",xe[I].material);z.push(ee)}return z.push(oe.loadGeometries(xe)),Promise.all(z).then(function(I){let R=I.slice(0,I.length-1),ee=I[I.length-1],he=[];for(let De=0,Ct=ee.length;De<Ct;De++){let Bt=ee[De],_t=xe[De],Mt,Xt=R[De];if(_t.mode===nt.TRIANGLES||_t.mode===nt.TRIANGLE_STRIP||_t.mode===nt.TRIANGLE_FAN||_t.mode===void 0)Mt=Ee.isSkinnedMesh===!0?new y.SkinnedMesh(Bt,Xt):new y.Mesh(Bt,Xt),Mt.isSkinnedMesh===!0&&Mt.normalizeSkinWeights(),_t.mode===nt.TRIANGLE_STRIP?Mt.geometry=(0,_.toTrianglesDrawMode)(Mt.geometry,y.TriangleStripDrawMode):_t.mode===nt.TRIANGLE_FAN&&(Mt.geometry=(0,_.toTrianglesDrawMode)(Mt.geometry,y.TriangleFanDrawMode));else if(_t.mode===nt.LINES)Mt=new y.LineSegments(Bt,Xt);else if(_t.mode===nt.LINE_STRIP)Mt=new y.Line(Bt,Xt);else if(_t.mode===nt.LINE_LOOP)Mt=new y.LineLoop(Bt,Xt);else if(_t.mode===nt.POINTS)Mt=new y.Points(Bt,Xt);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+_t.mode);Object.keys(Mt.geometry.morphAttributes).length>0&&si(Mt,Ee),Mt.name=oe.createUniqueName(Ee.name||"mesh_"+ae),En(Mt,Ee),_t.extensions&&ln(fe,Mt,_t),oe.assignFinalMaterial(Mt),he.push(Mt)}for(let De=0,Ct=he.length;De<Ct;De++)oe.associations.set(he[De],{meshes:ae,primitives:De});if(he.length===1)return Ee.extensions&&ln(fe,he[0],Ee),he[0];let _e=new y.Group;Ee.extensions&&ln(fe,_e,Ee),oe.associations.set(_e,{meshes:ae});for(let De=0,Ct=he.length;De<Ct;De++)_e.add(he[De]);return _e})}loadCamera(ae){let oe,Ce=this.json.cameras[ae],fe=Ce[Ce.type];if(!fe){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return Ce.type==="perspective"?oe=new y.PerspectiveCamera(y.MathUtils.radToDeg(fe.yfov),fe.aspectRatio||1,fe.znear||1,fe.zfar||2e6):Ce.type==="orthographic"&&(oe=new y.OrthographicCamera(-fe.xmag,fe.xmag,fe.ymag,-fe.ymag,fe.znear,fe.zfar)),Ce.name&&(oe.name=this.createUniqueName(Ce.name)),En(oe,Ce),Promise.resolve(oe)}loadSkin(ae){let oe=this.json.skins[ae],Ce=[];for(let fe=0,Ee=oe.joints.length;fe<Ee;fe++)Ce.push(this._loadNodeShallow(oe.joints[fe]));return oe.inverseBindMatrices!==void 0?Ce.push(this.getDependency("accessor",oe.inverseBindMatrices)):Ce.push(null),Promise.all(Ce).then(function(fe){let Ee=fe.pop(),xe=fe,z=[],I=[];for(let R=0,ee=xe.length;R<ee;R++){let he=xe[R];if(he){z.push(he);let _e=new y.Matrix4;Ee!==null&&_e.fromArray(Ee.array,R*16),I.push(_e)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',oe.joints[R])}return new y.Skeleton(z,I)})}loadAnimation(ae){let oe=this.json,Ce=this,fe=oe.animations[ae],Ee=fe.name?fe.name:"animation_"+ae,xe=[],z=[],I=[],R=[],ee=[];for(let he=0,_e=fe.channels.length;he<_e;he++){let De=fe.channels[he],Ct=fe.samplers[De.sampler],Bt=De.target,_t=Bt.node,Mt=fe.parameters!==void 0?fe.parameters[Ct.input]:Ct.input,Xt=fe.parameters!==void 0?fe.parameters[Ct.output]:Ct.output;Bt.node!==void 0&&(xe.push(this.getDependency("node",_t)),z.push(this.getDependency("accessor",Mt)),I.push(this.getDependency("accessor",Xt)),R.push(Ct),ee.push(Bt))}return Promise.all([Promise.all(xe),Promise.all(z),Promise.all(I),Promise.all(R),Promise.all(ee)]).then(function(he){let _e=he[0],De=he[1],Ct=he[2],Bt=he[3],_t=he[4],Mt=[];for(let Xt=0,Qi=_e.length;Xt<Qi;Xt++){let pn=_e[Xt],Oi=De[Xt],ti=Ct[Xt],yi=Bt[Xt],kr=_t[Xt];if(pn===void 0)continue;pn.updateMatrix&&pn.updateMatrix();let Ui=Ce._createAnimationTracks(pn,Oi,ti,yi,kr);if(Ui)for(let es=0;es<Ui.length;es++)Mt.push(Ui[es])}return new y.AnimationClip(Ee,void 0,Mt)})}createNodeMesh(ae){let oe=this.json,Ce=this,fe=oe.nodes[ae];return fe.mesh===void 0?null:Ce.getDependency("mesh",fe.mesh).then(function(Ee){let xe=Ce._getNodeRef(Ce.meshCache,fe.mesh,Ee);return fe.weights!==void 0&&xe.traverse(function(z){if(!!z.isMesh)for(let I=0,R=fe.weights.length;I<R;I++)z.morphTargetInfluences[I]=fe.weights[I]}),xe})}loadNode(ae){let oe=this.json,Ce=this,fe=oe.nodes[ae],Ee=Ce._loadNodeShallow(ae),xe=[],z=fe.children||[];for(let R=0,ee=z.length;R<ee;R++)xe.push(Ce.getDependency("node",z[R]));let I=fe.skin===void 0?Promise.resolve(null):Ce.getDependency("skin",fe.skin);return Promise.all([Ee,Promise.all(xe),I]).then(function(R){let ee=R[0],he=R[1],_e=R[2];_e!==null&&ee.traverse(function(De){!De.isSkinnedMesh||De.bind(_e,vi)});for(let De=0,Ct=he.length;De<Ct;De++)ee.add(he[De]);return ee})}_loadNodeShallow(ae){let oe=this.json,Ce=this.extensions,fe=this;if(this.nodeCache[ae]!==void 0)return this.nodeCache[ae];let Ee=oe.nodes[ae],xe=Ee.name?fe.createUniqueName(Ee.name):"",z=[],I=fe._invokeOne(function(R){return R.createNodeMesh&&R.createNodeMesh(ae)});return I&&z.push(I),Ee.camera!==void 0&&z.push(fe.getDependency("camera",Ee.camera).then(function(R){return fe._getNodeRef(fe.cameraCache,Ee.camera,R)})),fe._invokeAll(function(R){return R.createNodeAttachment&&R.createNodeAttachment(ae)}).forEach(function(R){z.push(R)}),this.nodeCache[ae]=Promise.all(z).then(function(R){let ee;if(Ee.isBone===!0?ee=new y.Bone:R.length>1?ee=new y.Group:R.length===1?ee=R[0]:ee=new y.Object3D,ee!==R[0])for(let he=0,_e=R.length;he<_e;he++)ee.add(R[he]);if(Ee.name&&(ee.userData.name=Ee.name,ee.name=xe),En(ee,Ee),Ee.extensions&&ln(Ce,ee,Ee),Ee.matrix!==void 0){let he=new y.Matrix4;he.fromArray(Ee.matrix),ee.applyMatrix4(he)}else Ee.translation!==void 0&&ee.position.fromArray(Ee.translation),Ee.rotation!==void 0&&ee.quaternion.fromArray(Ee.rotation),Ee.scale!==void 0&&ee.scale.fromArray(Ee.scale);return fe.associations.has(ee)||fe.associations.set(ee,{}),fe.associations.get(ee).nodes=ae,ee}),this.nodeCache[ae]}loadScene(ae){let oe=this.extensions,Ce=this.json.scenes[ae],fe=this,Ee=new y.Group;Ce.name&&(Ee.name=fe.createUniqueName(Ce.name)),En(Ee,Ce),Ce.extensions&&ln(oe,Ee,Ce);let xe=Ce.nodes||[],z=[];for(let I=0,R=xe.length;I<R;I++)z.push(fe.getDependency("node",xe[I]));return Promise.all(z).then(function(I){for(let ee=0,he=I.length;ee<he;ee++)Ee.add(I[ee]);let R=ee=>{let he=new Map;for(let[_e,De]of fe.associations)(_e instanceof y.Material||_e instanceof y.Texture)&&he.set(_e,De);return ee.traverse(_e=>{let De=fe.associations.get(_e);De!=null&&he.set(_e,De)}),he};return fe.associations=R(Ee),Ee})}_createAnimationTracks(ae,oe,Ce,fe,Ee){let xe=[],z=ae.name?ae.name:ae.uuid,I=[];un[Ee.path]===un.weights?ae.traverse(function(_e){_e.morphTargetInfluences&&I.push(_e.name?_e.name:_e.uuid)}):I.push(z);let R;switch(un[Ee.path]){case un.weights:R=y.NumberKeyframeTrack;break;case un.rotation:R=y.QuaternionKeyframeTrack;break;case un.position:case un.scale:R=y.VectorKeyframeTrack;break;default:switch(Ce.itemSize){case 1:R=y.NumberKeyframeTrack;break;case 2:case 3:default:R=y.VectorKeyframeTrack;break}break}let ee=fe.interpolation!==void 0?yn[fe.interpolation]:y.InterpolateLinear,he=this._getArrayFromAccessor(Ce);for(let _e=0,De=I.length;_e<De;_e++){let Ct=new R(I[_e]+"."+un[Ee.path],oe.array,he,ee);fe.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(Ct),xe.push(Ct)}return xe}_getArrayFromAccessor(ae){let oe=ae.array;if(ae.normalized){let Ce=Jn(oe.constructor),fe=new Float32Array(oe.length);for(let Ee=0,xe=oe.length;Ee<xe;Ee++)fe[Ee]=oe[Ee]*Ce;oe=fe}return oe}_createCubicSplineTrackInterpolant(ae){ae.createInterpolant=function(Ce){let fe=this instanceof y.QuaternionKeyframeTrack?je:Re;return new fe(this.times,this.values,this.getValueSize()/3,Ce)},ae.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Ji(vt,ae,oe){let Ce=ae.attributes,fe=new y.Box3;if(Ce.POSITION!==void 0){let z=oe.json.accessors[Ce.POSITION],I=z.min,R=z.max;if(I!==void 0&&R!==void 0){if(fe.set(new y.Vector3(I[0],I[1],I[2]),new y.Vector3(R[0],R[1],R[2])),z.normalized){let ee=Jn(mt[z.componentType]);fe.min.multiplyScalar(ee),fe.max.multiplyScalar(ee)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;let Ee=ae.targets;if(Ee!==void 0){let z=new y.Vector3,I=new y.Vector3;for(let R=0,ee=Ee.length;R<ee;R++){let he=Ee[R];if(he.POSITION!==void 0){let _e=oe.json.accessors[he.POSITION],De=_e.min,Ct=_e.max;if(De!==void 0&&Ct!==void 0){if(I.setX(Math.max(Math.abs(De[0]),Math.abs(Ct[0]))),I.setY(Math.max(Math.abs(De[1]),Math.abs(Ct[1]))),I.setZ(Math.max(Math.abs(De[2]),Math.abs(Ct[2]))),_e.normalized){let Bt=Jn(mt[_e.componentType]);I.multiplyScalar(Bt)}z.max(I)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}fe.expandByVector(z)}vt.boundingBox=fe;let xe=new y.Sphere;fe.getCenter(xe.center),xe.radius=fe.min.distanceTo(fe.max)/2,vt.boundingSphere=xe}function Ei(vt,ae,oe){let Ce=ae.attributes,fe=[];function Ee(xe,z){return oe.getDependency("accessor",xe).then(function(I){vt.setAttribute(z,I)})}for(let xe in Ce){let z=kt[xe]||xe.toLowerCase();z in vt.attributes||fe.push(Ee(Ce[xe],z))}if(ae.indices!==void 0&&!vt.index){let xe=oe.getDependency("accessor",ae.indices).then(function(z){vt.setIndex(z)});fe.push(xe)}return y.ColorManagement.workingColorSpace!==y.LinearSRGBColorSpace&&"COLOR_0"in Ce&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${y.ColorManagement.workingColorSpace}" not supported.`),En(vt,ae),Ji(vt,ae,oe),Promise.all(fe).then(function(){return ae.targets!==void 0?fi(vt,ae.targets,oe):vt})}},"./node_modules/three/examples/jsm/loaders/KTX2Loader.js":(k,K,f)=>{"use strict";f.r(K),f.d(K,{KTX2Loader:()=>c});var y=f("./node_modules/three/build/three.module.js"),_=f("./node_modules/three/examples/jsm/utils/WorkerPool.js"),v=f("./node_modules/three/examples/jsm/libs/ktx-parse.module.js"),C=f("./node_modules/three/examples/jsm/libs/zstddec.module.js");let l=new WeakMap,u=0,p;class c extends y.Loader{constructor(b){super(b);this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new _.WorkerPool,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER!="undefined"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(b){return this.transcoderPath=b,this}setWorkerLimit(b){return this.workerPool.setWorkerLimit(b),this}async detectSupportAsync(b){return this.workerConfig={astcSupported:await b.hasFeatureAsync("texture-compression-astc"),etc1Supported:await b.hasFeatureAsync("texture-compression-etc1"),etc2Supported:await b.hasFeatureAsync("texture-compression-etc2"),dxtSupported:await b.hasFeatureAsync("texture-compression-bc"),bptcSupported:await b.hasFeatureAsync("texture-compression-bptc"),pvrtcSupported:await b.hasFeatureAsync("texture-compression-pvrtc")},this}detectSupport(b){return b.isWebGPURenderer===!0?this.workerConfig={astcSupported:b.hasFeature("texture-compression-astc"),etc1Supported:b.hasFeature("texture-compression-etc1"),etc2Supported:b.hasFeature("texture-compression-etc2"),dxtSupported:b.hasFeature("texture-compression-bc"),bptcSupported:b.hasFeature("texture-compression-bptc"),pvrtcSupported:b.hasFeature("texture-compression-pvrtc")}:this.workerConfig={astcSupported:b.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:b.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:b.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:b.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:b.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:b.extensions.has("WEBGL_compressed_texture_pvrtc")||b.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this}init(){if(!this.transcoderPending){let b=new y.FileLoader(this.manager);b.setPath(this.transcoderPath),b.setWithCredentials(this.withCredentials);let L=b.loadAsync("basis_transcoder.js"),M=new y.FileLoader(this.manager);M.setPath(this.transcoderPath),M.setResponseType("arraybuffer"),M.setWithCredentials(this.withCredentials);let F=M.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([L,F]).then(([H,Y])=>{let W=c.BasisWorker.toString(),te=["/* constants */","let _EngineFormat = "+JSON.stringify(c.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(c.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(c.BasisFormat),"/* basis_transcoder.js */",H,"/* worker */",W.substring(W.indexOf("{")+1,W.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([te])),this.transcoderBinary=Y,this.workerPool.setWorkerCreator(()=>{let re=new Worker(this.workerSourceURL),X=this.transcoderBinary.slice(0);return re.postMessage({type:"init",config:this.workerConfig,transcoderBinary:X},[X]),re})}),u>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),u++}return this.transcoderPending}load(b,L,M,F){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");let H=new y.FileLoader(this.manager);H.setResponseType("arraybuffer"),H.setWithCredentials(this.withCredentials),H.load(b,Y=>{if(l.has(Y))return l.get(Y).promise.then(L).catch(F);this._createTexture(Y).then(W=>L?L(W):null).catch(F)},M,F)}_createTextureFrom(b,L){let{faces:M,width:F,height:H,format:Y,type:W,error:te,dfdFlags:re}=b;if(W==="error")return Promise.reject(te);let X;if(L.faceCount===6)X=new y.CompressedCubeTexture(M,Y,y.UnsignedByteType);else{let V=M[0].mipmaps;X=L.layerCount>1?new y.CompressedArrayTexture(V,F,H,L.layerCount,Y,y.UnsignedByteType):new y.CompressedTexture(V,F,H,Y,y.UnsignedByteType)}return X.minFilter=M[0].mipmaps.length===1?y.LinearFilter:y.LinearMipmapLinearFilter,X.magFilter=y.LinearFilter,X.generateMipmaps=!1,X.needsUpdate=!0,X.colorSpace=x(L),X.premultiplyAlpha=!!(re&v.KHR_DF_FLAG_ALPHA_PREMULTIPLIED),X}async _createTexture(b,L={}){let M=(0,v.read)(new Uint8Array(b));if(M.vkFormat!==v.VK_FORMAT_UNDEFINED)return m(M);let F=L,H=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:b,taskConfig:F},[b])).then(Y=>this._createTextureFrom(Y.data,M));return l.set(b,{promise:H}),H}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),u--,this}}c.BasisFormat={ETC1S:0,UASTC_4x4:1},c.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},c.EngineFormat={RGBAFormat:y.RGBAFormat,RGBA_ASTC_4x4_Format:y.RGBA_ASTC_4x4_Format,RGBA_BPTC_Format:y.RGBA_BPTC_Format,RGBA_ETC2_EAC_Format:y.RGBA_ETC2_EAC_Format,RGBA_PVRTC_4BPPV1_Format:y.RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format:y.RGBA_S3TC_DXT5_Format,RGB_ETC1_Format:y.RGB_ETC1_Format,RGB_ETC2_Format:y.RGB_ETC2_Format,RGB_PVRTC_4BPPV1_Format:y.RGB_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format:y.RGBA_S3TC_DXT1_Format},c.BasisWorker=function(){let S,b,L,M=_EngineFormat,F=_TranscoderFormat,H=_BasisFormat;self.addEventListener("message",function(ne){let pe=ne.data;switch(pe.type){case"init":S=pe.config,Y(pe.transcoderBinary);break;case"transcode":b.then(()=>{try{let{faces:be,buffers:Re,width:Ue,height:je,hasAlpha:nt,format:mt,dfdFlags:Dt}=W(pe.buffer);self.postMessage({type:"transcode",id:pe.id,faces:be,width:Ue,height:je,hasAlpha:nt,format:mt,dfdFlags:Dt},Re)}catch(be){console.error(be),self.postMessage({type:"error",id:pe.id,error:be.message})}});break}});function Y(ne){b=new Promise(pe=>{L={wasmBinary:ne,onRuntimeInitialized:pe},BASIS(L)}).then(()=>{L.initializeBasis(),L.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function W(ne){let pe=new L.KTX2File(new Uint8Array(ne));function be(){pe.close(),pe.delete()}if(!pe.isValid())throw be(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");let Re=pe.isUASTC()?H.UASTC_4x4:H.ETC1S,Ue=pe.getWidth(),je=pe.getHeight(),nt=pe.getLayers()||1,mt=pe.getLevels(),Dt=pe.getFaces(),pt=pe.getHasAlpha(),Tt=pe.getDFDFlags(),{transcoderFormat:kt,engineFormat:un}=V(Re,Ue,je,pt);if(!Ue||!je||!mt)throw be(),new Error("THREE.KTX2Loader:	Invalid texture");if(!pe.startTranscoding())throw be(),new Error("THREE.KTX2Loader: .startTranscoding failed");let yn=[],Sn=[];for(let Nn=0;Nn<Dt;Nn++){let ln=[];for(let En=0;En<mt;En++){let fi=[],si,qi;for(let Jn=0;Jn<nt;Jn++){let Fi=pe.getImageLevelInfo(En,Jn,Nn);Nn===0&&En===0&&Jn===0&&(Fi.origWidth%4!=0||Fi.origHeight%4!=0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),mt>1?(si=Fi.origWidth,qi=Fi.origHeight):(si=Fi.width,qi=Fi.height);let vi=new Uint8Array(pe.getImageTranscodedSizeInBytes(En,Jn,0,kt));if(!pe.transcodeImage(vi,En,Jn,Nn,kt,0,-1,-1))throw be(),new Error("THREE.KTX2Loader: .transcodeImage failed.");fi.push(vi)}let pi=Z(fi);ln.push({data:pi,width:si,height:qi}),Sn.push(pi.buffer)}yn.push({mipmaps:ln,width:Ue,height:je,format:un})}return be(),{faces:yn,buffers:Sn,width:Ue,height:je,hasAlpha:pt,format:un,dfdFlags:Tt}}let te=[{if:"astcSupported",basisFormat:[H.UASTC_4x4],transcoderFormat:[F.ASTC_4x4,F.ASTC_4x4],engineFormat:[M.RGBA_ASTC_4x4_Format,M.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[H.ETC1S,H.UASTC_4x4],transcoderFormat:[F.BC7_M5,F.BC7_M5],engineFormat:[M.RGBA_BPTC_Format,M.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[H.ETC1S,H.UASTC_4x4],transcoderFormat:[F.BC1,F.BC3],engineFormat:[M.RGBA_S3TC_DXT1_Format,M.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[H.ETC1S,H.UASTC_4x4],transcoderFormat:[F.ETC1,F.ETC2],engineFormat:[M.RGB_ETC2_Format,M.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[H.ETC1S,H.UASTC_4x4],transcoderFormat:[F.ETC1],engineFormat:[M.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[H.ETC1S,H.UASTC_4x4],transcoderFormat:[F.PVRTC1_4_RGB,F.PVRTC1_4_RGBA],engineFormat:[M.RGB_PVRTC_4BPPV1_Format,M.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],re=te.sort(function(ne,pe){return ne.priorityETC1S-pe.priorityETC1S}),X=te.sort(function(ne,pe){return ne.priorityUASTC-pe.priorityUASTC});function V(ne,pe,be,Re){let Ue,je,nt=ne===H.ETC1S?re:X;for(let mt=0;mt<nt.length;mt++){let Dt=nt[mt];if(!!S[Dt.if]&&!!Dt.basisFormat.includes(ne)&&!(Re&&Dt.transcoderFormat.length<2)&&!(Dt.needsPowerOfTwo&&!(O(pe)&&O(be))))return Ue=Dt.transcoderFormat[Re?1:0],je=Dt.engineFormat[Re?1:0],{transcoderFormat:Ue,engineFormat:je}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),Ue=F.RGBA32,je=M.RGBAFormat,{transcoderFormat:Ue,engineFormat:je}}function O(ne){return ne<=2?!0:(ne&ne-1)==0&&ne!==0}function Z(ne){if(ne.length===1)return ne[0];let pe=0;for(let Ue=0;Ue<ne.length;Ue++)pe+=ne[Ue].byteLength;let be=new Uint8Array(pe),Re=0;for(let Ue=0;Ue<ne.length;Ue++){let je=ne[Ue];be.set(je,Re),Re+=je.byteLength}return be}};let g=new Set([y.RGBAFormat,y.RGFormat,y.RedFormat]),A={[v.VK_FORMAT_R32G32B32A32_SFLOAT]:y.RGBAFormat,[v.VK_FORMAT_R16G16B16A16_SFLOAT]:y.RGBAFormat,[v.VK_FORMAT_R8G8B8A8_UNORM]:y.RGBAFormat,[v.VK_FORMAT_R8G8B8A8_SRGB]:y.RGBAFormat,[v.VK_FORMAT_R32G32_SFLOAT]:y.RGFormat,[v.VK_FORMAT_R16G16_SFLOAT]:y.RGFormat,[v.VK_FORMAT_R8G8_UNORM]:y.RGFormat,[v.VK_FORMAT_R8G8_SRGB]:y.RGFormat,[v.VK_FORMAT_R32_SFLOAT]:y.RedFormat,[v.VK_FORMAT_R16_SFLOAT]:y.RedFormat,[v.VK_FORMAT_R8_SRGB]:y.RedFormat,[v.VK_FORMAT_R8_UNORM]:y.RedFormat,[v.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:y.RGBA_ASTC_6x6_Format,[v.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:y.RGBA_ASTC_6x6_Format},h={[v.VK_FORMAT_R32G32B32A32_SFLOAT]:y.FloatType,[v.VK_FORMAT_R16G16B16A16_SFLOAT]:y.HalfFloatType,[v.VK_FORMAT_R8G8B8A8_UNORM]:y.UnsignedByteType,[v.VK_FORMAT_R8G8B8A8_SRGB]:y.UnsignedByteType,[v.VK_FORMAT_R32G32_SFLOAT]:y.FloatType,[v.VK_FORMAT_R16G16_SFLOAT]:y.HalfFloatType,[v.VK_FORMAT_R8G8_UNORM]:y.UnsignedByteType,[v.VK_FORMAT_R8G8_SRGB]:y.UnsignedByteType,[v.VK_FORMAT_R32_SFLOAT]:y.FloatType,[v.VK_FORMAT_R16_SFLOAT]:y.HalfFloatType,[v.VK_FORMAT_R8_SRGB]:y.UnsignedByteType,[v.VK_FORMAT_R8_UNORM]:y.UnsignedByteType,[v.VK_FORMAT_ASTC_6x6_SRGB_BLOCK]:y.UnsignedByteType,[v.VK_FORMAT_ASTC_6x6_UNORM_BLOCK]:y.UnsignedByteType};async function m(S){let{vkFormat:b}=S;if(A[b]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let L;S.supercompressionScheme===v.KHR_SUPERCOMPRESSION_ZSTD&&(p||(p=new Promise(async H=>{let Y=new C.ZSTDDecoder;await Y.init(),H(Y)})),L=await p);let M=[];for(let H=0;H<S.levels.length;H++){let Y=Math.max(1,S.pixelWidth>>H),W=Math.max(1,S.pixelHeight>>H),te=S.pixelDepth?Math.max(1,S.pixelDepth>>H):0,re=S.levels[H],X;if(S.supercompressionScheme===v.KHR_SUPERCOMPRESSION_NONE)X=re.levelData;else if(S.supercompressionScheme===v.KHR_SUPERCOMPRESSION_ZSTD)X=L.decode(re.levelData,re.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let V;h[b]===y.FloatType?V=new Float32Array(X.buffer,X.byteOffset,X.byteLength/Float32Array.BYTES_PER_ELEMENT):h[b]===y.HalfFloatType?V=new Uint16Array(X.buffer,X.byteOffset,X.byteLength/Uint16Array.BYTES_PER_ELEMENT):V=X,M.push({data:V,width:Y,height:W,depth:te})}let F;if(g.has(A[b]))F=S.pixelDepth===0?new y.DataTexture(M[0].data,S.pixelWidth,S.pixelHeight):new y.Data3DTexture(M[0].data,S.pixelWidth,S.pixelHeight,S.pixelDepth);else{if(S.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");F=new y.CompressedTexture(M,S.pixelWidth,S.pixelHeight)}return F.mipmaps=M,F.type=h[b],F.format=A[b],F.colorSpace=x(S),F.needsUpdate=!0,Promise.resolve(F)}function x(S){let b=S.dataFormatDescriptor[0];return b.colorPrimaries===v.KHR_DF_PRIMARIES_BT709?b.transferFunction===v.KHR_DF_TRANSFER_SRGB?y.SRGBColorSpace:y.LinearSRGBColorSpace:b.colorPrimaries===v.KHR_DF_PRIMARIES_DISPLAYP3?b.transferFunction===v.KHR_DF_TRANSFER_SRGB?y.DisplayP3ColorSpace:y.LinearDisplayP3ColorSpace:(b.colorPrimaries===v.KHR_DF_PRIMARIES_UNSPECIFIED||console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${b.colorPrimaries}"`),y.NoColorSpace)}},"./node_modules/three/examples/jsm/loaders/MTLLoader.js":(k,K,f)=>{"use strict";f.r(K),f.d(K,{MTLLoader:()=>_});var y=f("./node_modules/three/build/three.module.js");class _ extends y.Loader{constructor(l){super(l)}load(l,u,p,c){let g=this,A=this.path===""?y.LoaderUtils.extractUrlBase(l):this.path,h=new y.FileLoader(this.manager);h.setPath(this.path),h.setRequestHeader(this.requestHeader),h.setWithCredentials(this.withCredentials),h.load(l,function(m){try{u(g.parse(m,A))}catch(x){c?c(x):console.error(x),g.manager.itemError(l)}},p,c)}setMaterialOptions(l){return this.materialOptions=l,this}parse(l,u){let p=l.split(`
`),c={},g=/\s+/,A={};for(let m=0;m<p.length;m++){let x=p[m];if(x=x.trim(),x.length===0||x.charAt(0)==="#")continue;let S=x.indexOf(" "),b=S>=0?x.substring(0,S):x;b=b.toLowerCase();let L=S>=0?x.substring(S+1):"";if(L=L.trim(),b==="newmtl")c={name:L},A[L]=c;else if(b==="ka"||b==="kd"||b==="ks"||b==="ke"){let M=L.split(g,3);c[b]=[parseFloat(M[0]),parseFloat(M[1]),parseFloat(M[2])]}else c[b]=L}let h=new v(this.resourcePath||u,this.materialOptions);return h.setCrossOrigin(this.crossOrigin),h.setManager(this.manager),h.setMaterials(A),h}}class v{constructor(l="",u={}){this.baseUrl=l,this.options=u,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:y.FrontSide,this.wrap=this.options.wrap!==void 0?this.options.wrap:y.RepeatWrapping}setCrossOrigin(l){return this.crossOrigin=l,this}setManager(l){this.manager=l}setMaterials(l){this.materialsInfo=this.convert(l),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(l){if(!this.options)return l;let u={};for(let p in l){let c=l[p],g={};u[p]=g;for(let A in c){let h=!0,m=c[A],x=A.toLowerCase();switch(x){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(m=[m[0]/255,m[1]/255,m[2]/255]),this.options&&this.options.ignoreZeroRGBs&&m[0]===0&&m[1]===0&&m[2]===0&&(h=!1);break;default:break}h&&(g[x]=m)}}return u}preload(){for(let l in this.materialsInfo)this.create(l)}getIndex(l){return this.nameLookup[l]}getAsArray(){let l=0;for(let u in this.materialsInfo)this.materialsArray[l]=this.create(u),this.nameLookup[u]=l,l++;return this.materialsArray}create(l){return this.materials[l]===void 0&&this.createMaterial_(l),this.materials[l]}createMaterial_(l){let u=this,p=this.materialsInfo[l],c={name:l,side:this.side};function g(h,m){return typeof m!="string"||m===""?"":/^https?:\/\//i.test(m)?m:h+m}function A(h,m){if(c[h])return;let x=u.getTextureParams(m,c),S=u.loadTexture(g(u.baseUrl,x.url));S.repeat.copy(x.scale),S.offset.copy(x.offset),S.wrapS=u.wrap,S.wrapT=u.wrap,(h==="map"||h==="emissiveMap")&&(S.colorSpace=y.SRGBColorSpace),c[h]=S}for(let h in p){let m=p[h],x;if(m!=="")switch(h.toLowerCase()){case"kd":c.color=new y.Color().fromArray(m).convertSRGBToLinear();break;case"ks":c.specular=new y.Color().fromArray(m).convertSRGBToLinear();break;case"ke":c.emissive=new y.Color().fromArray(m).convertSRGBToLinear();break;case"map_kd":A("map",m);break;case"map_ks":A("specularMap",m);break;case"map_ke":A("emissiveMap",m);break;case"norm":A("normalMap",m);break;case"map_bump":case"bump":A("bumpMap",m);break;case"map_d":A("alphaMap",m),c.transparent=!0;break;case"ns":c.shininess=parseFloat(m);break;case"d":x=parseFloat(m),x<1&&(c.opacity=x,c.transparent=!0);break;case"tr":x=parseFloat(m),this.options&&this.options.invertTrProperty&&(x=1-x),x>0&&(c.opacity=1-x,c.transparent=!0);break;default:break}}return this.materials[l]=new y.MeshPhongMaterial(c),this.materials[l]}getTextureParams(l,u){let p={scale:new y.Vector2(1,1),offset:new y.Vector2(0,0)},c=l.split(/\s+/),g;return g=c.indexOf("-bm"),g>=0&&(u.bumpScale=parseFloat(c[g+1]),c.splice(g,2)),g=c.indexOf("-s"),g>=0&&(p.scale.set(parseFloat(c[g+1]),parseFloat(c[g+2])),c.splice(g,4)),g=c.indexOf("-o"),g>=0&&(p.offset.set(parseFloat(c[g+1]),parseFloat(c[g+2])),c.splice(g,4)),p.url=c.join(" ").trim(),p}loadTexture(l,u,p,c,g){let A=this.manager!==void 0?this.manager:y.DefaultLoadingManager,h=A.getHandler(l);h===null&&(h=new y.TextureLoader(A)),h.setCrossOrigin&&h.setCrossOrigin(this.crossOrigin);let m=h.load(l,p,c,g);return u!==void 0&&(m.mapping=u),m}}},"./node_modules/three/examples/jsm/loaders/OBJLoader.js":(k,K,f)=>{"use strict";f.r(K),f.d(K,{OBJLoader:()=>S});var y=f("./node_modules/three/build/three.module.js");let _=/^[og]\s*(.+)?/,v=/^mtllib /,C=/^usemtl /,l=/^usemap /,u=/\s+/,p=new y.Vector3,c=new y.Vector3,g=new y.Vector3,A=new y.Vector3,h=new y.Vector3,m=new y.Color;function x(){let b={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(L,M){if(this.object&&this.object.fromDeclaration===!1){this.object.name=L,this.object.fromDeclaration=M!==!1;return}let F=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:L||"",fromDeclaration:M!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(H,Y){let W=this._finalize(!1);W&&(W.inherited||W.groupCount<=0)&&this.materials.splice(W.index,1);let te={index:this.materials.length,name:H||"",mtllib:Array.isArray(Y)&&Y.length>0?Y[Y.length-1]:"",smooth:W!==void 0?W.smooth:this.smooth,groupStart:W!==void 0?W.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(re){let X={index:typeof re=="number"?re:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return X.clone=this.clone.bind(X),X}};return this.materials.push(te),te},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(H){let Y=this.currentMaterial();if(Y&&Y.groupEnd===-1&&(Y.groupEnd=this.geometry.vertices.length/3,Y.groupCount=Y.groupEnd-Y.groupStart,Y.inherited=!1),H&&this.materials.length>1)for(let W=this.materials.length-1;W>=0;W--)this.materials[W].groupCount<=0&&this.materials.splice(W,1);return H&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),Y}},F&&F.name&&typeof F.clone=="function"){let H=F.clone(0);H.inherited=!0,this.object.materials.push(H)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(L,M){let F=parseInt(L,10);return(F>=0?F-1:F+M/3)*3},parseNormalIndex:function(L,M){let F=parseInt(L,10);return(F>=0?F-1:F+M/3)*3},parseUVIndex:function(L,M){let F=parseInt(L,10);return(F>=0?F-1:F+M/2)*2},addVertex:function(L,M,F){let H=this.vertices,Y=this.object.geometry.vertices;Y.push(H[L+0],H[L+1],H[L+2]),Y.push(H[M+0],H[M+1],H[M+2]),Y.push(H[F+0],H[F+1],H[F+2])},addVertexPoint:function(L){let M=this.vertices;this.object.geometry.vertices.push(M[L+0],M[L+1],M[L+2])},addVertexLine:function(L){let M=this.vertices;this.object.geometry.vertices.push(M[L+0],M[L+1],M[L+2])},addNormal:function(L,M,F){let H=this.normals,Y=this.object.geometry.normals;Y.push(H[L+0],H[L+1],H[L+2]),Y.push(H[M+0],H[M+1],H[M+2]),Y.push(H[F+0],H[F+1],H[F+2])},addFaceNormal:function(L,M,F){let H=this.vertices,Y=this.object.geometry.normals;p.fromArray(H,L),c.fromArray(H,M),g.fromArray(H,F),h.subVectors(g,c),A.subVectors(p,c),h.cross(A),h.normalize(),Y.push(h.x,h.y,h.z),Y.push(h.x,h.y,h.z),Y.push(h.x,h.y,h.z)},addColor:function(L,M,F){let H=this.colors,Y=this.object.geometry.colors;H[L]!==void 0&&Y.push(H[L+0],H[L+1],H[L+2]),H[M]!==void 0&&Y.push(H[M+0],H[M+1],H[M+2]),H[F]!==void 0&&Y.push(H[F+0],H[F+1],H[F+2])},addUV:function(L,M,F){let H=this.uvs,Y=this.object.geometry.uvs;Y.push(H[L+0],H[L+1]),Y.push(H[M+0],H[M+1]),Y.push(H[F+0],H[F+1])},addDefaultUV:function(){let L=this.object.geometry.uvs;L.push(0,0),L.push(0,0),L.push(0,0)},addUVLine:function(L){let M=this.uvs;this.object.geometry.uvs.push(M[L+0],M[L+1])},addFace:function(L,M,F,H,Y,W,te,re,X){let V=this.vertices.length,O=this.parseVertexIndex(L,V),Z=this.parseVertexIndex(M,V),ne=this.parseVertexIndex(F,V);if(this.addVertex(O,Z,ne),this.addColor(O,Z,ne),te!==void 0&&te!==""){let pe=this.normals.length;O=this.parseNormalIndex(te,pe),Z=this.parseNormalIndex(re,pe),ne=this.parseNormalIndex(X,pe),this.addNormal(O,Z,ne)}else this.addFaceNormal(O,Z,ne);if(H!==void 0&&H!==""){let pe=this.uvs.length;O=this.parseUVIndex(H,pe),Z=this.parseUVIndex(Y,pe),ne=this.parseUVIndex(W,pe),this.addUV(O,Z,ne),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(L){this.object.geometry.type="Points";let M=this.vertices.length;for(let F=0,H=L.length;F<H;F++){let Y=this.parseVertexIndex(L[F],M);this.addVertexPoint(Y),this.addColor(Y)}},addLineGeometry:function(L,M){this.object.geometry.type="Line";let F=this.vertices.length,H=this.uvs.length;for(let Y=0,W=L.length;Y<W;Y++)this.addVertexLine(this.parseVertexIndex(L[Y],F));for(let Y=0,W=M.length;Y<W;Y++)this.addUVLine(this.parseUVIndex(M[Y],H))}};return b.startObject("",!1),b}class S extends y.Loader{constructor(L){super(L);this.materials=null}load(L,M,F,H){let Y=this,W=new y.FileLoader(this.manager);W.setPath(this.path),W.setRequestHeader(this.requestHeader),W.setWithCredentials(this.withCredentials),W.load(L,function(te){try{M(Y.parse(te))}catch(re){H?H(re):console.error(re),Y.manager.itemError(L)}},F,H)}setMaterials(L){return this.materials=L,this}parse(L){let M=new x;L.indexOf(`\r
`)!==-1&&(L=L.replace(/\r\n/g,`
`)),L.indexOf(`\\
`)!==-1&&(L=L.replace(/\\\n/g,""));let F=L.split(`
`),H=[];for(let te=0,re=F.length;te<re;te++){let X=F[te].trimStart();if(X.length===0)continue;let V=X.charAt(0);if(V!=="#")if(V==="v"){let O=X.split(u);switch(O[0]){case"v":M.vertices.push(parseFloat(O[1]),parseFloat(O[2]),parseFloat(O[3])),O.length>=7?(m.setRGB(parseFloat(O[4]),parseFloat(O[5]),parseFloat(O[6])).convertSRGBToLinear(),M.colors.push(m.r,m.g,m.b)):M.colors.push(void 0,void 0,void 0);break;case"vn":M.normals.push(parseFloat(O[1]),parseFloat(O[2]),parseFloat(O[3]));break;case"vt":M.uvs.push(parseFloat(O[1]),parseFloat(O[2]));break}}else if(V==="f"){let Z=X.slice(1).trim().split(u),ne=[];for(let be=0,Re=Z.length;be<Re;be++){let Ue=Z[be];if(Ue.length>0){let je=Ue.split("/");ne.push(je)}}let pe=ne[0];for(let be=1,Re=ne.length-1;be<Re;be++){let Ue=ne[be],je=ne[be+1];M.addFace(pe[0],Ue[0],je[0],pe[1],Ue[1],je[1],pe[2],Ue[2],je[2])}}else if(V==="l"){let O=X.substring(1).trim().split(" "),Z=[],ne=[];if(X.indexOf("/")===-1)Z=O;else for(let pe=0,be=O.length;pe<be;pe++){let Re=O[pe].split("/");Re[0]!==""&&Z.push(Re[0]),Re[1]!==""&&ne.push(Re[1])}M.addLineGeometry(Z,ne)}else if(V==="p"){let Z=X.slice(1).trim().split(" ");M.addPointGeometry(Z)}else if((H=_.exec(X))!==null){let O=(" "+H[0].slice(1).trim()).slice(1);M.startObject(O)}else if(C.test(X))M.object.startMaterial(X.substring(7).trim(),M.materialLibraries);else if(v.test(X))M.materialLibraries.push(X.substring(7).trim());else if(l.test(X))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(V==="s"){if(H=X.split(" "),H.length>1){let Z=H[1].trim().toLowerCase();M.object.smooth=Z!=="0"&&Z!=="off"}else M.object.smooth=!0;let O=M.object.currentMaterial();O&&(O.smooth=M.object.smooth)}else{if(X==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+X+'"')}}M.finalize();let Y=new y.Group;if(Y.materialLibraries=[].concat(M.materialLibraries),!(M.objects.length===1&&M.objects[0].geometry.vertices.length===0)===!0)for(let te=0,re=M.objects.length;te<re;te++){let X=M.objects[te],V=X.geometry,O=X.materials,Z=V.type==="Line",ne=V.type==="Points",pe=!1;if(V.vertices.length===0)continue;let be=new y.BufferGeometry;be.setAttribute("position",new y.Float32BufferAttribute(V.vertices,3)),V.normals.length>0&&be.setAttribute("normal",new y.Float32BufferAttribute(V.normals,3)),V.colors.length>0&&(pe=!0,be.setAttribute("color",new y.Float32BufferAttribute(V.colors,3))),V.hasUVIndices===!0&&be.setAttribute("uv",new y.Float32BufferAttribute(V.uvs,2));let Re=[];for(let je=0,nt=O.length;je<nt;je++){let mt=O[je],Dt=mt.name+"_"+mt.smooth+"_"+pe,pt=M.materials[Dt];if(this.materials!==null){if(pt=this.materials.create(mt.name),Z&&pt&&!(pt instanceof y.LineBasicMaterial)){let Tt=new y.LineBasicMaterial;y.Material.prototype.copy.call(Tt,pt),Tt.color.copy(pt.color),pt=Tt}else if(ne&&pt&&!(pt instanceof y.PointsMaterial)){let Tt=new y.PointsMaterial({size:10,sizeAttenuation:!1});y.Material.prototype.copy.call(Tt,pt),Tt.color.copy(pt.color),Tt.map=pt.map,pt=Tt}}pt===void 0&&(Z?pt=new y.LineBasicMaterial:ne?pt=new y.PointsMaterial({size:1,sizeAttenuation:!1}):pt=new y.MeshPhongMaterial,pt.name=mt.name,pt.flatShading=!mt.smooth,pt.vertexColors=pe,M.materials[Dt]=pt),Re.push(pt)}let Ue;if(Re.length>1){for(let je=0,nt=O.length;je<nt;je++){let mt=O[je];be.addGroup(mt.groupStart,mt.groupCount,je)}Z?Ue=new y.LineSegments(be,Re):ne?Ue=new y.Points(be,Re):Ue=new y.Mesh(be,Re)}else Z?Ue=new y.LineSegments(be,Re[0]):ne?Ue=new y.Points(be,Re[0]):Ue=new y.Mesh(be,Re[0]);Ue.name=X.name,Y.add(Ue)}else if(M.vertices.length>0){let te=new y.PointsMaterial({size:1,sizeAttenuation:!1}),re=new y.BufferGeometry;re.setAttribute("position",new y.Float32BufferAttribute(M.vertices,3)),M.colors.length>0&&M.colors[0]!==void 0&&(re.setAttribute("color",new y.Float32BufferAttribute(M.colors,3)),te.vertexColors=!0);let X=new y.Points(re,te);Y.add(X)}return Y}}},"./node_modules/three/examples/jsm/math/OBB.js":(k,K,f)=>{"use strict";f.r(K),f.d(K,{OBB:()=>F});var y=f("./node_modules/three/build/three.module.js");let _={c:null,u:[new y.Vector3,new y.Vector3,new y.Vector3],e:[]},v={c:null,u:[new y.Vector3,new y.Vector3,new y.Vector3],e:[]},C=[[],[],[]],l=[[],[],[]],u=[],p=new y.Vector3,c=new y.Vector3,g=new y.Vector3,A=new y.Vector3,h=new y.Vector3,m=new y.Vector3,x=new y.Matrix3,S=new y.Box3,b=new y.Matrix4,L=new y.Matrix4,M=new y.Ray;class F{constructor(W=new y.Vector3,te=new y.Vector3,re=new y.Matrix3){this.center=W,this.halfSize=te,this.rotation=re}set(W,te,re){return this.center=W,this.halfSize=te,this.rotation=re,this}copy(W){return this.center.copy(W.center),this.halfSize.copy(W.halfSize),this.rotation.copy(W.rotation),this}clone(){return new this.constructor().copy(this)}getSize(W){return W.copy(this.halfSize).multiplyScalar(2)}clampPoint(W,te){let re=this.halfSize;A.subVectors(W,this.center),this.rotation.extractBasis(p,c,g),te.copy(this.center);let X=y.MathUtils.clamp(A.dot(p),-re.x,re.x);te.add(p.multiplyScalar(X));let V=y.MathUtils.clamp(A.dot(c),-re.y,re.y);te.add(c.multiplyScalar(V));let O=y.MathUtils.clamp(A.dot(g),-re.z,re.z);return te.add(g.multiplyScalar(O)),te}containsPoint(W){return A.subVectors(W,this.center),this.rotation.extractBasis(p,c,g),Math.abs(A.dot(p))<=this.halfSize.x&&Math.abs(A.dot(c))<=this.halfSize.y&&Math.abs(A.dot(g))<=this.halfSize.z}intersectsBox3(W){return this.intersectsOBB(H.fromBox3(W))}intersectsSphere(W){return this.clampPoint(W.center,m),m.distanceToSquared(W.center)<=W.radius*W.radius}intersectsOBB(W,te=Number.EPSILON){_.c=this.center,_.e[0]=this.halfSize.x,_.e[1]=this.halfSize.y,_.e[2]=this.halfSize.z,this.rotation.extractBasis(_.u[0],_.u[1],_.u[2]),v.c=W.center,v.e[0]=W.halfSize.x,v.e[1]=W.halfSize.y,v.e[2]=W.halfSize.z,W.rotation.extractBasis(v.u[0],v.u[1],v.u[2]);for(let V=0;V<3;V++)for(let O=0;O<3;O++)C[V][O]=_.u[V].dot(v.u[O]);A.subVectors(v.c,_.c),u[0]=A.dot(_.u[0]),u[1]=A.dot(_.u[1]),u[2]=A.dot(_.u[2]);for(let V=0;V<3;V++)for(let O=0;O<3;O++)l[V][O]=Math.abs(C[V][O])+te;let re,X;for(let V=0;V<3;V++)if(re=_.e[V],X=v.e[0]*l[V][0]+v.e[1]*l[V][1]+v.e[2]*l[V][2],Math.abs(u[V])>re+X)return!1;for(let V=0;V<3;V++)if(re=_.e[0]*l[0][V]+_.e[1]*l[1][V]+_.e[2]*l[2][V],X=v.e[V],Math.abs(u[0]*C[0][V]+u[1]*C[1][V]+u[2]*C[2][V])>re+X)return!1;return re=_.e[1]*l[2][0]+_.e[2]*l[1][0],X=v.e[1]*l[0][2]+v.e[2]*l[0][1],!(Math.abs(u[2]*C[1][0]-u[1]*C[2][0])>re+X||(re=_.e[1]*l[2][1]+_.e[2]*l[1][1],X=v.e[0]*l[0][2]+v.e[2]*l[0][0],Math.abs(u[2]*C[1][1]-u[1]*C[2][1])>re+X)||(re=_.e[1]*l[2][2]+_.e[2]*l[1][2],X=v.e[0]*l[0][1]+v.e[1]*l[0][0],Math.abs(u[2]*C[1][2]-u[1]*C[2][2])>re+X)||(re=_.e[0]*l[2][0]+_.e[2]*l[0][0],X=v.e[1]*l[1][2]+v.e[2]*l[1][1],Math.abs(u[0]*C[2][0]-u[2]*C[0][0])>re+X)||(re=_.e[0]*l[2][1]+_.e[2]*l[0][1],X=v.e[0]*l[1][2]+v.e[2]*l[1][0],Math.abs(u[0]*C[2][1]-u[2]*C[0][1])>re+X)||(re=_.e[0]*l[2][2]+_.e[2]*l[0][2],X=v.e[0]*l[1][1]+v.e[1]*l[1][0],Math.abs(u[0]*C[2][2]-u[2]*C[0][2])>re+X)||(re=_.e[0]*l[1][0]+_.e[1]*l[0][0],X=v.e[1]*l[2][2]+v.e[2]*l[2][1],Math.abs(u[1]*C[0][0]-u[0]*C[1][0])>re+X)||(re=_.e[0]*l[1][1]+_.e[1]*l[0][1],X=v.e[0]*l[2][2]+v.e[2]*l[2][0],Math.abs(u[1]*C[0][1]-u[0]*C[1][1])>re+X)||(re=_.e[0]*l[1][2]+_.e[1]*l[0][2],X=v.e[0]*l[2][1]+v.e[1]*l[2][0],Math.abs(u[1]*C[0][2]-u[0]*C[1][2])>re+X))}intersectsPlane(W){this.rotation.extractBasis(p,c,g);let te=this.halfSize.x*Math.abs(W.normal.dot(p))+this.halfSize.y*Math.abs(W.normal.dot(c))+this.halfSize.z*Math.abs(W.normal.dot(g)),re=W.normal.dot(this.center)-W.constant;return Math.abs(re)<=te}intersectRay(W,te){return this.getSize(h),S.setFromCenterAndSize(A.set(0,0,0),h),b.setFromMatrix3(this.rotation),b.setPosition(this.center),L.copy(b).invert(),M.copy(W).applyMatrix4(L),M.intersectBox(S,te)?te.applyMatrix4(b):null}intersectsRay(W){return this.intersectRay(W,A)!==null}fromBox3(W){return W.getCenter(this.center),W.getSize(this.halfSize).multiplyScalar(.5),this.rotation.identity(),this}equals(W){return W.center.equals(this.center)&&W.halfSize.equals(this.halfSize)&&W.rotation.equals(this.rotation)}applyMatrix4(W){let te=W.elements,re=A.set(te[0],te[1],te[2]).length(),X=A.set(te[4],te[5],te[6]).length(),V=A.set(te[8],te[9],te[10]).length();W.determinant()<0&&(re=-re),x.setFromMatrix4(W);let Z=1/re,ne=1/X,pe=1/V;return x.elements[0]*=Z,x.elements[1]*=Z,x.elements[2]*=Z,x.elements[3]*=ne,x.elements[4]*=ne,x.elements[5]*=ne,x.elements[6]*=pe,x.elements[7]*=pe,x.elements[8]*=pe,this.rotation.multiply(x),this.halfSize.x*=re,this.halfSize.y*=X,this.halfSize.z*=V,A.setFromMatrixPosition(W),this.center.add(A),this}}let H=new F},"./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js":(k,K,f)=>{"use strict";f.r(K),f.d(K,{computeMikkTSpaceTangents:()=>_,computeMorphedAttributes:()=>m,deepCloneAttribute:()=>l,deinterleaveAttribute:()=>p,deinterleaveGeometry:()=>c,estimateBytesUsed:()=>g,interleaveAttributes:()=>u,mergeAttributes:()=>C,mergeGeometries:()=>v,mergeGroups:()=>x,mergeVertices:()=>A,toCreasedNormals:()=>S,toTrianglesDrawMode:()=>h});var y=f("./node_modules/three/build/three.module.js");function _(b,L,M=!0){if(!L||!L.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!b.hasAttribute("position")||!b.hasAttribute("normal")||!b.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function F(W){if(W.normalized||W.isInterleavedBufferAttribute){let te=new Float32Array(W.count*W.itemSize);for(let re=0,X=0;re<W.count;re++)te[X++]=W.getX(re),te[X++]=W.getY(re),W.itemSize>2&&(te[X++]=W.getZ(re));return te}return W.array instanceof Float32Array?W.array:new Float32Array(W.array)}let H=b.index?b.toNonIndexed():b,Y=L.generateTangents(F(H.attributes.position),F(H.attributes.normal),F(H.attributes.uv));if(M)for(let W=3;W<Y.length;W+=4)Y[W]*=-1;return H.setAttribute("tangent",new y.BufferAttribute(Y,4)),b!==H&&b.copy(H),b}function v(b,L=!1){let M=b[0].index!==null,F=new Set(Object.keys(b[0].attributes)),H=new Set(Object.keys(b[0].morphAttributes)),Y={},W={},te=b[0].morphTargetsRelative,re=new y.BufferGeometry,X=0;for(let V=0;V<b.length;++V){let O=b[V],Z=0;if(M!==(O.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+V+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let ne in O.attributes){if(!F.has(ne))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+V+'. All geometries must have compatible attributes; make sure "'+ne+'" attribute exists among all geometries, or in none of them.'),null;Y[ne]===void 0&&(Y[ne]=[]),Y[ne].push(O.attributes[ne]),Z++}if(Z!==F.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+V+". Make sure all geometries have the same number of attributes."),null;if(te!==O.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+V+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let ne in O.morphAttributes){if(!H.has(ne))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+V+".  .morphAttributes must be consistent throughout all geometries."),null;W[ne]===void 0&&(W[ne]=[]),W[ne].push(O.morphAttributes[ne])}if(L){let ne;if(M)ne=O.index.count;else if(O.attributes.position!==void 0)ne=O.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+V+". The geometry must have either an index or a position attribute"),null;re.addGroup(X,ne,V),X+=ne}}if(M){let V=0,O=[];for(let Z=0;Z<b.length;++Z){let ne=b[Z].index;for(let pe=0;pe<ne.count;++pe)O.push(ne.getX(pe)+V);V+=b[Z].attributes.position.count}re.setIndex(O)}for(let V in Y){let O=C(Y[V]);if(!O)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+V+" attribute."),null;re.setAttribute(V,O)}for(let V in W){let O=W[V][0].length;if(O===0)break;re.morphAttributes=re.morphAttributes||{},re.morphAttributes[V]=[];for(let Z=0;Z<O;++Z){let ne=[];for(let be=0;be<W[V].length;++be)ne.push(W[V][be][Z]);let pe=C(ne);if(!pe)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+V+" morphAttribute."),null;re.morphAttributes[V].push(pe)}}return re}function C(b){let L,M,F,H=-1,Y=0;for(let X=0;X<b.length;++X){let V=b[X];if(L===void 0&&(L=V.array.constructor),L!==V.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(M===void 0&&(M=V.itemSize),M!==V.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(F===void 0&&(F=V.normalized),F!==V.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(H===-1&&(H=V.gpuType),H!==V.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;Y+=V.count*M}let W=new L(Y),te=new y.BufferAttribute(W,M,F),re=0;for(let X=0;X<b.length;++X){let V=b[X];if(V.isInterleavedBufferAttribute){let O=re/M;for(let Z=0,ne=V.count;Z<ne;Z++)for(let pe=0;pe<M;pe++){let be=V.getComponent(Z,pe);te.setComponent(Z+O,pe,be)}}else W.set(V.array,re);re+=V.count*M}return H!==void 0&&(te.gpuType=H),te}function l(b){return b.isInstancedInterleavedBufferAttribute||b.isInterleavedBufferAttribute?p(b):b.isInstancedBufferAttribute?new y.InstancedBufferAttribute().copy(b):new y.BufferAttribute().copy(b)}function u(b){let L,M=0,F=0;for(let X=0,V=b.length;X<V;++X){let O=b[X];if(L===void 0&&(L=O.array.constructor),L!==O.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;M+=O.array.length,F+=O.itemSize}let H=new y.InterleavedBuffer(new L(M),F),Y=0,W=[],te=["getX","getY","getZ","getW"],re=["setX","setY","setZ","setW"];for(let X=0,V=b.length;X<V;X++){let O=b[X],Z=O.itemSize,ne=O.count,pe=new y.InterleavedBufferAttribute(H,Z,Y,O.normalized);W.push(pe),Y+=Z;for(let be=0;be<ne;be++)for(let Re=0;Re<Z;Re++)pe[re[Re]](be,O[te[Re]](be))}return W}function p(b){let L=b.data.array.constructor,M=b.count,F=b.itemSize,H=b.normalized,Y=new L(M*F),W;b.isInstancedInterleavedBufferAttribute?W=new y.InstancedBufferAttribute(Y,F,H,b.meshPerAttribute):W=new y.BufferAttribute(Y,F,H);for(let te=0;te<M;te++)W.setX(te,b.getX(te)),F>=2&&W.setY(te,b.getY(te)),F>=3&&W.setZ(te,b.getZ(te)),F>=4&&W.setW(te,b.getW(te));return W}function c(b){let L=b.attributes,M=b.morphTargets,F=new Map;for(let H in L){let Y=L[H];Y.isInterleavedBufferAttribute&&(F.has(Y)||F.set(Y,p(Y)),L[H]=F.get(Y))}for(let H in M){let Y=M[H];Y.isInterleavedBufferAttribute&&(F.has(Y)||F.set(Y,p(Y)),M[H]=F.get(Y))}}function g(b){let L=0;for(let F in b.attributes){let H=b.getAttribute(F);L+=H.count*H.itemSize*H.array.BYTES_PER_ELEMENT}let M=b.getIndex();return L+=M?M.count*M.itemSize*M.array.BYTES_PER_ELEMENT:0,L}function A(b,L=1e-4){L=Math.max(L,Number.EPSILON);let M={},F=b.getIndex(),H=b.getAttribute("position"),Y=F?F.count:H.count,W=0,te=Object.keys(b.attributes),re={},X={},V=[],O=["getX","getY","getZ","getW"],Z=["setX","setY","setZ","setW"];for(let je=0,nt=te.length;je<nt;je++){let mt=te[je],Dt=b.attributes[mt];re[mt]=new y.BufferAttribute(new Dt.array.constructor(Dt.count*Dt.itemSize),Dt.itemSize,Dt.normalized);let pt=b.morphAttributes[mt];pt&&(X[mt]=new y.BufferAttribute(new pt.array.constructor(pt.count*pt.itemSize),pt.itemSize,pt.normalized))}let ne=L*.5,pe=Math.log10(1/L),be=Math.pow(10,pe),Re=ne*be;for(let je=0;je<Y;je++){let nt=F?F.getX(je):je,mt="";for(let Dt=0,pt=te.length;Dt<pt;Dt++){let Tt=te[Dt],kt=b.getAttribute(Tt),un=kt.itemSize;for(let yn=0;yn<un;yn++)mt+=`${~~(kt[O[yn]](nt)*be+Re)},`}if(mt in M)V.push(M[mt]);else{for(let Dt=0,pt=te.length;Dt<pt;Dt++){let Tt=te[Dt],kt=b.getAttribute(Tt),un=b.morphAttributes[Tt],yn=kt.itemSize,Sn=re[Tt],Nn=X[Tt];for(let ln=0;ln<yn;ln++){let En=O[ln],fi=Z[ln];if(Sn[fi](W,kt[En](nt)),un)for(let si=0,qi=un.length;si<qi;si++)Nn[si][fi](W,un[si][En](nt))}}M[mt]=W,V.push(W),W++}}let Ue=b.clone();for(let je in b.attributes){let nt=re[je];if(Ue.setAttribute(je,new y.BufferAttribute(nt.array.slice(0,W*nt.itemSize),nt.itemSize,nt.normalized)),je in X)for(let mt=0;mt<X[je].length;mt++){let Dt=X[je][mt];Ue.morphAttributes[je][mt]=new y.BufferAttribute(Dt.array.slice(0,W*Dt.itemSize),Dt.itemSize,Dt.normalized)}}return Ue.setIndex(V),Ue}function h(b,L){if(L===y.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),b;if(L===y.TriangleFanDrawMode||L===y.TriangleStripDrawMode){let M=b.getIndex();if(M===null){let W=[],te=b.getAttribute("position");if(te!==void 0){for(let re=0;re<te.count;re++)W.push(re);b.setIndex(W),M=b.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),b}let F=M.count-2,H=[];if(L===y.TriangleFanDrawMode)for(let W=1;W<=F;W++)H.push(M.getX(0)),H.push(M.getX(W)),H.push(M.getX(W+1));else for(let W=0;W<F;W++)W%2==0?(H.push(M.getX(W)),H.push(M.getX(W+1)),H.push(M.getX(W+2))):(H.push(M.getX(W+2)),H.push(M.getX(W+1)),H.push(M.getX(W)));H.length/3!==F&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let Y=b.clone();return Y.setIndex(H),Y.clearGroups(),Y}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",L),b}function m(b){let L=new y.Vector3,M=new y.Vector3,F=new y.Vector3,H=new y.Vector3,Y=new y.Vector3,W=new y.Vector3,te=new y.Vector3,re=new y.Vector3,X=new y.Vector3;function V(Jn,Fi,vi,mr,Ji,Ei,vt,ae){L.fromBufferAttribute(Fi,Ji),M.fromBufferAttribute(Fi,Ei),F.fromBufferAttribute(Fi,vt);let oe=Jn.morphTargetInfluences;if(vi&&oe){te.set(0,0,0),re.set(0,0,0),X.set(0,0,0);for(let Ce=0,fe=vi.length;Ce<fe;Ce++){let Ee=oe[Ce],xe=vi[Ce];Ee!==0&&(H.fromBufferAttribute(xe,Ji),Y.fromBufferAttribute(xe,Ei),W.fromBufferAttribute(xe,vt),mr?(te.addScaledVector(H,Ee),re.addScaledVector(Y,Ee),X.addScaledVector(W,Ee)):(te.addScaledVector(H.sub(L),Ee),re.addScaledVector(Y.sub(M),Ee),X.addScaledVector(W.sub(F),Ee)))}L.add(te),M.add(re),F.add(X)}Jn.isSkinnedMesh&&(Jn.applyBoneTransform(Ji,L),Jn.applyBoneTransform(Ei,M),Jn.applyBoneTransform(vt,F)),ae[Ji*3+0]=L.x,ae[Ji*3+1]=L.y,ae[Ji*3+2]=L.z,ae[Ei*3+0]=M.x,ae[Ei*3+1]=M.y,ae[Ei*3+2]=M.z,ae[vt*3+0]=F.x,ae[vt*3+1]=F.y,ae[vt*3+2]=F.z}let O=b.geometry,Z=b.material,ne,pe,be,Re=O.index,Ue=O.attributes.position,je=O.morphAttributes.position,nt=O.morphTargetsRelative,mt=O.attributes.normal,Dt=O.morphAttributes.position,pt=O.groups,Tt=O.drawRange,kt,un,yn,Sn,Nn,ln,En,fi=new Float32Array(Ue.count*Ue.itemSize),si=new Float32Array(mt.count*mt.itemSize);if(Re!==null)if(Array.isArray(Z))for(kt=0,yn=pt.length;kt<yn;kt++)for(Nn=pt[kt],ln=Math.max(Nn.start,Tt.start),En=Math.min(Nn.start+Nn.count,Tt.start+Tt.count),un=ln,Sn=En;un<Sn;un+=3)ne=Re.getX(un),pe=Re.getX(un+1),be=Re.getX(un+2),V(b,Ue,je,nt,ne,pe,be,fi),V(b,mt,Dt,nt,ne,pe,be,si);else for(ln=Math.max(0,Tt.start),En=Math.min(Re.count,Tt.start+Tt.count),kt=ln,yn=En;kt<yn;kt+=3)ne=Re.getX(kt),pe=Re.getX(kt+1),be=Re.getX(kt+2),V(b,Ue,je,nt,ne,pe,be,fi),V(b,mt,Dt,nt,ne,pe,be,si);else if(Array.isArray(Z))for(kt=0,yn=pt.length;kt<yn;kt++)for(Nn=pt[kt],ln=Math.max(Nn.start,Tt.start),En=Math.min(Nn.start+Nn.count,Tt.start+Tt.count),un=ln,Sn=En;un<Sn;un+=3)ne=un,pe=un+1,be=un+2,V(b,Ue,je,nt,ne,pe,be,fi),V(b,mt,Dt,nt,ne,pe,be,si);else for(ln=Math.max(0,Tt.start),En=Math.min(Ue.count,Tt.start+Tt.count),kt=ln,yn=En;kt<yn;kt+=3)ne=kt,pe=kt+1,be=kt+2,V(b,Ue,je,nt,ne,pe,be,fi),V(b,mt,Dt,nt,ne,pe,be,si);let qi=new y.Float32BufferAttribute(fi,3),pi=new y.Float32BufferAttribute(si,3);return{positionAttribute:Ue,normalAttribute:mt,morphedPositionAttribute:qi,morphedNormalAttribute:pi}}function x(b){if(b.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),b;let L=b.groups;if(L=L.sort((W,te)=>W.materialIndex!==te.materialIndex?W.materialIndex-te.materialIndex:W.start-te.start),b.getIndex()===null){let W=b.getAttribute("position"),te=[];for(let re=0;re<W.count;re+=3)te.push(re,re+1,re+2);b.setIndex(te)}let M=b.getIndex(),F=[];for(let W=0;W<L.length;W++){let te=L[W],re=te.start,X=re+te.count;for(let V=re;V<X;V++)F.push(M.getX(V))}b.dispose(),b.setIndex(F);let H=0;for(let W=0;W<L.length;W++){let te=L[W];te.start=H,H+=te.count}let Y=L[0];b.groups=[Y];for(let W=1;W<L.length;W++){let te=L[W];Y.materialIndex===te.materialIndex?Y.count+=te.count:(Y=te,b.groups.push(Y))}return b}function S(b,L=Math.PI/3){let M=Math.cos(L),F=(1+1e-10)*100,H=[new y.Vector3,new y.Vector3,new y.Vector3],Y=new y.Vector3,W=new y.Vector3,te=new y.Vector3,re=new y.Vector3;function X(be){let Re=~~(be.x*F),Ue=~~(be.y*F),je=~~(be.z*F);return`${Re},${Ue},${je}`}let V=b.index?b.toNonIndexed():b,O=V.attributes.position,Z={};for(let be=0,Re=O.count/3;be<Re;be++){let Ue=3*be,je=H[0].fromBufferAttribute(O,Ue+0),nt=H[1].fromBufferAttribute(O,Ue+1),mt=H[2].fromBufferAttribute(O,Ue+2);Y.subVectors(mt,nt),W.subVectors(je,nt);let Dt=new y.Vector3().crossVectors(Y,W).normalize();for(let pt=0;pt<3;pt++){let Tt=H[pt],kt=X(Tt);kt in Z||(Z[kt]=[]),Z[kt].push(Dt)}}let ne=new Float32Array(O.count*3),pe=new y.BufferAttribute(ne,3,!1);for(let be=0,Re=O.count/3;be<Re;be++){let Ue=3*be,je=H[0].fromBufferAttribute(O,Ue+0),nt=H[1].fromBufferAttribute(O,Ue+1),mt=H[2].fromBufferAttribute(O,Ue+2);Y.subVectors(mt,nt),W.subVectors(je,nt),te.crossVectors(Y,W).normalize();for(let Dt=0;Dt<3;Dt++){let pt=H[Dt],Tt=X(pt),kt=Z[Tt];re.set(0,0,0);for(let un=0,yn=kt.length;un<yn;un++){let Sn=kt[un];te.dot(Sn)>M&&re.add(Sn)}re.normalize(),pe.setXYZ(Ue+Dt,re.x,re.y,re.z)}}return V.setAttribute("normal",pe),V}},"./node_modules/three/examples/jsm/utils/WorkerPool.js":(k,K,f)=>{"use strict";f.r(K),f.d(K,{WorkerPool:()=>y});class y{constructor(v=4){this.pool=v,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(v){if(!this.workers[v]){let C=this.workerCreator();C.addEventListener("message",this._onMessage.bind(this,v)),this.workers[v]=C}}_getIdleWorker(){for(let v=0;v<this.pool;v++)if(!(this.workerStatus&1<<v))return v;return-1}_onMessage(v,C){let l=this.workersResolve[v];if(l&&l(C),this.queue.length){let{resolve:u,msg:p,transfer:c}=this.queue.shift();this.workersResolve[v]=u,this.workers[v].postMessage(p,c)}else this.workerStatus^=1<<v}setWorkerCreator(v){this.workerCreator=v}setWorkerLimit(v){this.pool=v}postMessage(v,C){return new Promise(l=>{let u=this._getIdleWorker();u!==-1?(this._initWorker(u),this.workerStatus|=1<<u,this.workersResolve[u]=l,this.workers[u].postMessage(v,C)):this.queue.push({resolve:l,msg:v,transfer:C})})}dispose(){this.workers.forEach(v=>v.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}},"./src/lib/three.mjs":(k,K,f)=>{"use strict";f.r(K),f.d(K,{default:()=>h});var y=f("./node_modules/three/build/three.module.js"),_=f("./node_modules/three/examples/jsm/loaders/DRACOLoader.js"),v=f("./node_modules/three/examples/jsm/loaders/GLTFLoader.js"),C=f("./node_modules/three/examples/jsm/loaders/KTX2Loader.js"),l=f("./node_modules/three/examples/jsm/math/OBB.js"),u=f("./node_modules/three/examples/jsm/loaders/OBJLoader.js"),p=f("./node_modules/three/examples/jsm/loaders/MTLLoader.js"),c=f("./node_modules/three/examples/jsm/utils/BufferGeometryUtils.js"),g=f("./node_modules/three/examples/jsm/lights/LightProbeGenerator.js"),A={...y};A.DRACOLoader=_.DRACOLoader,A.GLTFLoader=v.GLTFLoader,A.KTX2Loader=C.KTX2Loader,A.OBJLoader=u.OBJLoader,A.MTLLoader=p.MTLLoader,A.OBB=l.OBB,A.BufferGeometryUtils=c,A.LightProbeGenerator=g.LightProbeGenerator;let h=A},"./package.json":k=>{"use strict";k.exports=JSON.parse('{"name":"aframe","version":"1.6.0","description":"A web framework for building virtual reality experiences.","homepage":"https://aframe.io/","main":"dist/aframe-master.js","scripts":{"dev":"cross-env INSPECTOR_VERSION=dev webpack serve --port 8080","dist":"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"webpack --config webpack.config.js","dist:min":"webpack --config webpack.prod.config.js","docs":"markserv --dir docs --port 9001","preghpages":"node ./scripts/preghpages.js","ghpages":"ghpages -p gh-pages/","lint":"standardx -v | snazzy","lint:fix":"standardx --fix","precommit":"npm run lint","prepush":"node scripts/testOnlyCheck.js","prerelease":"node scripts/release.js 1.5.0 1.6.0","start":"npm run dev","start:https":"npm run dev -- --server-type https","test":"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"node --experimental-require-module ./node_modules/mocha/bin/mocha --ui tdd tests/node"},"repository":"aframevr/aframe","license":"MIT","files":["dist/*","docs/**/*","src/**/*","vendor/**/*"],"dependencies":{"buffer":"^6.0.3","debug":"^4.3.4","deep-assign":"^2.0.0","load-bmfont":"^1.2.3","super-animejs":"^3.1.0","three":"npm:super-three@0.164.0","three-bmfont-text":"dmarcos/three-bmfont-text#eed4878795be9b3e38cf6aec6b903f56acd1f695","webvr-polyfill":"^0.10.12"},"devDependencies":{"@babel/core":"^7.17.10","babel-loader":"^8.2.5","babel-plugin-istanbul":"^6.1.1","chai":"^4.3.6","chai-shallow-deep-equal":"^1.4.0","chalk":"^1.1.3","cross-env":"^7.0.3","css-loader":"^6.7.1","eslint":"^8.45.0","eslint-config-semistandard":"^17.0.0","eslint-config-standard-jsx":"^11.0.0","ghpages":"0.0.8","git-rev":"^0.2.1","glob":"^8.0.3","husky":"^0.11.7","jsdom":"^24.0.0","jsdom-global":"^3.0.2","karma":"^6.4.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^3.1.1","karma-coverage":"^2.2.0","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-mocha-reporter":"^2.2.5","karma-sinon-chai":"^2.0.2","karma-webpack":"^5.0.0","markserv":"github:sukima/markserv#feature/fix-broken-websoketio-link","mocha":"^10.0.0","replace-in-file":"^2.5.3","shelljs":"^0.7.7","shx":"^0.2.2","sinon":"<12.0.0","sinon-chai":"^3.7.0","snazzy":"^5.0.0","standardx":"^7.0.0","style-loader":"^3.3.1","too-wordy":"ngokevin/too-wordy","webpack":"^5.73.0","webpack-cli":"^4.10.0","webpack-dev-server":"^4.11.0","webpack-merge":"^5.8.0","write-good":"^1.0.8"},"link":true,"standardx":{"ignore":["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},"keywords":["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","quest","meta","web-components","webvr","webxr"],"engines":{"node":">= 4.6.0","npm":">= 2.15.9"}}')}},ye={};function Oe(k){var K=ye[k];if(K!==void 0)return K.exports;var f=ye[k]={id:k,exports:{}};return Ke[k].call(f.exports,f,f.exports,Oe),f.exports}Oe.m=Ke,(()=>{Oe.n=k=>{var K=k&&k.__esModule?()=>k.default:()=>k;return Oe.d(K,{a:K}),K}})(),(()=>{Oe.d=(k,K)=>{for(var f in K)Oe.o(K,f)&&!Oe.o(k,f)&&Object.defineProperty(k,f,{enumerable:!0,get:K[f]})}})(),(()=>{Oe.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(k){if(typeof window=="object")return window}}()})(),(()=>{Oe.o=(k,K)=>Object.prototype.hasOwnProperty.call(k,K)})(),(()=>{Oe.r=k=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(k,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(k,"__esModule",{value:!0})}})(),(()=>{Oe.b=document.baseURI||self.location.href;var k={main:0}})(),(()=>{Oe.nc=void 0})();var it=Oe("./src/index.js");return it})())});var bs=Lc(Vp());globalThis.THREE=bs.default.THREE;globalThis.AFRAME=bs.default;var xn=bs.default.THREE;var Qd=class{constructor(ye){this.target=null;this.angleLimit=60*Math.PI/180;this._identQ=new xn.Quaternion;this._zV=new xn.Vector3(0,0,-1);this._tmpQ0=new xn.Quaternion;this._tmpV0=new xn.Vector3;this._bone=ye.nodes[ye.vrm.firstPerson.firstPersonBone]}update(ye){let Oe=this.target,it=this._bone;if(Oe==null||it==null)return;let k=it.worldToLocal(this._tmpV0.setFromMatrixPosition(Oe.matrixWorld)).normalize(),K=this._tmpQ0.setFromUnitVectors(this._zV,k),f=this.angleLimit,y=.08,_=2*Math.acos(K.w);_>f*1.5?(K=this._identQ,y=.04):_>f&&K.setFromAxisAngle(this._tmpV0.set(K.x,K.y,K.z).normalize(),f),it.quaternion.slerp(K,y)}};var Vd=class{constructor(ye){this._currentShape={};this._avatar=ye}setBlendShapeWeight(ye,Oe){this._currentShape[ye]=Oe,Oe==0&&delete this._currentShape[ye],this._updateBlendShape()}getBlendShapeWeight(ye){return this._currentShape[ye]||0}resetBlendShape(){this._currentShape={},this._updateBlendShape()}startBlink(ye){this.animatedMorph||(this.animatedMorph={name:"BLINK",times:[0,ye-.2,ye-.1,ye],values:[0,0,1,0]},this._updateBlendShape())}stopBlink(){this.animatedMorph=null,this._updateBlendShape()}_updateBlendShape(){let ye=(f,y,_)=>{let v=this._avatar.blendShapes[y];v&&v.binds.forEach(C=>{let l=C.target.name,u=f[l]||(f[l]=new Array(C.target.morphTargetInfluences.length*_.length).fill(0));for(let p=0;p<_.length;p++){let c=p*C.target.morphTargetInfluences.length+C.index;u[c]+=Math.max(C.weight*_[p],u[c])}})},Oe=[0],it={};this.animatedMorph&&(Oe=this.animatedMorph.times,ye(it,this.animatedMorph.name,this.animatedMorph.values));for(let[f,y]of Object.entries(this._currentShape))this._avatar.blendShapes[f]&&ye(it,f,new Array(Oe.length).fill(y));let k=Object.entries(it).map(([f,y])=>new xn.NumberKeyframeTrack(f+".morphTargetInfluences",Oe,y)),K=null;if(k.length>0){let f=new xn.AnimationClip("morph",void 0,k);K=this._avatar.mixer.clipAction(f).setEffectiveWeight(1).play()}this.morphAction&&this.morphAction.stop(),this.morphAction=K}};var Hd=class{constructor(ye){this._firstPersonBone=ye.nodes[ye.vrm.firstPerson.firstPersonBone],this._annotatedMeshes=ye.vrm.firstPerson.meshAnnotations.map(Oe=>({flag:Oe.firstPersonFlag,mesh:ye.meshes[Oe.mesh]}))}setFirstPerson(ye){this._annotatedMeshes.forEach(Oe=>{Oe.flag=="ThirdPersonOnly"?Oe.mesh.visible=!ye:Oe.flag=="FirstPersonOnly"?Oe.mesh.visible=ye:Oe.flag=="Auto"&&this._firstPersonBone&&(ye?this._genFirstPersonMesh(Oe.mesh):this._resetFirstPersonMesh(Oe.mesh))})}_genFirstPersonMesh(ye){if(ye.children.forEach(l=>this._genFirstPersonMesh(l)),!ye.isSkinnedMesh)return;let Oe={};this._firstPersonBone.traverse(l=>{Oe[l.uuid]=!0});let it=ye.skeleton.bones,k=ye.geometry.attributes.skinIndex,K=ye.geometry.attributes.skinWeight,f=ye.geometry.index,y=[],_=0,v=0;for(let l=0;l<k.array.length;l++){let u=k.array[l];K.array[l]>0&&Oe[it[u].uuid]&&(y[l/k.itemSize|0]||(_++,y[l/k.itemSize|0]=!0))}let C=[];for(let l=0;l<f.count;l++)y[f.array[l]]&&!C[l/3|0]&&(C[l/3|0]=!0,v++);if(v!=0&&v*3==f.count){ye.visible=!1;return}}_resetFirstPersonMesh(ye){ye.children.forEach(Oe=>this._resetFirstPersonMesh(Oe)),ye.visible=!0}};var Pc=class{constructor(ye){this.gltfLoader=ye||new xn.GLTFLoader(xn.DefaultLoadingManager)}async load(ye,Oe=[]){return new Promise((it,k)=>{this.gltfLoader.load(ye,async K=>{it(await new zd(K).init(K,Oe))},void 0,k)})}async parse(ye,Oe,it=[]){return new Promise((k,K)=>{let f=Date.now();this.gltfLoader.parse(ye,Oe,async y=>{console.log(`gltf parsed, duration: ${Date.now()-f} ms`),k(await new zd(y).init(y,it))},void 0,K)})}},zd=class{constructor(ye){this.bones={};this.blendShapes={};this.modules={};this.meta={};this.firstPersonBone=null;this._firstPersonMeshUtil=null;this.boneConstraints={head:{type:"ball",limit:60*Math.PI/180,twistAxis:new xn.Vector3(0,1,0),twistLimit:60*Math.PI/180},neck:{type:"ball",limit:30*Math.PI/180,twistAxis:new xn.Vector3(0,1,0),twistLimit:10*Math.PI/180},leftUpperLeg:{type:"ball",limit:170*Math.PI/180,twistAxis:new xn.Vector3(0,-1,0),twistLimit:Math.PI/2},rightUpperLeg:{type:"ball",limit:170*Math.PI/180,twistAxis:new xn.Vector3(0,-1,0),twistLimit:Math.PI/2},leftLowerLeg:{type:"hinge",axis:new xn.Vector3(1,0,0),min:-170*Math.PI/180,max:0*Math.PI/180},rightLowerLeg:{type:"hinge",axis:new xn.Vector3(1,0,0),min:-170*Math.PI/180,max:0*Math.PI/180}};this.model=ye.scene,this.mixer=new xn.AnimationMixer(this.model),this.isVRM=(ye.userData.gltfExtensions||{}).VRM!=null,this.animations=ye.animations||[],this._blendShapeUtil=new Vd(this)}async init(ye,Oe){if(!this.isVRM)return this;let it=ye.userData.gltfExtensions.VRM,k=this.bones,K=await ye.parser.getDependencies("node"),f=await ye.parser.getDependencies("mesh"),y={nodes:K,meshes:f,vrm:it,gltf:ye};this.meta=it.meta,Object.values(it.humanoid.humanBones).forEach(_=>{k[_.bone]=K[_.node]}),it.firstPerson&&(it.firstPerson.firstPersonBone&&(this.firstPersonBone=K[it.firstPerson.firstPersonBone],this.modules.lookat=new Qd(y)),it.firstPerson.meshAnnotations&&(this._firstPersonMeshUtil=new Hd(y))),this.model.skeleton=new xn.Skeleton(Object.values(k)),this._fixBoundingBox(),it.blendShapeMaster&&this._initBlendShapes(y);for(let _ of Oe){let v=_.instantiate(this,y);v&&(this.modules[_.name]=v)}return this}_initBlendShapes(ye){this.blendShapes=(ye.vrm.blendShapeMaster.blendShapeGroups||[]).reduce((Oe,it)=>{let k=it.binds.flatMap(K=>{let f=ye.meshes[K.mesh];return(f.isSkinnedMesh?[f]:f.children.filter(y=>y.isSkinnedMesh)).map(y=>({target:y,index:K.index,weight:K.weight/100}))});return Oe[(it.presetName||it.name).toUpperCase()]={name:it.name,binds:k},Oe},{})}_fixBoundingBox(){let ye=this.bones;if(!ye.hips)return;let Oe=new xn.Vector3,it=ye.hips.getWorldPosition(Oe).clone();this.model.traverse(k=>{let K=k;if(K.isSkinnedMesh){let f=K.getWorldPosition(Oe).sub(it).multiplyScalar(-1),y=f.clone().sub(K.geometry.boundingSphere.center).length()+K.geometry.boundingSphere.radius;K.geometry.boundingSphere.center.copy(f),K.geometry.boundingSphere.radius=y,K.geometry.boundingBox.min.set(f.x-y,f.y-y,f.z-y),K.geometry.boundingBox.max.set(f.x+y,f.y+y,f.z+y)}})}update(ye){this.mixer.update(ye);for(let Oe of Object.values(this.modules))Oe.update(ye)}setModule(ye,Oe){this.removeModule(ye),this.modules[ye]=Oe}removeModule(ye){let Oe=this.modules[ye];Oe&&Oe.dispose&&Oe.dispose(),delete this.modules[ye]}dispose(){for(let ye of Object.keys(this.modules))this.removeModule(ye);this.model.traverse(ye=>{let Oe=ye;Oe.isMesh&&(Oe.geometry.dispose(),Oe.material.map?.dispose()),ye.skeleton&&ye.skeleton.dispose()})}get lookAtTarget(){let ye=this.modules.lookat;return ye?ye.target:null}set lookAtTarget(ye){let Oe=this.modules.lookat;Oe&&(Oe.target=ye)}setBlendShapeWeight(ye,Oe){this._blendShapeUtil.setBlendShapeWeight(ye,Oe)}getBlendShapeWeight(ye){return this._blendShapeUtil.getBlendShapeWeight(ye)}resetBlendShape(){this._blendShapeUtil.resetBlendShape()}startBlink(ye){this._blendShapeUtil.startBlink(ye)}stopBlink(){this._blendShapeUtil.stopBlink()}getPose(ye){let Oe={bones:Object.keys(this.bones).map(it=>({name:it,q:this.bones[it].quaternion.toArray()}))};return ye&&(Oe.blendShape=Object.keys(this.blendShapes).map(it=>({name:it,value:this.getBlendShapeWeight(it)}))),Oe}setPose(ye){if(ye.bones)for(let Oe of ye.bones)this.bones[Oe.name]&&this.bones[Oe.name].quaternion.fromArray(Oe.q);if(ye.blendShape)for(let Oe of ye.blendShape)this.setBlendShapeWeight(Oe.name,Oe.value)}restPose(){for(let ye of Object.values(this.bones))ye.quaternion.set(0,0,0,1)}setFirstPerson(ye){this._firstPersonMeshUtil&&this._firstPersonMeshUtil.setFirstPerson(ye)}},Hp=class{constructor(){this.cache=new Map}init(){let ye=document.querySelectorAll("a-asset-item[vrm]").forEach(Oe=>{this.loadAvatar(Oe)})}async loadAvatar(ye){let Oe=ye.data,it=ye.getAttribute("src")??"",k=ye.getAttribute("id"),K=await new Pc().parse(Oe,it);this.cache.set("id",K)}},dy=new Hp;var jd=class{constructor(ye){this.collisionGroup=2;this.enable=!1;this.binds=[];this.fixedBinds=[];this.bodies=[];this.constraints=[];this._tmpQ0=new xn.Quaternion;this._tmpV0=new xn.Vector3;this._tmpV1=new xn.Vector3;this.world=null;this.internalWorld=!1;this.springBoneSystem=this._springBoneSystem(),this._init(ye)}_init(ye){if(!ye.vrm.secondaryAnimation)return;let Oe=ye.nodes,it=ye.vrm.secondaryAnimation,k=0,K=.9;(it.colliderGroups||[]).forEach((f,y)=>{let _=Oe[f.node];for(let v of f.colliders){let C=new CANNON.Body({mass:0,collisionFilterGroup:1<<this.collisionGroup+y+1,collisionFilterMask:-1});C.addShape(new CANNON.Sphere(v.radius*K),v.offset),this.bodies.push(C),this.fixedBinds.push([_,C]),k|=C.collisionFilterGroup}});for(let f of it.boneGroups||[]){let y=new CANNON.Vec3().copy(f.gravityDir||{x:0,y:-1,z:0}).scale(f.gravityPower||0),_=f.hitRadius||.05,v=~(this.collisionGroup|k);for(let C of f.colliderGroups||[])v|=1<<this.collisionGroup+C+1;for(let C of f.bones){let l=new CANNON.Body({mass:0,collisionFilterGroup:0,collisionFilterMask:0});l.position.copy(Oe[C].parent.getWorldPosition(this._tmpV0)),this.bodies.push(l),this.fixedBinds.push([Oe[C].parent,l]);let u=(p,c)=>{let g=c.getWorldPosition(this._tmpV0),A=g.clone(),h=c.children.length+1;c.children.length>0?c.children.forEach(M=>{g.add(M.getWorldPosition(this._tmpV1))}):(g.add(c.parent.getWorldPosition(this._tmpV1).sub(g).normalize().multiplyScalar(-.1).add(g)),h=2),g.multiplyScalar(1/h);let m=new CANNON.Body({mass:.5,linearDamping:Math.max(f.dragForce||0,1e-4),angularDamping:Math.max(f.dragForce||0,1e-4),collisionFilterGroup:this.collisionGroup,collisionFilterMask:v,position:new CANNON.Vec3().copy(g)});m.addShape(new CANNON.Sphere(_)),this.bodies.push(m);let x=new CANNON.Vec3().copy(this._tmpV1.copy(A).sub(g)),S=new CANNON.Vec3().copy(A.sub(p.position)),b=new CANNON.PointToPointConstraint(m,x,p,S);this.constraints.push(b);let L=m.position.distanceTo(p.position);this.binds.push([c,m]),this.springBoneSystem.objects.push({body:m,parentBody:p,force:y,boneGroup:f,size:_,distanceToParent:L}),c.children.forEach(M=>M.isBone&&u(m,M))};u(l,Oe[C])}}}_springBoneSystem(){let ye=new CANNON.Quaternion,Oe=new CANNON.Quaternion,it=new CANNON.Vec3;return{world:null,objects:[],update(){let k=this.world.gravity,K=this.world.dt,f=.1,y=1600;for(let _ of this.objects){let v=_.body,C=_.parentBody,l=v.force,u=v.mass,p=_.force;l.x+=u*(-k.x+p.x),l.y+=u*(-k.y+p.y),l.z+=u*(-k.z+p.z);let c=v.position.distanceTo(C.position);Math.abs(c-_.distanceToParent)>.01&&c>0&&C.position.lerp(v.position,_.distanceToParent/c,v.position);let g=v.angularVelocity.length();g>f&&v.angularVelocity.scale(f/g,v.angularVelocity);let A=_.size*_.size*u,h=v.quaternion.mult(C.quaternion.inverse(ye),Oe),[m,x]=h.toAxisAngle(it);x=x-Math.PI*2*Math.floor((x+Math.PI)/(Math.PI*2));let S=x*_.boneGroup.stiffiness*y;Math.abs(S)>Math.abs(x/K/K*.5)&&(S=x/K/K*.5);let b=m.scale(-S*A,m);v.torque.vadd(b,v.torque)}}}}attach(ye){this.detach(),this.internalWorld=ye==null,this.world=ye||new CANNON.World,this.springBoneSystem.world=this.world,this.world.subsystems.push(this.springBoneSystem),this.bodies.forEach(Oe=>this.world.addBody(Oe)),this.constraints.forEach(Oe=>this.world.addConstraint(Oe)),this.reset(),this.enable=!0,this.world.bodies.forEach(Oe=>{Oe.collisionFilterGroup==1&&Oe.collisionFilterMask==1&&(Oe.collisionFilterMask=-1)})}detach(){!this.world||(this.world.subsystems=this.world.subsystems.filter(ye=>ye!=this.springBoneSystem),this.world.constraints=this.world.constraints.filter(ye=>!this.constraints.includes(ye)),this.world.bodies=this.world.bodies.filter(ye=>!this.bodies.includes(ye)),this.world=null,this.enable=!1)}reset(){this.fixedBinds.forEach(([ye,Oe])=>{ye.updateWorldMatrix(!0,!1),Oe.position.copy(ye.getWorldPosition(this._tmpV0)),Oe.quaternion.copy(ye.parent.getWorldQuaternion(this._tmpQ0))}),this.binds.forEach(([ye,Oe])=>{ye.updateWorldMatrix(!0,!1),Oe.position.copy(ye.getWorldPosition(this._tmpV0)),Oe.quaternion.copy(ye.getWorldQuaternion(this._tmpQ0))})}update(ye){!this.enable||(this.fixedBinds.forEach(([Oe,it])=>{it.position.copy(Oe.getWorldPosition(this._tmpV0)),it.quaternion.copy(Oe.getWorldQuaternion(this._tmpQ0))}),this.internalWorld&&this.world.step(1/60,ye),this.binds.forEach(([Oe,it])=>{Oe.quaternion.copy(it.quaternion).premultiply(Oe.parent.getWorldQuaternion(this._tmpQ0).invert())}))}dispose(){this.detach()}};var Wd=class{constructor(ye,Oe,it){this.quaternion=new xn.Quaternion;this.worldMatrix=new xn.Matrix4;this.worldPosition=new xn.Vector3;this.position=ye,this.constraint=Oe,this.userData=it}},Kd=class{constructor(){this.iterationLimit=50;this.thresholdSq=1e-4;this._iv=new xn.Vector3(1,1,1);this._tmpV0=new xn.Vector3;this._tmpV1=new xn.Vector3;this._tmpV2=new xn.Vector3;this._tmpQ0=new xn.Quaternion;this._tmpQ1=new xn.Quaternion}_updateChain(ye,Oe){for(let it of ye)it.worldMatrix.compose(it.position,it.quaternion,this._iv).premultiply(Oe),it.worldPosition.setFromMatrixPosition(it.worldMatrix),Oe=it.worldMatrix}solve(ye,Oe,it){this._updateChain(ye,it);let k=ye[ye.length-1].worldPosition,K=k.distanceToSquared(Oe),f=this._tmpV2,y=this._tmpV1,_=this._tmpQ1;for(let v=0;v<this.iterationLimit&&!(k.distanceToSquared(Oe)<this.thresholdSq);v++){let C=this._tmpV0.copy(Oe);for(let l=ye.length-2;l>=0;l--){let u=ye[l],p=ye[l+1].position;u.worldMatrix.decompose(this._tmpV1,this._tmpQ0,this._tmpV2),f.copy(C).sub(this._tmpV1).applyQuaternion(_.copy(this._tmpQ0).invert()).normalize(),y.copy(p).normalize(),_.setFromUnitVectors(y,f),u.quaternion.multiply(_);let c=y.copy(p).applyQuaternion(this._tmpQ0.multiply(_));u.constraint&&(_.copy(u.quaternion).invert(),u.constraint.apply(u)&&(_.premultiply(u.quaternion),c.copy(p).applyQuaternion(this._tmpQ0.multiply(_)))),C.sub(c)}this._updateChain(ye,it)}return k.distanceToSquared(Oe)<K}};var Xd=class{constructor(){this.boneMapping=[{bone:"hips",nodeNames:["\u30BB\u30F3\u30BF\u30FC","center"]},{bone:"spine",nodeNames:["\u4E0A\u534A\u8EAB","upper body"]},{bone:"chest",nodeNames:["\u4E0A\u534A\u8EAB2","upper body2"]},{bone:"neck",nodeNames:["\u9996","neck"]},{bone:"head",nodeNames:["\u982D","head"]},{bone:"leftShoulder",nodeNames:["\u5DE6\u80A9","shoulder_L"]},{bone:"leftUpperArm",nodeNames:["\u5DE6\u8155","arm_L"]},{bone:"leftLowerArm",nodeNames:["\u5DE6\u3072\u3058","elbow_L"]},{bone:"leftHand",nodeNames:["\u5DE6\u624B\u9996","wrist_L"]},{bone:"rightShoulder",nodeNames:["\u53F3\u80A9","shoulder_R"]},{bone:"rightUpperArm",nodeNames:["\u53F3\u8155","arm_R"]},{bone:"rightLowerArm",nodeNames:["\u53F3\u3072\u3058","elbow_R"]},{bone:"rightHand",nodeNames:["\u53F3\u624B\u9996","wrist_R"]},{bone:"leftUpperLeg",nodeNames:["\u5DE6\u8DB3","leg_L"]},{bone:"leftLowerLeg",nodeNames:["\u5DE6\u3072\u3056","knee_L"]},{bone:"leftFoot",nodeNames:["\u5DE6\u8DB3\u9996","ankle_L"]},{bone:"leftToes",nodeNames:["\u5DE6\u3064\u307E\u5148","L toe"]},{bone:"rightUpperLeg",nodeNames:["\u53F3\u8DB3","leg_R"]},{bone:"rightLowerLeg",nodeNames:["\u53F3\u3072\u3056","knee_R"]},{bone:"rightFoot",nodeNames:["\u53F3\u8DB3\u9996","ankle_R"]},{bone:"rightToes",nodeNames:["\u53F3\u3064\u307E\u5148","R toe"]},{bone:"leftEye",nodeNames:["\u5DE6\u76EE","eye_L"]},{bone:"rightEye",nodeNames:["\u53F3\u76EE","eye_R"]},{bone:"leftThumbProximal",nodeNames:["\u5DE6\u89AA\u6307\uFF10","thumb0_L"]},{bone:"leftThumbIntermediate",nodeNames:["\u5DE6\u89AA\u6307\uFF11","thumb1_L"]},{bone:"leftThumbDistal",nodeNames:["\u5DE6\u89AA\u6307\uFF12","thumb2_L"]},{bone:"leftIndexProximal",nodeNames:["\u5DE6\u4EBA\u6307\uFF11","fore1_L"]},{bone:"leftIndexIntermediate",nodeNames:["\u5DE6\u4EBA\u6307\uFF12","fore2_L"]},{bone:"leftIndexDistal",nodeNames:["\u5DE6\u4EBA\u6307\uFF13","fore3_L"]},{bone:"leftMiddleProximal",nodeNames:["\u5DE6\u4E2D\u6307\uFF11","middle1_L"]},{bone:"leftMiddleIntermediate",nodeNames:["\u5DE6\u4E2D\u6307\uFF12","middle2_L"]},{bone:"leftMiddleDistal",nodeNames:["\u5DE6\u4E2D\u6307\uFF13","middle3_L"]},{bone:"leftRingProximal",nodeNames:["\u5DE6\u85AC\u6307\uFF11","third1_L"]},{bone:"leftRingIntermediate",nodeNames:["\u5DE6\u85AC\u6307\uFF12","third2_L"]},{bone:"leftRingDistal",nodeNames:["\u5DE6\u85AC\u6307\uFF13","third3_L"]},{bone:"leftLittleProximal",nodeNames:["\u5DE6\u5C0F\u6307\uFF11","little1_L"]},{bone:"leftLittleIntermediate",nodeNames:["\u5DE6\u5C0F\u6307\uFF12","little2_L"]},{bone:"leftLittleDistal",nodeNames:["\u5DE6\u5C0F\u6307\uFF13","little3_L"]},{bone:"rightThumbProximal",nodeNames:["\u53F3\u89AA\u6307\uFF10","thumb0_R"]},{bone:"rightThumbIntermediate",nodeNames:["\u53F3\u89AA\u6307\uFF11","thumb1_R"]},{bone:"rightThumbDistal",nodeNames:["\u53F3\u89AA\u6307\uFF12","thumb2_R"]},{bone:"rightIndexProximal",nodeNames:["\u53F3\u4EBA\u6307\uFF11","fore1_R"]},{bone:"rightIndexIntermediate",nodeNames:["\u53F3\u4EBA\u6307\uFF12","fore2_R"]},{bone:"rightIndexDistal",nodeNames:["\u53F3\u4EBA\u6307\uFF13","fore3_R"]},{bone:"rightMiddleProximal",nodeNames:["\u53F3\u4E2D\u6307\uFF11","middle1_R"]},{bone:"rightMiddleIntermediate",nodeNames:["\u53F3\u4E2D\u6307\uFF12","middle2_R"]},{bone:"rightMiddleDistal",nodeNames:["\u53F3\u4E2D\u6307\uFF13","middle3_R"]},{bone:"rightRingProximal",nodeNames:["\u53F3\u85AC\u6307\uFF11","third1_R"]},{bone:"rightRingIntermediate",nodeNames:["\u53F3\u85AC\u6307\uFF12","third2_R"]},{bone:"rightRingDistal",nodeNames:["\u53F3\u85AC\u6307\uFF13","third3_R"]},{bone:"rightLittleProximal",nodeNames:["\u53F3\u5C0F\u6307\uFF11","little1_R"]},{bone:"rightLittleIntermediate",nodeNames:["\u53F3\u5C0F\u6307\uFF12","little2_R"]},{bone:"rightLittleDistal",nodeNames:["\u53F3\u5C0F\u6307\uFF13","little3_R"]}];this.blendShapeMap={A:"\u3042",I:"\u3044",U:"\u3046",E:"\u3048",O:"\u304A",BLINK:"\u307E\u3070\u305F\u304D"};this.rotationOffsets={leftUpperArm:-38*xn.MathUtils.DEG2RAD,rightUpperArm:38*xn.MathUtils.DEG2RAD};this.ikConfigs=[{target:"\u5DE6\u8DB3\uFF29\uFF2B",bones:["leftFoot","leftLowerLeg","leftUpperLeg"]},{target:"\u53F3\u8DB3\uFF29\uFF2B",bones:["rightFoot","rightLowerLeg","rightUpperLeg"]},{target:"\u5DE6\u3064\u307E\u5148\uFF29\uFF2B",parent:0,bones:["leftToes","leftFoot"]},{target:"\u53F3\u3064\u307E\u5148\uFF29\uFF2B",parent:1,bones:["rightToes","rightFoot"]}];this.boneConstraints={leftLowerLeg:{min:new xn.Vector3(-175*Math.PI/180,0,0),max:new xn.Vector3(0,0,0)},rightLowerLeg:{min:new xn.Vector3(-175*Math.PI/180,0,0),max:new xn.Vector3(0,0,0)},leftUpperLeg:{min:new xn.Vector3(-Math.PI/2,-Math.PI/2,-Math.PI/2),max:new xn.Vector3(Math.PI,Math.PI/2,Math.PI/2)},rightUpperLeg:{min:new xn.Vector3(-Math.PI/2,-Math.PI/2,-Math.PI/2),max:new xn.Vector3(Math.PI,Math.PI/2,Math.PI/2)}}}async load(ye,Oe,it){let{MMDLoader:k}=await import("https://threejs.org/examples/jsm/loaders/MMDLoader.js"),{CCDIKSolver:K}=await import("https://threejs.org/examples/jsm/animation/CCDIKSolver.js"),f=new k,y={};for(let A of this.boneMapping){let h=Oe.bones[A.bone];if(h)for(let m of A.nodeNames)y[m]=h.name}let _={},v={};for(let[A,h]of Object.entries(this.rotationOffsets)){let m=Oe.bones[A];m&&(_[m.name]=new xn.Quaternion().setFromAxisAngle(new xn.Vector3(0,0,1),h),m.traverse(x=>{v[x.name]=[Math.cos(h),Math.sin(h)]}))}let C={};for(let[A,h]of Object.entries(this.blendShapeMap))Oe.blendShapes[A]&&(C[h]=A);Oe.model.morphTargetDictionary=C;let l=.08,u=(A,h)=>{[A[0],A[2]]=[A[0]*h[0]-A[2]*h[1],A[0]*h[1]+A[2]*h[0]]},p=(A,h)=>{[A[0],A[1]]=[A[0]*h[0]-A[1]*h[1],A[0]*h[1]+A[1]*h[0]]},c=new xn.Quaternion,g=new xn.Quaternion;return await new Promise((A,h)=>{f.loadVMD(ye,async m=>{let x=m.motions.filter(b=>b.boneName=="\u4E0B\u534A\u8EAB");if(x.length){x.sort((L,M)=>L.frameNum-M.frameNum);let b=(L,M)=>{L.sort((H,Y)=>H.frameNum-Y.frameNum);let F=0;for(let H of L){for(;F<x.length-1&&H.frameNum>x[F].frameNum;)F++;let Y=g.fromArray(x[F].rotation);if(F>0&&H.frameNum<x[F].frameNum){let W=(H.frameNum-x[F-1].frameNum)/(x[F].frameNum-x[F-1].frameNum);Y.slerp(c.fromArray(x[F-1].rotation),1-W)}M&&Y.invert(),H.rotation=c.fromArray(H.rotation).multiply(Y).toArray()}};b(m.motions.filter(L=>L.boneName=="\u30BB\u30F3\u30BF\u30FC"),!1),b(m.motions.filter(L=>L.boneName=="\u4E0A\u534A\u8EAB"),!0),x.forEach(L=>L.rotation=[0,0,0,1])}for(let b of m.motions){y[b.boneName]&&(b.boneName=y[b.boneName]);let L=_[b.boneName];L&&(b.rotation=c.fromArray(b.rotation).premultiply(L).toArray()),b.position[0]*=l,b.position[1]*=l,b.position[2]*=l,u(b.position,[-1,0]),u(b.rotation,[-1,0]);let M=v[b.boneName];M&&(p(b.position,M),p(b.rotation,M))}if(it.enableIK){let b=Oe.model.skeleton.bones,L=F=>{let H=b.findIndex(re=>re.name==F.target);if(H>=0)return H;let Y=F.parent!=null?b[L(this.ikConfigs[F.parent])]:Oe.model,W=new xn.Bone;W.name=F.target,b.push(W),Y.add(W),Y.updateMatrixWorld();let te=Oe.bones[F.bones[0]].getWorldPosition(new xn.Vector3);return W.position.copy(te.applyMatrix4(Y.matrixWorld.clone().invert())),b.length-1},M=[];for(let F of this.ikConfigs){if(m.motions.find(re=>re.boneName==F.target)==null)continue;let H=re=>b.findIndex(X=>X==Oe.bones[re]),Y=H(F.bones[0]);if(Y<0)continue;let W=[];F.bones.slice(1).forEach(re=>{let X=H(re);if(X>=0){let V={index:X},O=this.boneConstraints[re];O&&(V.rotationMax=O.max,V.rotationMin=O.min),W.push(V)}});let te={target:L(F),effector:Y,links:W,maxAngle:1,iteration:4};M.push(te)}if(M.length>0){console.log(M);let F=new K(Oe.model,M);Oe.setModule("MMDIK",{update:H=>F.update()})}}let S=f.animationBuilder.build(m,Oe.model);S.tracks.forEach(b=>{let L=b.name.match(/.morphTargetInfluences\[(\w+)\]/);if(L){let M=Oe.blendShapes[L[1]];M&&M.binds.length>0&&(b.name=M.binds[0].target.uuid+".morphTargetInfluences["+M.binds[0].index+"]")}}),A(S)},()=>{},h)})}};var Yd=class{async load(ye,Oe,it){let{BVHLoader:k}=await import("https://threejs.org/examples/jsm/loaders/BVHLoader.js");return await new Promise((K,f)=>{new k().load(ye,y=>{it.convertBone&&this.fixTrackName(y.clip,Oe),y.clip.tracks=y.clip.tracks.filter(_=>!_.name.match(/position/)||_.name.match(Oe.bones.hips.name)),K(y.clip)})})}convertBoneName(ye){return ye=ye.replace("Spin1","Spin"),ye=ye.replace("Chest1","Chest"),ye=ye.replace("Chest2","UpperChest"),ye=ye.replace("UpLeg","UpperLeg"),ye=ye.replace("LeftLeg","LeftLowerLeg"),ye=ye.replace("RightLeg","RightLowerLeg"),ye=ye.replace("ForeArm","UpperArm"),ye=ye.replace("LeftArm","LeftLowerArm"),ye=ye.replace("RightArm","RightLowerArm"),ye=ye.replace("Collar","Shoulder"),ye=ye.replace("Elbow","LowerArm"),ye=ye.replace("Wrist","Hand"),ye=ye.replace("LeftHip","LeftUpperLeg"),ye=ye.replace("RightHip","RightUpperLeg"),ye=ye.replace("Knee","LowerLeg"),ye=ye.replace("Ankle","Foot"),ye.charAt(0).toLowerCase()+ye.slice(1)}fixTrackName(ye,Oe){ye.tracks.forEach(it=>{it.name=it.name.replace(/bones\[(\w+)\]/,(k,K)=>{let f=Oe.bones[this.convertBoneName(K)];return"bones["+(f!=null?f.name:"NODE_NOT_FOUND")+"]"}),it.name=it.name.replace("ToeBase","Foot"),it.name.match(/quaternion/)&&(it.values=it.values.map((k,K)=>K%2==0?-k:k)),it.name.match(/position/)&&(it.values=it.values.map((k,K)=>(K%3==1?k:-k)*.09))}),ye.tracks=ye.tracks.filter(it=>!it.name.match(/NODE_NOT_FOUND/))}};bs.default.registerComponent("vrm",{schema:{src:{type:"selector",default:""},firstPerson:{default:!1},blink:{default:!0},blinkInterval:{default:5},lookAt:{type:"selector"},enablePhysics:{default:!1},cached:{default:!1}},init(){if(this.avatar=null,window.Worker)try{let Ke=new Worker("./workers/vrm-worker.js");Ke.onmessage=ye=>{this._getAvatarFromWorker(ye)},Ke.onmessageerror=ye=>{this._getErrorFromWorker(ye)},Ke.onerror=ye=>{console.log(ye)},this.worker=Ke}catch(Ke){console.log(Ke)}},update(Ke){this.data.src!==Ke.src&&(this.remove(),this._loadAvatar()),this._updateAvatar()},tick(Ke,ye){if(!this.avatar){this.pause();return}this.avatar.update(ye/1e3)},remove(){this.avatar&&(this.el.removeObject3D("avatar"),this.avatar.dispose())},async _loadAvatar(){let Ke=this.el,ye=this.data.src?.data,Oe=this.data.src?.getAttribute("src"),it=this.data.src?.getAttribute("id");if(!!ye)try{let k=[];globalThis.CANNON&&k.push({name:"physics",instantiate:(y,_)=>new jd(_)});let K=this.worker;if(K){K.postMessage([ye,Oe,[]]);return}let f;if(f=await new Pc().parse(ye,Oe,k),ye!=this.data.src?.data){f.dispose();return}this.avatar=f,Ke.setObject3D("avatar",f.model),this._updateAvatar(),this.play(),Ke.emit("model-loaded",{format:"vrm",model:f.model,avatar:f},!1)}catch(k){Ke.emit("model-error",{format:"vrm",src:Oe,cause:k},!1),console.log(k)}},_getAvatarFromWorker(Ke){let ye=this.el,Oe=Ke.data;ye.setObject3D("avatar",Oe.model),this.avatar=Oe,this._updateAvatar(),this.play(),ye.emit("model-loaded",{format:"vrm",model:Oe.model,avatar:Oe},!1)},_getErrorFromWorker(Ke){let ye=this.el,Oe=this.data.src?.getAttribute("src");ye.emit("model-error",{format:"vrm",src:Oe,cause:Ke},!1),console.log(Ke)},_updateAvatar(){if(!this.avatar)return;let Ke=this.data;this.avatar.setFirstPerson(Ke.firstPerson),Ke.lookAt?Ke.lookAt.tagName=="A-CAMERA"?this.avatar.lookAtTarget=this.el.sceneEl.camera:this.avatar.lookAtTarget=Ke.lookAt.object3D:this.avatar.lookAtTarget=null,Ke.blink?this.avatar.startBlink(Ke.blinkInterval):this.avatar.stopBlink();let ye=this.avatar.modules.physics;if(ye){if(Ke.enablePhysics&&ye.world==null){let Oe=this.el.sceneEl.systems.physics;ye.attach(Oe&&Oe.driver&&Oe.driver.world)}ye.enable=Ke.enablePhysics}}});bs.default.registerComponent("vrm-anim",{schema:{src:{default:""},format:{default:""},loop:{default:!0},enableIK:{default:!0},convertBone:{default:!0}},init(){this.avatar=null,this.el.components.vrm&&this.el.components.vrm.avatar&&(this.avatar=this.el.components.vrm.avatar),this.onVrmLoaded=Ke=>{this.avatar=Ke.detail.avatar,this.data.src!=""?this._loadClip(this.data.src):this.avatar.animations.length>0?this.playClip(this.avatar.animations[0]):this.playTestMotion()},this.el.addEventListener("model-loaded",this.onVrmLoaded)},update(Ke){Ke.src!=this.data.src&&this.avatar&&this._loadClip(this.data.src)},async _loadClip(Ke){if(this.stopAnimation(),this.avatar.restPose(),Ke==="")return;let ye=this.data.loop?THREE.LoopRepeat:THREE.LoopOnce,k=await((this.data.format||(Ke.toLowerCase().endsWith(".bvh")?"bvh":""))=="bvh"?new Yd:new Xd).load(Ke,this.avatar,this.data);!this.avatar||this.playClip(k)},stopAnimation(){this.animation&&(this.animation.stop(),this.avatar.mixer.uncacheClip(this.clip),this.avatar.removeModule("MMDIK"),this.animation=null)},playTestMotion(){let Ke=(it,k,K)=>new THREE.Quaternion().setFromEuler(new THREE.Euler(it*Math.PI/180,k*Math.PI/180,K*Math.PI/180)),ye={leftUpperArm:{keys:[{rot:Ke(0,0,65),time:0},{rot:Ke(0,0,63),time:1},{rot:Ke(0,0,65),time:2}]},rightUpperArm:{keys:[{rot:Ke(0,0,-65),time:0},{rot:Ke(0,0,-60),time:1},{rot:Ke(0,0,-65),time:2}]},spine:{keys:[{rot:Ke(0,2,0),time:0},{rot:Ke(2,0,-2),time:1},{rot:Ke(2,-2,0),time:2},{rot:Ke(0,0,2),time:3},{rot:Ke(0,2,0),time:4}]}},Oe=THREE.AnimationClip.parseAnimation({name:"testAnimation",hierarchy:Object.values(ye)},Object.keys(ye).map(it=>this.avatar.bones[it]||{name:it}));this.playClip(Oe)},playClip(Ke){let ye=this.data.loop?THREE.LoopRepeat:THREE.LoopOnce;this.stopAnimation(),this.clip=Ke,this.avatar.mixer.setTime(0),this.animation=this.avatar.mixer.clipAction(Ke).setLoop(ye).setEffectiveWeight(1).play(),this.animation.clampWhenFinished=!0},remove(){this.el.removeEventListener("model-loaded",this.onVrmLoaded),this.stopAnimation(),this.avatar=null}});bs.default.registerComponent("vrm-skeleton",{schema:{physicsOffset:{type:"vec3",default:{x:0,y:0,z:0}}},init(){this.physicsBodies=[],this.sceneObj=this.el.sceneEl.object3D,this.el.components.vrm&&this.el.components.vrm.avatar&&this._onAvatarUpdated(this.el.components.vrm.avatar),this.onVrmLoaded=Ke=>this._onAvatarUpdated(Ke.detail.avatar),this.el.addEventListener("model-loaded",this.onVrmLoaded)},_onAvatarUpdated(Ke){this.helper&&this.sceneObj.remove(this.helper),this.helper=new THREE.SkeletonHelper(Ke.model),this.sceneObj.add(this.helper),this._updatePhysicsBody(Ke)},_updatePhysicsBody(Ke){this._clearPhysicsBody();let ye=Ke.modules.physics;if(!ye||!ye.world)return;let Oe=new THREE.SphereGeometry(1,6,3),it=new THREE.MeshBasicMaterial({color:new THREE.Color("red"),wireframe:!0,depthTest:!1});ye.bodies.forEach(k=>{let K=new THREE.Group;k.shapes.forEach((f,y)=>{let _=new THREE.Mesh(Oe,it);_.position.copy(k.shapeOffsets[y]),_.scale.multiplyScalar(f.boundingSphereRadius||.01),K.add(_)}),this.sceneObj.add(K),this.physicsBodies.push([k,K])})},_clearPhysicsBody(){this.physicsBodies.forEach(([Ke,ye])=>ye.parent.remove(ye)),this.physicsBodies=[]},tick(){this.physicsBodies.forEach(([Ke,ye])=>{ye.position.copy(Ke.position).add(this.data.physicsOffset),ye.quaternion.copy(Ke.quaternion)})},remove(){this.el.removeEventListener("model-loaded",this.onVrmLoaded),this._clearPhysicsBody(),this.helper&&this.sceneObj.remove(this.helper)}});bs.default.registerComponent("vrm-poser",{schema:{color:{default:"#00ff00"},enableConstraints:{default:!0}},init(){this.binds=[],this._tmpV0=new THREE.Vector3,this._tmpV1=new THREE.Vector3,this._tmpQ0=new THREE.Quaternion,this._tmpQ1=new THREE.Quaternion,this._tmpM0=new THREE.Matrix4,this.el.components.vrm&&this.el.components.vrm.avatar&&this._onAvatarUpdated(this.el.components.vrm.avatar),this.onVrmLoaded=Ke=>this._onAvatarUpdated(Ke.detail.avatar),this.el.addEventListener("model-loaded",this.onVrmLoaded)},remove(){this.el.removeEventListener("model-loaded",this.onVrmLoaded),this._removeHandles()},getPoseData(Ke){if(!!this.avatar)return this.avatar.getPose(Ke)},setPoseData(Ke){!this.avatar||(this.avatar.setPose(Ke),this._updateHandlePosition())},_onAvatarUpdated(Ke){this._removeHandles(),this.avatar=Ke;let ye=new THREE.BoxGeometry(1,1,1),Oe=new THREE.MeshBasicMaterial({color:new THREE.Color(this.data.color),transparent:!0,opacity:.4,depthTest:!1}),it=this._tmpV0,k=this._tmpV1,K=this._tmpM0,f=this._tmpQ0,y=Ke.bones.hips,_={};for(let v of Object.keys(Ke.bones)){let C=Ke.bones[v],l=C==y,u=new THREE.Mesh(ye,Oe),p=document.createElement("a-entity");p.classList.add("collidable"),p.setAttribute("xy-drag-control",{}),p.setObject3D("handle",u);let c=p.object3D,g=C.children.reduce((h,m)=>Math.min(h,m.position.length()),C.position.length());c.scale.multiplyScalar(Math.max(Math.min(g/2,.05),.01)),_[C.uuid]=v,p.addEventListener("mousedown",h=>{this.el.emit("vrm-poser-select",{name:v,node:C})});let A=C.parent;for(;!_[A.uuid]&&A.parent&&A.parent.isBone;)A=A.parent;p.addEventListener("xy-drag",h=>{if(l){let m=c.parent.worldToLocal(C.getWorldPosition(it)).sub(c.position);Ke.model.position.sub(m)}A.updateMatrixWorld(!1),c.updateMatrixWorld(!1),K.getInverse(A.matrixWorld).multiply(c.matrixWorld).decompose(k,f,it),C.quaternion.copy(this._applyConstraintQ(v,f)),f.setFromUnitVectors(it.copy(C.position).normalize(),k.normalize()),A.children.length==1&&(A.quaternion.multiply(f),this._applyConstraintQ(_[A.uuid],A.quaternion)),this._updateHandlePosition(l?null:C)}),p.addEventListener("xy-dragend",h=>{this._updateHandlePosition(),console.log(A.name,v)}),this.el.appendChild(p),this.binds.push([C,c])}this._updateHandlePosition()},_applyConstraintQ(Ke,ye){if(!this.data.enableConstraints)return ye;let Oe=this._tmpQ1,it=this._tmpV0,k=this.avatar.boneConstraints[Ke];if(k&&k.type=="ball"){let K=2*Math.acos(ye.w);if(k.twistAxis){let f=K*Math.acos(ye.w)*it.copy(ye).normalize().dot(k.twistAxis);if(f=this._normalizeAngle(f),Math.abs(f)>k.twistLimit){let y=f<0?f+k.twistLimit:f-k.twistLimit;ye.multiply(Oe.setFromAxisAngle(k.twistAxis,-y)),K=2*Math.acos(ye.w)}}Math.abs(this._normalizeAngle(K))>k.limit&&ye.setFromAxisAngle(it.copy(ye).normalize(),k.limit)}else if(k&&k.type=="hinge"){let K=(k.min+k.max)/2,f=2*Math.acos(ye.w)*it.copy(ye).normalize().dot(k.axis);f=THREE.MathUtils.clamp(this._normalizeAngle(f-K),k.min-K,k.max-K),ye.setFromAxisAngle(k.axis,f+K)}return ye},_normalizeAngle(Ke){return Ke-Math.PI*2*Math.floor((Ke+Math.PI)/(Math.PI*2))},_removeHandles(){this.binds.forEach(([Ke,ye])=>{this.el.removeChild(ye.el);let Oe=ye.el.getObject3D("handle");Oe&&(Oe.material.dispose(),Oe.geometry.dispose()),ye.el.destroy()}),this.binds=[]},_updateHandlePosition(Ke){let ye=this._tmpV0,Oe=this.el.object3D;Oe.updateMatrixWorld(!1);let it=Oe.matrixWorld.clone().invert();this.binds.forEach(([k,K])=>{let f=k==Ke?ye:K.position;k.updateMatrixWorld(!1),K.matrix.copy(k.matrixWorld).premultiply(it).decompose(f,K.quaternion,ye)})}});bs.default.registerComponent("vrm-mimic",{schema:{leftHandTarget:{type:"selector",default:""},leftHandOffsetPosition:{type:"vec3"},leftHandOffsetRotation:{type:"vec3",default:{x:0,y:-Math.PI/2,z:0}},rightHandTarget:{type:"selector",default:""},rightHandOffsetPosition:{type:"vec3"},rightHandOffsetRotation:{type:"vec3",default:{x:0,y:Math.PI/2,z:0}},leftLegTarget:{type:"selector",default:""},rightLegTarget:{type:"selector",default:""},headTarget:{type:"selector",default:""},avatarOffset:{type:"vec3",default:{x:0,y:0,z:0}}},init(){this._tmpV0=new THREE.Vector3,this._tmpV1=new THREE.Vector3,this._tmpQ0=new THREE.Quaternion,this._tmpQ1=new THREE.Quaternion,this._tmpM0=new THREE.Matrix4,this.targetEls=[],this.el.components.vrm&&this.el.components.vrm.avatar&&this._onAvatarUpdated(this.el.components.vrm.avatar),this.onVrmLoaded=Ke=>this._onAvatarUpdated(Ke.detail.avatar),this.el.addEventListener("model-loaded",this.onVrmLoaded)},update(){this.data.headTarget?this.data.headTarget.tagName=="A-CAMERA"?this.headTarget=this.el.sceneEl.camera:this.headTarget=this.data.headTarget.object3D:this.headTarget=null,this.rightHandOffset=new THREE.Matrix4().compose(this.data.rightHandOffsetPosition,new THREE.Quaternion().setFromEuler(new THREE.Euler().setFromVector3(this.data.rightHandOffsetRotation)),new THREE.Vector3(1,1,1)),this.leftHandOffset=new THREE.Matrix4().compose(this.data.leftHandOffsetPosition,new THREE.Quaternion().setFromEuler(new THREE.Euler().setFromVector3(this.data.leftHandOffsetRotation)),new THREE.Vector3(1,1,1))},_onAvatarUpdated(Ke){this.avatar=Ke;for(let ye of this.targetEls)this.el.removeChild(ye);this.targetEls=[],this.update(),this.startAvatarIK_simpleIK(Ke)},startAvatarIK_simpleIK(Ke){let ye=new Kd;this.qbinds=[];let Oe=(it,k,K)=>{k==null&&(k=document.createElement("a-box"),k.classList.add("collidable"),k.setAttribute("xy-drag-control",{}),k.setAttribute("geometry",{width:.05,depth:.05,height:.05}),k.setAttribute("material",{color:"blue",depthTest:!1,transparent:!0,opacity:.4}),this.el.appendChild(k),this.targetEls.push(k));let f=(v,C)=>C.worldToLocal(v.getWorldPosition(new THREE.Vector3));it=it.filter(v=>Ke.bones[v]);let y=it.map(v=>Ke.bones[v]),_=y.map((v,C)=>{let l=C==0?v.position:f(v,y[C-1]),u=Ke.boneConstraints[it[C]],p=u?{apply:c=>this._applyConstraintQ(u,c.quaternion)}:null;return new Wd(l,p,v)});return this.qbinds.push([y[y.length-1],k.object3D,K]),{root:y[0],ikbones:_,bones:y,target:k.object3D}};this.chains=[Oe(["leftUpperArm","leftLowerArm","leftHand"],this.data.leftHandTarget,this.leftHandOffset),Oe(["rightUpperArm","rightLowerArm","rightHand"],this.data.rightHandTarget,this.rightHandOffset),Oe(["leftUpperLeg","leftLowerLeg","leftFoot"],this.data.leftLegTarget),Oe(["rightUpperLeg","rightLowerLeg","rightFoot"],this.data.rightLegTarget)],this.simpleIK=ye},_applyConstraintQ(Ke,ye){let Oe=this._tmpQ1,it=this._tmpV0,k=!1;if(Ke&&Ke.type=="ball"){let K=2*Math.acos(ye.w);if(Ke.twistAxis){let f=K*Math.acos(ye.w)*it.copy(ye).normalize().dot(Ke.twistAxis);if(f=this._normalizeAngle(f),Math.abs(f)>Ke.twistLimit){let y=f<0?f+Ke.twistLimit:f-Ke.twistLimit;ye.multiply(Oe.setFromAxisAngle(Ke.twistAxis,-y)),K=2*Math.acos(ye.w),k=!0}}Math.abs(this._normalizeAngle(K))>Ke.limit&&(ye.setFromAxisAngle(it.copy(ye).normalize(),Ke.limit),k=!0)}else if(Ke&&Ke.type=="hinge"){let K=(Ke.min+Ke.max)/2,f=it.copy(ye).normalize().dot(Ke.axis),y=2*Math.acos(ye.w)*f;y=THREE.MathUtils.clamp(this._normalizeAngle(y-K),Ke.min-K,Ke.max-K),ye.setFromAxisAngle(Ke.axis,y+K),k=!0}return k},_normalizeAngle(Ke){return Ke-Math.PI*2*Math.floor((Ke+Math.PI)/(Math.PI*2))},tick(Ke,ye){if(!!this.avatar){if(this.headTarget){let Oe=this._tmpV0,it=this._tmpQ0;this.headTarget.matrixWorld.decompose(Oe,it,this._tmpV1),Oe.y=0,this.avatar.model.position.copy(Oe.add(this.data.avatarOffset));let k=this.avatar.firstPersonBone;if(k){let K=this._tmpQ1.setFromRotationMatrix(k.parent.matrixWorld).invert();k.quaternion.copy(it.premultiply(K))}}if(this.simpleIK){let Oe=this.el.object3D.matrixWorld.clone().invert();for(let it of this.chains){let k=it.root.parent.matrixWorld.clone().premultiply(Oe);this.simpleIK.solve(it.ikbones,it.target.position,k),it.ikbones.forEach((K,f)=>{if(f==it.ikbones.length-1)return;let y=K.userData.quaternion.angleTo(K.quaternion);y>.2?K.userData.quaternion.slerp(K.quaternion,.2/y):K.userData.quaternion.copy(K.quaternion)})}this.qbinds.forEach(([it,k,K])=>{let f=K?k.matrixWorld.clone().multiply(K):k.matrixWorld,y=this._tmpQ0.setFromRotationMatrix(it.parent.matrixWorld).invert();it.quaternion.copy(this._tmpQ1.setFromRotationMatrix(f).premultiply(y))})}}},remove(){this.el.removeEventListener("model-loaded",this.onVrmLoaded);for(let Ke of this.targetEls)this.el.removeChild(Ke)}});})();
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * gl-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
/**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
/**
 * @license
 * webvr-polyfill
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * webvr-polyfill-dpdb
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * webvr-polyfill-dpdb 
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * wglu-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
//# sourceMappingURL=aframe-vrm.min.js.map
